{"timesteps_since_restore": 41758, "training_iteration": 1, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-48-54", "episode_reward_min": 550.2845894989842, "timesteps_this_iter": 41758, "episode_reward_mean": 611.8553720702851, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 1, "custom_metrics": {"outflow_rate_max": 778.2211428571428, "cost2_min": -121.76710835736728, "cost1_mean": 217.45370115602472, "cost2_mean": -100.31695390611827, "system_level_velocity_mean": 8.192488649080955, "cost1_max": 253.62120491364894, "cost1_min": 188.42655250337322, "cost2_max": -82.93786827094306, "outflow_rate_mean": 521.1622000000001, "system_level_velocity_min": 7.170052126097283, "outflow_rate_min": 299.24285714285713, "system_level_velocity_max": 9.36462105248388}, "info": {"num_steps_trained": 41758, "load_time_ms": 118.5, "grad_time_ms": 10563.781, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00020310266700107604, "total_loss": 2.8533947467803955, "vf_loss": 2.853205442428589, "policy_loss": 0.0001488172565586865, "cur_kl_coeff": 0.20000003278255463, "vf_explained_var": 0.8935970067977905, "entropy": 1.4237021207809448}, "update_time_ms": 2701.916, "num_steps_sampled": 41758, "sample_time_ms": 42472.558}, "episode_len_mean": 700.0, "time_this_iter_s": 55.990975856781006, "num_metric_batches_dropped": 0, "timesteps_total": 41758, "episodes_total": 6, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6cc0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbfd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6b38>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222534, "episode_reward_max": 671.7383039727224, "episodes_this_iter": 6, "time_total_s": 55.990975856781006, "time_since_restore": 55.990975856781006}
{"timesteps_since_restore": 92486, "training_iteration": 2, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-49-23", "episode_reward_min": 549.8601207077484, "timesteps_this_iter": 50728, "episode_reward_mean": 670.7293171769759, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 2, "custom_metrics": {"outflow_rate_max": 1018.6465610389611, "cost2_min": -149.94480735153454, "cost1_mean": 232.59768287401178, "cost2_mean": -114.8711131944528, "system_level_velocity_mean": 8.777087777268836, "cost1_max": 316.17015459302513, "cost1_min": 188.42655250337322, "cost2_max": -82.93786827094306, "outflow_rate_mean": 531.5643883116883, "system_level_velocity_min": 7.170052126097283, "outflow_rate_min": 299.24285714285713, "system_level_velocity_max": 11.934867067451526}, "info": {"num_steps_trained": 92486, "load_time_ms": 76.419, "grad_time_ms": 10892.683, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.004030262120068073, "total_loss": 1.895986795425415, "vf_loss": 1.8964757919311523, "policy_loss": -0.0008919740212149918, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.9454070329666138, "entropy": 1.4240071773529053}, "update_time_ms": 1354.696, "num_steps_sampled": 92486, "sample_time_ms": 30366.885}, "episode_len_mean": 700.0, "time_this_iter_s": 29.618935346603394, "num_metric_batches_dropped": 0, "timesteps_total": 92486, "episodes_total": 16, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f94611700f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f94611701d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170b38>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222563, "episode_reward_max": 963.5571193461321, "episodes_this_iter": 10, "time_total_s": 85.6099112033844, "time_since_restore": 85.6099112033844}
{"timesteps_since_restore": 140641, "training_iteration": 3, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-49-53", "episode_reward_min": 160.1156134062967, "timesteps_this_iter": 48155, "episode_reward_mean": 702.4068213082066, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 3, "custom_metrics": {"outflow_rate_max": 1018.6465610389611, "cost2_min": -171.79369441336576, "cost1_mean": 234.43774610917504, "cost2_mean": -128.78363987224336, "system_level_velocity_mean": 9.369773204912411, "cost1_max": 316.17015459302513, "cost1_min": 73.89490794327375, "cost2_max": -50.791251494571554, "outflow_rate_mean": 526.0025320104687, "system_level_velocity_min": 6.847808552791286, "outflow_rate_min": 147.0997142857143, "system_level_velocity_max": 19.453003195287604}, "info": {"num_steps_trained": 140641, "load_time_ms": 64.493, "grad_time_ms": 10444.45, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.004687816835939884, "total_loss": 1.6860157251358032, "vf_loss": 1.6867822408676147, "policy_loss": -0.0010010276455432177, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9809187054634094, "entropy": 1.415357232093811}, "update_time_ms": 905.151, "num_steps_sampled": 140641, "sample_time_ms": 26864.904}, "episode_len_mean": 682.0, "time_this_iter_s": 29.55806255340576, "num_metric_batches_dropped": 0, "timesteps_total": 140641, "episodes_total": 33, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03550>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd035c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222593, "episode_reward_max": 963.5571193461321, "episodes_this_iter": 17, "time_total_s": 115.16797375679016, "time_since_restore": 115.16797375679016}
{"timesteps_since_restore": 189885, "training_iteration": 4, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-50-20", "episode_reward_min": 160.1156134062967, "timesteps_this_iter": 49244, "episode_reward_mean": 720.924329977, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 4, "custom_metrics": {"outflow_rate_max": 1018.6465610389611, "cost2_min": -171.79369441336576, "cost1_mean": 238.57744305889366, "cost2_mean": -128.96717037802097, "system_level_velocity_mean": 9.40546843522459, "cost1_max": 316.17015459302513, "cost1_min": 73.89490794327375, "cost2_max": -50.791251494571554, "outflow_rate_mean": 557.7617462333535, "system_level_velocity_min": 6.847808552791286, "outflow_rate_min": 147.0997142857143, "system_level_velocity_max": 19.453003195287604}, "info": {"num_steps_trained": 189885, "load_time_ms": 52.456, "grad_time_ms": 10417.496, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006130380090326071, "total_loss": 1.6923969984054565, "vf_loss": 1.6937742233276367, "policy_loss": -0.001530697918497026, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9823589324951172, "entropy": 1.4182624816894531}, "update_time_ms": 681.013, "num_steps_sampled": 189885, "sample_time_ms": 24420.886}, "episode_len_mean": 686.5, "time_this_iter_s": 27.54292893409729, "num_metric_batches_dropped": 0, "timesteps_total": 189885, "episodes_total": 44, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf668>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdfa20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdfc88>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222620, "episode_reward_max": 963.5571193461321, "episodes_this_iter": 11, "time_total_s": 142.71090269088745, "time_since_restore": 142.71090269088745}
{"timesteps_since_restore": 234229, "training_iteration": 5, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-50-46", "episode_reward_min": 160.1156134062967, "timesteps_this_iter": 44344, "episode_reward_mean": 745.8650621837154, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 5, "custom_metrics": {"outflow_rate_max": 1018.6465610389611, "cost2_min": -171.79369441336576, "cost1_mean": 244.50472596178722, "cost2_mean": -130.664138888798, "system_level_velocity_mean": 9.545450487178208, "cost1_max": 316.68400631159005, "cost1_min": 73.89490794327375, "cost2_max": -50.791251494571554, "outflow_rate_mean": 591.9906584696323, "system_level_velocity_min": 6.847808552791286, "outflow_rate_min": 147.0997142857143, "system_level_velocity_max": 19.453003195287604}, "info": {"num_steps_trained": 234229, "load_time_ms": 44.559, "grad_time_ms": 10301.443, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010768319480121136, "total_loss": 1.978090524673462, "vf_loss": 1.9812935590744019, "policy_loss": -0.0034723179414868355, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9850195646286011, "entropy": 1.4110286235809326}, "update_time_ms": 546.494, "num_steps_sampled": 234229, "sample_time_ms": 22631.125}, "episode_len_mean": 689.578947368421, "time_this_iter_s": 25.404654502868652, "num_metric_batches_dropped": 0, "timesteps_total": 234229, "episodes_total": 57, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd550>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222646, "episode_reward_max": 1060.3797979707563, "episodes_this_iter": 13, "time_total_s": 168.1155571937561, "time_since_restore": 168.1155571937561}
{"timesteps_since_restore": 281556, "training_iteration": 6, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-51-13", "episode_reward_min": 160.1156134062967, "timesteps_this_iter": 47327, "episode_reward_mean": 757.5930772781243, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 6, "custom_metrics": {"outflow_rate_max": 1018.6465610389611, "cost2_min": -171.79369441336576, "cost1_mean": 245.75927788985447, "cost2_mean": -128.71231535355193, "system_level_velocity_mean": 9.521323851519703, "cost1_max": 330.6487724183961, "cost1_min": 73.89490794327375, "cost2_max": -50.791251494571554, "outflow_rate_mean": 620.2941352855729, "system_level_velocity_min": 6.847808552791286, "outflow_rate_min": 147.0997142857143, "system_level_velocity_max": 19.453003195287604}, "info": {"num_steps_trained": 281556, "load_time_ms": 39.876, "grad_time_ms": 10423.567, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.005772748962044716, "total_loss": 3.4058966636657715, "vf_loss": 3.4077987670898438, "policy_loss": -0.00204682070761919, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9653202891349792, "entropy": 1.4047904014587402}, "update_time_ms": 456.96, "num_steps_sampled": 281556, "sample_time_ms": 21457.335}, "episode_len_mean": 691.75, "time_this_iter_s": 26.73099184036255, "num_metric_batches_dropped": 0, "timesteps_total": 281556, "episodes_total": 72, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd630>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222673, "episode_reward_max": 1060.3797979707563, "episodes_this_iter": 15, "time_total_s": 194.84654903411865, "time_since_restore": 194.84654903411865}
{"timesteps_since_restore": 326939, "training_iteration": 7, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-51-38", "episode_reward_min": 160.1156134062967, "timesteps_this_iter": 45383, "episode_reward_mean": 787.0447831042993, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 7, "custom_metrics": {"outflow_rate_max": 1018.6465610389611, "cost2_min": -171.79369441336576, "cost1_mean": 248.04977420717006, "cost2_mean": -129.623988181366, "system_level_velocity_mean": 9.556747310394593, "cost1_max": 330.6487724183961, "cost1_min": 73.89490794327375, "cost2_max": -50.791251494571554, "outflow_rate_mean": 646.8293769277994, "system_level_velocity_min": 6.847808552791286, "outflow_rate_min": 147.0997142857143, "system_level_velocity_max": 19.453003195287604}, "info": {"num_steps_trained": 326939, "load_time_ms": 36.174, "grad_time_ms": 10433.479, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.005844687111675739, "total_loss": 3.8082964420318604, "vf_loss": 3.809640645980835, "policy_loss": -0.0014903998235240579, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.966253936290741, "entropy": 1.389821171760559}, "update_time_ms": 392.742, "num_steps_sampled": 326939, "sample_time_ms": 20506.457}, "episode_len_mean": 693.0117647058823, "time_this_iter_s": 25.398860216140747, "num_metric_batches_dropped": 0, "timesteps_total": 326939, "episodes_total": 85, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03588>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03320>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222698, "episode_reward_max": 1133.5417001870692, "episodes_this_iter": 13, "time_total_s": 220.2454092502594, "time_since_restore": 220.2454092502594}
{"timesteps_since_restore": 373791, "training_iteration": 8, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-52-06", "episode_reward_min": 160.1156134062967, "timesteps_this_iter": 46852, "episode_reward_mean": 821.4945921619156, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 8, "custom_metrics": {"outflow_rate_max": 1018.6465610389611, "cost2_min": -190.07380074983567, "cost1_mean": 249.79353674534386, "cost2_mean": -132.307742599156, "system_level_velocity_mean": 9.56683317465599, "cost1_max": 330.6487724183961, "cost1_min": 73.89490794327375, "cost2_max": -50.791251494571554, "outflow_rate_mean": 677.1134914116066, "system_level_velocity_min": 6.847808552791286, "outflow_rate_min": 147.0997142857143, "system_level_velocity_max": 19.453003195287604}, "info": {"num_steps_trained": 373791, "load_time_ms": 33.669, "grad_time_ms": 10449.384, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00660292711108923, "total_loss": 6.049540042877197, "vf_loss": 6.050776481628418, "policy_loss": -0.0014017738867551088, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9219216108322144, "entropy": 1.3765265941619873}, "update_time_ms": 344.803, "num_steps_sampled": 373791, "sample_time_ms": 20096.94}, "episode_len_mean": 694.06, "time_this_iter_s": 27.91237187385559, "num_metric_batches_dropped": 0, "timesteps_total": 373791, "episodes_total": 100, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0198>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0b38>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222726, "episode_reward_max": 1165.1516656382582, "episodes_this_iter": 15, "time_total_s": 248.157781124115, "time_since_restore": 248.157781124115}
{"timesteps_since_restore": 418728, "training_iteration": 9, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-52-33", "episode_reward_min": 160.1156134062967, "timesteps_this_iter": 44937, "episode_reward_mean": 871.2911134537331, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 9, "custom_metrics": {"outflow_rate_max": 1018.6465610389611, "cost2_min": -192.5565540265397, "cost1_mean": 254.55784863175828, "cost2_mean": -138.64800706474557, "system_level_velocity_mean": 9.725580139645194, "cost1_max": 330.6487724183961, "cost1_min": 73.89490794327375, "cost2_max": -50.791251494571554, "outflow_rate_mean": 725.7838842827352, "system_level_velocity_min": 6.847808552791286, "outflow_rate_min": 147.0997142857143, "system_level_velocity_max": 19.453003195287604}, "info": {"num_steps_trained": 418728, "load_time_ms": 31.483, "grad_time_ms": 10346.875, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0063717360608279705, "total_loss": 4.644423961639404, "vf_loss": 4.64522123336792, "policy_loss": -0.0009564694482833147, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9481108784675598, "entropy": 1.3759355545043945}, "update_time_ms": 307.5, "num_steps_sampled": 418728, "sample_time_ms": 19827.433}, "episode_len_mean": 694.06, "time_this_iter_s": 27.29558253288269, "num_metric_batches_dropped": 0, "timesteps_total": 418728, "episodes_total": 113, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd748>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd7b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222753, "episode_reward_max": 1182.394308181192, "episodes_this_iter": 13, "time_total_s": 275.4533636569977, "time_since_restore": 275.4533636569977}
{"timesteps_since_restore": 467222, "training_iteration": 10, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-53-01", "episode_reward_min": 160.1156134062967, "timesteps_this_iter": 48494, "episode_reward_mean": 911.7885084285008, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 10, "custom_metrics": {"outflow_rate_max": 1001.856748051948, "cost2_min": -192.5565540265397, "cost1_mean": 257.56913989144766, "cost2_mean": -141.4596642600155, "system_level_velocity_mean": 9.81229905336714, "cost1_max": 330.6487724183961, "cost1_min": 73.89490794327375, "cost2_max": -50.791251494571554, "outflow_rate_mean": 764.4954742687494, "system_level_velocity_min": 6.847808552791286, "outflow_rate_min": 147.0997142857143, "system_level_velocity_max": 19.453003195287604}, "info": {"num_steps_trained": 467222, "load_time_ms": 29.834, "grad_time_ms": 10325.917, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00774582102894783, "total_loss": 4.182218551635742, "vf_loss": 4.183266639709473, "policy_loss": -0.0012414392549544573, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.9572997689247131, "entropy": 1.3535107374191284}, "update_time_ms": 277.373, "num_steps_sampled": 467222, "sample_time_ms": 19546.489}, "episode_len_mean": 694.06, "time_this_iter_s": 27.263794422149658, "num_metric_batches_dropped": 0, "timesteps_total": 467222, "episodes_total": 125, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd630>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdda0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222781, "episode_reward_max": 1182.394308181192, "episodes_this_iter": 12, "time_total_s": 302.71715807914734, "time_since_restore": 302.71715807914734}
{"timesteps_since_restore": 514700, "training_iteration": 11, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-53-28", "episode_reward_min": 598.2122583038024, "timesteps_this_iter": 47478, "episode_reward_mean": 958.9240502340413, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 11, "custom_metrics": {"outflow_rate_max": 1001.856748051948, "cost2_min": -198.02250610980985, "cost1_mean": 261.81992584680313, "cost2_mean": -147.43056228374132, "system_level_velocity_mean": 9.776311980632725, "cost1_max": 330.6487724183961, "cost1_min": 198.95816360221778, "cost2_max": -85.68334966855804, "outflow_rate_mean": 803.9686548451548, "system_level_velocity_min": 7.610945246391546, "outflow_rate_min": 459.844, "system_level_velocity_max": 12.463618213054987}, "info": {"num_steps_trained": 514700, "load_time_ms": 19.649, "grad_time_ms": 10157.368, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007079063914716244, "total_loss": 3.511047601699829, "vf_loss": 3.5123069286346436, "policy_loss": -0.001436542603187263, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.9745311737060547, "entropy": 1.3592194318771362}, "update_time_ms": 7.822, "num_steps_sampled": 514700, "sample_time_ms": 17134.169}, "episode_len_mean": 700.0, "time_this_iter_s": 27.343470573425293, "num_metric_batches_dropped": 0, "timesteps_total": 514700, "episodes_total": 139, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03320>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222808, "episode_reward_max": 1205.2994150691707, "episodes_this_iter": 14, "time_total_s": 330.06062865257263, "time_since_restore": 330.06062865257263}
{"timesteps_since_restore": 562132, "training_iteration": 12, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-53-55", "episode_reward_min": 664.3861482827296, "timesteps_this_iter": 47432, "episode_reward_mean": 995.1623244164319, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 12, "custom_metrics": {"outflow_rate_max": 1001.856748051948, "cost2_min": -208.55246410555148, "cost1_mean": 264.8619131417128, "cost2_mean": -155.67552316264144, "system_level_velocity_mean": 9.868170027481531, "cost1_max": 330.6487724183961, "cost1_min": 219.16161522430463, "cost2_max": -93.1316299106664, "outflow_rate_mean": 831.1990392927073, "system_level_velocity_min": 8.220838457703278, "outflow_rate_min": 520.8975428571429, "system_level_velocity_max": 12.463618213054987}, "info": {"num_steps_trained": 562132, "load_time_ms": 17.267, "grad_time_ms": 9917.017, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009396983310580254, "total_loss": 3.5945143699645996, "vf_loss": 3.596264600753784, "policy_loss": -0.001985114300623536, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.9718331694602966, "entropy": 1.36968195438385}, "update_time_ms": 7.776, "num_steps_sampled": 562132, "sample_time_ms": 17162.894}, "episode_len_mean": 700.0, "time_this_iter_s": 27.461042881011963, "num_metric_batches_dropped": 0, "timesteps_total": 562132, "episodes_total": 154, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0198>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222835, "episode_reward_max": 1267.313000766059, "episodes_this_iter": 15, "time_total_s": 357.5216715335846, "time_since_restore": 357.5216715335846}
{"timesteps_since_restore": 610689, "training_iteration": 13, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-54-24", "episode_reward_min": 664.3861482827296, "timesteps_this_iter": 48557, "episode_reward_mean": 1026.4808709795116, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 13, "custom_metrics": {"outflow_rate_max": 1001.856748051948, "cost2_min": -208.55246410555148, "cost1_mean": 267.98051502996043, "cost2_mean": -161.65196892838142, "system_level_velocity_mean": 9.961832458989063, "cost1_max": 330.6487724183961, "cost1_min": 221.1343252421382, "cost2_max": -93.1316299106664, "outflow_rate_mean": 853.0954456583418, "system_level_velocity_min": 8.220838457703278, "outflow_rate_min": 585.4365714285714, "system_level_velocity_max": 12.463618213054987}, "info": {"num_steps_trained": 610689, "load_time_ms": 14.657, "grad_time_ms": 10001.54, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008101154118776321, "total_loss": 3.772265672683716, "vf_loss": 3.7740237712860107, "policy_loss": -0.0019604237750172615, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9711121916770935, "entropy": 1.3686045408248901}, "update_time_ms": 7.819, "num_steps_sampled": 610689, "sample_time_ms": 16989.19}, "episode_len_mean": 700.0, "time_this_iter_s": 28.645286798477173, "num_metric_batches_dropped": 0, "timesteps_total": 610689, "episodes_total": 165, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdb00>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdeb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222864, "episode_reward_max": 1267.313000766059, "episodes_this_iter": 11, "time_total_s": 386.16695833206177, "time_since_restore": 386.16695833206177}
{"timesteps_since_restore": 657862, "training_iteration": 14, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-54-51", "episode_reward_min": 835.4124646157018, "timesteps_this_iter": 47173, "episode_reward_mean": 1056.841174212078, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 14, "custom_metrics": {"outflow_rate_max": 1001.856748051948, "cost2_min": -208.55246410555148, "cost1_mean": 269.6942748796621, "cost2_mean": -167.776257288857, "system_level_velocity_mean": 10.002685073514968, "cost1_max": 313.380081704599, "cost1_min": 229.7068856893846, "cost2_max": -106.76164505763455, "outflow_rate_mean": 866.7703497822179, "system_level_velocity_min": 8.565789585651356, "outflow_rate_min": 697.5812571428572, "system_level_velocity_max": 11.588703192369643}, "info": {"num_steps_trained": 657862, "load_time_ms": 14.454, "grad_time_ms": 10091.412, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006593969650566578, "total_loss": 4.386342525482178, "vf_loss": 4.387199878692627, "policy_loss": -0.0010219187242910266, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.965414822101593, "entropy": 1.362059235572815}, "update_time_ms": 7.788, "num_steps_sampled": 657862, "sample_time_ms": 16874.783}, "episode_len_mean": 700.0, "time_this_iter_s": 27.288938999176025, "num_metric_batches_dropped": 0, "timesteps_total": 657862, "episodes_total": 179, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdfd0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222891, "episode_reward_max": 1267.313000766059, "episodes_this_iter": 14, "time_total_s": 413.4558973312378, "time_since_restore": 413.4558973312378}
{"timesteps_since_restore": 703934, "training_iteration": 15, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-55-19", "episode_reward_min": 921.8354695252182, "timesteps_this_iter": 46072, "episode_reward_mean": 1066.1842989716447, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 15, "custom_metrics": {"outflow_rate_max": 1019.5064683316684, "cost2_min": -208.55246410555148, "cost1_mean": 272.90935069674487, "cost2_mean": -170.31170561170956, "system_level_velocity_mean": 10.114551056063148, "cost1_max": 313.380081704599, "cost1_min": 229.7068856893846, "cost2_max": -106.76164505763455, "outflow_rate_mean": 878.9796364395604, "system_level_velocity_min": 8.565789585651356, "outflow_rate_min": 697.5812571428572, "system_level_velocity_max": 11.588703192369643}, "info": {"num_steps_trained": 703934, "load_time_ms": 14.38, "grad_time_ms": 10376.274, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007816778495907784, "total_loss": 5.591668605804443, "vf_loss": 5.592851161956787, "policy_loss": -0.0013775302795693278, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9576916098594666, "entropy": 1.3580509424209595}, "update_time_ms": 7.785, "num_steps_sampled": 703934, "sample_time_ms": 16853.545}, "episode_len_mean": 700.0, "time_this_iter_s": 28.06888771057129, "num_metric_batches_dropped": 0, "timesteps_total": 703934, "episodes_total": 194, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80438>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80160>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222919, "episode_reward_max": 1267.313000766059, "episodes_this_iter": 15, "time_total_s": 441.5247850418091, "time_since_restore": 441.5247850418091}
{"timesteps_since_restore": 748567, "training_iteration": 16, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-55-46", "episode_reward_min": 934.3532970563919, "timesteps_this_iter": 44633, "episode_reward_mean": 1076.857868168464, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 16, "custom_metrics": {"outflow_rate_max": 1019.5064683316684, "cost2_min": -208.55246410555148, "cost1_mean": 276.4192541180647, "cost2_mean": -170.57786399205045, "system_level_velocity_mean": 10.23487209295191, "cost1_max": 313.380081704599, "cost1_min": 229.7068856893846, "cost2_max": -133.69575275866242, "outflow_rate_mean": 888.7184772787213, "system_level_velocity_min": 8.565789585651356, "outflow_rate_min": 697.5812571428572, "system_level_velocity_max": 11.588703192369643}, "info": {"num_steps_trained": 748567, "load_time_ms": 14.077, "grad_time_ms": 10396.211, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00802962388843298, "total_loss": 6.057303428649902, "vf_loss": 6.058797359466553, "policy_loss": -0.0016944115050137043, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9473795294761658, "entropy": 1.3357210159301758}, "update_time_ms": 7.702, "num_steps_sampled": 748567, "sample_time_ms": 16841.485}, "episode_len_mean": 700.0, "time_this_iter_s": 26.80377173423767, "num_metric_batches_dropped": 0, "timesteps_total": 748567, "episodes_total": 206, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdc88>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdfd0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222946, "episode_reward_max": 1267.313000766059, "episodes_this_iter": 12, "time_total_s": 468.32855677604675, "time_since_restore": 468.32855677604675}
{"timesteps_since_restore": 791179, "training_iteration": 17, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-56-12", "episode_reward_min": 934.3532970563919, "timesteps_this_iter": 42612, "episode_reward_mean": 1076.5634447944217, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 17, "custom_metrics": {"outflow_rate_max": 1019.5064683316684, "cost2_min": -208.55246410555148, "cost1_mean": 280.0690395103189, "cost2_mean": -165.11753247346365, "system_level_velocity_mean": 10.37081801974051, "cost1_max": 313.380081704599, "cost1_min": 229.7068856893846, "cost2_max": -111.36760408536415, "outflow_rate_mean": 898.015992919081, "system_level_velocity_min": 8.565789585651356, "outflow_rate_min": 697.5812571428572, "system_level_velocity_max": 11.588703192369643}, "info": {"num_steps_trained": 791179, "load_time_ms": 14.017, "grad_time_ms": 10329.227, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016742510721087456, "total_loss": 12.659961700439453, "vf_loss": 12.663921356201172, "policy_loss": -0.0043766433373093605, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8743063807487488, "entropy": 1.3258159160614014}, "update_time_ms": 7.812, "num_steps_sampled": 791179, "sample_time_ms": 16973.871}, "episode_len_mean": 700.0, "time_this_iter_s": 26.05631709098816, "num_metric_batches_dropped": 0, "timesteps_total": 791179, "episodes_total": 223, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03cc0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd035c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222972, "episode_reward_max": 1267.313000766059, "episodes_this_iter": 17, "time_total_s": 494.3848738670349, "time_since_restore": 494.3848738670349}
{"timesteps_since_restore": 833096, "training_iteration": 18, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-56-39", "episode_reward_min": 940.7178189655398, "timesteps_this_iter": 41917, "episode_reward_mean": 1070.0871089958732, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 18, "custom_metrics": {"outflow_rate_max": 1053.0646793206795, "cost2_min": -208.55246410555148, "cost1_mean": 280.560995001873, "cost2_mean": -153.32327802240292, "system_level_velocity_mean": 10.388546836188175, "cost1_max": 313.380081704599, "cost1_min": 229.7068856893846, "cost2_max": -80.79030719293576, "outflow_rate_mean": 908.670360067932, "system_level_velocity_min": 8.565789585651356, "outflow_rate_min": 697.5812571428572, "system_level_velocity_max": 11.588703192369643}, "info": {"num_steps_trained": 833096, "load_time_ms": 13.738, "grad_time_ms": 10217.511, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009574844501912594, "total_loss": 15.516263008117676, "vf_loss": 15.518284797668457, "policy_loss": -0.0022604959085583687, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7913985252380371, "entropy": 1.282303810119629}, "update_time_ms": 7.59, "num_steps_sampled": 833096, "sample_time_ms": 16915.046}, "episode_len_mean": 700.0, "time_this_iter_s": 26.181761264801025, "num_metric_batches_dropped": 0, "timesteps_total": 833096, "episodes_total": 239, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03978>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd032b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd037b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557222999, "episode_reward_max": 1267.313000766059, "episodes_this_iter": 16, "time_total_s": 520.5666351318359, "time_since_restore": 520.5666351318359}
{"timesteps_since_restore": 876621, "training_iteration": 19, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-57-05", "episode_reward_min": 905.4551978666416, "timesteps_this_iter": 43525, "episode_reward_mean": 1064.4562767448763, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 19, "custom_metrics": {"outflow_rate_max": 1053.0646793206795, "cost2_min": -194.5904124651239, "cost1_mean": 281.54086897505425, "cost2_mean": -142.95766290383708, "system_level_velocity_mean": 10.422824895100089, "cost1_max": 310.13115612495506, "cost1_min": 229.7068856893846, "cost2_max": -80.79030719293576, "outflow_rate_mean": 917.0098048871129, "system_level_velocity_min": 8.565789585651356, "outflow_rate_min": 697.5812571428572, "system_level_velocity_max": 11.511571300807287}, "info": {"num_steps_trained": 876621, "load_time_ms": 14.264, "grad_time_ms": 10244.393, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01131709199398756, "total_loss": 10.920926094055176, "vf_loss": 10.92393684387207, "policy_loss": -0.003293267684057355, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.8544563055038452, "entropy": 1.2921422719955444}, "update_time_ms": 7.401, "num_steps_sampled": 876621, "sample_time_ms": 16795.239}, "episode_len_mean": 700.0, "time_this_iter_s": 26.38195037841797, "num_metric_batches_dropped": 0, "timesteps_total": 876621, "episodes_total": 251, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80be0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80748>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223025, "episode_reward_max": 1198.6855125750553, "episodes_this_iter": 12, "time_total_s": 546.9485855102539, "time_since_restore": 546.9485855102539}
{"timesteps_since_restore": 918279, "training_iteration": 20, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-57-32", "episode_reward_min": 905.4551978666416, "timesteps_this_iter": 41658, "episode_reward_mean": 1061.4142634565349, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 20, "custom_metrics": {"outflow_rate_max": 1092.4621350649354, "cost2_min": -190.96511816078788, "cost1_mean": 281.11007391256885, "cost2_mean": -131.9263397724609, "system_level_velocity_mean": 10.411234993638722, "cost1_max": 310.13115612495506, "cost1_min": 229.7068856893846, "cost2_max": -80.79030719293576, "outflow_rate_mean": 918.0581281758242, "system_level_velocity_min": 8.565789585651356, "outflow_rate_min": 697.5812571428572, "system_level_velocity_max": 11.511571300807287}, "info": {"num_steps_trained": 918279, "load_time_ms": 13.98, "grad_time_ms": 10153.924, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.022651657462120056, "total_loss": 14.398248672485352, "vf_loss": 14.4025239944458, "policy_loss": -0.004843102302402258, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.8575552105903625, "entropy": 1.2772244215011597}, "update_time_ms": 7.718, "num_steps_sampled": 918279, "sample_time_ms": 16837.868}, "episode_len_mean": 700.0, "time_this_iter_s": 26.797024250030518, "num_metric_batches_dropped": 0, "timesteps_total": 918279, "episodes_total": 265, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdbe0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfda20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd780>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223052, "episode_reward_max": 1198.6855125750553, "episodes_this_iter": 14, "time_total_s": 573.7456097602844, "time_since_restore": 573.7456097602844}
{"timesteps_since_restore": 958977, "training_iteration": 21, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-57-56", "episode_reward_min": 905.4551978666416, "timesteps_this_iter": 40698, "episode_reward_mean": 1053.626770383024, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 21, "custom_metrics": {"outflow_rate_max": 1122.937361038961, "cost2_min": -178.76065606306017, "cost1_mean": 285.535212659591, "cost2_mean": -119.14513893814157, "system_level_velocity_mean": 10.599862428118113, "cost1_max": 321.1540291533261, "cost1_min": 247.20526567862169, "cost2_max": -75.7134087007501, "outflow_rate_mean": 944.0589139260742, "system_level_velocity_min": 9.115885220009798, "outflow_rate_min": 749.2240571428572, "system_level_velocity_max": 11.994729451645307}, "info": {"num_steps_trained": 958977, "load_time_ms": 13.519, "grad_time_ms": 10170.624, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01161213032901287, "total_loss": 15.991686820983887, "vf_loss": 15.994756698608398, "policy_loss": -0.0035065626725554466, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.7888326048851013, "entropy": 1.2531853914260864}, "update_time_ms": 7.833, "num_steps_sampled": 958977, "sample_time_ms": 16523.934}, "episode_len_mean": 700.0, "time_this_iter_s": 24.362977504730225, "num_metric_batches_dropped": 0, "timesteps_total": 958977, "episodes_total": 281, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd1d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd940>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223076, "episode_reward_max": 1198.6855125750553, "episodes_this_iter": 16, "time_total_s": 598.1085872650146, "time_since_restore": 598.1085872650146}
{"timesteps_since_restore": 1001446, "training_iteration": 22, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-58-22", "episode_reward_min": 902.0102538729882, "timesteps_this_iter": 42469, "episode_reward_mean": 1043.3736272622536, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 22, "custom_metrics": {"outflow_rate_max": 1122.937361038961, "cost2_min": -162.35247925244067, "cost1_mean": 286.09345178178444, "cost2_mean": -105.50280754592605, "system_level_velocity_mean": 10.64565309725406, "cost1_max": 321.1540291533261, "cost1_min": 247.20526567862169, "cost2_max": -63.743302542304434, "outflow_rate_mean": 950.889813150849, "system_level_velocity_min": 9.115885220009798, "outflow_rate_min": 749.2240571428572, "system_level_velocity_max": 11.994729451645307}, "info": {"num_steps_trained": 1001446, "load_time_ms": 13.707, "grad_time_ms": 10246.164, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011063260957598686, "total_loss": 17.736291885375977, "vf_loss": 17.73724937438965, "policy_loss": -0.0013729037018492818, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.7880190014839172, "entropy": 1.2364641427993774}, "update_time_ms": 8.042, "num_steps_sampled": 1001446, "sample_time_ms": 16264.663}, "episode_len_mean": 700.0, "time_this_iter_s": 25.63100838661194, "num_metric_batches_dropped": 0, "timesteps_total": 1001446, "episodes_total": 298, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9461150940>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461150c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f94611500f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223102, "episode_reward_max": 1198.6855125750553, "episodes_this_iter": 17, "time_total_s": 623.7395956516266, "time_since_restore": 623.7395956516266}
{"timesteps_since_restore": 1043689, "training_iteration": 23, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-58-49", "episode_reward_min": 902.0102538729882, "timesteps_this_iter": 42243, "episode_reward_mean": 1047.6504476595653, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 23, "custom_metrics": {"outflow_rate_max": 1132.6888895104896, "cost2_min": -142.5824586129305, "cost1_mean": 288.1366193453328, "cost2_mean": -99.27158840152634, "system_level_velocity_mean": 10.727140453405239, "cost1_max": 324.874041409367, "cost1_min": 247.20526567862169, "cost2_max": -63.743302542304434, "outflow_rate_mean": 962.6150980699302, "system_level_velocity_min": 9.115885220009798, "outflow_rate_min": 749.2240571428572, "system_level_velocity_max": 12.043692385463167}, "info": {"num_steps_trained": 1043689, "load_time_ms": 13.556, "grad_time_ms": 10177.229, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010093875229358673, "total_loss": 14.299853324890137, "vf_loss": 14.301365852355957, "policy_loss": -0.0018894488457590342, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.8572929501533508, "entropy": 1.2418543100357056}, "update_time_ms": 8.157, "num_steps_sampled": 1043689, "sample_time_ms": 16143.147}, "episode_len_mean": 700.0, "time_this_iter_s": 26.734915018081665, "num_metric_batches_dropped": 0, "timesteps_total": 1043689, "episodes_total": 316, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80630>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223129, "episode_reward_max": 1236.9386648990444, "episodes_this_iter": 18, "time_total_s": 650.4745106697083, "time_since_restore": 650.4745106697083}
{"timesteps_since_restore": 1086632, "training_iteration": 24, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-59-16", "episode_reward_min": 902.0102538729882, "timesteps_this_iter": 42943, "episode_reward_mean": 1057.7921002632636, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 24, "custom_metrics": {"outflow_rate_max": 1193.5530157842156, "cost2_min": -127.72716199872393, "cost1_mean": 292.19769630490805, "cost2_mean": -99.20996060303874, "system_level_velocity_mean": 10.87877664572619, "cost1_max": 326.4560376113709, "cost1_min": 247.20526567862169, "cost2_max": -63.743302542304434, "outflow_rate_mean": 980.8282325994008, "system_level_velocity_min": 9.115885220009798, "outflow_rate_min": 749.2240571428572, "system_level_velocity_max": 12.14257065432228}, "info": {"num_steps_trained": 1086632, "load_time_ms": 13.34, "grad_time_ms": 10044.875, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010312552563846111, "total_loss": 10.725591659545898, "vf_loss": 10.72746467590332, "policy_loss": -0.002258847001940012, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9050965309143066, "entropy": 1.237612247467041}, "update_time_ms": 8.019, "num_steps_sampled": 1086632, "sample_time_ms": 16260.251}, "episode_len_mean": 700.0, "time_this_iter_s": 27.12456464767456, "num_metric_batches_dropped": 0, "timesteps_total": 1086632, "episodes_total": 329, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd0f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223156, "episode_reward_max": 1236.9386648990444, "episodes_this_iter": 13, "time_total_s": 677.5990753173828, "time_since_restore": 677.5990753173828}
{"timesteps_since_restore": 1128747, "training_iteration": 25, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_09-59-43", "episode_reward_min": 419.78303205554914, "timesteps_this_iter": 42115, "episode_reward_mean": 1077.2493348619644, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 25, "custom_metrics": {"outflow_rate_max": 1273.7387584415583, "cost2_min": -146.69135119020945, "cost1_mean": 297.1307527204281, "cost2_mean": -102.34654597537404, "system_level_velocity_mean": 11.172674517327223, "cost1_max": 352.66789757378035, "cost1_min": 141.83565227242252, "cost2_max": -63.743302542304434, "outflow_rate_mean": 1008.5378994290771, "system_level_velocity_min": 9.115885220009798, "outflow_rate_min": 688.599448202402, "system_level_velocity_max": 16.515816928480042}, "info": {"num_steps_trained": 1128747, "load_time_ms": 13.575, "grad_time_ms": 9744.363, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010380572639405727, "total_loss": 15.759777069091797, "vf_loss": 15.761198997497559, "policy_loss": -0.0018108340445905924, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.8778373003005981, "entropy": 1.247047781944275}, "update_time_ms": 7.946, "num_steps_sampled": 1128747, "sample_time_ms": 16461.399}, "episode_len_mean": 695.25, "time_this_iter_s": 27.068904161453247, "num_metric_batches_dropped": 0, "timesteps_total": 1128747, "episodes_total": 345, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f94611ba9e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdcf8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223183, "episode_reward_max": 1281.8850640859266, "episodes_this_iter": 16, "time_total_s": 704.6679794788361, "time_since_restore": 704.6679794788361}
{"timesteps_since_restore": 1172061, "training_iteration": 26, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-00-09", "episode_reward_min": 419.78303205554914, "timesteps_this_iter": 43314, "episode_reward_mean": 1101.6654883441304, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 26, "custom_metrics": {"outflow_rate_max": 1286.7938925074925, "cost2_min": -159.49530054855944, "cost1_mean": 303.7443828696789, "cost2_mean": -107.78612420050352, "system_level_velocity_mean": 11.413167205843155, "cost1_max": 362.14335280098675, "cost1_min": 141.83565227242252, "cost2_max": -63.743302542304434, "outflow_rate_mean": 1036.6379070534526, "system_level_velocity_min": 9.366940136632623, "outflow_rate_min": 688.599448202402, "system_level_velocity_max": 16.515816928480042}, "info": {"num_steps_trained": 1172061, "load_time_ms": 13.419, "grad_time_ms": 9568.58, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009348271414637566, "total_loss": 10.638111114501953, "vf_loss": 10.640073776245117, "policy_loss": -0.002312936121597886, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9213042855262756, "entropy": 1.2513346672058105}, "update_time_ms": 7.763, "num_steps_sampled": 1172061, "sample_time_ms": 16605.103}, "episode_len_mean": 695.25, "time_this_iter_s": 26.473931789398193, "num_metric_batches_dropped": 0, "timesteps_total": 1172061, "episodes_total": 359, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80898>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc804e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80048>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223209, "episode_reward_max": 1355.7586060401534, "episodes_this_iter": 14, "time_total_s": 731.1419112682343, "time_since_restore": 731.1419112682343}
{"timesteps_since_restore": 1215556, "training_iteration": 27, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-00-36", "episode_reward_min": 419.78303205554914, "timesteps_this_iter": 43495, "episode_reward_mean": 1119.4111024878387, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 27, "custom_metrics": {"outflow_rate_max": 1286.7938925074925, "cost2_min": -159.49530054855944, "cost1_mean": 310.1631437964904, "cost2_mean": -112.4137809382856, "system_level_velocity_mean": 11.641741023416749, "cost1_max": 362.14335280098675, "cost1_min": 141.83565227242252, "cost2_max": -63.743302542304434, "outflow_rate_mean": 1060.1160495509548, "system_level_velocity_min": 9.502685042938998, "outflow_rate_min": 688.599448202402, "system_level_velocity_max": 16.515816928480042}, "info": {"num_steps_trained": 1215556, "load_time_ms": 13.369, "grad_time_ms": 9558.383, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011060989461839199, "total_loss": 10.082986831665039, "vf_loss": 10.084440231323242, "policy_loss": -0.0018684043316170573, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9273427724838257, "entropy": 1.243607521057129}, "update_time_ms": 7.667, "num_steps_sampled": 1215556, "sample_time_ms": 16623.648}, "episode_len_mean": 695.25, "time_this_iter_s": 26.125341415405273, "num_metric_batches_dropped": 0, "timesteps_total": 1215556, "episodes_total": 372, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80940>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc800f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223236, "episode_reward_max": 1355.7586060401534, "episodes_this_iter": 13, "time_total_s": 757.2672526836395, "time_since_restore": 757.2672526836395}
{"timesteps_since_restore": 1258512, "training_iteration": 28, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-01-02", "episode_reward_min": 419.78303205554914, "timesteps_this_iter": 42956, "episode_reward_mean": 1147.981620269593, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 28, "custom_metrics": {"outflow_rate_max": 1286.7938925074925, "cost2_min": -159.49530054855944, "cost1_mean": 315.7709831690452, "cost2_mean": -121.03806190250087, "system_level_velocity_mean": 11.823042931830582, "cost1_max": 362.14335280098675, "cost1_min": 141.83565227242252, "cost2_max": -67.75069966324479, "outflow_rate_mean": 1081.0966589695367, "system_level_velocity_min": 9.502685042938998, "outflow_rate_min": 688.599448202402, "system_level_velocity_max": 16.515816928480042}, "info": {"num_steps_trained": 1258512, "load_time_ms": 13.442, "grad_time_ms": 9563.934, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010097378864884377, "total_loss": 11.23813247680664, "vf_loss": 11.239435195922852, "policy_loss": -0.0016822017496451735, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9295880198478699, "entropy": 1.2549779415130615}, "update_time_ms": 7.543, "num_steps_sampled": 1258512, "sample_time_ms": 16615.062}, "episode_len_mean": 695.25, "time_this_iter_s": 26.158468008041382, "num_metric_batches_dropped": 0, "timesteps_total": 1258512, "episodes_total": 389, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a748>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ada0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ad68>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223262, "episode_reward_max": 1355.7586060401534, "episodes_this_iter": 17, "time_total_s": 783.4257206916809, "time_since_restore": 783.4257206916809}
{"timesteps_since_restore": 1302625, "training_iteration": 29, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-01-29", "episode_reward_min": 419.78303205554914, "timesteps_this_iter": 44113, "episode_reward_mean": 1176.6075641398245, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 29, "custom_metrics": {"outflow_rate_max": 1316.0259424575422, "cost2_min": -163.18891509904898, "cost1_mean": 322.4662147280476, "cost2_mean": -129.4149614386006, "system_level_velocity_mean": 12.056149358044339, "cost1_max": 364.4442258662498, "cost1_min": 141.83565227242252, "cost2_max": -73.60021759747215, "outflow_rate_mean": 1112.0468132192868, "system_level_velocity_min": 10.467649227353961, "outflow_rate_min": 688.599448202402, "system_level_velocity_max": 16.515816928480042}, "info": {"num_steps_trained": 1302625, "load_time_ms": 12.999, "grad_time_ms": 9555.675, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00945256371051073, "total_loss": 9.826250076293945, "vf_loss": 9.827881813049316, "policy_loss": -0.0019869536627084017, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9399265646934509, "entropy": 1.2480814456939697}, "update_time_ms": 7.526, "num_steps_sampled": 1302625, "sample_time_ms": 16662.302}, "episode_len_mean": 695.25, "time_this_iter_s": 26.76915669441223, "num_metric_batches_dropped": 0, "timesteps_total": 1302625, "episodes_total": 404, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80438>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223289, "episode_reward_max": 1363.0659042677903, "episodes_this_iter": 15, "time_total_s": 810.1948773860931, "time_since_restore": 810.1948773860931}
{"timesteps_since_restore": 1345808, "training_iteration": 30, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-01-56", "episode_reward_min": 419.78303205554914, "timesteps_this_iter": 43183, "episode_reward_mean": 1193.9229782988355, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 30, "custom_metrics": {"outflow_rate_max": 1360.2682229770228, "cost2_min": -179.2206501401282, "cost1_mean": 325.67049553625225, "cost2_mean": -136.84627981674953, "system_level_velocity_mean": 12.163799141522826, "cost1_max": 364.4442258662498, "cost1_min": 141.83565227242252, "cost2_max": -73.60021759747215, "outflow_rate_mean": 1128.8173079605453, "system_level_velocity_min": 10.48311952148746, "outflow_rate_min": 688.599448202402, "system_level_velocity_max": 16.515816928480042}, "info": {"num_steps_trained": 1345808, "load_time_ms": 13.1, "grad_time_ms": 9610.306, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01197835337370634, "total_loss": 6.812007904052734, "vf_loss": 6.814793586730957, "policy_loss": -0.0032339810859411955, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9637175798416138, "entropy": 1.251945972442627}, "update_time_ms": 7.426, "num_steps_sampled": 1345808, "sample_time_ms": 16686.711}, "episode_len_mean": 695.25, "time_this_iter_s": 27.56934142112732, "num_metric_batches_dropped": 0, "timesteps_total": 1345808, "episodes_total": 418, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03a58>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd4a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223316, "episode_reward_max": 1363.0659042677903, "episodes_this_iter": 14, "time_total_s": 837.7642188072205, "time_since_restore": 837.7642188072205}
{"timesteps_since_restore": 1390815, "training_iteration": 31, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-02-24", "episode_reward_min": 419.78303205554914, "timesteps_this_iter": 45007, "episode_reward_mean": 1204.7148428002859, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 31, "custom_metrics": {"outflow_rate_max": 1360.2682229770228, "cost2_min": -179.2206501401282, "cost1_mean": 327.9764257789819, "cost2_mean": -142.5504945117613, "system_level_velocity_mean": 12.237742527759574, "cost1_max": 375.40715641021245, "cost1_min": 141.83565227242252, "cost2_max": -73.60021759747215, "outflow_rate_mean": 1138.7613676808253, "system_level_velocity_min": 10.48311952148746, "outflow_rate_min": 688.599448202402, "system_level_velocity_max": 16.515816928480042}, "info": {"num_steps_trained": 1390815, "load_time_ms": 13.271, "grad_time_ms": 9724.392, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009479202330112457, "total_loss": 7.110844135284424, "vf_loss": 7.111778736114502, "policy_loss": -0.0012901126174256206, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9495081305503845, "entropy": 1.2580726146697998}, "update_time_ms": 7.413, "num_steps_sampled": 1390815, "sample_time_ms": 16946.549}, "episode_len_mean": 695.25, "time_this_iter_s": 28.100879430770874, "num_metric_batches_dropped": 0, "timesteps_total": 1390815, "episodes_total": 432, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc808d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc803c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80b00>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223344, "episode_reward_max": 1363.0659042677903, "episodes_this_iter": 14, "time_total_s": 865.8650982379913, "time_since_restore": 865.8650982379913}
{"timesteps_since_restore": 1436437, "training_iteration": 32, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-02-53", "episode_reward_min": 51.34617381928326, "timesteps_this_iter": 45622, "episode_reward_mean": 1209.7036398598766, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 32, "custom_metrics": {"outflow_rate_max": 1360.2682229770228, "cost2_min": -183.07787952332507, "cost1_mean": 328.30723091109525, "cost2_mean": -147.0710146246639, "system_level_velocity_mean": 12.311819073716364, "cost1_max": 375.40715641021245, "cost1_min": 29.04093123985732, "cost2_max": -25.833824881406212, "outflow_rate_mean": 1142.334556217548, "system_level_velocity_min": 10.95220765506077, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.616113613629963}, "info": {"num_steps_trained": 1436437, "load_time_ms": 13.47, "grad_time_ms": 9789.225, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011119686998426914, "total_loss": 9.694740295410156, "vf_loss": 9.696426391601562, "policy_loss": -0.002102071652188897, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9412878751754761, "entropy": 1.226172924041748}, "update_time_ms": 7.366, "num_steps_sampled": 1436437, "sample_time_ms": 17204.062}, "episode_len_mean": 693.43, "time_this_iter_s": 28.870614290237427, "num_metric_batches_dropped": 0, "timesteps_total": 1436437, "episodes_total": 446, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03f98>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03550>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223373, "episode_reward_max": 1363.0659042677903, "episodes_this_iter": 14, "time_total_s": 894.7357125282288, "time_since_restore": 894.7357125282288}
{"timesteps_since_restore": 1479910, "training_iteration": 33, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-03-20", "episode_reward_min": 51.34617381928326, "timesteps_this_iter": 43473, "episode_reward_mean": 1202.9213320604897, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 33, "custom_metrics": {"outflow_rate_max": 1360.2682229770228, "cost2_min": -183.07787952332507, "cost1_mean": 325.2790027232329, "cost2_mean": -151.04246629232426, "system_level_velocity_mean": 12.358244768369302, "cost1_max": 375.40715641021245, "cost1_min": 29.04093123985732, "cost2_max": -25.399303225341797, "outflow_rate_mean": 1135.7200042218208, "system_level_velocity_min": 10.95220765506077, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.616113613629963}, "info": {"num_steps_trained": 1479910, "load_time_ms": 13.517, "grad_time_ms": 9796.203, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009221495129168034, "total_loss": 9.613832473754883, "vf_loss": 9.615509986877441, "policy_loss": -0.0020241711754351854, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9496164917945862, "entropy": 1.2078337669372559}, "update_time_ms": 7.449, "num_steps_sampled": 1479910, "sample_time_ms": 17205.565}, "episode_len_mean": 686.93, "time_this_iter_s": 26.816088914871216, "num_metric_batches_dropped": 0, "timesteps_total": 1479910, "episodes_total": 462, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8aa20>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8afd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a4a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223400, "episode_reward_max": 1363.0659042677903, "episodes_this_iter": 16, "time_total_s": 921.5518014431, "time_since_restore": 921.5518014431}
{"timesteps_since_restore": 1523039, "training_iteration": 34, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-03-47", "episode_reward_min": 51.34617381928326, "timesteps_this_iter": 43129, "episode_reward_mean": 1212.9255849840713, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 34, "custom_metrics": {"outflow_rate_max": 1360.2682229770228, "cost2_min": -183.07787952332507, "cost1_mean": 325.63747916734366, "cost2_mean": -156.94625199370944, "system_level_velocity_mean": 12.36277484060386, "cost1_max": 375.40715641021245, "cost1_min": 29.04093123985732, "cost2_max": -25.399303225341797, "outflow_rate_mean": 1142.5466526094333, "system_level_velocity_min": 10.95220765506077, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.616113613629963}, "info": {"num_steps_trained": 1523039, "load_time_ms": 13.502, "grad_time_ms": 9771.622, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008812041953206062, "total_loss": 12.141251564025879, "vf_loss": 12.142732620239258, "policy_loss": -0.001811643480323255, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9184350371360779, "entropy": 1.203487515449524}, "update_time_ms": 7.764, "num_steps_sampled": 1523039, "sample_time_ms": 17183.409}, "episode_len_mean": 686.93, "time_this_iter_s": 26.663957834243774, "num_metric_batches_dropped": 0, "timesteps_total": 1523039, "episodes_total": 481, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80cf8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80dd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223427, "episode_reward_max": 1376.1992329764807, "episodes_this_iter": 19, "time_total_s": 948.2157592773438, "time_since_restore": 948.2157592773438}
{"timesteps_since_restore": 1566795, "training_iteration": 35, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-04-14", "episode_reward_min": 51.34617381928326, "timesteps_this_iter": 43756, "episode_reward_mean": 1218.1296034066138, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 35, "custom_metrics": {"outflow_rate_max": 1360.2682229770228, "cost2_min": -183.07787952332507, "cost1_mean": 326.3771993661847, "cost2_mean": -159.60253600810879, "system_level_velocity_mean": 12.386951678780813, "cost1_max": 375.40715641021245, "cost1_min": 29.04093123985732, "cost2_max": -25.399303225341797, "outflow_rate_mean": 1147.3716928571857, "system_level_velocity_min": 10.958737289484509, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.616113613629963}, "info": {"num_steps_trained": 1566795, "load_time_ms": 13.524, "grad_time_ms": 9825.318, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01059117540717125, "total_loss": 7.195093631744385, "vf_loss": 7.197338104248047, "policy_loss": -0.002641440834850073, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9459314346313477, "entropy": 1.2005232572555542}, "update_time_ms": 7.677, "num_steps_sampled": 1566795, "sample_time_ms": 17159.703}, "episode_len_mean": 686.93, "time_this_iter_s": 27.369250774383545, "num_metric_batches_dropped": 0, "timesteps_total": 1566795, "episodes_total": 492, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80898>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc807f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80c50>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223454, "episode_reward_max": 1376.1992329764807, "episodes_this_iter": 11, "time_total_s": 975.5850100517273, "time_since_restore": 975.5850100517273}
{"timesteps_since_restore": 1611068, "training_iteration": 36, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-04-40", "episode_reward_min": 51.34617381928326, "timesteps_this_iter": 44273, "episode_reward_mean": 1215.5844168309834, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 36, "custom_metrics": {"outflow_rate_max": 1360.2682229770228, "cost2_min": -183.07787952332507, "cost1_mean": 324.86531855108353, "cost2_mean": -160.69350653201792, "system_level_velocity_mean": 12.328874809878043, "cost1_max": 375.40715641021245, "cost1_min": 29.04093123985732, "cost2_max": -25.399303225341797, "outflow_rate_mean": 1141.5593506793637, "system_level_velocity_min": 10.958737289484509, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.616113613629963}, "info": {"num_steps_trained": 1611068, "load_time_ms": 13.634, "grad_time_ms": 9880.986, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009797761216759682, "total_loss": 7.797687530517578, "vf_loss": 7.799612045288086, "policy_loss": -0.0022921522613614798, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9499258995056152, "entropy": 1.1836020946502686}, "update_time_ms": 7.74, "num_steps_sampled": 1611068, "sample_time_ms": 17042.938}, "episode_len_mean": 686.93, "time_this_iter_s": 25.885406017303467, "num_metric_batches_dropped": 0, "timesteps_total": 1611068, "episodes_total": 504, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a400>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8af98>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223480, "episode_reward_max": 1376.1992329764807, "episodes_this_iter": 12, "time_total_s": 1001.4704160690308, "time_since_restore": 1001.4704160690308}
{"timesteps_since_restore": 1654354, "training_iteration": 37, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-05-06", "episode_reward_min": 51.34617381928326, "timesteps_this_iter": 43286, "episode_reward_mean": 1214.0384403555443, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 37, "custom_metrics": {"outflow_rate_max": 1340.931000999001, "cost2_min": -183.07787952332507, "cost1_mean": 322.94881274263696, "cost2_mean": -159.18745864946928, "system_level_velocity_mean": 12.258397499098248, "cost1_max": 375.40715641021245, "cost1_min": 29.04093123985732, "cost2_max": -25.399303225341797, "outflow_rate_mean": 1144.5410324256172, "system_level_velocity_min": 10.625833316356374, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.616113613629963}, "info": {"num_steps_trained": 1654354, "load_time_ms": 13.636, "grad_time_ms": 9892.164, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010463058948516846, "total_loss": 14.61889934539795, "vf_loss": 14.62147331237793, "policy_loss": -0.0029671203810721636, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.8923283815383911, "entropy": 1.175735592842102}, "update_time_ms": 7.708, "num_steps_sampled": 1654354, "sample_time_ms": 17038.651}, "episode_len_mean": 686.93, "time_this_iter_s": 26.197956562042236, "num_metric_batches_dropped": 0, "timesteps_total": 1654354, "episodes_total": 520, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a7f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ae48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8aac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223506, "episode_reward_max": 1376.1992329764807, "episodes_this_iter": 16, "time_total_s": 1027.668372631073, "time_since_restore": 1027.668372631073}
{"timesteps_since_restore": 1696405, "training_iteration": 38, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-05-32", "episode_reward_min": 51.34617381928326, "timesteps_this_iter": 42051, "episode_reward_mean": 1210.0361563480838, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 38, "custom_metrics": {"outflow_rate_max": 1340.931000999001, "cost2_min": -183.07787952332507, "cost1_mean": 322.14190293612216, "cost2_mean": -156.40390962991495, "system_level_velocity_mean": 12.237848437460162, "cost1_max": 369.57186125215463, "cost1_min": 29.04093123985732, "cost2_max": -25.399303225341797, "outflow_rate_mean": 1146.991056489553, "system_level_velocity_min": 10.625833316356374, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.616113613629963}, "info": {"num_steps_trained": 1696405, "load_time_ms": 13.459, "grad_time_ms": 9883.132, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012777162715792656, "total_loss": 14.455106735229492, "vf_loss": 14.456524848937988, "policy_loss": -0.001898059737868607, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9074877500534058, "entropy": 1.163066029548645}, "update_time_ms": 7.749, "num_steps_sampled": 1696405, "sample_time_ms": 16995.386}, "episode_len_mean": 686.93, "time_this_iter_s": 25.63563060760498, "num_metric_batches_dropped": 0, "timesteps_total": 1696405, "episodes_total": 537, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fcf8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fe10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f710>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223532, "episode_reward_max": 1376.1992329764807, "episodes_this_iter": 17, "time_total_s": 1053.304003238678, "time_since_restore": 1053.304003238678}
{"timesteps_since_restore": 1738231, "training_iteration": 39, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-05-59", "episode_reward_min": 584.546762441456, "timesteps_this_iter": 41826, "episode_reward_mean": 1213.8332887155977, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 39, "custom_metrics": {"outflow_rate_max": 1394.2242025974026, "cost2_min": -181.5635313942995, "cost1_mean": 326.78273846833, "cost2_mean": -154.39405431181734, "system_level_velocity_mean": 12.151556470340294, "cost1_max": 369.57186125215463, "cost1_min": 179.98316809924077, "cost2_max": -98.69640219495741, "outflow_rate_mean": 1159.6912986891016, "system_level_velocity_min": 10.625833316356374, "outflow_rate_min": 832.1819760030666, "system_level_velocity_max": 14.87383782052704}, "info": {"num_steps_trained": 1738231, "load_time_ms": 13.265, "grad_time_ms": 9856.349, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01147457305341959, "total_loss": 12.832294464111328, "vf_loss": 12.833882331848145, "policy_loss": -0.0020182582084089518, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9329342246055603, "entropy": 1.1603033542633057}, "update_time_ms": 8.118, "num_steps_sampled": 1738231, "sample_time_ms": 17015.285}, "episode_len_mean": 696.16, "time_this_iter_s": 26.69175410270691, "num_metric_batches_dropped": 0, "timesteps_total": 1738231, "episodes_total": 555, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f9b0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f128>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223559, "episode_reward_max": 1376.1992329764807, "episodes_this_iter": 18, "time_total_s": 1079.995757341385, "time_since_restore": 1079.995757341385}
{"timesteps_since_restore": 1781915, "training_iteration": 40, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-06-25", "episode_reward_min": 584.546762441456, "timesteps_this_iter": 43684, "episode_reward_mean": 1210.1589204729025, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 40, "custom_metrics": {"outflow_rate_max": 1394.2242025974026, "cost2_min": -181.0539703535179, "cost1_mean": 327.68121070916726, "cost2_mean": -152.32776743775563, "system_level_velocity_mean": 12.208415363106294, "cost1_max": 370.34685264990566, "cost1_min": 179.98316809924077, "cost2_max": -98.69640219495741, "outflow_rate_mean": 1161.3638585612296, "system_level_velocity_min": 10.625833316356374, "outflow_rate_min": 832.1819760030666, "system_level_velocity_max": 14.87383782052704}, "info": {"num_steps_trained": 1781915, "load_time_ms": 13.31, "grad_time_ms": 9887.722, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012161433696746826, "total_loss": 12.285545349121094, "vf_loss": 12.289307594299316, "policy_loss": -0.004219406750053167, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9264429807662964, "entropy": 1.158253788948059}, "update_time_ms": 8.301, "num_steps_sampled": 1781915, "sample_time_ms": 16880.101}, "episode_len_mean": 696.16, "time_this_iter_s": 26.550789833068848, "num_metric_batches_dropped": 0, "timesteps_total": 1781915, "episodes_total": 570, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03240>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03828>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223585, "episode_reward_max": 1400.5220636780355, "episodes_this_iter": 15, "time_total_s": 1106.5465471744537, "time_since_restore": 1106.5465471744537}
{"timesteps_since_restore": 1824289, "training_iteration": 41, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-06-51", "episode_reward_min": 60.26016001081254, "timesteps_this_iter": 42374, "episode_reward_mean": 1192.0507615921226, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 41, "custom_metrics": {"outflow_rate_max": 1394.2242025974026, "cost2_min": -175.70325033757985, "cost1_mean": 325.20571616992527, "cost2_mean": -149.03986962818274, "system_level_velocity_mean": 12.305445774209169, "cost1_max": 370.34685264990566, "cost1_min": 33.62387766260007, "cost2_max": -27.75688571431607, "outflow_rate_mean": 1154.0592175716574, "system_level_velocity_min": 10.625833316356374, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.66794004564656}, "info": {"num_steps_trained": 1824289, "load_time_ms": 13.181, "grad_time_ms": 9906.729, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01647116057574749, "total_loss": 9.17802906036377, "vf_loss": 9.183708190917969, "policy_loss": -0.006296746898442507, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9366987943649292, "entropy": 1.1314260959625244}, "update_time_ms": 8.367, "num_steps_sampled": 1824289, "sample_time_ms": 16581.492}, "episode_len_mean": 689.66, "time_this_iter_s": 25.306214570999146, "num_metric_batches_dropped": 0, "timesteps_total": 1824289, "episodes_total": 581, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a828>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ab00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8aac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223611, "episode_reward_max": 1400.5220636780355, "episodes_this_iter": 11, "time_total_s": 1131.8527617454529, "time_since_restore": 1131.8527617454529}
{"timesteps_since_restore": 1867668, "training_iteration": 42, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-07-16", "episode_reward_min": 60.26016001081254, "timesteps_this_iter": 43379, "episode_reward_mean": 1188.7295676395097, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 42, "custom_metrics": {"outflow_rate_max": 1394.2242025974026, "cost2_min": -175.70325033757985, "cost1_mean": 327.97075417689643, "cost2_mean": -147.81936037978653, "system_level_velocity_mean": 12.437631800528418, "cost1_max": 381.65026261000605, "cost1_min": 33.62387766260007, "cost2_max": -27.75688571431607, "outflow_rate_mean": 1164.3787781470821, "system_level_velocity_min": 10.625833316356374, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.66794004564656}, "info": {"num_steps_trained": 1867668, "load_time_ms": 13.187, "grad_time_ms": 9932.087, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013476284220814705, "total_loss": 15.503331184387207, "vf_loss": 15.507046699523926, "policy_loss": -0.004220306407660246, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9016618728637695, "entropy": 1.1312785148620605}, "update_time_ms": 8.484, "num_steps_sampled": 1867668, "sample_time_ms": 16226.242}, "episode_len_mean": 689.66, "time_this_iter_s": 25.559012413024902, "num_metric_batches_dropped": 0, "timesteps_total": 1867668, "episodes_total": 596, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f668>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f8d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223636, "episode_reward_max": 1400.5220636780355, "episodes_this_iter": 15, "time_total_s": 1157.4117741584778, "time_since_restore": 1157.4117741584778}
{"timesteps_since_restore": 1909738, "training_iteration": 43, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-07-41", "episode_reward_min": 60.26016001081254, "timesteps_this_iter": 42070, "episode_reward_mean": 1190.8604255292557, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 43, "custom_metrics": {"outflow_rate_max": 1394.2242025974026, "cost2_min": -176.71331872623955, "cost1_mean": 332.7028878144657, "cost2_mean": -149.1664677628573, "system_level_velocity_mean": 12.634430254236765, "cost1_max": 381.65026261000605, "cost1_min": 33.62387766260007, "cost2_max": -27.75688571431607, "outflow_rate_mean": 1179.5438835376917, "system_level_velocity_min": 10.625833316356374, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.66794004564656}, "info": {"num_steps_trained": 1909738, "load_time_ms": 13.046, "grad_time_ms": 9943.791, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014498868957161903, "total_loss": 10.074858665466309, "vf_loss": 10.078991889953613, "policy_loss": -0.004676795098930597, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9514680504798889, "entropy": 1.1402562856674194}, "update_time_ms": 8.529, "num_steps_sampled": 1909738, "sample_time_ms": 15981.884}, "episode_len_mean": 689.66, "time_this_iter_s": 24.473173141479492, "num_metric_batches_dropped": 0, "timesteps_total": 1909738, "episodes_total": 613, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f9b0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223661, "episode_reward_max": 1400.5220636780355, "episodes_this_iter": 17, "time_total_s": 1181.8849472999573, "time_since_restore": 1181.8849472999573}
{"timesteps_since_restore": 1951253, "training_iteration": 44, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-08-07", "episode_reward_min": 56.25567895891196, "timesteps_this_iter": 41515, "episode_reward_mean": 1180.4997443534041, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 44, "custom_metrics": {"outflow_rate_max": 1394.2242025974026, "cost2_min": -177.26269735161665, "cost1_mean": 330.76271599174476, "cost2_mean": -150.0761819170484, "system_level_velocity_mean": 12.746555806333243, "cost1_max": 381.65026261000605, "cost1_min": 28.9494239747141, "cost2_max": -22.17259169395747, "outflow_rate_mean": 1174.4420659581315, "system_level_velocity_min": 10.806552264939224, "outflow_rate_min": 330.66536012591945, "system_level_velocity_max": 18.66794004564656}, "info": {"num_steps_trained": 1951253, "load_time_ms": 13.09, "grad_time_ms": 10004.966, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012389617040753365, "total_loss": 14.569998741149902, "vf_loss": 14.571879386901855, "policy_loss": -0.0023463829420506954, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9267828464508057, "entropy": 1.1685512065887451}, "update_time_ms": 8.458, "num_steps_sampled": 1951253, "sample_time_ms": 15847.405}, "episode_len_mean": 683.1, "time_this_iter_s": 25.92928910255432, "num_metric_batches_dropped": 0, "timesteps_total": 1951253, "episodes_total": 632, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a390>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8aef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f470>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223687, "episode_reward_max": 1400.5220636780355, "episodes_this_iter": 19, "time_total_s": 1207.8142364025116, "time_since_restore": 1207.8142364025116}
{"timesteps_since_restore": 1995576, "training_iteration": 45, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-08-33", "episode_reward_min": 56.25567895891196, "timesteps_this_iter": 44323, "episode_reward_mean": 1187.008644655881, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 45, "custom_metrics": {"outflow_rate_max": 1385.7973694305695, "cost2_min": -177.26269735161665, "cost1_mean": 332.5584615893401, "cost2_mean": -150.63247070779246, "system_level_velocity_mean": 12.738831572006061, "cost1_max": 381.65026261000605, "cost1_min": 28.9494239747141, "cost2_max": -22.17259169395747, "outflow_rate_mean": 1175.7284638964024, "system_level_velocity_min": 10.806552264939224, "outflow_rate_min": 330.66536012591945, "system_level_velocity_max": 18.66794004564656}, "info": {"num_steps_trained": 1995576, "load_time_ms": 12.884, "grad_time_ms": 10077.467, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011834593489766121, "total_loss": 8.817841529846191, "vf_loss": 8.820406913757324, "policy_loss": -0.003009156323969364, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9391218423843384, "entropy": 1.1818615198135376}, "update_time_ms": 8.51, "num_steps_sampled": 1995576, "sample_time_ms": 15639.0}, "episode_len_mean": 686.94, "time_this_iter_s": 25.99399495124817, "num_metric_batches_dropped": 0, "timesteps_total": 1995576, "episodes_total": 645, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc807b8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8af28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8abe0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223713, "episode_reward_max": 1400.5220636780355, "episodes_this_iter": 13, "time_total_s": 1233.8082313537598, "time_since_restore": 1233.8082313537598}
{"timesteps_since_restore": 2038164, "training_iteration": 46, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-08-58", "episode_reward_min": 56.25567895891196, "timesteps_this_iter": 42588, "episode_reward_mean": 1186.870135132821, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 46, "custom_metrics": {"outflow_rate_max": 1385.7973694305695, "cost2_min": -177.26269735161665, "cost1_mean": 330.64787221584623, "cost2_mean": -150.37629744998497, "system_level_velocity_mean": 12.671666174246262, "cost1_max": 381.65026261000605, "cost1_min": 28.9494239747141, "cost2_max": -22.17259169395747, "outflow_rate_mean": 1170.1085148974014, "system_level_velocity_min": 10.806552264939224, "outflow_rate_min": 330.66536012591945, "system_level_velocity_max": 18.66794004564656}, "info": {"num_steps_trained": 2038164, "load_time_ms": 12.945, "grad_time_ms": 10150.471, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013032088987529278, "total_loss": 10.312271118164062, "vf_loss": 10.315110206604004, "policy_loss": -0.003327123122289777, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9323137402534485, "entropy": 1.1542788743972778}, "update_time_ms": 8.733, "num_steps_sampled": 2038164, "sample_time_ms": 15520.63}, "episode_len_mean": 686.94, "time_this_iter_s": 25.42074680328369, "num_metric_batches_dropped": 0, "timesteps_total": 2038164, "episodes_total": 657, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fb38>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f0b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223738, "episode_reward_max": 1356.0298581473626, "episodes_this_iter": 12, "time_total_s": 1259.2289781570435, "time_since_restore": 1259.2289781570435}
{"timesteps_since_restore": 2080491, "training_iteration": 47, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-09-24", "episode_reward_min": 56.25567895891196, "timesteps_this_iter": 42327, "episode_reward_mean": 1188.8305274952638, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 47, "custom_metrics": {"outflow_rate_max": 1363.771044955045, "cost2_min": -177.26269735161665, "cost1_mean": 330.6775047964765, "cost2_mean": -150.8655355780724, "system_level_velocity_mean": 12.670469024569034, "cost1_max": 381.65026261000605, "cost1_min": 28.9494239747141, "cost2_max": -22.17259169395747, "outflow_rate_mean": 1173.8422966676312, "system_level_velocity_min": 10.806552264939224, "outflow_rate_min": 330.66536012591945, "system_level_velocity_max": 18.66794004564656}, "info": {"num_steps_trained": 2080491, "load_time_ms": 13.016, "grad_time_ms": 10264.053, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014678915031254292, "total_loss": 12.940608978271484, "vf_loss": 12.94340991973877, "policy_loss": -0.0033510662615299225, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.923905074596405, "entropy": 1.1603924036026}, "update_time_ms": 8.772, "num_steps_sampled": 2080491, "sample_time_ms": 15352.644}, "episode_len_mean": 686.94, "time_this_iter_s": 25.683483362197876, "num_metric_batches_dropped": 0, "timesteps_total": 2080491, "episodes_total": 673, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc808d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc804e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80f98>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223764, "episode_reward_max": 1346.1873382490237, "episodes_this_iter": 16, "time_total_s": 1284.9124615192413, "time_since_restore": 1284.9124615192413}
{"timesteps_since_restore": 2123617, "training_iteration": 48, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-09-51", "episode_reward_min": 56.25567895891196, "timesteps_this_iter": 43126, "episode_reward_mean": 1196.665906887241, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 48, "custom_metrics": {"outflow_rate_max": 1363.771044955045, "cost2_min": -182.3032631994355, "cost1_mean": 333.01094776859725, "cost2_mean": -154.45210671899468, "system_level_velocity_mean": 12.672221858440182, "cost1_max": 381.65026261000605, "cost1_min": 28.9494239747141, "cost2_max": -22.17259169395747, "outflow_rate_mean": 1184.6140848997886, "system_level_velocity_min": 10.806552264939224, "outflow_rate_min": 330.66536012591945, "system_level_velocity_max": 18.593643858117883}, "info": {"num_steps_trained": 2123617, "load_time_ms": 13.319, "grad_time_ms": 10388.406, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012645031325519085, "total_loss": 13.443655967712402, "vf_loss": 13.446868896484375, "policy_loss": -0.003687912132591009, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9460906982421875, "entropy": 1.167384147644043}, "update_time_ms": 9.014, "num_steps_sampled": 2123617, "sample_time_ms": 15336.734}, "episode_len_mean": 689.35, "time_this_iter_s": 26.746123790740967, "num_metric_batches_dropped": 0, "timesteps_total": 2123617, "episodes_total": 690, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95208>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc959e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223791, "episode_reward_max": 1375.6180777841726, "episodes_this_iter": 17, "time_total_s": 1311.6585853099823, "time_since_restore": 1311.6585853099823}
{"timesteps_since_restore": 2166671, "training_iteration": 49, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-10-17", "episode_reward_min": 56.25567895891196, "timesteps_this_iter": 43054, "episode_reward_mean": 1186.7191163739187, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 49, "custom_metrics": {"outflow_rate_max": 1377.510708091908, "cost2_min": -188.7396024685017, "cost1_mean": 328.61502013017446, "cost2_mean": -155.13751334084463, "system_level_velocity_mean": 12.67367452632609, "cost1_max": 379.05248090655505, "cost1_min": 28.9494239747141, "cost2_max": -22.17259169395747, "outflow_rate_mean": 1169.9680122901602, "system_level_velocity_min": 10.806552264939224, "outflow_rate_min": 327.6328597164795, "system_level_velocity_max": 18.593643858117883}, "info": {"num_steps_trained": 2166671, "load_time_ms": 13.066, "grad_time_ms": 10487.214, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015356394462287426, "total_loss": 8.062642097473145, "vf_loss": 8.065956115722656, "policy_loss": -0.0038885255344212055, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9687463641166687, "entropy": 1.1649118661880493}, "update_time_ms": 8.878, "num_steps_sampled": 2166671, "sample_time_ms": 15165.121}, "episode_len_mean": 682.86, "time_this_iter_s": 25.97161316871643, "num_metric_batches_dropped": 0, "timesteps_total": 2166671, "episodes_total": 705, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9461150320>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223817, "episode_reward_max": 1375.6180777841726, "episodes_this_iter": 15, "time_total_s": 1337.6301984786987, "time_since_restore": 1337.6301984786987}
{"timesteps_since_restore": 2211647, "training_iteration": 50, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-10-43", "episode_reward_min": 62.19744055385922, "timesteps_this_iter": 44976, "episode_reward_mean": 1197.425854124082, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 50, "custom_metrics": {"outflow_rate_max": 1377.510708091908, "cost2_min": -188.7396024685017, "cost1_mean": 331.3882482605058, "cost2_mean": -158.30202791655012, "system_level_velocity_mean": 12.599525961364291, "cost1_max": 379.05248090655505, "cost1_min": 34.147577726684055, "cost2_max": -23.34291534298653, "outflow_rate_mean": 1177.6687057937963, "system_level_velocity_min": 10.806552264939224, "outflow_rate_min": 327.6328597164795, "system_level_velocity_max": 18.378989322641317}, "info": {"num_steps_trained": 2211647, "load_time_ms": 13.108, "grad_time_ms": 10566.975, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010950155556201935, "total_loss": 6.022100448608398, "vf_loss": 6.02487325668335, "policy_loss": -0.003183052409440279, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9793968200683594, "entropy": 1.1374098062515259}, "update_time_ms": 8.54, "num_steps_sampled": 2211647, "sample_time_ms": 15092.536}, "episode_len_mean": 689.42, "time_this_iter_s": 26.610628128051758, "num_metric_batches_dropped": 0, "timesteps_total": 2211647, "episodes_total": 721, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f978>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ff60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223843, "episode_reward_max": 1375.6180777841726, "episodes_this_iter": 16, "time_total_s": 1364.2408266067505, "time_since_restore": 1364.2408266067505}
{"timesteps_since_restore": 2256269, "training_iteration": 51, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-11-10", "episode_reward_min": 62.19744055385922, "timesteps_this_iter": 44622, "episode_reward_mean": 1203.1000908874607, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 51, "custom_metrics": {"outflow_rate_max": 1377.510708091908, "cost2_min": -192.7899770271415, "cost1_mean": 334.85491654279707, "cost2_mean": -159.86546483748918, "system_level_velocity_mean": 12.739569779150495, "cost1_max": 391.9558851369029, "cost1_min": 34.147577726684055, "cost2_max": -23.34291534298653, "outflow_rate_mean": 1182.042569845744, "system_level_velocity_min": 10.836222609145292, "outflow_rate_min": 327.6328597164795, "system_level_velocity_max": 18.378989322641317}, "info": {"num_steps_trained": 2256269, "load_time_ms": 13.295, "grad_time_ms": 10588.141, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013994542881846428, "total_loss": 6.457111358642578, "vf_loss": 6.460847854614258, "policy_loss": -0.004261147230863571, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9756322503089905, "entropy": 1.1165293455123901}, "update_time_ms": 8.509, "num_steps_sampled": 2256269, "sample_time_ms": 15220.622}, "episode_len_mean": 689.42, "time_this_iter_s": 26.793533086776733, "num_metric_batches_dropped": 0, "timesteps_total": 2256269, "episodes_total": 734, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd780>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfda20>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223870, "episode_reward_max": 1379.0752544941251, "episodes_this_iter": 13, "time_total_s": 1391.0343596935272, "time_since_restore": 1391.0343596935272}
{"timesteps_since_restore": 2299668, "training_iteration": 52, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-11-36", "episode_reward_min": 62.19744055385922, "timesteps_this_iter": 43399, "episode_reward_mean": 1213.220597610948, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 52, "custom_metrics": {"outflow_rate_max": 1420.4864719280718, "cost2_min": -192.7899770271415, "cost1_mean": 337.70085076639594, "cost2_mean": -163.78107157440246, "system_level_velocity_mean": 12.947121997690212, "cost1_max": 391.9558851369029, "cost1_min": 34.147577726684055, "cost2_max": -23.34291534298653, "outflow_rate_mean": 1197.1994120891923, "system_level_velocity_min": 11.227500530460151, "outflow_rate_min": 327.6328597164795, "system_level_velocity_max": 18.378989322641317}, "info": {"num_steps_trained": 2299668, "load_time_ms": 13.117, "grad_time_ms": 10542.706, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013969296589493752, "total_loss": 9.538311004638672, "vf_loss": 9.542098045349121, "policy_loss": -0.0043100761249661446, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9628594517707825, "entropy": 1.1057058572769165}, "update_time_ms": 8.167, "num_steps_sampled": 2299668, "sample_time_ms": 15298.995}, "episode_len_mean": 684.69, "time_this_iter_s": 25.879557847976685, "num_metric_batches_dropped": 0, "timesteps_total": 2299668, "episodes_total": 750, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95dd8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95160>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223896, "episode_reward_max": 1477.2926692423055, "episodes_this_iter": 16, "time_total_s": 1416.913917541504, "time_since_restore": 1416.913917541504}
{"timesteps_since_restore": 2344189, "training_iteration": 53, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-12-03", "episode_reward_min": 54.162288504516155, "timesteps_this_iter": 44521, "episode_reward_mean": 1213.0400330738842, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 53, "custom_metrics": {"outflow_rate_max": 1420.4864719280718, "cost2_min": -201.2368908575839, "cost1_mean": 337.0506639971359, "cost2_mean": -167.51208271000579, "system_level_velocity_mean": 13.10052763787977, "cost1_max": 391.9558851369029, "cost1_min": 28.910807547382916, "cost2_max": -23.34291534298653, "outflow_rate_mean": 1194.1380449144856, "system_level_velocity_min": 11.227500530460151, "outflow_rate_min": 327.6328597164795, "system_level_velocity_max": 19.56325211764407}, "info": {"num_steps_trained": 2344189, "load_time_ms": 13.439, "grad_time_ms": 10490.252, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012162812985479832, "total_loss": 6.508990287780762, "vf_loss": 6.512556076049805, "policy_loss": -0.004022021312266588, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9790059924125671, "entropy": 1.130947232246399}, "update_time_ms": 8.021, "num_steps_sampled": 2344189, "sample_time_ms": 15651.362}, "episode_len_mean": 678.12, "time_this_iter_s": 27.47289729118347, "num_metric_batches_dropped": 0, "timesteps_total": 2344189, "episodes_total": 767, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a2e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ae10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a4e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223923, "episode_reward_max": 1477.2926692423055, "episodes_this_iter": 17, "time_total_s": 1444.3868148326874, "time_since_restore": 1444.3868148326874}
{"timesteps_since_restore": 2390667, "training_iteration": 54, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-12-32", "episode_reward_min": 54.162288504516155, "timesteps_this_iter": 46478, "episode_reward_mean": 1221.34642189384, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 54, "custom_metrics": {"outflow_rate_max": 1420.4864719280718, "cost2_min": -201.2368908575839, "cost1_mean": 337.84868266849327, "cost2_mean": -169.87241615011487, "system_level_velocity_mean": 13.126602120992375, "cost1_max": 391.9558851369029, "cost1_min": 28.910807547382916, "cost2_max": -23.34291534298653, "outflow_rate_mean": 1196.2712748447905, "system_level_velocity_min": 11.227500530460151, "outflow_rate_min": 327.6328597164795, "system_level_velocity_max": 19.56325211764407}, "info": {"num_steps_trained": 2390667, "load_time_ms": 13.636, "grad_time_ms": 10439.719, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014214753173291683, "total_loss": 4.2236008644104, "vf_loss": 4.2278242111206055, "policy_loss": -0.0047563547268509865, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9836035966873169, "entropy": 1.1283020973205566}, "update_time_ms": 7.716, "num_steps_sampled": 2390667, "sample_time_ms": 15961.21}, "episode_len_mean": 678.12, "time_this_iter_s": 28.51883816719055, "num_metric_batches_dropped": 0, "timesteps_total": 2390667, "episodes_total": 778, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f4e0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f4a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223952, "episode_reward_max": 1477.2926692423055, "episodes_this_iter": 11, "time_total_s": 1472.905652999878, "time_since_restore": 1472.905652999878}
{"timesteps_since_restore": 2435360, "training_iteration": 55, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-12-58", "episode_reward_min": 54.162288504516155, "timesteps_this_iter": 44693, "episode_reward_mean": 1223.6399151869582, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 55, "custom_metrics": {"outflow_rate_max": 1420.4864719280718, "cost2_min": -201.2368908575839, "cost1_mean": 338.6065313828895, "cost2_mean": -170.83959785841637, "system_level_velocity_mean": 13.059250240957134, "cost1_max": 391.9558851369029, "cost1_min": 28.910807547382916, "cost2_max": -23.34291534298653, "outflow_rate_mean": 1189.6159837980092, "system_level_velocity_min": 10.460965044503503, "outflow_rate_min": 327.6328597164795, "system_level_velocity_max": 19.56325211764407}, "info": {"num_steps_trained": 2435360, "load_time_ms": 13.669, "grad_time_ms": 10199.838, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013581141829490662, "total_loss": 4.355003356933594, "vf_loss": 4.359148025512695, "policy_loss": -0.004653781186789274, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9863427877426147, "entropy": 1.097967505455017}, "update_time_ms": 7.644, "num_steps_sampled": 2435360, "sample_time_ms": 16173.566}, "episode_len_mean": 682.21, "time_this_iter_s": 25.72092294692993, "num_metric_batches_dropped": 0, "timesteps_total": 2435360, "episodes_total": 792, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80978>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc806a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd160>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557223978, "episode_reward_max": 1477.2926692423055, "episodes_this_iter": 14, "time_total_s": 1498.6265759468079, "time_since_restore": 1498.6265759468079}
{"timesteps_since_restore": 2479044, "training_iteration": 56, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-13-25", "episode_reward_min": 54.162288504516155, "timesteps_this_iter": 43684, "episode_reward_mean": 1239.6349621281781, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 56, "custom_metrics": {"outflow_rate_max": 1420.4864719280718, "cost2_min": -201.2368908575839, "cost1_mean": 342.0372964524158, "cost2_mean": -173.04301733346222, "system_level_velocity_mean": 13.013217775200467, "cost1_max": 391.9558851369029, "cost1_min": 28.910807547382916, "cost2_max": -25.729523207158078, "outflow_rate_mean": 1196.6018412294043, "system_level_velocity_min": 10.460965044503503, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.56325211764407}, "info": {"num_steps_trained": 2479044, "load_time_ms": 13.828, "grad_time_ms": 10023.236, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012627423740923405, "total_loss": 5.017534255981445, "vf_loss": 5.020449638366699, "policy_loss": -0.0033888397738337517, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9846107363700867, "entropy": 1.1078141927719116}, "update_time_ms": 7.304, "num_steps_sampled": 2479044, "sample_time_ms": 16578.784}, "episode_len_mean": 688.7, "time_this_iter_s": 27.718942642211914, "num_metric_batches_dropped": 0, "timesteps_total": 2479044, "episodes_total": 810, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80748>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80080>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224005, "episode_reward_max": 1477.2926692423055, "episodes_this_iter": 18, "time_total_s": 1526.3455185890198, "time_since_restore": 1526.3455185890198}
{"timesteps_since_restore": 2523456, "training_iteration": 57, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-13-52", "episode_reward_min": 54.162288504516155, "timesteps_this_iter": 44412, "episode_reward_mean": 1251.182221165987, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 57, "custom_metrics": {"outflow_rate_max": 1420.4864719280718, "cost2_min": -204.09933280358365, "cost1_mean": 343.9707959056291, "cost2_mean": -174.8749211072654, "system_level_velocity_mean": 13.089533418341782, "cost1_max": 409.6656381768408, "cost1_min": 28.910807547382916, "cost2_max": -25.729523207158078, "outflow_rate_mean": 1198.5862766461055, "system_level_velocity_min": 10.460965044503503, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.56325211764407}, "info": {"num_steps_trained": 2523456, "load_time_ms": 13.756, "grad_time_ms": 9752.923, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013395079411566257, "total_loss": 4.360260009765625, "vf_loss": 4.363394260406494, "policy_loss": -0.0036364903207868338, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9852998852729797, "entropy": 1.0845791101455688}, "update_time_ms": 7.452, "num_steps_sampled": 2523456, "sample_time_ms": 16927.274}, "episode_len_mean": 688.7, "time_this_iter_s": 26.4512619972229, "num_metric_batches_dropped": 0, "timesteps_total": 2523456, "episodes_total": 822, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80588>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224032, "episode_reward_max": 1477.2926692423055, "episodes_this_iter": 12, "time_total_s": 1552.7967805862427, "time_since_restore": 1552.7967805862427}
{"timesteps_since_restore": 2566663, "training_iteration": 58, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-14-18", "episode_reward_min": 54.162288504516155, "timesteps_this_iter": 43207, "episode_reward_mean": 1246.0853233358614, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 58, "custom_metrics": {"outflow_rate_max": 1420.4864719280718, "cost2_min": -204.09933280358365, "cost1_mean": 342.4027001445269, "cost2_mean": -175.49517309434796, "system_level_velocity_mean": 13.134359695572892, "cost1_max": 409.6656381768408, "cost1_min": 28.910807547382916, "cost2_max": -25.729523207158078, "outflow_rate_mean": 1198.949157281608, "system_level_velocity_min": 10.460965044503503, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.56325211764407}, "info": {"num_steps_trained": 2566663, "load_time_ms": 13.364, "grad_time_ms": 9527.119, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01506936177611351, "total_loss": 6.2816243171691895, "vf_loss": 6.284847736358643, "policy_loss": -0.003788791596889496, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9815346002578735, "entropy": 1.0846388339996338}, "update_time_ms": 7.505, "num_steps_sampled": 2566663, "sample_time_ms": 17101.823}, "episode_len_mean": 684.07, "time_this_iter_s": 26.20672607421875, "num_metric_batches_dropped": 0, "timesteps_total": 2566663, "episodes_total": 837, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc804e0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc802e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224058, "episode_reward_max": 1534.2229186141785, "episodes_this_iter": 15, "time_total_s": 1579.0035066604614, "time_since_restore": 1579.0035066604614}
{"timesteps_since_restore": 2611938, "training_iteration": 59, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-14-47", "episode_reward_min": 446.6982586747564, "timesteps_this_iter": 45275, "episode_reward_mean": 1257.9185367169564, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 59, "custom_metrics": {"outflow_rate_max": 1402.3548995004994, "cost2_min": -204.09933280358365, "cost1_mean": 345.2268618613663, "cost2_mean": -178.02330869588732, "system_level_velocity_mean": 12.956349399014707, "cost1_max": 409.6656381768408, "cost1_min": 142.81503957585255, "cost2_max": -79.81602860164841, "outflow_rate_mean": 1198.3705743869277, "system_level_velocity_min": 10.460965044503503, "outflow_rate_min": 718.7936838358781, "system_level_velocity_max": 15.870793126766594}, "info": {"num_steps_trained": 2611938, "load_time_ms": 13.486, "grad_time_ms": 9539.976, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013507788069546223, "total_loss": 6.467263698577881, "vf_loss": 6.470796585083008, "policy_loss": -0.004039184655994177, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9757968783378601, "entropy": 1.111219882965088}, "update_time_ms": 7.528, "num_steps_sampled": 2611938, "sample_time_ms": 17365.341}, "episode_len_mean": 695.37, "time_this_iter_s": 28.748584270477295, "num_metric_batches_dropped": 0, "timesteps_total": 2611938, "episodes_total": 855, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc959e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc952b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224087, "episode_reward_max": 1534.2229186141785, "episodes_this_iter": 18, "time_total_s": 1607.7520909309387, "time_since_restore": 1607.7520909309387}
{"timesteps_since_restore": 2656694, "training_iteration": 60, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-15-13", "episode_reward_min": 446.6982586747564, "timesteps_this_iter": 44756, "episode_reward_mean": 1263.3142315873285, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 60, "custom_metrics": {"outflow_rate_max": 1435.5798161485573, "cost2_min": -205.46338508888635, "cost1_mean": 346.60379415183206, "cost2_mean": -178.64956423661144, "system_level_velocity_mean": 13.00402413039509, "cost1_max": 409.6656381768408, "cost1_min": 142.81503957585255, "cost2_max": -79.81602860164841, "outflow_rate_mean": 1204.192888725883, "system_level_velocity_min": 10.460965044503503, "outflow_rate_min": 718.7936838358781, "system_level_velocity_max": 15.870793126766594}, "info": {"num_steps_trained": 2656694, "load_time_ms": 13.206, "grad_time_ms": 9467.893, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015141395851969719, "total_loss": 5.881447792053223, "vf_loss": 5.884089946746826, "policy_loss": -0.003209375776350498, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9788356423377991, "entropy": 1.0919456481933594}, "update_time_ms": 7.772, "num_steps_sampled": 2656694, "sample_time_ms": 17357.869}, "episode_len_mean": 695.37, "time_this_iter_s": 25.813108921051025, "num_metric_batches_dropped": 0, "timesteps_total": 2656694, "episodes_total": 863, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f0f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f278>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224113, "episode_reward_max": 1534.2229186141785, "episodes_this_iter": 8, "time_total_s": 1633.5651998519897, "time_since_restore": 1633.5651998519897}
{"timesteps_since_restore": 2700159, "training_iteration": 61, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-15-40", "episode_reward_min": 446.6982586747564, "timesteps_this_iter": 43465, "episode_reward_mean": 1261.2233071790483, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 61, "custom_metrics": {"outflow_rate_max": 1435.5798161485573, "cost2_min": -213.90653564358064, "cost1_mean": 344.2099928007538, "cost2_mean": -179.4787674850708, "system_level_velocity_mean": 12.922390935404426, "cost1_max": 409.6656381768408, "cost1_min": 142.81503957585255, "cost2_max": -79.81602860164841, "outflow_rate_mean": 1194.6251055621055, "system_level_velocity_min": 10.460965044503503, "outflow_rate_min": 718.7936838358781, "system_level_velocity_max": 15.870793126766594}, "info": {"num_steps_trained": 2700159, "load_time_ms": 12.976, "grad_time_ms": 9456.897, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01390898134559393, "total_loss": 7.705167293548584, "vf_loss": 7.708195209503174, "policy_loss": -0.0035491876769810915, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9779065251350403, "entropy": 1.0845626592636108}, "update_time_ms": 8.026, "num_steps_sampled": 2700159, "sample_time_ms": 17406.047}, "episode_len_mean": 695.37, "time_this_iter_s": 27.17556619644165, "num_metric_batches_dropped": 0, "timesteps_total": 2700159, "episodes_total": 880, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a198>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ab38>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224140, "episode_reward_max": 1583.1080504659164, "episodes_this_iter": 17, "time_total_s": 1660.7407660484314, "time_since_restore": 1660.7407660484314}
{"timesteps_since_restore": 2745084, "training_iteration": 62, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-16-08", "episode_reward_min": 446.6982586747564, "timesteps_this_iter": 44925, "episode_reward_mean": 1268.4175373974542, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 62, "custom_metrics": {"outflow_rate_max": 1478.6319856143855, "cost2_min": -213.90653564358064, "cost1_mean": 347.08105687332284, "cost2_mean": -181.70681224225157, "system_level_velocity_mean": 13.025283238707726, "cost1_max": 409.6656381768408, "cost1_min": 142.81503957585255, "cost2_max": -79.81602860164841, "outflow_rate_mean": 1205.5150972204472, "system_level_velocity_min": 10.7601012248637, "outflow_rate_min": 718.7936838358781, "system_level_velocity_max": 15.870793126766594}, "info": {"num_steps_trained": 2745084, "load_time_ms": 13.032, "grad_time_ms": 9661.799, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01422148011624813, "total_loss": 7.249622821807861, "vf_loss": 7.255137920379639, "policy_loss": -0.006049562711268663, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9777017831802368, "entropy": 1.1041139364242554}, "update_time_ms": 8.337, "num_steps_sampled": 2745084, "sample_time_ms": 17396.485}, "episode_len_mean": 695.37, "time_this_iter_s": 27.839877605438232, "num_metric_batches_dropped": 0, "timesteps_total": 2745084, "episodes_total": 897, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3080>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd9b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224168, "episode_reward_max": 1583.1080504659164, "episodes_this_iter": 17, "time_total_s": 1688.5806436538696, "time_since_restore": 1688.5806436538696}
{"timesteps_since_restore": 2790807, "training_iteration": 63, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-16-35", "episode_reward_min": 446.6982586747564, "timesteps_this_iter": 45723, "episode_reward_mean": 1273.6318599545127, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 63, "custom_metrics": {"outflow_rate_max": 1478.6319856143855, "cost2_min": -213.90653564358064, "cost1_mean": 348.4376655689776, "cost2_mean": -182.91523124018244, "system_level_velocity_mean": 13.074697992680147, "cost1_max": 409.6656381768408, "cost1_min": 142.81503957585255, "cost2_max": -79.81602860164841, "outflow_rate_mean": 1212.001552726353, "system_level_velocity_min": 10.7601012248637, "outflow_rate_min": 718.7936838358781, "system_level_velocity_max": 15.870793126766594}, "info": {"num_steps_trained": 2790807, "load_time_ms": 12.859, "grad_time_ms": 9888.807, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015063325874507427, "total_loss": 3.94970703125, "vf_loss": 3.9542341232299805, "policy_loss": -0.0050919027999043465, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9874792695045471, "entropy": 1.0930883884429932}, "update_time_ms": 8.414, "num_steps_sampled": 2790807, "sample_time_ms": 17127.103}, "episode_len_mean": 695.37, "time_this_iter_s": 27.063159227371216, "num_metric_batches_dropped": 0, "timesteps_total": 2790807, "episodes_total": 908, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95cc0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95748>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224195, "episode_reward_max": 1583.1080504659164, "episodes_this_iter": 11, "time_total_s": 1715.6438028812408, "time_since_restore": 1715.6438028812408}
{"timesteps_since_restore": 2835282, "training_iteration": 64, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-17-02", "episode_reward_min": 57.318369682558135, "timesteps_this_iter": 44475, "episode_reward_mean": 1250.9797380713933, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 64, "custom_metrics": {"outflow_rate_max": 1478.6319856143855, "cost2_min": -217.35746811180104, "cost1_mean": 340.9317623150904, "cost2_mean": -179.5403203322002, "system_level_velocity_mean": 13.077458096698733, "cost1_max": 405.02033611148306, "cost1_min": 29.429944198381257, "cost2_max": -21.723355078367096, "outflow_rate_mean": 1194.594047900129, "system_level_velocity_min": 10.7601012248637, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.373482998181917}, "info": {"num_steps_trained": 2835282, "load_time_ms": 12.934, "grad_time_ms": 10010.278, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014997413381934166, "total_loss": 8.414254188537598, "vf_loss": 8.417444229125977, "policy_loss": -0.003752425080165267, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9767236113548279, "entropy": 1.0904619693756104}, "update_time_ms": 8.732, "num_steps_sampled": 2835282, "sample_time_ms": 16826.074}, "episode_len_mean": 684.15, "time_this_iter_s": 26.742924213409424, "num_metric_batches_dropped": 0, "timesteps_total": 2835282, "episodes_total": 926, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a160>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8acf8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224222, "episode_reward_max": 1586.9070314801913, "episodes_this_iter": 18, "time_total_s": 1742.3867270946503, "time_since_restore": 1742.3867270946503}
{"timesteps_since_restore": 2881983, "training_iteration": 65, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-17-30", "episode_reward_min": 57.318369682558135, "timesteps_this_iter": 46701, "episode_reward_mean": 1242.318151694522, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 65, "custom_metrics": {"outflow_rate_max": 1478.6319856143855, "cost2_min": -217.35746811180104, "cost1_mean": 337.7676162976415, "cost2_mean": -178.14891815471026, "system_level_velocity_mean": 12.972117066454375, "cost1_max": 405.02033611148306, "cost1_min": 29.429944198381257, "cost2_max": -21.723355078367096, "outflow_rate_mean": 1182.6920105347365, "system_level_velocity_min": 10.7601012248637, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.373482998181917}, "info": {"num_steps_trained": 2881983, "load_time_ms": 13.039, "grad_time_ms": 10178.419, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015643766149878502, "total_loss": 5.517808437347412, "vf_loss": 5.519233703613281, "policy_loss": -0.00201211404055357, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9829219579696655, "entropy": 1.099810242652893}, "update_time_ms": 8.885, "num_steps_sampled": 2881983, "sample_time_ms": 16903.062}, "episode_len_mean": 683.93, "time_this_iter_s": 28.179116010665894, "num_metric_batches_dropped": 0, "timesteps_total": 2881983, "episodes_total": 940, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80d30>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80710>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224250, "episode_reward_max": 1586.9070314801913, "episodes_this_iter": 14, "time_total_s": 1770.5658431053162, "time_since_restore": 1770.5658431053162}
{"timesteps_since_restore": 2926924, "training_iteration": 66, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-17-55", "episode_reward_min": 57.318369682558135, "timesteps_this_iter": 44941, "episode_reward_mean": 1230.0691608513966, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 66, "custom_metrics": {"outflow_rate_max": 1478.6319856143855, "cost2_min": -217.35746811180104, "cost1_mean": 334.9251311544111, "cost2_mean": -176.44046124953246, "system_level_velocity_mean": 12.988942145614285, "cost1_max": 405.02033611148306, "cost1_min": 29.429944198381257, "cost2_max": -21.723355078367096, "outflow_rate_mean": 1177.6540881196368, "system_level_velocity_min": 10.939274862582687, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.373482998181917}, "info": {"num_steps_trained": 2926924, "load_time_ms": 12.826, "grad_time_ms": 10272.749, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014509348198771477, "total_loss": 5.869629383087158, "vf_loss": 5.872766017913818, "policy_loss": -0.003680181223899126, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.98336261510849, "entropy": 1.0535489320755005}, "update_time_ms": 9.044, "num_steps_sampled": 2926924, "sample_time_ms": 16582.952}, "episode_len_mean": 679.19, "time_this_iter_s": 25.44039273262024, "num_metric_batches_dropped": 0, "timesteps_total": 2926924, "episodes_total": 953, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd5f8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfde10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdda0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224275, "episode_reward_max": 1586.9070314801913, "episodes_this_iter": 13, "time_total_s": 1796.0062358379364, "time_since_restore": 1796.0062358379364}
{"timesteps_since_restore": 2972826, "training_iteration": 67, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-18-23", "episode_reward_min": 57.318369682558135, "timesteps_this_iter": 45902, "episode_reward_mean": 1218.190845751101, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 67, "custom_metrics": {"outflow_rate_max": 1478.6319856143855, "cost2_min": -217.35746811180104, "cost1_mean": 333.10288252323824, "cost2_mean": -175.4234084518309, "system_level_velocity_mean": 12.927990597874, "cost1_max": 405.02033611148306, "cost1_min": 29.429944198381257, "cost2_max": -21.723355078367096, "outflow_rate_mean": 1173.2151029597378, "system_level_velocity_min": 10.939274862582687, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.373482998181917}, "info": {"num_steps_trained": 2972826, "load_time_ms": 12.871, "grad_time_ms": 10473.997, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015238065272569656, "total_loss": 3.5193686485290527, "vf_loss": 3.5221123695373535, "policy_loss": -0.0033148396760225296, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.989966094493866, "entropy": 1.0908199548721313}, "update_time_ms": 8.783, "num_steps_sampled": 2972826, "sample_time_ms": 16466.664}, "episode_len_mean": 679.19, "time_this_iter_s": 27.294475078582764, "num_metric_batches_dropped": 0, "timesteps_total": 2972826, "episodes_total": 970, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80b70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80780>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224303, "episode_reward_max": 1586.9070314801913, "episodes_this_iter": 17, "time_total_s": 1823.3007109165192, "time_since_restore": 1823.3007109165192}
{"timesteps_since_restore": 3018846, "training_iteration": 68, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-18-49", "episode_reward_min": 57.318369682558135, "timesteps_this_iter": 46020, "episode_reward_mean": 1224.8973344221974, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 68, "custom_metrics": {"outflow_rate_max": 1478.6319856143855, "cost2_min": -217.35746811180104, "cost1_mean": 333.07989389186037, "cost2_mean": -175.82441251227064, "system_level_velocity_mean": 12.932575319858433, "cost1_max": 405.02033611148306, "cost1_min": 29.429944198381257, "cost2_max": -21.723355078367096, "outflow_rate_mean": 1175.8620638872808, "system_level_velocity_min": 10.939274862582687, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.373482998181917}, "info": {"num_steps_trained": 3018846, "load_time_ms": 13.397, "grad_time_ms": 10567.676, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015817921608686447, "total_loss": 4.003903865814209, "vf_loss": 4.0076799392700195, "policy_loss": -0.00436935992911458, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9883211851119995, "entropy": 1.0877203941345215}, "update_time_ms": 8.565, "num_steps_sampled": 3018846, "sample_time_ms": 16397.873}, "episode_len_mean": 679.19, "time_this_iter_s": 26.459601879119873, "num_metric_batches_dropped": 0, "timesteps_total": 3018846, "episodes_total": 983, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f588>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224329, "episode_reward_max": 1586.9070314801913, "episodes_this_iter": 13, "time_total_s": 1849.760312795639, "time_since_restore": 1849.760312795639}
{"timesteps_since_restore": 3064435, "training_iteration": 69, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-19-16", "episode_reward_min": 57.318369682558135, "timesteps_this_iter": 45589, "episode_reward_mean": 1208.3034177997172, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 69, "custom_metrics": {"outflow_rate_max": 1447.4029020626433, "cost2_min": -217.35746811180104, "cost1_mean": 328.02083983213095, "cost2_mean": -172.4995117003224, "system_level_velocity_mean": 12.997254295888405, "cost1_max": 408.655476095949, "cost1_min": 29.429944198381257, "cost2_max": -21.723355078367096, "outflow_rate_mean": 1164.1324460258745, "system_level_velocity_min": 10.939274862582687, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.373482998181917}, "info": {"num_steps_trained": 3064435, "load_time_ms": 13.754, "grad_time_ms": 10449.827, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016660934314131737, "total_loss": 8.833305358886719, "vf_loss": 8.835649490356445, "policy_loss": -0.00296855834312737, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9733805060386658, "entropy": 1.0499086380004883}, "update_time_ms": 8.205, "num_steps_sampled": 3064435, "sample_time_ms": 16319.991}, "episode_len_mean": 668.99, "time_this_iter_s": 26.76756501197815, "num_metric_batches_dropped": 0, "timesteps_total": 3064435, "episodes_total": 997, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f4e0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224356, "episode_reward_max": 1586.9070314801913, "episodes_this_iter": 14, "time_total_s": 1876.5278778076172, "time_since_restore": 1876.5278778076172}
{"timesteps_since_restore": 3106954, "training_iteration": 70, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-19-42", "episode_reward_min": 54.123891724798625, "timesteps_this_iter": 42519, "episode_reward_mean": 1198.2961992015255, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 70, "custom_metrics": {"outflow_rate_max": 1427.710487312687, "cost2_min": -217.35746811180104, "cost1_mean": 328.0408942518155, "cost2_mean": -171.43430022080636, "system_level_velocity_mean": 13.090203266562702, "cost1_max": 413.5149138020147, "cost1_min": 28.72880562884178, "cost2_max": -21.723355078367096, "outflow_rate_mean": 1157.9286652318747, "system_level_velocity_min": 10.939274862582687, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 19.433702737318356}, "info": {"num_steps_trained": 3106954, "load_time_ms": 13.754, "grad_time_ms": 10270.65, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.027069086208939552, "total_loss": 8.077842712402344, "vf_loss": 8.084227561950684, "policy_loss": -0.007399585098028183, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9788107872009277, "entropy": 1.0653645992279053}, "update_time_ms": 7.896, "num_steps_sampled": 3106954, "sample_time_ms": 16467.604}, "episode_len_mean": 667.08, "time_this_iter_s": 25.496365308761597, "num_metric_batches_dropped": 0, "timesteps_total": 3106954, "episodes_total": 1015, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f748>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224382, "episode_reward_max": 1539.2302500119267, "episodes_this_iter": 18, "time_total_s": 1902.0242431163788, "time_since_restore": 1902.0242431163788}
{"timesteps_since_restore": 3151609, "training_iteration": 71, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-20-09", "episode_reward_min": 54.123891724798625, "timesteps_this_iter": 44655, "episode_reward_mean": 1213.3293918635509, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 71, "custom_metrics": {"outflow_rate_max": 1432.5999026620436, "cost2_min": -207.65204847070225, "cost1_mean": 335.022913312415, "cost2_mean": -173.78511326323923, "system_level_velocity_mean": 13.19087044651969, "cost1_max": 413.5149138020147, "cost1_min": 28.72880562884178, "cost2_max": -24.033543827272112, "outflow_rate_mean": 1176.5547101295278, "system_level_velocity_min": 10.939274862582687, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.433702737318356}, "info": {"num_steps_trained": 3151609, "load_time_ms": 13.719, "grad_time_ms": 10141.116, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014479029923677444, "total_loss": 5.137364864349365, "vf_loss": 5.141720294952393, "policy_loss": -0.005170023534446955, "cur_kl_coeff": 0.05625000223517418, "vf_explained_var": 0.9850777983665466, "entropy": 1.0842088460922241}, "update_time_ms": 7.636, "num_steps_sampled": 3151609, "sample_time_ms": 16653.147}, "episode_len_mean": 673.64, "time_this_iter_s": 27.7222797870636, "num_metric_batches_dropped": 0, "timesteps_total": 3151609, "episodes_total": 1030, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f400>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f5c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224409, "episode_reward_max": 1559.8818837277895, "episodes_this_iter": 15, "time_total_s": 1929.7465229034424, "time_since_restore": 1929.7465229034424}
{"timesteps_since_restore": 3197871, "training_iteration": 72, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-20-38", "episode_reward_min": 54.123891724798625, "timesteps_this_iter": 46262, "episode_reward_mean": 1221.303292863112, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 72, "custom_metrics": {"outflow_rate_max": 1432.5999026620436, "cost2_min": -209.91442003185546, "cost1_mean": 337.5244433262483, "cost2_mean": -175.78310017616178, "system_level_velocity_mean": 13.245657182360786, "cost1_max": 413.5149138020147, "cost1_min": 28.72880562884178, "cost2_max": -24.033543827272112, "outflow_rate_mean": 1186.072974420285, "system_level_velocity_min": 10.939274862582687, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.433702737318356}, "info": {"num_steps_trained": 3197871, "load_time_ms": 13.592, "grad_time_ms": 9990.348, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013549734838306904, "total_loss": 6.145283222198486, "vf_loss": 6.148944854736328, "policy_loss": -0.004423835780471563, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.9801947474479675, "entropy": 1.0542622804641724}, "update_time_ms": 7.596, "num_steps_sampled": 3197871, "sample_time_ms": 16890.731}, "episode_len_mean": 675.5, "time_this_iter_s": 28.702815294265747, "num_metric_batches_dropped": 0, "timesteps_total": 3197871, "episodes_total": 1042, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc807f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80780>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224438, "episode_reward_max": 1559.8818837277895, "episodes_this_iter": 12, "time_total_s": 1958.4493381977081, "time_since_restore": 1958.4493381977081}
{"timesteps_since_restore": 3243152, "training_iteration": 73, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-21-05", "episode_reward_min": 54.123891724798625, "timesteps_this_iter": 45281, "episode_reward_mean": 1238.3752179726384, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 73, "custom_metrics": {"outflow_rate_max": 1432.5999026620436, "cost2_min": -209.91442003185546, "cost1_mean": 342.131785256445, "cost2_mean": -178.75369287436567, "system_level_velocity_mean": 13.31094859623644, "cost1_max": 413.5149138020147, "cost1_min": 28.72880562884178, "cost2_max": -24.033543827272112, "outflow_rate_mean": 1195.4335965671823, "system_level_velocity_min": 11.168431429312717, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.433702737318356}, "info": {"num_steps_trained": 3243152, "load_time_ms": 13.39, "grad_time_ms": 9905.046, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015087643638253212, "total_loss": 4.0556440353393555, "vf_loss": 4.059998512268066, "policy_loss": -0.005203288048505783, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.9887287020683289, "entropy": 1.0145028829574585}, "update_time_ms": 7.513, "num_steps_sampled": 3243152, "sample_time_ms": 16950.349}, "episode_len_mean": 680.24, "time_this_iter_s": 26.800614595413208, "num_metric_batches_dropped": 0, "timesteps_total": 3243152, "episodes_total": 1056, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca30b8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfde10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdeb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224465, "episode_reward_max": 1559.8818837277895, "episodes_this_iter": 14, "time_total_s": 1985.2499527931213, "time_since_restore": 1985.2499527931213}
{"timesteps_since_restore": 3287993, "training_iteration": 74, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-21-32", "episode_reward_min": 54.123891724798625, "timesteps_this_iter": 44841, "episode_reward_mean": 1231.1507703938275, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 74, "custom_metrics": {"outflow_rate_max": 1432.5999026620436, "cost2_min": -209.91442003185546, "cost1_mean": 341.7384377489909, "cost2_mean": -177.53137384635937, "system_level_velocity_mean": 13.496433281973955, "cost1_max": 413.5149138020147, "cost1_min": 28.72880562884178, "cost2_max": -24.033543827272112, "outflow_rate_mean": 1191.675273483598, "system_level_velocity_min": 11.648827588606002, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.44098127325363}, "info": {"num_steps_trained": 3287993, "load_time_ms": 13.362, "grad_time_ms": 9843.485, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017508666962385178, "total_loss": 5.236966609954834, "vf_loss": 5.2408857345581055, "policy_loss": -0.004904306959360838, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.98614901304245, "entropy": 1.0517433881759644}, "update_time_ms": 7.748, "num_steps_sampled": 3287993, "sample_time_ms": 17086.301}, "episode_len_mean": 673.67, "time_this_iter_s": 27.49890375137329, "num_metric_batches_dropped": 0, "timesteps_total": 3287993, "episodes_total": 1072, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8af60>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8afd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a940>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224492, "episode_reward_max": 1559.8818837277895, "episodes_this_iter": 16, "time_total_s": 2012.7488565444946, "time_since_restore": 2012.7488565444946}
{"timesteps_since_restore": 3332798, "training_iteration": 75, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-22-00", "episode_reward_min": 54.123891724798625, "timesteps_this_iter": 44805, "episode_reward_mean": 1221.0520529840717, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 75, "custom_metrics": {"outflow_rate_max": 1444.5199165187753, "cost2_min": -211.16318311848465, "cost1_mean": 340.1786005644373, "cost2_mean": -176.6309265660995, "system_level_velocity_mean": 13.62473775101888, "cost1_max": 413.5149138020147, "cost1_min": 28.72880562884178, "cost2_max": -24.033543827272112, "outflow_rate_mean": 1185.3876961843007, "system_level_velocity_min": 11.620154799481542, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.44098127325363}, "info": {"num_steps_trained": 3332798, "load_time_ms": 12.842, "grad_time_ms": 9833.655, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017290346324443817, "total_loss": 8.680018424987793, "vf_loss": 8.682928085327148, "policy_loss": -0.003882934106513858, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.9747067093849182, "entropy": 1.0208196640014648}, "update_time_ms": 7.938, "num_steps_sampled": 3332798, "sample_time_ms": 17018.699}, "episode_len_mean": 667.48, "time_this_iter_s": 27.409576416015625, "num_metric_batches_dropped": 0, "timesteps_total": 3332798, "episodes_total": 1088, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3438>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca31d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224520, "episode_reward_max": 1596.5261497813503, "episodes_this_iter": 16, "time_total_s": 2040.1584329605103, "time_since_restore": 2040.1584329605103}
{"timesteps_since_restore": 3377010, "training_iteration": 76, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-22-29", "episode_reward_min": 54.94059057772215, "timesteps_this_iter": 44212, "episode_reward_mean": 1232.6514944741273, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 76, "custom_metrics": {"outflow_rate_max": 1444.5199165187753, "cost2_min": -228.08466571870042, "cost1_mean": 344.176229002912, "cost2_mean": -180.43665650133838, "system_level_velocity_mean": 13.494733922028983, "cost1_max": 401.48735124579014, "cost1_min": 28.890336684126943, "cost2_max": -25.068115732766024, "outflow_rate_mean": 1188.651224114748, "system_level_velocity_min": 11.4502037917839, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.44098127325363}, "info": {"num_steps_trained": 3377010, "load_time_ms": 12.999, "grad_time_ms": 9858.762, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013056138530373573, "total_loss": 4.6819047927856445, "vf_loss": 4.6852006912231445, "policy_loss": -0.004030653741210699, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.9880357980728149, "entropy": 1.0234582424163818}, "update_time_ms": 7.931, "num_steps_sampled": 3377010, "sample_time_ms": 17335.093}, "episode_len_mean": 678.85, "time_this_iter_s": 28.875355005264282, "num_metric_batches_dropped": 0, "timesteps_total": 3377010, "episodes_total": 1104, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc950f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224549, "episode_reward_max": 1596.5261497813503, "episodes_this_iter": 16, "time_total_s": 2069.0337879657745, "time_since_restore": 2069.0337879657745}
{"timesteps_since_restore": 3423400, "training_iteration": 77, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-22-57", "episode_reward_min": 54.94059057772215, "timesteps_this_iter": 46390, "episode_reward_mean": 1238.0422471993154, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 77, "custom_metrics": {"outflow_rate_max": 1444.5199165187753, "cost2_min": -228.08466571870042, "cost1_mean": 346.91010190292087, "cost2_mean": -182.00066905853208, "system_level_velocity_mean": 13.602572337686055, "cost1_max": 400.70539320685634, "cost1_min": 28.890336684126943, "cost2_max": -25.068115732766024, "outflow_rate_mean": 1195.2663610357095, "system_level_velocity_min": 11.4502037917839, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.44098127325363}, "info": {"num_steps_trained": 3423400, "load_time_ms": 13.021, "grad_time_ms": 9836.906, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015874294564127922, "total_loss": 4.70325231552124, "vf_loss": 4.7076263427734375, "policy_loss": -0.005267322529107332, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.9862449169158936, "entropy": 1.0017757415771484}, "update_time_ms": 8.086, "num_steps_sampled": 3423400, "sample_time_ms": 17462.244}, "episode_len_mean": 678.85, "time_this_iter_s": 28.345881938934326, "num_metric_batches_dropped": 0, "timesteps_total": 3423400, "episodes_total": 1118, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd630>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdf28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd5f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224577, "episode_reward_max": 1596.5261497813503, "episodes_this_iter": 14, "time_total_s": 2097.379669904709, "time_since_restore": 2097.379669904709}
{"timesteps_since_restore": 3470138, "training_iteration": 78, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-23-26", "episode_reward_min": 54.94059057772215, "timesteps_this_iter": 46738, "episode_reward_mean": 1239.0688076820945, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 78, "custom_metrics": {"outflow_rate_max": 1444.5199165187753, "cost2_min": -228.08466571870042, "cost1_mean": 347.5969855834017, "cost2_mean": -183.13257931756644, "system_level_velocity_mean": 13.627132108041888, "cost1_max": 418.4979447004845, "cost1_min": 28.890336684126943, "cost2_max": -25.068115732766024, "outflow_rate_mean": 1195.4102963192495, "system_level_velocity_min": 11.4502037917839, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.44098127325363}, "info": {"num_steps_trained": 3470138, "load_time_ms": 12.741, "grad_time_ms": 10006.918, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0167764350771904, "total_loss": 4.66380500793457, "vf_loss": 4.668094158172607, "policy_loss": -0.005232817959040403, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.9873250722885132, "entropy": 0.9910871386528015}, "update_time_ms": 8.101, "num_steps_sampled": 3470138, "sample_time_ms": 17506.648}, "episode_len_mean": 678.85, "time_this_iter_s": 28.60831642150879, "num_metric_batches_dropped": 0, "timesteps_total": 3470138, "episodes_total": 1130, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95748>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc952b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224606, "episode_reward_max": 1596.5261497813503, "episodes_this_iter": 12, "time_total_s": 2125.9879863262177, "time_since_restore": 2125.9879863262177}
{"timesteps_since_restore": 3515500, "training_iteration": 79, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-23-52", "episode_reward_min": 54.94059057772215, "timesteps_this_iter": 45362, "episode_reward_mean": 1230.1816987758184, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 79, "custom_metrics": {"outflow_rate_max": 1494.8756495386967, "cost2_min": -228.08466571870042, "cost1_mean": 345.37961127675294, "cost2_mean": -182.92326473570176, "system_level_velocity_mean": 13.705439939311765, "cost1_max": 418.4979447004845, "cost1_min": 28.890336684126943, "cost2_max": -25.068115732766024, "outflow_rate_mean": 1190.798792916673, "system_level_velocity_min": 11.4502037917839, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.44098127325363}, "info": {"num_steps_trained": 3515500, "load_time_ms": 12.528, "grad_time_ms": 10089.291, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01857750490307808, "total_loss": 11.823799133300781, "vf_loss": 11.82568073272705, "policy_loss": -0.002926022280007601, "cur_kl_coeff": 0.05624999478459358, "vf_explained_var": 0.9690870642662048, "entropy": 0.9949051141738892}, "update_time_ms": 8.465, "num_steps_sampled": 3515500, "sample_time_ms": 17379.836}, "episode_len_mean": 672.21, "time_this_iter_s": 26.33516812324524, "num_metric_batches_dropped": 0, "timesteps_total": 3515500, "episodes_total": 1147, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3c88>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca36d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224632, "episode_reward_max": 1596.5261497813503, "episodes_this_iter": 17, "time_total_s": 2152.323154449463, "time_since_restore": 2152.323154449463}
{"timesteps_since_restore": 3560350, "training_iteration": 80, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-24-18", "episode_reward_min": 54.94059057772215, "timesteps_this_iter": 44850, "episode_reward_mean": 1223.5864410948666, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 80, "custom_metrics": {"outflow_rate_max": 1499.3219519186698, "cost2_min": -228.08466571870042, "cost1_mean": 346.4677323124681, "cost2_mean": -183.28461669574386, "system_level_velocity_mean": 13.740702216107323, "cost1_max": 423.4877306570894, "cost1_min": 28.890336684126943, "cost2_max": -25.068115732766024, "outflow_rate_mean": 1191.9856768247648, "system_level_velocity_min": 11.4502037917839, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.44098127325363}, "info": {"num_steps_trained": 3560350, "load_time_ms": 12.665, "grad_time_ms": 10242.911, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016948524862527847, "total_loss": 7.0623345375061035, "vf_loss": 7.0657057762146, "policy_loss": -0.004325109999626875, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.9816349744796753, "entropy": 1.0022670030593872}, "update_time_ms": 8.743, "num_steps_sampled": 3560350, "sample_time_ms": 17265.052}, "episode_len_mean": 672.21, "time_this_iter_s": 25.883320331573486, "num_metric_batches_dropped": 0, "timesteps_total": 3560350, "episodes_total": 1162, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fc18>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fe80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224658, "episode_reward_max": 1596.5261497813503, "episodes_this_iter": 15, "time_total_s": 2178.2064747810364, "time_since_restore": 2178.2064747810364}
{"timesteps_since_restore": 3605272, "training_iteration": 81, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-24-45", "episode_reward_min": 60.2680511085629, "timesteps_this_iter": 44922, "episode_reward_mean": 1244.1712643673343, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 81, "custom_metrics": {"outflow_rate_max": 1499.3219519186698, "cost2_min": -234.54986722103126, "cost1_mean": 351.2348501744107, "cost2_mean": -188.24343545930554, "system_level_velocity_mean": 13.715339271114344, "cost1_max": 423.4877306570894, "cost1_min": 33.597035980188174, "cost2_max": -27.495890838807156, "outflow_rate_mean": 1202.261954543009, "system_level_velocity_min": 11.4502037917839, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.83824470348635}, "info": {"num_steps_trained": 3605272, "load_time_ms": 12.596, "grad_time_ms": 10366.557, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01661103591322899, "total_loss": 6.99169921875, "vf_loss": 6.995672225952148, "policy_loss": -0.004906872753053904, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.979503333568573, "entropy": 1.0076199769973755}, "update_time_ms": 9.013, "num_steps_sampled": 3605272, "sample_time_ms": 17049.581}, "episode_len_mean": 678.78, "time_this_iter_s": 26.8274085521698, "num_metric_batches_dropped": 0, "timesteps_total": 3605272, "episodes_total": 1178, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fe10>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f8d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224685, "episode_reward_max": 1583.3634148795572, "episodes_this_iter": 16, "time_total_s": 2205.033883333206, "time_since_restore": 2205.033883333206}
{"timesteps_since_restore": 3652045, "training_iteration": 82, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-25-13", "episode_reward_min": 265.92903962954784, "timesteps_this_iter": 46773, "episode_reward_mean": 1267.681246617268, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 82, "custom_metrics": {"outflow_rate_max": 1499.3219519186698, "cost2_min": -234.54986722103126, "cost1_mean": 357.79226506819805, "cost2_mean": -193.63916172030866, "system_level_velocity_mean": 13.646608426657718, "cost1_max": 423.4877306570894, "cost1_min": 99.3241437048581, "cost2_max": -53.34980962471879, "outflow_rate_mean": 1221.1372250871268, "system_level_velocity_min": 11.4502037917839, "outflow_rate_min": 559.327043271345, "system_level_velocity_max": 17.937902565030424}, "info": {"num_steps_trained": 3652045, "load_time_ms": 12.911, "grad_time_ms": 10427.484, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016386188566684723, "total_loss": 4.363033294677734, "vf_loss": 4.367516040802002, "policy_loss": -0.005404781084507704, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.9879451394081116, "entropy": 1.007969617843628}, "update_time_ms": 9.033, "num_steps_sampled": 3652045, "sample_time_ms": 16932.422}, "episode_len_mean": 690.37, "time_this_iter_s": 28.18040943145752, "num_metric_batches_dropped": 0, "timesteps_total": 3652045, "episodes_total": 1191, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6a90>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a5c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224713, "episode_reward_max": 1583.3634148795572, "episodes_this_iter": 13, "time_total_s": 2233.2142927646637, "time_since_restore": 2233.2142927646637}
{"timesteps_since_restore": 3697494, "training_iteration": 83, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-25-39", "episode_reward_min": 265.92903962954784, "timesteps_this_iter": 45449, "episode_reward_mean": 1270.8111859728772, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 83, "custom_metrics": {"outflow_rate_max": 1499.3219519186698, "cost2_min": -234.54986722103126, "cost1_mean": 358.49448966656223, "cost2_mean": -194.68593535573706, "system_level_velocity_mean": 13.670175823538067, "cost1_max": 423.4877306570894, "cost1_min": 99.3241437048581, "cost2_max": -53.34980962471879, "outflow_rate_mean": 1226.9211083009718, "system_level_velocity_min": 11.71662653637363, "outflow_rate_min": 559.327043271345, "system_level_velocity_max": 17.937902565030424}, "info": {"num_steps_trained": 3697494, "load_time_ms": 13.294, "grad_time_ms": 10419.934, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.021273287013173103, "total_loss": 4.482778072357178, "vf_loss": 4.488799571990967, "policy_loss": -0.007218072656542063, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.9874399900436401, "entropy": 0.9865015149116516}, "update_time_ms": 8.996, "num_steps_sampled": 3697494, "sample_time_ms": 16865.87}, "episode_len_mean": 690.37, "time_this_iter_s": 26.072340726852417, "num_metric_batches_dropped": 0, "timesteps_total": 3697494, "episodes_total": 1204, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95a90>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95860>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224739, "episode_reward_max": 1583.3634148795572, "episodes_this_iter": 13, "time_total_s": 2259.286633491516, "time_since_restore": 2259.286633491516}
{"timesteps_since_restore": 3743055, "training_iteration": 84, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-26-06", "episode_reward_min": 56.361719648916534, "timesteps_this_iter": 45561, "episode_reward_mean": 1259.1122148100073, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 84, "custom_metrics": {"outflow_rate_max": 1499.3219519186698, "cost2_min": -234.54986722103126, "cost1_mean": 352.6196434812719, "cost2_mean": -195.4486405791534, "system_level_velocity_mean": 13.614640970860728, "cost1_max": 423.4877306570894, "cost1_min": 31.658805378100276, "cost2_max": -27.260687343344248, "outflow_rate_mean": 1211.7217589733925, "system_level_velocity_min": 11.71662653637363, "outflow_rate_min": 326.4101243732012, "system_level_velocity_max": 19.094033285394968}, "info": {"num_steps_trained": 3743055, "load_time_ms": 12.795, "grad_time_ms": 10438.045, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.020176036283373833, "total_loss": 7.536281585693359, "vf_loss": 7.539048194885254, "policy_loss": -0.0044690463691949844, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9797748327255249, "entropy": 1.0030878782272339}, "update_time_ms": 8.502, "num_steps_sampled": 3743055, "sample_time_ms": 16790.358}, "episode_len_mean": 683.84, "time_this_iter_s": 26.89400005340576, "num_metric_batches_dropped": 0, "timesteps_total": 3743055, "episodes_total": 1222, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd550>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdf98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224766, "episode_reward_max": 1583.3634148795572, "episodes_this_iter": 18, "time_total_s": 2286.180633544922, "time_since_restore": 2286.180633544922}
{"timesteps_since_restore": 3789417, "training_iteration": 85, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-26-33", "episode_reward_min": 54.000957096388916, "timesteps_this_iter": 46362, "episode_reward_mean": 1243.1560549832102, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 85, "custom_metrics": {"outflow_rate_max": 1499.3219519186698, "cost2_min": -234.54986722103126, "cost1_mean": 347.49746983323433, "cost2_mean": -194.77731751426083, "system_level_velocity_mean": 13.605470368879526, "cost1_max": 423.4877306570894, "cost1_min": 28.517807646389823, "cost2_max": -22.372122562643757, "outflow_rate_mean": 1199.1053222693085, "system_level_velocity_min": 11.71662653637363, "outflow_rate_min": 326.4101243732012, "system_level_velocity_max": 19.121242755242864}, "info": {"num_steps_trained": 3789417, "load_time_ms": 13.307, "grad_time_ms": 10448.497, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0138259157538414, "total_loss": 6.077575206756592, "vf_loss": 6.080454349517822, "policy_loss": -0.004629116039723158, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9832971096038818, "entropy": 0.9864237308502197}, "update_time_ms": 8.146, "num_steps_sampled": 3789417, "sample_time_ms": 16770.112}, "episode_len_mean": 677.27, "time_this_iter_s": 27.295035362243652, "num_metric_batches_dropped": 0, "timesteps_total": 3789417, "episodes_total": 1235, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca69e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6da0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224793, "episode_reward_max": 1583.3634148795572, "episodes_this_iter": 13, "time_total_s": 2313.4756689071655, "time_since_restore": 2313.4756689071655}
{"timesteps_since_restore": 3837239, "training_iteration": 86, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-27-00", "episode_reward_min": 54.000957096388916, "timesteps_this_iter": 47822, "episode_reward_mean": 1255.4118953382667, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 86, "custom_metrics": {"outflow_rate_max": 1499.3219519186698, "cost2_min": -234.54986722103126, "cost1_mean": 350.14357985292185, "cost2_mean": -196.47076388439203, "system_level_velocity_mean": 13.4727252227579, "cost1_max": 423.4877306570894, "cost1_min": 28.517807646389823, "cost2_max": -22.372122562643757, "outflow_rate_mean": 1202.6799096184511, "system_level_velocity_min": 11.613533610879971, "outflow_rate_min": 326.4101243732012, "system_level_velocity_max": 19.121242755242864}, "info": {"num_steps_trained": 3837239, "load_time_ms": 13.473, "grad_time_ms": 10397.449, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0150903994217515, "total_loss": 4.435815334320068, "vf_loss": 4.438526153564453, "policy_loss": -0.00462076673284173, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9874204397201538, "entropy": 0.9661373496055603}, "update_time_ms": 8.032, "num_steps_sampled": 3837239, "sample_time_ms": 16568.258}, "episode_len_mean": 686.9, "time_this_iter_s": 26.338712692260742, "num_metric_batches_dropped": 0, "timesteps_total": 3837239, "episodes_total": 1247, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95f98>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc952b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224820, "episode_reward_max": 1579.5412711298989, "episodes_this_iter": 12, "time_total_s": 2339.8143815994263, "time_since_restore": 2339.8143815994263}
{"timesteps_since_restore": 3883059, "training_iteration": 87, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-27-26", "episode_reward_min": 54.000957096388916, "timesteps_this_iter": 45820, "episode_reward_mean": 1258.6578219303574, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 87, "custom_metrics": {"outflow_rate_max": 1375.9618886290184, "cost2_min": -234.54986722103126, "cost1_mean": 347.3554257676146, "cost2_mean": -197.71613891308775, "system_level_velocity_mean": 13.373263805618285, "cost1_max": 401.93832813961194, "cost1_min": 28.517807646389823, "cost2_max": -22.372122562643757, "outflow_rate_mean": 1198.2501470480804, "system_level_velocity_min": 11.613533610879971, "outflow_rate_min": 326.4101243732012, "system_level_velocity_max": 19.121242755242864}, "info": {"num_steps_trained": 3883059, "load_time_ms": 13.517, "grad_time_ms": 10368.447, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014389610849320889, "total_loss": 5.630075454711914, "vf_loss": 5.633456230163574, "policy_loss": -0.005202360451221466, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9858081340789795, "entropy": 0.9538868069648743}, "update_time_ms": 7.841, "num_steps_sampled": 3883059, "sample_time_ms": 16427.646}, "episode_len_mean": 686.9, "time_this_iter_s": 26.651312589645386, "num_metric_batches_dropped": 0, "timesteps_total": 3883059, "episodes_total": 1263, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80550>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224846, "episode_reward_max": 1483.4658374978965, "episodes_this_iter": 16, "time_total_s": 2366.4656941890717, "time_since_restore": 2366.4656941890717}
{"timesteps_since_restore": 3929394, "training_iteration": 88, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-27-55", "episode_reward_min": 54.000957096388916, "timesteps_this_iter": 46335, "episode_reward_mean": 1251.050401201697, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 88, "custom_metrics": {"outflow_rate_max": 1375.9618886290184, "cost2_min": -240.3510784971482, "cost1_mean": 345.7920827477243, "cost2_mean": -196.5000734465256, "system_level_velocity_mean": 13.330398557322782, "cost1_max": 401.93832813961194, "cost1_min": 28.517807646389823, "cost2_max": -22.372122562643757, "outflow_rate_mean": 1195.8891310957974, "system_level_velocity_min": 11.613533610879971, "outflow_rate_min": 326.4101243732012, "system_level_velocity_max": 19.121242755242864}, "info": {"num_steps_trained": 3929394, "load_time_ms": 13.462, "grad_time_ms": 10208.532, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01623009331524372, "total_loss": 6.245490550994873, "vf_loss": 6.251204490661621, "policy_loss": -0.0077679818496108055, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9828586578369141, "entropy": 0.966642439365387}, "update_time_ms": 7.811, "num_steps_sampled": 3929394, "sample_time_ms": 16525.592}, "episode_len_mean": 686.9, "time_this_iter_s": 27.987507581710815, "num_metric_batches_dropped": 0, "timesteps_total": 3929394, "episodes_total": 1278, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd278>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdf60>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224875, "episode_reward_max": 1471.4235538394992, "episodes_this_iter": 15, "time_total_s": 2394.4532017707825, "time_since_restore": 2394.4532017707825}
{"timesteps_since_restore": 3975446, "training_iteration": 89, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-28-23", "episode_reward_min": 54.000957096388916, "timesteps_this_iter": 46052, "episode_reward_mean": 1255.257013028166, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 89, "custom_metrics": {"outflow_rate_max": 1375.9618886290184, "cost2_min": -252.88008372387964, "cost1_mean": 344.2929190808698, "cost2_mean": -196.73729360529148, "system_level_velocity_mean": 13.274123787871773, "cost1_max": 401.93832813961194, "cost1_min": 28.517807646389823, "cost2_max": -22.372122562643757, "outflow_rate_mean": 1192.399546640253, "system_level_velocity_min": 11.613533610879971, "outflow_rate_min": 326.4101243732012, "system_level_velocity_max": 19.121242755242864}, "info": {"num_steps_trained": 3975446, "load_time_ms": 13.647, "grad_time_ms": 10112.42, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013763904571533203, "total_loss": 4.397453308105469, "vf_loss": 4.400214672088623, "policy_loss": -0.004503197968006134, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9887418150901794, "entropy": 0.967370331287384}, "update_time_ms": 7.501, "num_steps_sampled": 3975446, "sample_time_ms": 16841.586}, "episode_len_mean": 686.9, "time_this_iter_s": 28.563924312591553, "num_metric_batches_dropped": 0, "timesteps_total": 3975446, "episodes_total": 1292, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95c88>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc955c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224903, "episode_reward_max": 1471.4235538394992, "episodes_this_iter": 14, "time_total_s": 2423.017126083374, "time_since_restore": 2423.017126083374}
{"timesteps_since_restore": 4020807, "training_iteration": 90, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-28-52", "episode_reward_min": 54.000957096388916, "timesteps_this_iter": 45361, "episode_reward_mean": 1242.2616114200382, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 90, "custom_metrics": {"outflow_rate_max": 1416.0844219192575, "cost2_min": -252.88008372387964, "cost1_mean": 341.6782182160105, "cost2_mean": -194.69257255612712, "system_level_velocity_mean": 13.339636882474712, "cost1_max": 403.13561832055234, "cost1_min": 28.517807646389823, "cost2_max": -22.372122562643757, "outflow_rate_mean": 1183.720290571085, "system_level_velocity_min": 11.613533610879971, "outflow_rate_min": 326.4101243732012, "system_level_velocity_max": 19.121242755242864}, "info": {"num_steps_trained": 4020807, "load_time_ms": 13.85, "grad_time_ms": 10196.49, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016408421099185944, "total_loss": 7.930155277252197, "vf_loss": 7.933700084686279, "policy_loss": -0.005622037220746279, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9797841906547546, "entropy": 0.9728774428367615}, "update_time_ms": 7.615, "num_steps_sampled": 4020807, "sample_time_ms": 17044.461}, "episode_len_mean": 680.96, "time_this_iter_s": 28.7728111743927, "num_metric_batches_dropped": 0, "timesteps_total": 4020807, "episodes_total": 1308, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc952e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc956d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95eb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224932, "episode_reward_max": 1528.1711058383187, "episodes_this_iter": 16, "time_total_s": 2451.7899372577667, "time_since_restore": 2451.7899372577667}
{"timesteps_since_restore": 4066770, "training_iteration": 91, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-29-21", "episode_reward_min": 54.000957096388916, "timesteps_this_iter": 45963, "episode_reward_mean": 1257.0698545994096, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 91, "custom_metrics": {"outflow_rate_max": 1416.0844219192575, "cost2_min": -252.88008372387964, "cost1_mean": 345.5684789915826, "cost2_mean": -197.54970581459986, "system_level_velocity_mean": 13.309589791252213, "cost1_max": 403.13561832055234, "cost1_min": 28.517807646389823, "cost2_max": -22.372122562643757, "outflow_rate_mean": 1195.6165639878689, "system_level_velocity_min": 11.613533610879971, "outflow_rate_min": 338.35525222187107, "system_level_velocity_max": 19.121242755242864}, "info": {"num_steps_trained": 4066770, "load_time_ms": 13.986, "grad_time_ms": 10292.555, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013961219228804111, "total_loss": 4.726344108581543, "vf_loss": 4.729616641998291, "policy_loss": -0.005039503797888756, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.986877977848053, "entropy": 0.9696422219276428}, "update_time_ms": 7.564, "num_steps_sampled": 4066770, "sample_time_ms": 17144.702}, "episode_len_mean": 687.49, "time_this_iter_s": 28.778889894485474, "num_metric_batches_dropped": 0, "timesteps_total": 4066770, "episodes_total": 1319, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6358>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461150588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8aa20>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224961, "episode_reward_max": 1528.1711058383187, "episodes_this_iter": 11, "time_total_s": 2480.568827152252, "time_since_restore": 2480.568827152252}
{"timesteps_since_restore": 4111241, "training_iteration": 92, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-29-47", "episode_reward_min": 161.66851018317467, "timesteps_this_iter": 44471, "episode_reward_mean": 1260.864492814996, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 92, "custom_metrics": {"outflow_rate_max": 1416.0844219192575, "cost2_min": -252.88008372387964, "cost1_mean": 348.41349657653484, "cost2_mean": -198.74751010109424, "system_level_velocity_mean": 13.356662800760528, "cost1_max": 403.13561832055234, "cost1_min": 71.63342741852723, "cost2_max": -39.01466828033403, "outflow_rate_mean": 1204.2484529928033, "system_level_velocity_min": 11.613533610879971, "outflow_rate_min": 440.82883481794096, "system_level_velocity_max": 18.40654960365939}, "info": {"num_steps_trained": 4111241, "load_time_ms": 13.963, "grad_time_ms": 10299.18, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017788957804441452, "total_loss": 6.715293884277344, "vf_loss": 6.718572616577148, "policy_loss": -0.005529190879315138, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9835996627807617, "entropy": 0.963441789150238}, "update_time_ms": 7.676, "num_steps_sampled": 4111241, "sample_time_ms": 16956.698}, "episode_len_mean": 689.44, "time_this_iter_s": 26.343520879745483, "num_metric_batches_dropped": 0, "timesteps_total": 4111241, "episodes_total": 1337, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca39e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f400>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557224987, "episode_reward_max": 1528.1711058383187, "episodes_this_iter": 18, "time_total_s": 2506.9123480319977, "time_since_restore": 2506.9123480319977}
{"timesteps_since_restore": 4155045, "training_iteration": 93, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-30-14", "episode_reward_min": 161.66851018317467, "timesteps_this_iter": 43804, "episode_reward_mean": 1247.2527296912072, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 93, "custom_metrics": {"outflow_rate_max": 1416.0844219192575, "cost2_min": -252.88008372387964, "cost1_mean": 348.3426726527872, "cost2_mean": -200.1122800793959, "system_level_velocity_mean": 13.464924433966521, "cost1_max": 403.13561832055234, "cost1_min": 71.63342741852723, "cost2_max": -39.01466828033403, "outflow_rate_mean": 1203.4207742344463, "system_level_velocity_min": 11.621635819610775, "outflow_rate_min": 440.82883481794096, "system_level_velocity_max": 18.40654960365939}, "info": {"num_steps_trained": 4155045, "load_time_ms": 13.719, "grad_time_ms": 10324.164, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015306186862289906, "total_loss": 7.230290412902832, "vf_loss": 7.231311321258545, "policy_loss": -0.00295834057033062, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9823772311210632, "entropy": 1.0043272972106934}, "update_time_ms": 7.946, "num_steps_sampled": 4155045, "sample_time_ms": 17054.429}, "episode_len_mean": 684.62, "time_this_iter_s": 27.279513597488403, "num_metric_batches_dropped": 0, "timesteps_total": 4155045, "episodes_total": 1353, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3470>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca39b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95748>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225014, "episode_reward_max": 1528.1711058383187, "episodes_this_iter": 16, "time_total_s": 2534.191861629486, "time_since_restore": 2534.191861629486}
{"timesteps_since_restore": 4201265, "training_iteration": 94, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-30-41", "episode_reward_min": 161.66851018317467, "timesteps_this_iter": 46220, "episode_reward_mean": 1243.832015295139, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 94, "custom_metrics": {"outflow_rate_max": 1416.0844219192575, "cost2_min": -252.88008372387964, "cost1_mean": 347.82889397116014, "cost2_mean": -201.26363983143986, "system_level_velocity_mean": 13.4499177654863, "cost1_max": 403.13561832055234, "cost1_min": 71.63342741852723, "cost2_max": -39.01466828033403, "outflow_rate_mean": 1201.0382749996809, "system_level_velocity_min": 11.621635819610775, "outflow_rate_min": 440.82883481794096, "system_level_velocity_max": 18.40654960365939}, "info": {"num_steps_trained": 4201265, "load_time_ms": 14.27, "grad_time_ms": 10378.82, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015089798718690872, "total_loss": 3.800140142440796, "vf_loss": 3.804039239883423, "policy_loss": -0.005808986257761717, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9896179437637329, "entropy": 0.987510085105896}, "update_time_ms": 8.019, "num_steps_sampled": 4201265, "sample_time_ms": 17015.881}, "episode_len_mean": 684.62, "time_this_iter_s": 27.054908275604248, "num_metric_batches_dropped": 0, "timesteps_total": 4201265, "episodes_total": 1366, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc807f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80ba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225041, "episode_reward_max": 1528.1711058383187, "episodes_this_iter": 13, "time_total_s": 2561.2467699050903, "time_since_restore": 2561.2467699050903}
{"timesteps_since_restore": 4247689, "training_iteration": 95, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-31-09", "episode_reward_min": 161.66851018317467, "timesteps_this_iter": 46424, "episode_reward_mean": 1239.6865015587266, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 95, "custom_metrics": {"outflow_rate_max": 1416.0844219192575, "cost2_min": -252.88008372387964, "cost1_mean": 348.2701756853957, "cost2_mean": -202.0007449807617, "system_level_velocity_mean": 13.462104758729943, "cost1_max": 403.13561832055234, "cost1_min": 71.63342741852723, "cost2_max": -39.01466828033403, "outflow_rate_mean": 1199.1293446988054, "system_level_velocity_min": 11.706202639513249, "outflow_rate_min": 440.82883481794096, "system_level_velocity_max": 18.40654960365939}, "info": {"num_steps_trained": 4247689, "load_time_ms": 14.409, "grad_time_ms": 10393.495, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012855038046836853, "total_loss": 4.198124885559082, "vf_loss": 4.201550006866455, "policy_loss": -0.0050521972589194775, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9883988499641418, "entropy": 1.0005149841308594}, "update_time_ms": 7.984, "num_steps_sampled": 4247689, "sample_time_ms": 17004.812}, "episode_len_mean": 684.62, "time_this_iter_s": 27.33997368812561, "num_metric_batches_dropped": 0, "timesteps_total": 4247689, "episodes_total": 1380, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6b00>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca65f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6978>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225069, "episode_reward_max": 1528.1711058383187, "episodes_this_iter": 14, "time_total_s": 2588.586743593216, "time_since_restore": 2588.586743593216}
{"timesteps_since_restore": 4293730, "training_iteration": 96, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-31-36", "episode_reward_min": 51.39592433592057, "timesteps_this_iter": 46041, "episode_reward_mean": 1222.596184608862, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 96, "custom_metrics": {"outflow_rate_max": 1416.0844219192575, "cost2_min": -236.22906556585454, "cost1_mean": 344.3450496230055, "cost2_mean": -201.28177736504057, "system_level_velocity_mean": 13.496107481820728, "cost1_max": 400.3450560106126, "cost1_min": 28.982273642762422, "cost2_max": -24.828897981823815, "outflow_rate_mean": 1187.2064602038088, "system_level_velocity_min": 11.4263181254053, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.526746292599594}, "info": {"num_steps_trained": 4293730, "load_time_ms": 14.365, "grad_time_ms": 10414.045, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015671784058213234, "total_loss": 6.849006652832031, "vf_loss": 6.852361679077148, "policy_loss": -0.0053382557816803455, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9826561808586121, "entropy": 0.9797943234443665}, "update_time_ms": 7.989, "num_steps_sampled": 4293730, "sample_time_ms": 17076.433}, "episode_len_mean": 678.05, "time_this_iter_s": 27.249698638916016, "num_metric_batches_dropped": 0, "timesteps_total": 4293730, "episodes_total": 1394, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6390>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6c18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225096, "episode_reward_max": 1528.1711058383187, "episodes_this_iter": 14, "time_total_s": 2615.836442232132, "time_since_restore": 2615.836442232132}
{"timesteps_since_restore": 4341223, "training_iteration": 97, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-32-03", "episode_reward_min": 51.39592433592057, "timesteps_this_iter": 47493, "episode_reward_mean": 1223.4527450955234, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 97, "custom_metrics": {"outflow_rate_max": 1374.7643890109891, "cost2_min": -236.22906556585454, "cost1_mean": 345.58063281311956, "cost2_mean": -201.94267283949387, "system_level_velocity_mean": 13.381480765417436, "cost1_max": 400.3450560106126, "cost1_min": 28.982273642762422, "cost2_max": -24.828897981823815, "outflow_rate_mean": 1184.3229641399332, "system_level_velocity_min": 11.4263181254053, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.526746292599594}, "info": {"num_steps_trained": 4341223, "load_time_ms": 14.481, "grad_time_ms": 10434.129, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01452560629695654, "total_loss": 3.4847631454467773, "vf_loss": 3.4886090755462646, "policy_loss": -0.005683954805135727, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9913297891616821, "entropy": 0.9926517009735107}, "update_time_ms": 8.152, "num_steps_sampled": 4341223, "sample_time_ms": 17033.229}, "episode_len_mean": 683.99, "time_this_iter_s": 26.418790340423584, "num_metric_batches_dropped": 0, "timesteps_total": 4341223, "episodes_total": 1407, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6400>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6748>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225123, "episode_reward_max": 1488.054512555947, "episodes_this_iter": 13, "time_total_s": 2642.2552325725555, "time_since_restore": 2642.2552325725555}
{"timesteps_since_restore": 4385832, "training_iteration": 98, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-32-28", "episode_reward_min": 51.39592433592057, "timesteps_this_iter": 44609, "episode_reward_mean": 1218.6748799686764, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 98, "custom_metrics": {"outflow_rate_max": 1487.5221802197802, "cost2_min": -236.22906556585454, "cost1_mean": 343.3899095515672, "cost2_mean": -201.18538754083897, "system_level_velocity_mean": 13.289012442820543, "cost1_max": 420.9028443999563, "cost1_min": 28.982273642762422, "cost2_max": -24.828897981823815, "outflow_rate_mean": 1174.117145513031, "system_level_velocity_min": 11.4263181254053, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.526746292599594}, "info": {"num_steps_trained": 4385832, "load_time_ms": 14.907, "grad_time_ms": 10374.901, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013852380216121674, "total_loss": 5.382302761077881, "vf_loss": 5.384360313415527, "policy_loss": -0.0038109133020043373, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9877094626426697, "entropy": 0.9750909805297852}, "update_time_ms": 8.08, "num_steps_sampled": 4385832, "sample_time_ms": 16880.37}, "episode_len_mean": 683.99, "time_this_iter_s": 25.87713050842285, "num_metric_batches_dropped": 0, "timesteps_total": 4385832, "episodes_total": 1423, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95208>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc958d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225148, "episode_reward_max": 1533.1245388423404, "episodes_this_iter": 16, "time_total_s": 2668.1323630809784, "time_since_restore": 2668.1323630809784}
{"timesteps_since_restore": 4431063, "training_iteration": 99, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-32-55", "episode_reward_min": 51.39592433592057, "timesteps_this_iter": 45231, "episode_reward_mean": 1201.2934529881218, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 99, "custom_metrics": {"outflow_rate_max": 1487.5221802197802, "cost2_min": -236.22906556585454, "cost1_mean": 335.428662158347, "cost2_mean": -197.01043022781332, "system_level_velocity_mean": 13.180869303927375, "cost1_max": 420.9028443999563, "cost1_min": 28.982273642762422, "cost2_max": -24.828897981823815, "outflow_rate_mean": 1148.1667690862387, "system_level_velocity_min": 10.740936756150951, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.526746292599594}, "info": {"num_steps_trained": 4431063, "load_time_ms": 14.939, "grad_time_ms": 10259.033, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01664653979241848, "total_loss": 9.63952350616455, "vf_loss": 9.642775535583496, "policy_loss": -0.005358832888305187, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9732441902160645, "entropy": 1.0015965700149536}, "update_time_ms": 8.201, "num_steps_sampled": 4431063, "sample_time_ms": 16785.918}, "episode_len_mean": 676.73, "time_this_iter_s": 26.425907611846924, "num_metric_batches_dropped": 0, "timesteps_total": 4431063, "episodes_total": 1441, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3f28>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225175, "episode_reward_max": 1533.1245388423404, "episodes_this_iter": 18, "time_total_s": 2694.5582706928253, "time_since_restore": 2694.5582706928253}
{"timesteps_since_restore": 4479310, "training_iteration": 100, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-33-23", "episode_reward_min": 51.39592433592057, "timesteps_this_iter": 48247, "episode_reward_mean": 1199.3996294371782, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 100, "custom_metrics": {"outflow_rate_max": 1487.5221802197802, "cost2_min": -236.22906556585454, "cost1_mean": 333.81608644626635, "cost2_mean": -196.36286927221798, "system_level_velocity_mean": 13.146370333863047, "cost1_max": 420.9028443999563, "cost1_min": 28.982273642762422, "cost2_max": -24.828897981823815, "outflow_rate_mean": 1140.9560515633586, "system_level_velocity_min": 10.740936756150951, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.526746292599594}, "info": {"num_steps_trained": 4479310, "load_time_ms": 14.935, "grad_time_ms": 10161.143, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01314578577876091, "total_loss": 5.101478576660156, "vf_loss": 5.1021246910095215, "policy_loss": -0.0023098390083760023, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9850499629974365, "entropy": 1.014304518699646}, "update_time_ms": 7.82, "num_steps_sampled": 4479310, "sample_time_ms": 16826.829}, "episode_len_mean": 675.8, "time_this_iter_s": 28.19689178466797, "num_metric_batches_dropped": 0, "timesteps_total": 4479310, "episodes_total": 1450, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6da0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6f60>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225203, "episode_reward_max": 1533.1245388423404, "episodes_this_iter": 9, "time_total_s": 2722.7551624774933, "time_since_restore": 2722.7551624774933}
{"timesteps_since_restore": 4524959, "training_iteration": 101, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-33-50", "episode_reward_min": 51.39592433592057, "timesteps_this_iter": 45649, "episode_reward_mean": 1193.3082333702755, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 101, "custom_metrics": {"outflow_rate_max": 1487.5221802197802, "cost2_min": -236.22906556585454, "cost1_mean": 330.98308908769724, "cost2_mean": -195.63871906934813, "system_level_velocity_mean": 13.034503299361, "cost1_max": 420.9028443999563, "cost1_min": 28.982273642762422, "cost2_max": -24.828897981823815, "outflow_rate_mean": 1130.9553462732367, "system_level_velocity_min": 10.740936756150951, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.526746292599594}, "info": {"num_steps_trained": 4524959, "load_time_ms": 14.905, "grad_time_ms": 9961.629, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015399501658976078, "total_loss": 5.073347568511963, "vf_loss": 5.077460289001465, "policy_loss": -0.006061212625354528, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9869686365127563, "entropy": 0.9745070934295654}, "update_time_ms": 7.466, "num_steps_sampled": 4524959, "sample_time_ms": 16880.86}, "episode_len_mean": 675.8, "time_this_iter_s": 27.3185453414917, "num_metric_batches_dropped": 0, "timesteps_total": 4524959, "episodes_total": 1467, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6438>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6550>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225230, "episode_reward_max": 1533.1245388423404, "episodes_this_iter": 17, "time_total_s": 2750.073707818985, "time_since_restore": 2750.073707818985}
{"timesteps_since_restore": 4570373, "training_iteration": 102, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-34-18", "episode_reward_min": 58.64927876688123, "timesteps_this_iter": 45414, "episode_reward_mean": 1190.003631077353, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 102, "custom_metrics": {"outflow_rate_max": 1487.5221802197802, "cost2_min": -236.22906556585454, "cost1_mean": 331.2649045492748, "cost2_mean": -194.37287336856465, "system_level_velocity_mean": 13.05152711587548, "cost1_max": 420.9028443999563, "cost1_min": 33.45984571565535, "cost2_max": -26.708429294957316, "outflow_rate_mean": 1126.9818881320728, "system_level_velocity_min": 10.740936756150951, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.208153543969164}, "info": {"num_steps_trained": 4570373, "load_time_ms": 14.685, "grad_time_ms": 9811.123, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014614486135542393, "total_loss": 5.454291820526123, "vf_loss": 5.459167957305908, "policy_loss": -0.006724994163960218, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9856279492378235, "entropy": 0.9838260412216187}, "update_time_ms": 7.28, "num_steps_sampled": 4570373, "sample_time_ms": 17099.774}, "episode_len_mean": 675.87, "time_this_iter_s": 27.01975131034851, "num_metric_batches_dropped": 0, "timesteps_total": 4570373, "episodes_total": 1482, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95748>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc957f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc955c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225258, "episode_reward_max": 1533.1245388423404, "episodes_this_iter": 15, "time_total_s": 2777.0934591293335, "time_since_restore": 2777.0934591293335}
{"timesteps_since_restore": 4616112, "training_iteration": 103, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-34-45", "episode_reward_min": 58.64927876688123, "timesteps_this_iter": 45739, "episode_reward_mean": 1182.5246190283804, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 103, "custom_metrics": {"outflow_rate_max": 1487.5221802197802, "cost2_min": -225.53584581457721, "cost1_mean": 330.68865729664014, "cost2_mean": -194.24863891068682, "system_level_velocity_mean": 13.03239584089279, "cost1_max": 420.9028443999563, "cost1_min": 33.45984571565535, "cost2_max": -26.708429294957316, "outflow_rate_mean": 1122.2077525530635, "system_level_velocity_min": 10.740936756150951, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.208153543969164}, "info": {"num_steps_trained": 4616112, "load_time_ms": 14.559, "grad_time_ms": 9784.522, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01669398695230484, "total_loss": 4.078709602355957, "vf_loss": 4.082292556762695, "policy_loss": -0.00569536816328764, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9894412755966187, "entropy": 0.9876288175582886}, "update_time_ms": 7.154, "num_steps_sampled": 4616112, "sample_time_ms": 17184.654}, "episode_len_mean": 675.87, "time_this_iter_s": 27.865808486938477, "num_metric_batches_dropped": 0, "timesteps_total": 4616112, "episodes_total": 1495, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a048>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6320>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225285, "episode_reward_max": 1533.1245388423404, "episodes_this_iter": 13, "time_total_s": 2804.959267616272, "time_since_restore": 2804.959267616272}
{"timesteps_since_restore": 4662539, "training_iteration": 104, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-35-14", "episode_reward_min": 58.64927876688123, "timesteps_this_iter": 46427, "episode_reward_mean": 1179.06092698237, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 104, "custom_metrics": {"outflow_rate_max": 1487.5221802197802, "cost2_min": -237.8845532975901, "cost1_mean": 329.8714486775956, "cost2_mean": -194.66717718538166, "system_level_velocity_mean": 13.148904587308898, "cost1_max": 420.9028443999563, "cost1_min": 33.45984571565535, "cost2_max": -26.708429294957316, "outflow_rate_mean": 1128.99466099679, "system_level_velocity_min": 10.740936756150951, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.208153543969164}, "info": {"num_steps_trained": 4662539, "load_time_ms": 14.341, "grad_time_ms": 9782.478, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014436563476920128, "total_loss": 8.025766372680664, "vf_loss": 8.028721809387207, "policy_loss": -0.0047823884524405, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9787154197692871, "entropy": 0.9892944693565369}, "update_time_ms": 7.375, "num_steps_sampled": 4662539, "sample_time_ms": 17351.694}, "episode_len_mean": 670.47, "time_this_iter_s": 28.717846393585205, "num_metric_batches_dropped": 0, "timesteps_total": 4662539, "episodes_total": 1512, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3828>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca35f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3be0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225314, "episode_reward_max": 1484.1158946697237, "episodes_this_iter": 17, "time_total_s": 2833.677114009857, "time_since_restore": 2833.677114009857}
{"timesteps_since_restore": 4707982, "training_iteration": 105, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-35-41", "episode_reward_min": 58.64927876688123, "timesteps_this_iter": 45443, "episode_reward_mean": 1179.0472756874549, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 105, "custom_metrics": {"outflow_rate_max": 1349.2997800199798, "cost2_min": -237.8845532975901, "cost1_mean": 330.2100799557809, "cost2_mean": -195.62804894361187, "system_level_velocity_mean": 13.175023507453936, "cost1_max": 405.00002925386974, "cost1_min": 33.45984571565535, "cost2_max": -26.708429294957316, "outflow_rate_mean": 1130.1618449531866, "system_level_velocity_min": 10.740936756150951, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.208153543969164}, "info": {"num_steps_trained": 4707982, "load_time_ms": 14.347, "grad_time_ms": 9820.206, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01189405657351017, "total_loss": 3.8059604167938232, "vf_loss": 3.8094589710235596, "policy_loss": -0.005003517959266901, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9908919930458069, "entropy": 0.9851856231689453}, "update_time_ms": 7.461, "num_steps_sampled": 4707982, "sample_time_ms": 17210.546}, "episode_len_mean": 670.47, "time_this_iter_s": 26.305755615234375, "num_metric_batches_dropped": 0, "timesteps_total": 4707982, "episodes_total": 1525, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3cf8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ae48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225341, "episode_reward_max": 1484.1158946697237, "episodes_this_iter": 13, "time_total_s": 2859.9828696250916, "time_since_restore": 2859.9828696250916}
{"timesteps_since_restore": 4754723, "training_iteration": 106, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-36-08", "episode_reward_min": 58.64927876688123, "timesteps_this_iter": 46741, "episode_reward_mean": 1204.9583327307878, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 106, "custom_metrics": {"outflow_rate_max": 1349.2997800199798, "cost2_min": -237.8845532975901, "cost1_mean": 338.2185034845777, "cost2_mean": -200.23186410307937, "system_level_velocity_mean": 13.177300786467718, "cost1_max": 405.00002925386974, "cost1_min": 34.22189678079106, "cost2_max": -29.380076707855356, "outflow_rate_mean": 1153.1374224773772, "system_level_velocity_min": 10.880786292865372, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.208153543969164}, "info": {"num_steps_trained": 4754723, "load_time_ms": 14.322, "grad_time_ms": 9920.029, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014708139933645725, "total_loss": 3.5424084663391113, "vf_loss": 3.5469422340393066, "policy_loss": -0.006395356729626656, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9906173348426819, "entropy": 0.9835566878318787}, "update_time_ms": 7.521, "num_steps_sampled": 4754723, "sample_time_ms": 17159.422}, "episode_len_mean": 682.35, "time_this_iter_s": 27.764381170272827, "num_metric_batches_dropped": 0, "timesteps_total": 4754723, "episodes_total": 1538, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc959b0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95e80>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225368, "episode_reward_max": 1484.1158946697237, "episodes_this_iter": 13, "time_total_s": 2887.7472507953644, "time_since_restore": 2887.7472507953644}
{"timesteps_since_restore": 4798996, "training_iteration": 107, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-36-36", "episode_reward_min": 51.014428513379926, "timesteps_this_iter": 44273, "episode_reward_mean": 1196.6078065193358, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 107, "custom_metrics": {"outflow_rate_max": 1349.2997800199798, "cost2_min": -237.8845532975901, "cost1_mean": 338.9441364424822, "cost2_mean": -201.862280737927, "system_level_velocity_mean": 13.259781380037932, "cost1_max": 405.00002925386974, "cost1_min": 29.150192820858354, "cost2_max": -28.807170949759016, "outflow_rate_mean": 1154.5325536309201, "system_level_velocity_min": 10.880786292865372, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.81514300522104}, "info": {"num_steps_trained": 4798996, "load_time_ms": 14.205, "grad_time_ms": 9938.651, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016286859288811684, "total_loss": 7.169000625610352, "vf_loss": 7.1725592613220215, "policy_loss": -0.005620162934064865, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.983914852142334, "entropy": 0.9810765385627747}, "update_time_ms": 7.393, "num_steps_sampled": 4798996, "sample_time_ms": 17278.263}, "episode_len_mean": 681.53, "time_this_iter_s": 27.788177013397217, "num_metric_batches_dropped": 0, "timesteps_total": 4798996, "episodes_total": 1556, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fba8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f8d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225396, "episode_reward_max": 1484.1158946697237, "episodes_this_iter": 18, "time_total_s": 2915.5354278087616, "time_since_restore": 2915.5354278087616}
{"timesteps_since_restore": 4848007, "training_iteration": 108, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-37-04", "episode_reward_min": 51.014428513379926, "timesteps_this_iter": 49011, "episode_reward_mean": 1199.8121733180062, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 108, "custom_metrics": {"outflow_rate_max": 1382.4687292707292, "cost2_min": -237.8845532975901, "cost1_mean": 340.4557312346597, "cost2_mean": -202.31229745713685, "system_level_velocity_mean": 13.324198625282282, "cost1_max": 405.00002925386974, "cost1_min": 29.150192820858354, "cost2_max": -28.807170949759016, "outflow_rate_mean": 1157.5969630344575, "system_level_velocity_min": 10.880786292865372, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.81514300522104}, "info": {"num_steps_trained": 4848007, "load_time_ms": 13.977, "grad_time_ms": 10043.342, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014895768836140633, "total_loss": 3.5547072887420654, "vf_loss": 3.557382583618164, "policy_loss": -0.0045608882792294025, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9888352155685425, "entropy": 1.011879801750183}, "update_time_ms": 7.569, "num_steps_sampled": 4848007, "sample_time_ms": 17354.169}, "episode_len_mean": 681.53, "time_this_iter_s": 27.666257619857788, "num_metric_batches_dropped": 0, "timesteps_total": 4848007, "episodes_total": 1566, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0080>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3198>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225424, "episode_reward_max": 1484.1158946697237, "episodes_this_iter": 10, "time_total_s": 2943.2016854286194, "time_since_restore": 2943.2016854286194}
{"timesteps_since_restore": 4893244, "training_iteration": 109, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-37-35", "episode_reward_min": 51.014428513379926, "timesteps_this_iter": 45237, "episode_reward_mean": 1213.5351149578923, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 109, "custom_metrics": {"outflow_rate_max": 1382.4687292707292, "cost2_min": -249.64458513772075, "cost1_mean": 343.10993330684744, "cost2_mean": -205.86251730769692, "system_level_velocity_mean": 13.239263267964397, "cost1_max": 416.4261982643609, "cost1_min": 29.150192820858354, "cost2_max": -28.807170949759016, "outflow_rate_mean": 1167.4070275841163, "system_level_velocity_min": 10.880786292865372, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.81514300522104}, "info": {"num_steps_trained": 4893244, "load_time_ms": 13.891, "grad_time_ms": 10400.42, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013924578204751015, "total_loss": 5.571952819824219, "vf_loss": 5.5760626792907715, "policy_loss": -0.005871992092579603, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9869711399078369, "entropy": 0.9755300283432007}, "update_time_ms": 7.398, "num_steps_sampled": 4893244, "sample_time_ms": 17432.276}, "episode_len_mean": 688.03, "time_this_iter_s": 30.78832769393921, "num_metric_batches_dropped": 0, "timesteps_total": 4893244, "episodes_total": 1581, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6748>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6ef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225455, "episode_reward_max": 1484.1158946697237, "episodes_this_iter": 15, "time_total_s": 2973.9900131225586, "time_since_restore": 2973.9900131225586}
{"timesteps_since_restore": 4939562, "training_iteration": 110, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-38-03", "episode_reward_min": 51.014428513379926, "timesteps_this_iter": 46318, "episode_reward_mean": 1229.760213527031, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 110, "custom_metrics": {"outflow_rate_max": 1427.5994839748487, "cost2_min": -249.64458513772075, "cost1_mean": 345.11884760715986, "cost2_mean": -208.1212327731698, "system_level_velocity_mean": 13.173519829515067, "cost1_max": 416.4261982643609, "cost1_min": 29.150192820858354, "cost2_max": -28.807170949759016, "outflow_rate_mean": 1173.5994239648599, "system_level_velocity_min": 10.805855810681416, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.81514300522104}, "info": {"num_steps_trained": 4939562, "load_time_ms": 13.724, "grad_time_ms": 10258.644, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015552100725471973, "total_loss": 5.447105884552002, "vf_loss": 5.450814247131348, "policy_loss": -0.005676458589732647, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.985541582107544, "entropy": 0.986620306968689}, "update_time_ms": 7.647, "num_steps_sampled": 4939562, "sample_time_ms": 17567.261}, "episode_len_mean": 693.43, "time_this_iter_s": 28.139991760253906, "num_metric_batches_dropped": 0, "timesteps_total": 4939562, "episodes_total": 1599, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdb38>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6dd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225483, "episode_reward_max": 1456.4601943680864, "episodes_this_iter": 18, "time_total_s": 3002.1300048828125, "time_since_restore": 3002.1300048828125}
{"timesteps_since_restore": 4986759, "training_iteration": 111, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-38-33", "episode_reward_min": 51.014428513379926, "timesteps_this_iter": 47197, "episode_reward_mean": 1228.9264140742632, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 111, "custom_metrics": {"outflow_rate_max": 1427.5994839748487, "cost2_min": -249.64458513772075, "cost1_mean": 343.3858794478929, "cost2_mean": -208.61690170058236, "system_level_velocity_mean": 13.109664774937393, "cost1_max": 416.4261982643609, "cost1_min": 29.150192820858354, "cost2_max": -28.807170949759016, "outflow_rate_mean": 1168.1156197890355, "system_level_velocity_min": 10.805855810681416, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.81514300522104}, "info": {"num_steps_trained": 4986759, "load_time_ms": 13.971, "grad_time_ms": 10381.702, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012942751869559288, "total_loss": 3.6805193424224854, "vf_loss": 3.6833207607269287, "policy_loss": -0.0044395215809345245, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9895435571670532, "entropy": 0.9844104647636414}, "update_time_ms": 8.037, "num_steps_sampled": 4986759, "sample_time_ms": 17695.506}, "episode_len_mean": 693.43, "time_this_iter_s": 29.84506893157959, "num_metric_batches_dropped": 0, "timesteps_total": 4986759, "episodes_total": 1609, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6898>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca62b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca66d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225513, "episode_reward_max": 1456.4601943680864, "episodes_this_iter": 10, "time_total_s": 3031.975073814392, "time_since_restore": 3031.975073814392}
{"timesteps_since_restore": 5033669, "training_iteration": 112, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-39-00", "episode_reward_min": 51.014428513379926, "timesteps_this_iter": 46910, "episode_reward_mean": 1224.3055167555758, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 112, "custom_metrics": {"outflow_rate_max": 1427.5994839748487, "cost2_min": -249.64458513772075, "cost1_mean": 343.48279195948163, "cost2_mean": -208.49557971542788, "system_level_velocity_mean": 13.109333829398908, "cost1_max": 416.4261982643609, "cost1_min": 29.150192820858354, "cost2_max": -28.807170949759016, "outflow_rate_mean": 1164.981188805078, "system_level_velocity_min": 10.805855810681416, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.81514300522104}, "info": {"num_steps_trained": 5033669, "load_time_ms": 14.112, "grad_time_ms": 10499.863, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014192617498338223, "total_loss": 4.754825592041016, "vf_loss": 4.757877349853516, "policy_loss": -0.004847672302275896, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9876248836517334, "entropy": 0.9675691723823547}, "update_time_ms": 8.179, "num_steps_sampled": 5033669, "sample_time_ms": 17638.149}, "episode_len_mean": 693.43, "time_this_iter_s": 27.64483332633972, "num_metric_batches_dropped": 0, "timesteps_total": 5033669, "episodes_total": 1621, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb00b8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0080>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225540, "episode_reward_max": 1456.4601943680864, "episodes_this_iter": 12, "time_total_s": 3059.619907140732, "time_since_restore": 3059.619907140732}
{"timesteps_since_restore": 5077578, "training_iteration": 113, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-39-26", "episode_reward_min": 51.014428513379926, "timesteps_this_iter": 43909, "episode_reward_mean": 1215.7774226425195, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 113, "custom_metrics": {"outflow_rate_max": 1427.5994839748487, "cost2_min": -249.64458513772075, "cost1_mean": 339.84418005606386, "cost2_mean": -207.939904638753, "system_level_velocity_mean": 12.982177200447063, "cost1_max": 416.4261982643609, "cost1_min": 29.150192820858354, "cost2_max": -28.807170949759016, "outflow_rate_mean": 1154.1324540655824, "system_level_velocity_min": 10.805855810681416, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.81514300522104}, "info": {"num_steps_trained": 5077578, "load_time_ms": 14.371, "grad_time_ms": 10524.13, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015807069838047028, "total_loss": 6.3331146240234375, "vf_loss": 6.338056564331055, "policy_loss": -0.00694257253780961, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9855713248252869, "entropy": 0.9752229452133179}, "update_time_ms": 8.289, "num_steps_sampled": 5077578, "sample_time_ms": 17418.276}, "episode_len_mean": 693.43, "time_this_iter_s": 25.919182300567627, "num_metric_batches_dropped": 0, "timesteps_total": 5077578, "episodes_total": 1639, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80b70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc954a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225566, "episode_reward_max": 1485.8543682623883, "episodes_this_iter": 18, "time_total_s": 3085.5390894412994, "time_since_restore": 3085.5390894412994}
{"timesteps_since_restore": 5121782, "training_iteration": 114, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-39-53", "episode_reward_min": 1022.5079642456494, "timesteps_this_iter": 44204, "episode_reward_mean": 1231.9213808108047, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 114, "custom_metrics": {"outflow_rate_max": 1427.5994839748487, "cost2_min": -249.64458513772075, "cost1_mean": 343.99495299727954, "cost2_mean": -208.48615817605736, "system_level_velocity_mean": 12.95019979067093, "cost1_max": 416.4261982643609, "cost1_min": 283.0146905622263, "cost2_max": -177.04411362646056, "outflow_rate_mean": 1162.262804185814, "system_level_velocity_min": 10.805855810681416, "outflow_rate_min": 980.5861066933068, "system_level_velocity_max": 15.571064086479128}, "info": {"num_steps_trained": 5121782, "load_time_ms": 14.617, "grad_time_ms": 10496.953, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014395578764379025, "total_loss": 4.49177360534668, "vf_loss": 4.495230197906494, "policy_loss": -0.005278346128761768, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9881327152252197, "entropy": 0.9810695648193359}, "update_time_ms": 8.265, "num_steps_sampled": 5121782, "sample_time_ms": 17277.556}, "episode_len_mean": 700.0, "time_this_iter_s": 27.043189525604248, "num_metric_batches_dropped": 0, "timesteps_total": 5121782, "episodes_total": 1651, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd518>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdcf8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225593, "episode_reward_max": 1485.8543682623883, "episodes_this_iter": 12, "time_total_s": 3112.5822789669037, "time_since_restore": 3112.5822789669037}
{"timesteps_since_restore": 5168917, "training_iteration": 115, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-40-21", "episode_reward_min": 1022.5079642456494, "timesteps_this_iter": 47135, "episode_reward_mean": 1224.6265884177258, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 115, "custom_metrics": {"outflow_rate_max": 1427.5994839748487, "cost2_min": -249.64458513772075, "cost1_mean": 345.1507858155252, "cost2_mean": -207.57951587109602, "system_level_velocity_mean": 12.993249386408179, "cost1_max": 416.4261982643609, "cost1_min": 283.0146905622263, "cost2_max": -177.04411362646056, "outflow_rate_mean": 1166.2049099950639, "system_level_velocity_min": 10.805855810681416, "outflow_rate_min": 980.5861066933068, "system_level_velocity_max": 15.571064086479128}, "info": {"num_steps_trained": 5168917, "load_time_ms": 14.418, "grad_time_ms": 10449.561, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014282806776463985, "total_loss": 4.726758003234863, "vf_loss": 4.730206489562988, "policy_loss": -0.005255718715488911, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.987173855304718, "entropy": 0.9830597043037415}, "update_time_ms": 8.259, "num_steps_sampled": 5168917, "sample_time_ms": 17471.629}, "episode_len_mean": 700.0, "time_this_iter_s": 27.760122060775757, "num_metric_batches_dropped": 0, "timesteps_total": 5168917, "episodes_total": 1664, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc955c0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc956d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc952b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225621, "episode_reward_max": 1485.8543682623883, "episodes_this_iter": 13, "time_total_s": 3140.3424010276794, "time_since_restore": 3140.3424010276794}
{"timesteps_since_restore": 5213446, "training_iteration": 116, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-40-47", "episode_reward_min": 1022.5079642456494, "timesteps_this_iter": 44529, "episode_reward_mean": 1220.8413304544474, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 116, "custom_metrics": {"outflow_rate_max": 1427.5994839748487, "cost2_min": -245.2122995164028, "cost1_mean": 344.7121181263749, "cost2_mean": -206.75727133762953, "system_level_velocity_mean": 12.989350902273348, "cost1_max": 408.22997359029966, "cost1_min": 283.0146905622263, "cost2_max": -177.04411362646056, "outflow_rate_mean": 1166.8934873835576, "system_level_velocity_min": 10.805855810681416, "outflow_rate_min": 980.5861066933068, "system_level_velocity_max": 15.347662549641468}, "info": {"num_steps_trained": 5213446, "load_time_ms": 14.563, "grad_time_ms": 10361.401, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017101621255278587, "total_loss": 6.8667144775390625, "vf_loss": 6.87267541885376, "policy_loss": -0.008124949410557747, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9838154911994934, "entropy": 0.9646247625350952}, "update_time_ms": 8.144, "num_steps_sampled": 5213446, "sample_time_ms": 17351.513}, "episode_len_mean": 700.0, "time_this_iter_s": 25.656519889831543, "num_metric_batches_dropped": 0, "timesteps_total": 5213446, "episodes_total": 1682, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0588>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb09e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225647, "episode_reward_max": 1485.8543682623883, "episodes_this_iter": 18, "time_total_s": 3165.998920917511, "time_since_restore": 3165.998920917511}
{"timesteps_since_restore": 5258754, "training_iteration": 117, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-41-13", "episode_reward_min": 1022.5079642456494, "timesteps_this_iter": 45308, "episode_reward_mean": 1224.5492067534965, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 117, "custom_metrics": {"outflow_rate_max": 1373.9776930246226, "cost2_min": -245.2122995164028, "cost1_mean": 347.4876073777131, "cost2_mean": -206.55782840933784, "system_level_velocity_mean": 13.101194006078172, "cost1_max": 408.22997359029966, "cost1_min": 283.0146905622263, "cost2_max": -175.30030217978813, "outflow_rate_mean": 1172.5753648470354, "system_level_velocity_min": 10.812299690731523, "outflow_rate_min": 980.5861066933068, "system_level_velocity_max": 15.347662549641468}, "info": {"num_steps_trained": 5258754, "load_time_ms": 14.713, "grad_time_ms": 10322.76, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017174094915390015, "total_loss": 4.08479118347168, "vf_loss": 4.0888352394104, "policy_loss": -0.00621836120262742, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.989978015422821, "entropy": 0.976097822189331}, "update_time_ms": 8.381, "num_steps_sampled": 5258754, "sample_time_ms": 17207.511}, "episode_len_mean": 700.0, "time_this_iter_s": 25.981480836868286, "num_metric_batches_dropped": 0, "timesteps_total": 5258754, "episodes_total": 1695, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdcf8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95e10>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225673, "episode_reward_max": 1485.8543682623883, "episodes_this_iter": 13, "time_total_s": 3191.9804017543793, "time_since_restore": 3191.9804017543793}
{"timesteps_since_restore": 5304926, "training_iteration": 118, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-41-40", "episode_reward_min": 1043.5428337504695, "timesteps_this_iter": 46172, "episode_reward_mean": 1228.1155418589253, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 118, "custom_metrics": {"outflow_rate_max": 1464.672006993007, "cost2_min": -245.2122995164028, "cost1_mean": 350.6535742223265, "cost2_mean": -206.0739192743808, "system_level_velocity_mean": 13.212912487965632, "cost1_max": 425.35785513195844, "cost1_min": 283.0146905622263, "cost2_max": -175.30030217978813, "outflow_rate_mean": 1183.1548767720515, "system_level_velocity_min": 10.812299690731523, "outflow_rate_min": 980.5861066933068, "system_level_velocity_max": 15.86489576093595}, "info": {"num_steps_trained": 5304926, "load_time_ms": 14.653, "grad_time_ms": 10261.013, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014689220115542412, "total_loss": 4.575614929199219, "vf_loss": 4.578603267669678, "policy_loss": -0.00484717171639204, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.988405168056488, "entropy": 0.9608193039894104}, "update_time_ms": 8.223, "num_steps_sampled": 5304926, "sample_time_ms": 17217.128}, "episode_len_mean": 700.0, "time_this_iter_s": 27.154287099838257, "num_metric_batches_dropped": 0, "timesteps_total": 5304926, "episodes_total": 1708, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0780>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb03c8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225700, "episode_reward_max": 1485.8543682623883, "episodes_this_iter": 13, "time_total_s": 3219.1346888542175, "time_since_restore": 3219.1346888542175}
{"timesteps_since_restore": 5350080, "training_iteration": 119, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-42-08", "episode_reward_min": 1060.76410498347, "timesteps_this_iter": 45154, "episode_reward_mean": 1238.944553514594, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 119, "custom_metrics": {"outflow_rate_max": 1464.672006993007, "cost2_min": -245.2122995164028, "cost1_mean": 353.7447639262234, "cost2_mean": -205.64259791333166, "system_level_velocity_mean": 13.312243796940868, "cost1_max": 425.35785513195844, "cost1_min": 302.3623149690282, "cost2_max": -175.30030217978813, "outflow_rate_mean": 1195.9122646448843, "system_level_velocity_min": 11.481178527800216, "outflow_rate_min": 1057.480202997003, "system_level_velocity_max": 15.86489576093595}, "info": {"num_steps_trained": 5350080, "load_time_ms": 14.65, "grad_time_ms": 10016.721, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015349474735558033, "total_loss": 5.5225019454956055, "vf_loss": 5.5262861251831055, "policy_loss": -0.005727025680243969, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9871324896812439, "entropy": 0.9440673589706421}, "update_time_ms": 8.372, "num_steps_sampled": 5350080, "sample_time_ms": 17187.827}, "episode_len_mean": 700.0, "time_this_iter_s": 28.04396677017212, "num_metric_batches_dropped": 0, "timesteps_total": 5350080, "episodes_total": 1724, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80a58>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80b38>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225728, "episode_reward_max": 1485.8543682623883, "episodes_this_iter": 16, "time_total_s": 3247.1786556243896, "time_since_restore": 3247.1786556243896}
{"timesteps_since_restore": 5395217, "training_iteration": 120, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-42-37", "episode_reward_min": 1060.76410498347, "timesteps_this_iter": 45137, "episode_reward_mean": 1245.9949149055228, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 120, "custom_metrics": {"outflow_rate_max": 1464.672006993007, "cost2_min": -244.11962903931368, "cost1_mean": 355.5214265087179, "cost2_mean": -206.2141649118343, "system_level_velocity_mean": 13.371002059035241, "cost1_max": 425.35785513195844, "cost1_min": 296.58019059960037, "cost2_max": -175.30030217978813, "outflow_rate_mean": 1198.958150923547, "system_level_velocity_min": 11.277058826458124, "outflow_rate_min": 1027.044145054945, "system_level_velocity_max": 15.86489576093595}, "info": {"num_steps_trained": 5395217, "load_time_ms": 14.168, "grad_time_ms": 10173.8, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015723487362265587, "total_loss": 4.684754848480225, "vf_loss": 4.688073635101318, "policy_loss": -0.005308753810822964, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.988860547542572, "entropy": 0.9467183947563171}, "update_time_ms": 8.328, "num_steps_sampled": 5395217, "sample_time_ms": 17055.638}, "episode_len_mean": 700.0, "time_this_iter_s": 28.361860275268555, "num_metric_batches_dropped": 0, "timesteps_total": 5395217, "episodes_total": 1739, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3470>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca64e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225757, "episode_reward_max": 1461.5816168316628, "episodes_this_iter": 15, "time_total_s": 3275.540515899658, "time_since_restore": 3275.540515899658}
{"timesteps_since_restore": 5442076, "training_iteration": 121, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-43-14", "episode_reward_min": 1060.76410498347, "timesteps_this_iter": 46859, "episode_reward_mean": 1244.765198126437, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 121, "custom_metrics": {"outflow_rate_max": 1464.672006993007, "cost2_min": -244.11962903931368, "cost1_mean": 356.28108421773686, "cost2_mean": -206.1935159236465, "system_level_velocity_mean": 13.394202255441758, "cost1_max": 425.35785513195844, "cost1_min": 296.58019059960037, "cost2_max": -175.30030217978813, "outflow_rate_mean": 1205.333726932832, "system_level_velocity_min": 11.277058826458124, "outflow_rate_min": 1027.044145054945, "system_level_velocity_max": 15.86489576093595}, "info": {"num_steps_trained": 5442076, "load_time_ms": 14.026, "grad_time_ms": 10534.113, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016790417954325676, "total_loss": 4.194369316101074, "vf_loss": 4.1984148025512695, "policy_loss": -0.006170672830194235, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9885892868041992, "entropy": 0.9408427476882935}, "update_time_ms": 8.346, "num_steps_sampled": 5442076, "sample_time_ms": 17443.299}, "episode_len_mean": 700.0, "time_this_iter_s": 37.393654584884644, "num_metric_batches_dropped": 0, "timesteps_total": 5442076, "episodes_total": 1749, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb00b8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0c18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225794, "episode_reward_max": 1461.5816168316628, "episodes_this_iter": 10, "time_total_s": 3312.934170484543, "time_since_restore": 3312.934170484543}
{"timesteps_since_restore": 5486842, "training_iteration": 122, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-43-43", "episode_reward_min": 1060.76410498347, "timesteps_this_iter": 44766, "episode_reward_mean": 1253.841610299248, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 122, "custom_metrics": {"outflow_rate_max": 1464.672006993007, "cost2_min": -239.3252652759595, "cost1_mean": 355.99271983159167, "cost2_mean": -206.63407459617613, "system_level_velocity_mean": 13.383410113131724, "cost1_max": 425.35785513195844, "cost1_min": 296.58019059960037, "cost2_max": -175.30030217978813, "outflow_rate_mean": 1207.3479794339778, "system_level_velocity_min": 11.277058826458124, "outflow_rate_min": 1027.044145054945, "system_level_velocity_max": 15.86489576093595}, "info": {"num_steps_trained": 5486842, "load_time_ms": 13.946, "grad_time_ms": 10509.995, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014105177484452724, "total_loss": 5.113901615142822, "vf_loss": 5.116854667663574, "policy_loss": -0.004737768322229385, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9885332584381104, "entropy": 0.9270474314689636}, "update_time_ms": 8.984, "num_steps_sampled": 5486842, "sample_time_ms": 17622.249}, "episode_len_mean": 700.0, "time_this_iter_s": 29.18503999710083, "num_metric_batches_dropped": 0, "timesteps_total": 5486842, "episodes_total": 1765, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0b38>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb07f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0a90>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225823, "episode_reward_max": 1461.5816168316628, "episodes_this_iter": 16, "time_total_s": 3342.1192104816437, "time_since_restore": 3342.1192104816437}
{"timesteps_since_restore": 5530388, "training_iteration": 123, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-44-09", "episode_reward_min": 1100.581676358512, "timesteps_this_iter": 43546, "episode_reward_mean": 1265.287828492644, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 123, "custom_metrics": {"outflow_rate_max": 1464.672006993007, "cost2_min": -244.00651521457087, "cost1_mean": 356.58640243204064, "cost2_mean": -207.06838457641416, "system_level_velocity_mean": 13.404319229412911, "cost1_max": 425.35785513195844, "cost1_min": 296.58019059960037, "cost2_max": -175.30030217978813, "outflow_rate_mean": 1211.8301504815186, "system_level_velocity_min": 11.277058826458124, "outflow_rate_min": 1027.044145054945, "system_level_velocity_max": 15.86489576093595}, "info": {"num_steps_trained": 5530388, "load_time_ms": 13.808, "grad_time_ms": 10461.402, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01552566047757864, "total_loss": 5.108394622802734, "vf_loss": 5.1133880615234375, "policy_loss": -0.006958814803510904, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9874479174613953, "entropy": 0.9466700553894043}, "update_time_ms": 8.901, "num_steps_sampled": 5530388, "sample_time_ms": 17652.477}, "episode_len_mean": 700.0, "time_this_iter_s": 25.752215147018433, "num_metric_batches_dropped": 0, "timesteps_total": 5530388, "episodes_total": 1780, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6eb8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdeb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225849, "episode_reward_max": 1511.134445514688, "episodes_this_iter": 15, "time_total_s": 3367.871425628662, "time_since_restore": 3367.871425628662}
{"timesteps_since_restore": 5574604, "training_iteration": 124, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-44-36", "episode_reward_min": 1100.581676358512, "timesteps_this_iter": 44216, "episode_reward_mean": 1257.7866533178849, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 124, "custom_metrics": {"outflow_rate_max": 1464.672006993007, "cost2_min": -244.00651521457087, "cost1_mean": 354.83237711572684, "cost2_mean": -206.8119308683412, "system_level_velocity_mean": 13.338996466893038, "cost1_max": 425.35785513195844, "cost1_min": 296.58019059960037, "cost2_max": -183.13526296069415, "outflow_rate_mean": 1208.576529328554, "system_level_velocity_min": 11.277058826458124, "outflow_rate_min": 1027.044145054945, "system_level_velocity_max": 15.86489576093595}, "info": {"num_steps_trained": 5574604, "load_time_ms": 13.553, "grad_time_ms": 10421.112, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016279524192214012, "total_loss": 6.188761234283447, "vf_loss": 6.193173408508301, "policy_loss": -0.0064716581255197525, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9844381809234619, "entropy": 0.9397763609886169}, "update_time_ms": 8.84, "num_steps_sampled": 5574604, "sample_time_ms": 17696.308}, "episode_len_mean": 700.0, "time_this_iter_s": 27.065187215805054, "num_metric_batches_dropped": 0, "timesteps_total": 5574604, "episodes_total": 1794, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6f98>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca66a0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225876, "episode_reward_max": 1511.134445514688, "episodes_this_iter": 14, "time_total_s": 3394.936612844467, "time_since_restore": 3394.936612844467}
{"timesteps_since_restore": 5622220, "training_iteration": 125, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-45-04", "episode_reward_min": 325.9124800584975, "timesteps_this_iter": 47616, "episode_reward_mean": 1233.1109590665167, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 125, "custom_metrics": {"outflow_rate_max": 1411.7524950343775, "cost2_min": -244.00651521457087, "cost1_mean": 347.1238193776363, "cost2_mean": -204.34403556575992, "system_level_velocity_mean": 13.296712183028921, "cost1_max": 420.4901301548982, "cost1_min": 110.97579679922364, "cost2_max": -66.7930625651295, "outflow_rate_mean": 1186.9304619780507, "system_level_velocity_min": 11.277058826458124, "outflow_rate_min": 550.8164334030884, "system_level_velocity_max": 17.27538640141951}, "info": {"num_steps_trained": 5622220, "load_time_ms": 13.739, "grad_time_ms": 10460.808, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018815604969859123, "total_loss": 5.88363790512085, "vf_loss": 5.887792587280273, "policy_loss": -0.006535999942570925, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9835376739501953, "entropy": 0.9357201457023621}, "update_time_ms": 8.989, "num_steps_sampled": 5622220, "sample_time_ms": 17712.052}, "episode_len_mean": 690.11, "time_this_iter_s": 28.33375906944275, "num_metric_batches_dropped": 0, "timesteps_total": 5622220, "episodes_total": 1808, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0ba8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0a20>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225904, "episode_reward_max": 1511.134445514688, "episodes_this_iter": 14, "time_total_s": 3423.27037191391, "time_since_restore": 3423.27037191391}
{"timesteps_since_restore": 5668286, "training_iteration": 126, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-45-32", "episode_reward_min": 325.9124800584975, "timesteps_this_iter": 46066, "episode_reward_mean": 1226.5479823651463, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 126, "custom_metrics": {"outflow_rate_max": 1411.7524950343775, "cost2_min": -244.00651521457087, "cost1_mean": 344.14537678871983, "cost2_mean": -205.63322873921277, "system_level_velocity_mean": 13.195337398694573, "cost1_max": 420.4901301548982, "cost1_min": 110.97579679922364, "cost2_max": -66.7930625651295, "outflow_rate_mean": 1178.6307459633597, "system_level_velocity_min": 11.277058826458124, "outflow_rate_min": 550.8164334030884, "system_level_velocity_max": 17.27538640141951}, "info": {"num_steps_trained": 5668286, "load_time_ms": 13.532, "grad_time_ms": 10500.758, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016616832464933395, "total_loss": 4.6440606117248535, "vf_loss": 4.648141384124756, "policy_loss": -0.006183173507452011, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9885084629058838, "entropy": 0.9360113739967346}, "update_time_ms": 9.237, "num_steps_sampled": 5668286, "sample_time_ms": 17883.493}, "episode_len_mean": 690.11, "time_this_iter_s": 27.784746408462524, "num_metric_batches_dropped": 0, "timesteps_total": 5668286, "episodes_total": 1821, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca64a8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca69b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225932, "episode_reward_max": 1511.134445514688, "episodes_this_iter": 13, "time_total_s": 3451.0551183223724, "time_since_restore": 3451.0551183223724}
{"timesteps_since_restore": 5714779, "training_iteration": 127, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-46-00", "episode_reward_min": 325.9124800584975, "timesteps_this_iter": 46493, "episode_reward_mean": 1212.121456666485, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 127, "custom_metrics": {"outflow_rate_max": 1373.2215192807193, "cost2_min": -244.00651521457087, "cost1_mean": 340.28236112274686, "cost2_mean": -203.2456675074545, "system_level_velocity_mean": 13.165744025308427, "cost1_max": 420.4901301548982, "cost1_min": 110.97579679922364, "cost2_max": -66.7930625651295, "outflow_rate_mean": 1170.8570344139778, "system_level_velocity_min": 11.358387576438114, "outflow_rate_min": 550.8164334030884, "system_level_velocity_max": 17.27538640141951}, "info": {"num_steps_trained": 5714779, "load_time_ms": 13.339, "grad_time_ms": 10582.357, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016309665516018867, "total_loss": 6.488013744354248, "vf_loss": 6.492776870727539, "policy_loss": -0.006826699711382389, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9838695526123047, "entropy": 0.936093270778656}, "update_time_ms": 9.085, "num_steps_sampled": 5714779, "sample_time_ms": 17965.712}, "episode_len_mean": 685.5, "time_this_iter_s": 27.60833740234375, "num_metric_batches_dropped": 0, "timesteps_total": 5714779, "episodes_total": 1837, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca37f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca38d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3d30>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225960, "episode_reward_max": 1511.134445514688, "episodes_this_iter": 16, "time_total_s": 3478.663455724716, "time_since_restore": 3478.663455724716}
{"timesteps_since_restore": 5761681, "training_iteration": 128, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-46-28", "episode_reward_min": 325.9124800584975, "timesteps_this_iter": 46902, "episode_reward_mean": 1205.5609601992664, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 128, "custom_metrics": {"outflow_rate_max": 1368.949615772463, "cost2_min": -244.00651521457087, "cost1_mean": 337.3099655847629, "cost2_mean": -202.07576195963003, "system_level_velocity_mean": 13.071581256042506, "cost1_max": 408.9204060844985, "cost1_min": 110.97579679922364, "cost2_max": -66.7930625651295, "outflow_rate_mean": 1159.2389490165517, "system_level_velocity_min": 11.358387576438114, "outflow_rate_min": 550.8164334030884, "system_level_velocity_max": 17.27538640141951}, "info": {"num_steps_trained": 5761681, "load_time_ms": 13.305, "grad_time_ms": 10720.589, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015239551663398743, "total_loss": 4.266280651092529, "vf_loss": 4.269368648529053, "policy_loss": -0.005016795825213194, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9889195561408997, "entropy": 0.9345576167106628}, "update_time_ms": 9.241, "num_steps_sampled": 5761681, "sample_time_ms": 17945.419}, "episode_len_mean": 685.5, "time_this_iter_s": 28.33737802505493, "num_metric_batches_dropped": 0, "timesteps_total": 5761681, "episodes_total": 1850, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6908>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca65c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557225988, "episode_reward_max": 1511.134445514688, "episodes_this_iter": 13, "time_total_s": 3507.000833749771, "time_since_restore": 3507.000833749771}
{"timesteps_since_restore": 5806334, "training_iteration": 129, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-46-54", "episode_reward_min": 325.9124800584975, "timesteps_this_iter": 44653, "episode_reward_mean": 1203.2620132912914, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 129, "custom_metrics": {"outflow_rate_max": 1405.0472997002998, "cost2_min": -244.00651521457087, "cost1_mean": 337.7709756062127, "cost2_mean": -201.3038303251595, "system_level_velocity_mean": 13.086527320101833, "cost1_max": 408.9204060844985, "cost1_min": 110.97579679922364, "cost2_max": -66.7930625651295, "outflow_rate_mean": 1160.1284663758984, "system_level_velocity_min": 11.358387576438114, "outflow_rate_min": 550.8164334030884, "system_level_velocity_max": 17.27538640141951}, "info": {"num_steps_trained": 5806334, "load_time_ms": 13.28, "grad_time_ms": 10733.915, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01463533565402031, "total_loss": 4.171877861022949, "vf_loss": 4.175314903259277, "policy_loss": -0.005289447493851185, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9907423257827759, "entropy": 0.9139918088912964}, "update_time_ms": 9.352, "num_steps_sampled": 5806334, "sample_time_ms": 17738.892}, "episode_len_mean": 685.5, "time_this_iter_s": 26.10191583633423, "num_metric_batches_dropped": 0, "timesteps_total": 5806334, "episodes_total": 1865, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3b00>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3ba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226014, "episode_reward_max": 1511.134445514688, "episodes_this_iter": 15, "time_total_s": 3533.1027495861053, "time_since_restore": 3533.1027495861053}
{"timesteps_since_restore": 5851335, "training_iteration": 130, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-47-22", "episode_reward_min": 325.9124800584975, "timesteps_this_iter": 45001, "episode_reward_mean": 1196.2225003651035, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 130, "custom_metrics": {"outflow_rate_max": 1405.0472997002998, "cost2_min": -232.49299071607348, "cost1_mean": 337.86155076310575, "cost2_mean": -199.84263479076617, "system_level_velocity_mean": 13.095316744950571, "cost1_max": 397.9388010822486, "cost1_min": 110.97579679922364, "cost2_max": -66.7930625651295, "outflow_rate_mean": 1155.429568289749, "system_level_velocity_min": 11.358387576438114, "outflow_rate_min": 550.8164334030884, "system_level_velocity_max": 17.27538640141951}, "info": {"num_steps_trained": 5851335, "load_time_ms": 14.088, "grad_time_ms": 10629.118, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015583853237330914, "total_loss": 5.318427562713623, "vf_loss": 5.323463439941406, "policy_loss": -0.00700753927230835, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9872398376464844, "entropy": 0.9348546266555786}, "update_time_ms": 9.324, "num_steps_sampled": 5851335, "sample_time_ms": 17749.74}, "episode_len_mean": 685.5, "time_this_iter_s": 27.428802013397217, "num_metric_batches_dropped": 0, "timesteps_total": 5851335, "episodes_total": 1881, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3400>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226042, "episode_reward_max": 1484.0737955436139, "episodes_this_iter": 16, "time_total_s": 3560.5315515995026, "time_since_restore": 3560.5315515995026}
{"timesteps_since_restore": 5898449, "training_iteration": 131, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-47-48", "episode_reward_min": 54.52436666284495, "timesteps_this_iter": 47114, "episode_reward_mean": 1190.641055575815, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 131, "custom_metrics": {"outflow_rate_max": 1621.5758241758242, "cost2_min": -232.49299071607348, "cost1_mean": 335.83099392525236, "cost2_mean": -197.22900831856268, "system_level_velocity_mean": 13.204277486314247, "cost1_max": 438.58519321032554, "cost1_min": 29.038810298142778, "cost2_max": -25.234081627386132, "outflow_rate_mean": 1154.9508543109055, "system_level_velocity_min": 11.216802253489536, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.625915999356348}, "info": {"num_steps_trained": 5898449, "load_time_ms": 14.217, "grad_time_ms": 10081.632, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.019059402868151665, "total_loss": 9.188867568969727, "vf_loss": 9.19369888305664, "policy_loss": -0.007243695668876171, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9761655926704407, "entropy": 0.9253780245780945}, "update_time_ms": 8.986, "num_steps_sampled": 5898449, "sample_time_ms": 17218.472}, "episode_len_mean": 678.93, "time_this_iter_s": 26.51680064201355, "num_metric_batches_dropped": 0, "timesteps_total": 5898449, "episodes_total": 1894, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8feb8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f8d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226068, "episode_reward_max": 1484.0737955436139, "episodes_this_iter": 13, "time_total_s": 3587.048352241516, "time_since_restore": 3587.048352241516}
{"timesteps_since_restore": 5944909, "training_iteration": 132, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-48-17", "episode_reward_min": 49.03043483186657, "timesteps_this_iter": 46460, "episode_reward_mean": 1190.4536755828522, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 132, "custom_metrics": {"outflow_rate_max": 1621.5758241758242, "cost2_min": -232.49299071607348, "cost1_mean": 335.9034698932327, "cost2_mean": -197.56919178926245, "system_level_velocity_mean": 13.16411580904883, "cost1_max": 438.58519321032554, "cost1_min": 29.038810298142778, "cost2_max": -25.234081627386132, "outflow_rate_mean": 1154.5363689206208, "system_level_velocity_min": 11.216802253489536, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.895470812396024}, "info": {"num_steps_trained": 5944909, "load_time_ms": 14.309, "grad_time_ms": 10000.411, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01660734973847866, "total_loss": 6.193284034729004, "vf_loss": 6.197894096374512, "policy_loss": -0.006712311413139105, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9857094883918762, "entropy": 0.9116955995559692}, "update_time_ms": 7.973, "num_steps_sampled": 5944909, "sample_time_ms": 17237.703}, "episode_len_mean": 682.25, "time_this_iter_s": 28.549813508987427, "num_metric_batches_dropped": 0, "timesteps_total": 5944909, "episodes_total": 1909, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f128>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ff98>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226097, "episode_reward_max": 1484.0737955436139, "episodes_this_iter": 15, "time_total_s": 3615.5981657505035, "time_since_restore": 3615.5981657505035}
{"timesteps_since_restore": 5993235, "training_iteration": 133, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-48-48", "episode_reward_min": 49.03043483186657, "timesteps_this_iter": 48326, "episode_reward_mean": 1187.1824483331754, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 133, "custom_metrics": {"outflow_rate_max": 1621.5758241758242, "cost2_min": -230.76502289905173, "cost1_mean": 335.81339489722893, "cost2_mean": -196.3837215989662, "system_level_velocity_mean": 13.165750752881404, "cost1_max": 438.58519321032554, "cost1_min": 29.038810298142778, "cost2_max": -25.234081627386132, "outflow_rate_mean": 1152.031865111136, "system_level_velocity_min": 11.216802253489536, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.895470812396024}, "info": {"num_steps_trained": 5993235, "load_time_ms": 14.239, "grad_time_ms": 10090.465, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015180106274783611, "total_loss": 3.929837465286255, "vf_loss": 3.9336998462677, "policy_loss": -0.005783688742667437, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9892996549606323, "entropy": 0.9139026999473572}, "update_time_ms": 7.807, "num_steps_sampled": 5993235, "sample_time_ms": 17644.271}, "episode_len_mean": 682.25, "time_this_iter_s": 30.696027517318726, "num_metric_batches_dropped": 0, "timesteps_total": 5993235, "episodes_total": 1923, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca37f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca39e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca33c8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226128, "episode_reward_max": 1484.0737955436139, "episodes_this_iter": 14, "time_total_s": 3646.2941932678223, "time_since_restore": 3646.2941932678223}
{"timesteps_since_restore": 6040598, "training_iteration": 134, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-49-15", "episode_reward_min": 49.03043483186657, "timesteps_this_iter": 47363, "episode_reward_mean": 1201.799759578221, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 134, "custom_metrics": {"outflow_rate_max": 1621.5758241758242, "cost2_min": -230.76502289905173, "cost1_mean": 338.1950243624408, "cost2_mean": -197.9542421271327, "system_level_velocity_mean": 13.14792800598643, "cost1_max": 438.58519321032554, "cost1_min": 29.038810298142778, "cost2_max": -25.234081627386132, "outflow_rate_mean": 1157.6048167850993, "system_level_velocity_min": 11.216802253489536, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.895470812396024}, "info": {"num_steps_trained": 6040598, "load_time_ms": 14.489, "grad_time_ms": 10177.864, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018017800524830818, "total_loss": 4.0822014808654785, "vf_loss": 4.086249828338623, "policy_loss": -0.006328270770609379, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9896132946014404, "entropy": 0.9052435159683228}, "update_time_ms": 8.001, "num_steps_sampled": 6040598, "sample_time_ms": 17590.043}, "episode_len_mean": 686.86, "time_this_iter_s": 27.42038321495056, "num_metric_batches_dropped": 0, "timesteps_total": 6040598, "episodes_total": 1936, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6b70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca65c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226155, "episode_reward_max": 1484.0737955436139, "episodes_this_iter": 13, "time_total_s": 3673.714576482773, "time_since_restore": 3673.714576482773}
{"timesteps_since_restore": 6084360, "training_iteration": 135, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-49-42", "episode_reward_min": 49.03043483186657, "timesteps_this_iter": 43762, "episode_reward_mean": 1183.7330448312416, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 135, "custom_metrics": {"outflow_rate_max": 1621.5758241758242, "cost2_min": -230.76502289905173, "cost1_mean": 333.3284862180161, "cost2_mean": -195.12759166411945, "system_level_velocity_mean": 13.29280661511112, "cost1_max": 438.58519321032554, "cost1_min": 28.646253922356582, "cost2_max": -25.234081627386132, "outflow_rate_mean": 1148.6404454523058, "system_level_velocity_min": 10.485923101947945, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.895470812396024}, "info": {"num_steps_trained": 6084360, "load_time_ms": 14.188, "grad_time_ms": 10139.913, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018145348876714706, "total_loss": 8.648374557495117, "vf_loss": 8.652052879333496, "policy_loss": -0.00597359798848629, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9804392457008362, "entropy": 0.8972687125205994}, "update_time_ms": 7.913, "num_steps_sampled": 6084360, "sample_time_ms": 17509.0}, "episode_len_mean": 674.35, "time_this_iter_s": 27.15564465522766, "num_metric_batches_dropped": 0, "timesteps_total": 6084360, "episodes_total": 1956, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a208>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3ac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226182, "episode_reward_max": 1484.0737955436139, "episodes_this_iter": 20, "time_total_s": 3700.8702211380005, "time_since_restore": 3700.8702211380005}
{"timesteps_since_restore": 6131322, "training_iteration": 136, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-50-09", "episode_reward_min": 49.03043483186657, "timesteps_this_iter": 46962, "episode_reward_mean": 1186.3145392576162, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 136, "custom_metrics": {"outflow_rate_max": 1621.5758241758242, "cost2_min": -230.76502289905173, "cost1_mean": 334.1107465472017, "cost2_mean": -194.12722558379136, "system_level_velocity_mean": 13.315997881411532, "cost1_max": 438.58519321032554, "cost1_min": 28.646253922356582, "cost2_max": -25.234081627386132, "outflow_rate_mean": 1151.6816435680723, "system_level_velocity_min": 10.485923101947945, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.895470812396024}, "info": {"num_steps_trained": 6131322, "load_time_ms": 14.175, "grad_time_ms": 10192.491, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016410978510975838, "total_loss": 3.8461461067199707, "vf_loss": 3.8493776321411133, "policy_loss": -0.0053086960688233376, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9892356991767883, "entropy": 0.8976417779922485}, "update_time_ms": 8.043, "num_steps_sampled": 6131322, "sample_time_ms": 17324.261}, "episode_len_mean": 674.35, "time_this_iter_s": 26.461979627609253, "num_metric_batches_dropped": 0, "timesteps_total": 6131322, "episodes_total": 1970, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3588>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb35c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3c18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226209, "episode_reward_max": 1484.0737955436139, "episodes_this_iter": 14, "time_total_s": 3727.3322007656097, "time_since_restore": 3727.3322007656097}
{"timesteps_since_restore": 6175562, "training_iteration": 137, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-50-35", "episode_reward_min": 49.03043483186657, "timesteps_this_iter": 44240, "episode_reward_mean": 1179.863641590507, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 137, "custom_metrics": {"outflow_rate_max": 1621.5758241758242, "cost2_min": -228.87178317558178, "cost1_mean": 332.59670022895955, "cost2_mean": -193.91721727041534, "system_level_velocity_mean": 13.257576149106344, "cost1_max": 438.58519321032554, "cost1_min": 28.646253922356582, "cost2_max": -25.234081627386132, "outflow_rate_mean": 1147.8403437696354, "system_level_velocity_min": 10.485923101947945, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.895470812396024}, "info": {"num_steps_trained": 6175562, "load_time_ms": 14.236, "grad_time_ms": 10181.586, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01400703750550747, "total_loss": 4.4856181144714355, "vf_loss": 4.488455295562744, "policy_loss": -0.004610580392181873, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9899784922599792, "entropy": 0.9145416021347046}, "update_time_ms": 8.145, "num_steps_sampled": 6175562, "sample_time_ms": 17207.518}, "episode_len_mean": 674.35, "time_this_iter_s": 26.324690341949463, "num_metric_batches_dropped": 0, "timesteps_total": 6175562, "episodes_total": 1982, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3978>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226235, "episode_reward_max": 1480.3627828006825, "episodes_this_iter": 12, "time_total_s": 3753.656891107559, "time_since_restore": 3753.656891107559}
{"timesteps_since_restore": 6220923, "training_iteration": 138, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-51-01", "episode_reward_min": 49.03043483186657, "timesteps_this_iter": 45361, "episode_reward_mean": 1188.01348406639, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 138, "custom_metrics": {"outflow_rate_max": 1415.7601413997766, "cost2_min": -228.87178317558178, "cost1_mean": 336.1206547495777, "cost2_mean": -195.08663552454513, "system_level_velocity_mean": 13.209447815317928, "cost1_max": 409.02538973428125, "cost1_min": 28.646253922356582, "cost2_max": -25.511575601603813, "outflow_rate_mean": 1153.5031144515406, "system_level_velocity_min": 10.485923101947945, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.895470812396024}, "info": {"num_steps_trained": 6220923, "load_time_ms": 14.354, "grad_time_ms": 10164.294, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016128093004226685, "total_loss": 4.717614650726318, "vf_loss": 4.721630573272705, "policy_loss": -0.006057343445718288, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9886561036109924, "entropy": 0.9211456179618835}, "update_time_ms": 8.004, "num_steps_sampled": 6220923, "sample_time_ms": 16983.505}, "episode_len_mean": 680.92, "time_this_iter_s": 25.913116931915283, "num_metric_batches_dropped": 0, "timesteps_total": 6220923, "episodes_total": 1996, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6908>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca60f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6c88>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226261, "episode_reward_max": 1506.333926315425, "episodes_this_iter": 14, "time_total_s": 3779.5700080394745, "time_since_restore": 3779.5700080394745}
{"timesteps_since_restore": 6268428, "training_iteration": 139, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-51-27", "episode_reward_min": 50.63627187362114, "timesteps_this_iter": 47505, "episode_reward_mean": 1204.4712018009982, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 139, "custom_metrics": {"outflow_rate_max": 1472.979041758242, "cost2_min": -228.87178317558178, "cost1_mean": 340.94033622711214, "cost2_mean": -195.80584375257177, "system_level_velocity_mean": 13.205731272660241, "cost1_max": 409.02538973428125, "cost1_min": 28.646253922356582, "cost2_max": -25.511575601603813, "outflow_rate_mean": 1165.3479485091293, "system_level_velocity_min": 10.485923101947945, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.371405210655112}, "info": {"num_steps_trained": 6268428, "load_time_ms": 14.496, "grad_time_ms": 10312.004, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017503589391708374, "total_loss": 4.673133850097656, "vf_loss": 4.6770501136779785, "policy_loss": -0.006131132133305073, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9877732396125793, "entropy": 0.9376688003540039}, "update_time_ms": 7.858, "num_steps_sampled": 6268428, "sample_time_ms": 16856.498}, "episode_len_mean": 687.49, "time_this_iter_s": 26.325565576553345, "num_metric_batches_dropped": 0, "timesteps_total": 6268428, "episodes_total": 2010, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3550>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f128>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226287, "episode_reward_max": 1506.333926315425, "episodes_this_iter": 14, "time_total_s": 3805.895573616028, "time_since_restore": 3805.895573616028}
{"timesteps_since_restore": 6313135, "training_iteration": 140, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-51-53", "episode_reward_min": 50.63627187362114, "timesteps_this_iter": 44707, "episode_reward_mean": 1208.058895871454, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 140, "custom_metrics": {"outflow_rate_max": 1472.979041758242, "cost2_min": -228.54222263920946, "cost1_mean": 342.6159134090486, "cost2_mean": -195.6002161490958, "system_level_velocity_mean": 13.271429808027415, "cost1_max": 409.02538973428125, "cost1_min": 28.646253922356582, "cost2_max": -25.511575601603813, "outflow_rate_mean": 1173.2527863056857, "system_level_velocity_min": 10.485923101947945, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.371405210655112}, "info": {"num_steps_trained": 6313135, "load_time_ms": 14.457, "grad_time_ms": 10372.181, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017716120928525925, "total_loss": 5.423109531402588, "vf_loss": 5.427771091461182, "policy_loss": -0.006904066540300846, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9878957271575928, "entropy": 0.9345055222511292}, "update_time_ms": 7.692, "num_steps_sampled": 6313135, "sample_time_ms": 16635.037}, "episode_len_mean": 687.49, "time_this_iter_s": 25.823238134384155, "num_metric_batches_dropped": 0, "timesteps_total": 6313135, "episodes_total": 2026, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3da0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3780>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226313, "episode_reward_max": 1506.333926315425, "episodes_this_iter": 16, "time_total_s": 3831.718811750412, "time_since_restore": 3831.718811750412}
{"timesteps_since_restore": 6357301, "training_iteration": 141, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-52-21", "episode_reward_min": 50.63627187362114, "timesteps_this_iter": 44166, "episode_reward_mean": 1196.9874218451785, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 141, "custom_metrics": {"outflow_rate_max": 1472.979041758242, "cost2_min": -229.3250180194019, "cost1_mean": 343.1778067028048, "cost2_mean": -193.51723349933812, "system_level_velocity_mean": 13.41024450060613, "cost1_max": 409.02538973428125, "cost1_min": 28.646253922356582, "cost2_max": -25.511575601603813, "outflow_rate_mean": 1172.2075048041115, "system_level_velocity_min": 10.763316534167947, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.371405210655112}, "info": {"num_steps_trained": 6357301, "load_time_ms": 14.428, "grad_time_ms": 10447.287, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016344327479600906, "total_loss": 9.77723217010498, "vf_loss": 9.781647682189941, "policy_loss": -0.006483867298811674, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.976312518119812, "entropy": 0.9467161297798157}, "update_time_ms": 7.731, "num_steps_sampled": 6357301, "sample_time_ms": 16692.459}, "episode_len_mean": 683.07, "time_this_iter_s": 27.846842527389526, "num_metric_batches_dropped": 0, "timesteps_total": 6357301, "episodes_total": 2044, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0710>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0da0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226341, "episode_reward_max": 1506.333926315425, "episodes_this_iter": 18, "time_total_s": 3859.5656542778015, "time_since_restore": 3859.5656542778015}
{"timesteps_since_restore": 6404732, "training_iteration": 142, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-52-50", "episode_reward_min": 188.67328674576223, "timesteps_this_iter": 47431, "episode_reward_mean": 1209.3301471013351, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 142, "custom_metrics": {"outflow_rate_max": 1472.979041758242, "cost2_min": -230.85868149761592, "cost1_mean": 345.3113164783434, "cost2_mean": -195.17457591282556, "system_level_velocity_mean": 13.314111916812118, "cost1_max": 413.193504985541, "cost1_min": 81.11581299180834, "cost2_max": -48.76741791246285, "outflow_rate_mean": 1174.5424144568103, "system_level_velocity_min": 10.763316534167947, "outflow_rate_min": 432.3459214107582, "system_level_velocity_max": 17.87785752895256}, "info": {"num_steps_trained": 6404732, "load_time_ms": 14.327, "grad_time_ms": 10428.937, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0164157897233963, "total_loss": 5.499401092529297, "vf_loss": 5.503468036651611, "policy_loss": -0.006145003251731396, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9848204851150513, "entropy": 0.9301550984382629}, "update_time_ms": 7.828, "num_steps_sampled": 6404732, "sample_time_ms": 16690.829}, "episode_len_mean": 689.64, "time_this_iter_s": 28.354034185409546, "num_metric_batches_dropped": 0, "timesteps_total": 6404732, "episodes_total": 2055, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd908>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226370, "episode_reward_max": 1513.7508879051, "episodes_this_iter": 11, "time_total_s": 3887.919688463211, "time_since_restore": 3887.919688463211}
{"timesteps_since_restore": 6452993, "training_iteration": 143, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-53-18", "episode_reward_min": 188.67328674576223, "timesteps_this_iter": 48261, "episode_reward_mean": 1202.8408243600252, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 143, "custom_metrics": {"outflow_rate_max": 1472.979041758242, "cost2_min": -230.85868149761592, "cost1_mean": 343.377460307527, "cost2_mean": -195.9863410286198, "system_level_velocity_mean": 13.242019642003026, "cost1_max": 426.20964699706013, "cost1_min": 81.11581299180834, "cost2_max": -48.76741791246285, "outflow_rate_mean": 1170.478693945557, "system_level_velocity_min": 10.763316534167947, "outflow_rate_min": 432.3459214107582, "system_level_velocity_max": 17.87785752895256}, "info": {"num_steps_trained": 6452993, "load_time_ms": 14.353, "grad_time_ms": 10280.672, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01771707274019718, "total_loss": 4.581062316894531, "vf_loss": 4.586228370666504, "policy_loss": -0.007408334407955408, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9884369969367981, "entropy": 0.935203492641449}, "update_time_ms": 8.037, "num_steps_sampled": 6452993, "sample_time_ms": 16591.778}, "episode_len_mean": 689.64, "time_this_iter_s": 28.221806049346924, "num_metric_batches_dropped": 0, "timesteps_total": 6452993, "episodes_total": 2067, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6320>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca66d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226398, "episode_reward_max": 1513.7508879051, "episodes_this_iter": 12, "time_total_s": 3916.141494512558, "time_since_restore": 3916.141494512558}
{"timesteps_since_restore": 6497669, "training_iteration": 144, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-53-45", "episode_reward_min": 188.67328674576223, "timesteps_this_iter": 44676, "episode_reward_mean": 1202.3598314462358, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 144, "custom_metrics": {"outflow_rate_max": 1472.979041758242, "cost2_min": -230.85868149761592, "cost1_mean": 343.00346231885464, "cost2_mean": -194.1941637220253, "system_level_velocity_mean": 13.25034888968589, "cost1_max": 426.20964699706013, "cost1_min": 81.11581299180834, "cost2_max": -48.76741791246285, "outflow_rate_mean": 1168.1102084888962, "system_level_velocity_min": 10.763316534167947, "outflow_rate_min": 432.3459214107582, "system_level_velocity_max": 17.87785752895256}, "info": {"num_steps_trained": 6497669, "load_time_ms": 14.037, "grad_time_ms": 10064.372, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015363774262368679, "total_loss": 5.260344505310059, "vf_loss": 5.2647528648376465, "policy_loss": -0.006352836731821299, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9884825348854065, "entropy": 0.9073508381843567}, "update_time_ms": 7.645, "num_steps_sampled": 6497669, "sample_time_ms": 16788.35}, "episode_len_mean": 689.64, "time_this_iter_s": 27.20002555847168, "num_metric_batches_dropped": 0, "timesteps_total": 6497669, "episodes_total": 2085, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3f28>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3320>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226425, "episode_reward_max": 1513.7508879051, "episodes_this_iter": 18, "time_total_s": 3943.3415200710297, "time_since_restore": 3943.3415200710297}
{"timesteps_since_restore": 6543433, "training_iteration": 145, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-54-13", "episode_reward_min": 188.67328674576223, "timesteps_this_iter": 45764, "episode_reward_mean": 1199.746581042719, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 145, "custom_metrics": {"outflow_rate_max": 1472.979041758242, "cost2_min": -230.85868149761592, "cost1_mean": 341.0751201007164, "cost2_mean": -193.0940316666685, "system_level_velocity_mean": 13.306929885809831, "cost1_max": 426.20964699706013, "cost1_min": 81.11581299180834, "cost2_max": -48.76741791246285, "outflow_rate_mean": 1167.7441230046288, "system_level_velocity_min": 10.763316534167947, "outflow_rate_min": 432.3459214107582, "system_level_velocity_max": 17.87785752895256}, "info": {"num_steps_trained": 6543433, "load_time_ms": 13.951, "grad_time_ms": 10082.552, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01926569640636444, "total_loss": 7.217737197875977, "vf_loss": 7.223201751708984, "policy_loss": -0.007903513498604298, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9824237823486328, "entropy": 0.9322398900985718}, "update_time_ms": 7.743, "num_steps_sampled": 6543433, "sample_time_ms": 16803.187}, "episode_len_mean": 684.18, "time_this_iter_s": 27.488389015197754, "num_metric_batches_dropped": 0, "timesteps_total": 6543433, "episodes_total": 2097, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6ba8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca64e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226453, "episode_reward_max": 1513.7508879051, "episodes_this_iter": 12, "time_total_s": 3970.8299090862274, "time_since_restore": 3970.8299090862274}
{"timesteps_since_restore": 6589175, "training_iteration": 146, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-54-41", "episode_reward_min": 188.67328674576223, "timesteps_this_iter": 45742, "episode_reward_mean": 1198.2611835486534, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 146, "custom_metrics": {"outflow_rate_max": 1455.947711888112, "cost2_min": -230.85868149761592, "cost1_mean": 340.915170274928, "cost2_mean": -193.30041311775557, "system_level_velocity_mean": 13.302034663231218, "cost1_max": 426.20964699706013, "cost1_min": 81.11581299180834, "cost2_max": -48.76741791246285, "outflow_rate_mean": 1169.625785565715, "system_level_velocity_min": 10.763316534167947, "outflow_rate_min": 432.3459214107582, "system_level_velocity_max": 17.87785752895256}, "info": {"num_steps_trained": 6589175, "load_time_ms": 13.335, "grad_time_ms": 10088.302, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016611484810709953, "total_loss": 4.3844428062438965, "vf_loss": 4.387457847595215, "policy_loss": -0.005117542110383511, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9897857308387756, "entropy": 0.9368122220039368}, "update_time_ms": 7.802, "num_steps_sampled": 6589175, "sample_time_ms": 16945.856}, "episode_len_mean": 684.18, "time_this_iter_s": 27.94164776802063, "num_metric_batches_dropped": 0, "timesteps_total": 6589175, "episodes_total": 2113, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3ef0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226481, "episode_reward_max": 1513.7508879051, "episodes_this_iter": 16, "time_total_s": 3998.771556854248, "time_since_restore": 3998.771556854248}
{"timesteps_since_restore": 6633102, "training_iteration": 147, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-55-08", "episode_reward_min": 188.67328674576223, "timesteps_this_iter": 43927, "episode_reward_mean": 1194.2586889241384, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 147, "custom_metrics": {"outflow_rate_max": 1455.947711888112, "cost2_min": -232.43384451137223, "cost1_mean": 341.4953000754322, "cost2_mean": -193.116390801606, "system_level_velocity_mean": 13.32959547656829, "cost1_max": 426.20964699706013, "cost1_min": 81.11581299180834, "cost2_max": -48.76741791246285, "outflow_rate_mean": 1168.7726347306675, "system_level_velocity_min": 10.98897659873637, "outflow_rate_min": 432.3459214107582, "system_level_velocity_max": 17.87785752895256}, "info": {"num_steps_trained": 6633102, "load_time_ms": 13.186, "grad_time_ms": 10091.17, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018857616931200027, "total_loss": 5.128779411315918, "vf_loss": 5.132484436035156, "policy_loss": -0.00609176279976964, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9891794919967651, "entropy": 0.9224387407302856}, "update_time_ms": 7.893, "num_steps_sampled": 6633102, "sample_time_ms": 17058.204}, "episode_len_mean": 684.18, "time_this_iter_s": 27.486207962036133, "num_metric_batches_dropped": 0, "timesteps_total": 6633102, "episodes_total": 2130, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6940>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0b00>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226508, "episode_reward_max": 1513.7508879051, "episodes_this_iter": 17, "time_total_s": 4026.257764816284, "time_since_restore": 4026.257764816284}
{"timesteps_since_restore": 6680808, "training_iteration": 148, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-55-35", "episode_reward_min": 266.61892528112384, "timesteps_this_iter": 47706, "episode_reward_mean": 1213.239107728103, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 148, "custom_metrics": {"outflow_rate_max": 1455.947711888112, "cost2_min": -232.43384451137223, "cost1_mean": 345.9177185436392, "cost2_mean": -195.2835497488985, "system_level_velocity_mean": 13.238924823596392, "cost1_max": 426.20964699706013, "cost1_min": 101.55918701630952, "cost2_max": -62.85587462894159, "outflow_rate_mean": 1177.675396462257, "system_level_velocity_min": 10.98897659873637, "outflow_rate_min": 501.29517201754385, "system_level_velocity_max": 17.308997597672462}, "info": {"num_steps_trained": 6680808, "load_time_ms": 12.939, "grad_time_ms": 10166.83, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018169749528169632, "total_loss": 5.250735759735107, "vf_loss": 5.254702091217041, "policy_loss": -0.006266103591769934, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9848138689994812, "entropy": 0.9425473809242249}, "update_time_ms": 8.29, "num_steps_sampled": 6680808, "sample_time_ms": 17086.462}, "episode_len_mean": 694.54, "time_this_iter_s": 26.98027539253235, "num_metric_batches_dropped": 0, "timesteps_total": 6680808, "episodes_total": 2139, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3fd0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226535, "episode_reward_max": 1513.7508879051, "episodes_this_iter": 9, "time_total_s": 4053.2380402088165, "time_since_restore": 4053.2380402088165}
{"timesteps_since_restore": 6727047, "training_iteration": 149, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-56-02", "episode_reward_min": 266.61892528112384, "timesteps_this_iter": 46239, "episode_reward_mean": 1207.4781901580575, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 149, "custom_metrics": {"outflow_rate_max": 1455.947711888112, "cost2_min": -232.43384451137223, "cost1_mean": 345.17369198784115, "cost2_mean": -194.5689668698668, "system_level_velocity_mean": 13.223569601837049, "cost1_max": 426.20964699706013, "cost1_min": 101.55918701630952, "cost2_max": -62.85587462894159, "outflow_rate_mean": 1175.8088410415598, "system_level_velocity_min": 10.98897659873637, "outflow_rate_min": 501.29517201754385, "system_level_velocity_max": 17.308997597672462}, "info": {"num_steps_trained": 6727047, "load_time_ms": 12.663, "grad_time_ms": 10174.498, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016556570306420326, "total_loss": 5.142735481262207, "vf_loss": 5.146813869476318, "policy_loss": -0.006173989735543728, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9875813126564026, "entropy": 0.9222248196601868}, "update_time_ms": 8.428, "num_steps_sampled": 6727047, "sample_time_ms": 17179.587}, "episode_len_mean": 694.54, "time_this_iter_s": 27.328418970108032, "num_metric_batches_dropped": 0, "timesteps_total": 6727047, "episodes_total": 2154, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc952e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226562, "episode_reward_max": 1496.1128199520213, "episodes_this_iter": 15, "time_total_s": 4080.5664591789246, "time_since_restore": 4080.5664591789246}
{"timesteps_since_restore": 6774031, "training_iteration": 150, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-56-30", "episode_reward_min": 266.61892528112384, "timesteps_this_iter": 46984, "episode_reward_mean": 1206.251765216322, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 150, "custom_metrics": {"outflow_rate_max": 1455.947711888112, "cost2_min": -232.43384451137223, "cost1_mean": 345.51108268403607, "cost2_mean": -194.2597740344816, "system_level_velocity_mean": 13.253978689566624, "cost1_max": 424.46083931584224, "cost1_min": 101.55918701630952, "cost2_max": -62.85587462894159, "outflow_rate_mean": 1174.3062363634144, "system_level_velocity_min": 10.98897659873637, "outflow_rate_min": 501.29517201754385, "system_level_velocity_max": 17.308997597672462}, "info": {"num_steps_trained": 6774031, "load_time_ms": 12.66, "grad_time_ms": 10313.363, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018854500725865364, "total_loss": 4.9446234703063965, "vf_loss": 4.949751377105713, "policy_loss": -0.007513919845223427, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9876178503036499, "entropy": 0.9348267316818237}, "update_time_ms": 8.763, "num_steps_sampled": 6774031, "sample_time_ms": 17261.487}, "episode_len_mean": 694.54, "time_this_iter_s": 28.054417371749878, "num_metric_batches_dropped": 0, "timesteps_total": 6774031, "episodes_total": 2171, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3160>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca35c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226590, "episode_reward_max": 1496.1128199520213, "episodes_this_iter": 17, "time_total_s": 4108.620876550674, "time_since_restore": 4108.620876550674}
{"timesteps_since_restore": 6818729, "training_iteration": 151, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-56-57", "episode_reward_min": 266.61892528112384, "timesteps_this_iter": 44698, "episode_reward_mean": 1212.9780710845353, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 151, "custom_metrics": {"outflow_rate_max": 1455.947711888112, "cost2_min": -232.43384451137223, "cost1_mean": 345.8280934520922, "cost2_mean": -195.5870516114736, "system_level_velocity_mean": 13.25596529327349, "cost1_max": 424.46083931584224, "cost1_min": 101.55918701630952, "cost2_max": -62.85587462894159, "outflow_rate_mean": 1174.458778907929, "system_level_velocity_min": 10.683916549979907, "outflow_rate_min": 501.29517201754385, "system_level_velocity_max": 17.308997597672462}, "info": {"num_steps_trained": 6818729, "load_time_ms": 12.649, "grad_time_ms": 10356.485, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017517786473035812, "total_loss": 4.5783467292785645, "vf_loss": 4.58152437210083, "policy_loss": -0.0053951311856508255, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9891501665115356, "entropy": 0.9075223207473755}, "update_time_ms": 8.979, "num_steps_sampled": 6818729, "sample_time_ms": 17042.015}, "episode_len_mean": 694.54, "time_this_iter_s": 26.081680059432983, "num_metric_batches_dropped": 0, "timesteps_total": 6818729, "episodes_total": 2182, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc917b8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc916d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226617, "episode_reward_max": 1496.1128199520213, "episodes_this_iter": 11, "time_total_s": 4134.702556610107, "time_since_restore": 4134.702556610107}
{"timesteps_since_restore": 6865539, "training_iteration": 152, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-57-26", "episode_reward_min": 458.5116472624981, "timesteps_this_iter": 46810, "episode_reward_mean": 1199.9528496605867, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 152, "custom_metrics": {"outflow_rate_max": 1452.1335857906802, "cost2_min": -232.43384451137223, "cost1_mean": 342.8286517008581, "cost2_mean": -195.87700156112246, "system_level_velocity_mean": 13.240828350664488, "cost1_max": 424.46083931584224, "cost1_min": 146.0408530334645, "cost2_max": -84.59510516177232, "outflow_rate_mean": 1165.9462271078733, "system_level_velocity_min": 10.683916549979907, "outflow_rate_min": 732.7211952710386, "system_level_velocity_max": 17.593853473383927}, "info": {"num_steps_trained": 6865539, "load_time_ms": 12.783, "grad_time_ms": 10491.243, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018347615376114845, "total_loss": 9.226107597351074, "vf_loss": 9.22752857208252, "policy_loss": -0.003742412431165576, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9778735041618347, "entropy": 0.8894829750061035}, "update_time_ms": 8.936, "num_steps_sampled": 6865539, "sample_time_ms": 16963.501}, "episode_len_mean": 691.04, "time_this_iter_s": 28.92269229888916, "num_metric_batches_dropped": 0, "timesteps_total": 6865539, "episodes_total": 2199, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3128>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb37b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226646, "episode_reward_max": 1496.1128199520213, "episodes_this_iter": 17, "time_total_s": 4163.625248908997, "time_since_restore": 4163.625248908997}
{"timesteps_since_restore": 6911041, "training_iteration": 153, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-57-53", "episode_reward_min": 458.5116472624981, "timesteps_this_iter": 45502, "episode_reward_mean": 1201.5000945988925, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 153, "custom_metrics": {"outflow_rate_max": 1452.1335857906802, "cost2_min": -232.43384451137223, "cost1_mean": 344.2667341843246, "cost2_mean": -195.69966064476506, "system_level_velocity_mean": 13.300960766884446, "cost1_max": 424.46083931584224, "cost1_min": 146.0408530334645, "cost2_max": -84.59510516177232, "outflow_rate_mean": 1167.7294228848023, "system_level_velocity_min": 10.683916549979907, "outflow_rate_min": 732.7211952710386, "system_level_velocity_max": 17.593853473383927}, "info": {"num_steps_trained": 6911041, "load_time_ms": 12.88, "grad_time_ms": 10436.361, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017410388216376305, "total_loss": 3.903275728225708, "vf_loss": 3.9055347442626953, "policy_loss": -0.0044626896269619465, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9905617237091064, "entropy": 0.8914138078689575}, "update_time_ms": 8.73, "num_steps_sampled": 6911041, "sample_time_ms": 16976.29}, "episode_len_mean": 691.04, "time_this_iter_s": 27.79537582397461, "num_metric_batches_dropped": 0, "timesteps_total": 6911041, "episodes_total": 2212, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91588>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91358>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226673, "episode_reward_max": 1496.1128199520213, "episodes_this_iter": 13, "time_total_s": 4191.420624732971, "time_since_restore": 4191.420624732971}
{"timesteps_since_restore": 6957522, "training_iteration": 154, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-58-20", "episode_reward_min": 458.5116472624981, "timesteps_this_iter": 46481, "episode_reward_mean": 1206.7816649768733, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 154, "custom_metrics": {"outflow_rate_max": 1404.5947312687313, "cost2_min": -231.83666924203945, "cost1_mean": 345.57635450442433, "cost2_mean": -195.46491144877157, "system_level_velocity_mean": 13.345783786744418, "cost1_max": 424.46083931584224, "cost1_min": 146.0408530334645, "cost2_max": -84.59510516177232, "outflow_rate_mean": 1171.2783435842205, "system_level_velocity_min": 10.043892997254337, "outflow_rate_min": 732.7211952710386, "system_level_velocity_max": 17.593853473383927}, "info": {"num_steps_trained": 6957522, "load_time_ms": 12.978, "grad_time_ms": 10460.814, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017500722780823708, "total_loss": 3.8278250694274902, "vf_loss": 3.8314404487609863, "policy_loss": -0.005829948931932449, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9907914400100708, "entropy": 0.9032883644104004}, "update_time_ms": 8.946, "num_steps_sampled": 6957522, "sample_time_ms": 16920.366}, "episode_len_mean": 691.04, "time_this_iter_s": 26.890284061431885, "num_metric_batches_dropped": 0, "timesteps_total": 6957522, "episodes_total": 2226, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6a90>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca67b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226700, "episode_reward_max": 1461.6013675218555, "episodes_this_iter": 14, "time_total_s": 4218.310908794403, "time_since_restore": 4218.310908794403}
{"timesteps_since_restore": 7002454, "training_iteration": 155, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-58-50", "episode_reward_min": 458.5116472624981, "timesteps_this_iter": 44932, "episode_reward_mean": 1209.8067287264505, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 155, "custom_metrics": {"outflow_rate_max": 1404.5947312687313, "cost2_min": -238.41842091420463, "cost1_mean": 344.39655481981083, "cost2_mean": -195.46923551187297, "system_level_velocity_mean": 13.297138854336579, "cost1_max": 420.87526899572197, "cost1_min": 146.0408530334645, "cost2_max": -84.59510516177232, "outflow_rate_mean": 1172.192840593682, "system_level_velocity_min": 10.043892997254337, "outflow_rate_min": 732.7211952710386, "system_level_velocity_max": 17.593853473383927}, "info": {"num_steps_trained": 7002454, "load_time_ms": 13.192, "grad_time_ms": 10381.505, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017125187441706657, "total_loss": 4.100368976593018, "vf_loss": 4.103418827056885, "policy_loss": -0.005217081401497126, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9903767704963684, "entropy": 0.8976922035217285}, "update_time_ms": 8.814, "num_steps_sampled": 7002454, "sample_time_ms": 17201.601}, "episode_len_mean": 691.04, "time_this_iter_s": 29.51757836341858, "num_metric_batches_dropped": 0, "timesteps_total": 7002454, "episodes_total": 2242, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3e48>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3240>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226730, "episode_reward_max": 1461.6013675218555, "episodes_this_iter": 16, "time_total_s": 4247.828487157822, "time_since_restore": 4247.828487157822}
{"timesteps_since_restore": 7047461, "training_iteration": 156, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-59-18", "episode_reward_min": 48.637597276864774, "timesteps_this_iter": 45007, "episode_reward_mean": 1201.1516331370267, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 156, "custom_metrics": {"outflow_rate_max": 1404.5947312687313, "cost2_min": -238.6910354545142, "cost1_mean": 341.90709285624536, "cost2_mean": -193.91239885507716, "system_level_velocity_mean": 13.38103891767907, "cost1_max": 420.87526899572197, "cost1_min": 29.041752523292686, "cost2_max": -27.136549004088927, "outflow_rate_mean": 1168.8164422760003, "system_level_velocity_min": 10.043892997254337, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.62477531380932}, "info": {"num_steps_trained": 7047461, "load_time_ms": 13.086, "grad_time_ms": 10281.195, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.019191401079297066, "total_loss": 6.0796661376953125, "vf_loss": 6.086137771606445, "policy_loss": -0.00890031736344099, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9853468537330627, "entropy": 0.898671567440033}, "update_time_ms": 8.554, "num_steps_sampled": 7047461, "sample_time_ms": 17281.349}, "episode_len_mean": 684.47, "time_this_iter_s": 27.72820210456848, "num_metric_batches_dropped": 0, "timesteps_total": 7047461, "episodes_total": 2257, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3c18>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb37b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3dd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226758, "episode_reward_max": 1456.0311304296915, "episodes_this_iter": 15, "time_total_s": 4275.55668926239, "time_since_restore": 4275.55668926239}
{"timesteps_since_restore": 7094379, "training_iteration": 157, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_10-59-46", "episode_reward_min": 48.637597276864774, "timesteps_this_iter": 46918, "episode_reward_mean": 1205.1967537361318, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 157, "custom_metrics": {"outflow_rate_max": 1426.4442165246517, "cost2_min": -238.6910354545142, "cost1_mean": 343.36123797455474, "cost2_mean": -194.09129460612544, "system_level_velocity_mean": 13.42629781042316, "cost1_max": 420.87526899572197, "cost1_min": 29.041752523292686, "cost2_max": -27.136549004088927, "outflow_rate_mean": 1173.8635654810305, "system_level_velocity_min": 10.043892997254337, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.62477531380932}, "info": {"num_steps_trained": 7094379, "load_time_ms": 12.995, "grad_time_ms": 10285.862, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.020734932273626328, "total_loss": 3.9245595932006836, "vf_loss": 3.9281933307647705, "policy_loss": -0.006257752422243357, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9905024170875549, "entropy": 0.8957262635231018}, "update_time_ms": 8.467, "num_steps_sampled": 7094379, "sample_time_ms": 17367.588}, "episode_len_mean": 684.47, "time_this_iter_s": 28.394373416900635, "num_metric_batches_dropped": 0, "timesteps_total": 7094379, "episodes_total": 2269, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3630>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3e48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226786, "episode_reward_max": 1522.356658166622, "episodes_this_iter": 12, "time_total_s": 4303.951062679291, "time_since_restore": 4303.951062679291}
{"timesteps_since_restore": 7140482, "training_iteration": 158, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-00-14", "episode_reward_min": 48.637597276864774, "timesteps_this_iter": 46103, "episode_reward_mean": 1196.670290342373, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 158, "custom_metrics": {"outflow_rate_max": 1426.4442165246517, "cost2_min": -238.6910354545142, "cost1_mean": 343.69100271627343, "cost2_mean": -190.90837152813467, "system_level_velocity_mean": 13.551127513895278, "cost1_max": 420.87526899572197, "cost1_min": 29.041752523292686, "cost2_max": -27.136549004088927, "outflow_rate_mean": 1178.5574985267187, "system_level_velocity_min": 10.043892997254337, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.62477531380932}, "info": {"num_steps_trained": 7140482, "load_time_ms": 13.195, "grad_time_ms": 10248.313, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014026998542249203, "total_loss": 6.287834167480469, "vf_loss": 6.290060997009277, "policy_loss": -0.004890015348792076, "cur_kl_coeff": 0.18984374403953552, "vf_explained_var": 0.9860585331916809, "entropy": 0.8884615302085876}, "update_time_ms": 8.418, "num_steps_sampled": 7140482, "sample_time_ms": 17497.534}, "episode_len_mean": 679.91, "time_this_iter_s": 27.889777660369873, "num_metric_batches_dropped": 0, "timesteps_total": 7140482, "episodes_total": 2285, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0b38>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb05f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb08d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226814, "episode_reward_max": 1522.356658166622, "episodes_this_iter": 16, "time_total_s": 4331.840840339661, "time_since_restore": 4331.840840339661}
{"timesteps_since_restore": 7185314, "training_iteration": 159, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-00-40", "episode_reward_min": 48.637597276864774, "timesteps_this_iter": 44832, "episode_reward_mean": 1195.1285971446885, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 159, "custom_metrics": {"outflow_rate_max": 1426.4442165246517, "cost2_min": -238.6910354545142, "cost1_mean": 343.43066931062805, "cost2_mean": -189.42679980009532, "system_level_velocity_mean": 13.586018529155103, "cost1_max": 420.87526899572197, "cost1_min": 29.041752523292686, "cost2_max": -27.136549004088927, "outflow_rate_mean": 1178.282386729068, "system_level_velocity_min": 10.043892997254337, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.62477531380932}, "info": {"num_steps_trained": 7185314, "load_time_ms": 13.274, "grad_time_ms": 10187.452, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01932278461754322, "total_loss": 8.148356437683105, "vf_loss": 8.148792266845703, "policy_loss": -0.004103569779545069, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9823110699653625, "entropy": 0.89519864320755}, "update_time_ms": 8.316, "num_steps_sampled": 7185314, "sample_time_ms": 17439.657}, "episode_len_mean": 678.54, "time_this_iter_s": 26.135191440582275, "num_metric_batches_dropped": 0, "timesteps_total": 7185314, "episodes_total": 2301, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6e48>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca65f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6278>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226840, "episode_reward_max": 1522.356658166622, "episodes_this_iter": 16, "time_total_s": 4357.976031780243, "time_since_restore": 4357.976031780243}
{"timesteps_since_restore": 7228982, "training_iteration": 160, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-01-08", "episode_reward_min": 48.637597276864774, "timesteps_this_iter": 43668, "episode_reward_mean": 1201.5886556612534, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 160, "custom_metrics": {"outflow_rate_max": 1426.6489801845214, "cost2_min": -238.6910354545142, "cost1_mean": 345.4696094507645, "cost2_mean": -189.9992507833015, "system_level_velocity_mean": 13.661732409001745, "cost1_max": 412.3430566085067, "cost1_min": 29.041752523292686, "cost2_max": -27.136549004088927, "outflow_rate_mean": 1186.6388262246314, "system_level_velocity_min": 10.043892997254337, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.62477531380932}, "info": {"num_steps_trained": 7228982, "load_time_ms": 13.094, "grad_time_ms": 10154.539, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015862107276916504, "total_loss": 5.1176886558532715, "vf_loss": 5.121756076812744, "policy_loss": -0.00707812188193202, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.988551676273346, "entropy": 0.8941958546638489}, "update_time_ms": 8.296, "num_steps_sampled": 7228982, "sample_time_ms": 17445.084}, "episode_len_mean": 678.54, "time_this_iter_s": 27.76942467689514, "num_metric_batches_dropped": 0, "timesteps_total": 7228982, "episodes_total": 2317, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb39e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226868, "episode_reward_max": 1522.356658166622, "episodes_this_iter": 16, "time_total_s": 4385.745456457138, "time_since_restore": 4385.745456457138}
{"timesteps_since_restore": 7273741, "training_iteration": 161, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-01-37", "episode_reward_min": 48.637597276864774, "timesteps_this_iter": 44759, "episode_reward_mean": 1187.8417905142162, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 161, "custom_metrics": {"outflow_rate_max": 1426.6489801845214, "cost2_min": -238.6910354545142, "cost1_mean": 343.3584416653728, "cost2_mean": -187.64051281244662, "system_level_velocity_mean": 13.763803533115983, "cost1_max": 412.3430566085067, "cost1_min": 29.041752523292686, "cost2_max": -27.136549004088927, "outflow_rate_mean": 1183.220385000588, "system_level_velocity_min": 11.38095585942684, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.62477531380932}, "info": {"num_steps_trained": 7273741, "load_time_ms": 12.966, "grad_time_ms": 10154.311, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016252858564257622, "total_loss": 8.177384376525879, "vf_loss": 8.18027114868164, "policy_loss": -0.005972177721560001, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.980147123336792, "entropy": 0.8928355574607849}, "update_time_ms": 8.134, "num_steps_sampled": 7273741, "sample_time_ms": 17727.379}, "episode_len_mean": 672.04, "time_this_iter_s": 28.9024441242218, "num_metric_batches_dropped": 0, "timesteps_total": 7273741, "episodes_total": 2332, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3048>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb39b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226897, "episode_reward_max": 1522.356658166622, "episodes_this_iter": 15, "time_total_s": 4414.64790058136, "time_since_restore": 4414.64790058136}
{"timesteps_since_restore": 7319944, "training_iteration": 162, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-02-05", "episode_reward_min": 63.456382037858354, "timesteps_this_iter": 46203, "episode_reward_mean": 1194.7634314982433, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 162, "custom_metrics": {"outflow_rate_max": 1534.9608717517776, "cost2_min": -238.6910354545142, "cost1_mean": 345.59081645732226, "cost2_mean": -188.87108888026384, "system_level_velocity_mean": 13.827768016697119, "cost1_max": 432.03685614039074, "cost1_min": 33.91067270848027, "cost2_max": -26.934954743473217, "outflow_rate_mean": 1190.2849281517024, "system_level_velocity_min": 11.38095585942684, "outflow_rate_min": 319.94761241423953, "system_level_velocity_max": 18.863777730563093}, "info": {"num_steps_trained": 7319944, "load_time_ms": 12.851, "grad_time_ms": 10101.429, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015194824896752834, "total_loss": 6.775105953216553, "vf_loss": 6.779025554656982, "policy_loss": -0.00680339802056551, "cur_kl_coeff": 0.18984374403953552, "vf_explained_var": 0.9836668372154236, "entropy": 0.8932890295982361}, "update_time_ms": 8.358, "num_steps_sampled": 7319944, "sample_time_ms": 17659.055}, "episode_len_mean": 672.13, "time_this_iter_s": 27.734843015670776, "num_metric_batches_dropped": 0, "timesteps_total": 7319944, "episodes_total": 2347, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95630>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc952e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95d68>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226925, "episode_reward_max": 1561.4075399564501, "episodes_this_iter": 15, "time_total_s": 4442.382743597031, "time_since_restore": 4442.382743597031}
{"timesteps_since_restore": 7366248, "training_iteration": 163, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-02-32", "episode_reward_min": 63.456382037858354, "timesteps_this_iter": 46304, "episode_reward_mean": 1198.4372057174305, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 163, "custom_metrics": {"outflow_rate_max": 1534.9608717517776, "cost2_min": -230.47347096357902, "cost1_mean": 348.03835360501364, "cost2_mean": -188.28367072231558, "system_level_velocity_mean": 13.916273800445865, "cost1_max": 432.03685614039074, "cost1_min": 33.91067270848027, "cost2_max": -26.934954743473217, "outflow_rate_mean": 1194.459799936976, "system_level_velocity_min": 11.38095585942684, "outflow_rate_min": 319.94761241423953, "system_level_velocity_max": 18.863777730563093}, "info": {"num_steps_trained": 7366248, "load_time_ms": 12.893, "grad_time_ms": 10281.971, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014111846685409546, "total_loss": 4.549395561218262, "vf_loss": 4.551279544830322, "policy_loss": -0.004562695045024157, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9889054894447327, "entropy": 0.9008898138999939}, "update_time_ms": 8.687, "num_steps_sampled": 7366248, "sample_time_ms": 17469.596}, "episode_len_mean": 672.13, "time_this_iter_s": 27.729971647262573, "num_metric_batches_dropped": 0, "timesteps_total": 7366248, "episodes_total": 2360, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6ac8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6470>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226952, "episode_reward_max": 1561.4075399564501, "episodes_this_iter": 13, "time_total_s": 4470.112715244293, "time_since_restore": 4470.112715244293}
{"timesteps_since_restore": 7412633, "training_iteration": 164, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-03-00", "episode_reward_min": 63.456382037858354, "timesteps_this_iter": 46385, "episode_reward_mean": 1200.5034151852526, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 164, "custom_metrics": {"outflow_rate_max": 1534.9608717517776, "cost2_min": -226.2468346055317, "cost1_mean": 345.9021437202189, "cost2_mean": -188.3237605918994, "system_level_velocity_mean": 13.832521714404624, "cost1_max": 432.03685614039074, "cost1_min": 33.91067270848027, "cost2_max": -26.934954743473217, "outflow_rate_mean": 1188.5548684977093, "system_level_velocity_min": 11.38095585942684, "outflow_rate_min": 319.94761241423953, "system_level_velocity_max": 18.863777730563093}, "info": {"num_steps_trained": 7412633, "load_time_ms": 12.949, "grad_time_ms": 10387.436, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013880683109164238, "total_loss": 4.1972880363464355, "vf_loss": 4.200656414031982, "policy_loss": -0.006003806833177805, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9894002079963684, "entropy": 0.9144300818443298}, "update_time_ms": 8.667, "num_steps_sampled": 7412633, "sample_time_ms": 17398.138}, "episode_len_mean": 672.13, "time_this_iter_s": 27.24599552154541, "num_metric_batches_dropped": 0, "timesteps_total": 7412633, "episodes_total": 2374, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc915c0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557226980, "episode_reward_max": 1561.4075399564501, "episodes_this_iter": 14, "time_total_s": 4497.358710765839, "time_since_restore": 4497.358710765839}
{"timesteps_since_restore": 7457590, "training_iteration": 165, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-03-27", "episode_reward_min": 63.456382037858354, "timesteps_this_iter": 44957, "episode_reward_mean": 1209.9407879166886, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 165, "custom_metrics": {"outflow_rate_max": 1534.9608717517776, "cost2_min": -226.2468346055317, "cost1_mean": 345.8415317454528, "cost2_mean": -190.74242004994542, "system_level_velocity_mean": 13.71087871742482, "cost1_max": 432.03685614039074, "cost1_min": 33.91067270848027, "cost2_max": -26.934954743473217, "outflow_rate_mean": 1186.4974992630341, "system_level_velocity_min": 11.01864630010664, "outflow_rate_min": 319.94761241423953, "system_level_velocity_max": 18.863777730563093}, "info": {"num_steps_trained": 7457590, "load_time_ms": 12.89, "grad_time_ms": 10448.283, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014564196579158306, "total_loss": 4.629857063293457, "vf_loss": 4.63332986831665, "policy_loss": -0.006237678229808807, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9892276525497437, "entropy": 0.9170473217964172}, "update_time_ms": 8.715, "num_steps_sampled": 7457590, "sample_time_ms": 17163.671}, "episode_len_mean": 676.69, "time_this_iter_s": 27.75667691230774, "num_metric_batches_dropped": 0, "timesteps_total": 7457590, "episodes_total": 2389, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91da0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3dd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227007, "episode_reward_max": 1564.0407851767368, "episodes_this_iter": 15, "time_total_s": 4525.115387678146, "time_since_restore": 4525.115387678146}
{"timesteps_since_restore": 7503296, "training_iteration": 166, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-03-55", "episode_reward_min": 61.39365537485794, "timesteps_this_iter": 45706, "episode_reward_mean": 1202.431584784447, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 166, "custom_metrics": {"outflow_rate_max": 1534.9608717517776, "cost2_min": -226.2468346055317, "cost1_mean": 344.0218167818709, "cost2_mean": -189.83672917347587, "system_level_velocity_mean": 13.678606382177765, "cost1_max": 432.03685614039074, "cost1_min": 33.80314165780505, "cost2_max": -26.87909900305915, "outflow_rate_mean": 1179.0697647787667, "system_level_velocity_min": 11.01864630010664, "outflow_rate_min": 319.94761241423953, "system_level_velocity_max": 18.863777730563093}, "info": {"num_steps_trained": 7503296, "load_time_ms": 13.406, "grad_time_ms": 10427.902, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015869908034801483, "total_loss": 8.451274871826172, "vf_loss": 8.454602241516113, "policy_loss": -0.0063399095088243484, "cur_kl_coeff": 0.1898437887430191, "vf_explained_var": 0.9777576327323914, "entropy": 0.91021728515625}, "update_time_ms": 8.801, "num_steps_sampled": 7503296, "sample_time_ms": 17154.566}, "episode_len_mean": 675.19, "time_this_iter_s": 27.431715726852417, "num_metric_batches_dropped": 0, "timesteps_total": 7503296, "episodes_total": 2407, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91be0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91a90>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227035, "episode_reward_max": 1564.0407851767368, "episodes_this_iter": 18, "time_total_s": 4552.547103404999, "time_since_restore": 4552.547103404999}
{"timesteps_since_restore": 7549502, "training_iteration": 167, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-04-23", "episode_reward_min": 61.39365537485794, "timesteps_this_iter": 46206, "episode_reward_mean": 1209.6490355469023, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 167, "custom_metrics": {"outflow_rate_max": 1534.9608717517776, "cost2_min": -218.5294515566818, "cost1_mean": 344.0238481947133, "cost2_mean": -190.6708694445285, "system_level_velocity_mean": 13.506165550356489, "cost1_max": 432.03685614039074, "cost1_min": 33.80314165780505, "cost2_max": -26.87909900305915, "outflow_rate_mean": 1177.9301801479594, "system_level_velocity_min": 11.01864630010664, "outflow_rate_min": 319.94761241423953, "system_level_velocity_max": 18.84262319033727}, "info": {"num_steps_trained": 7549502, "load_time_ms": 13.547, "grad_time_ms": 10387.072, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015385594218969345, "total_loss": 5.286048889160156, "vf_loss": 5.290030002593994, "policy_loss": -0.006902026478201151, "cur_kl_coeff": 0.18984374403953552, "vf_explained_var": 0.9866514205932617, "entropy": 0.9140574336051941}, "update_time_ms": 8.633, "num_steps_sampled": 7549502, "sample_time_ms": 17161.095}, "episode_len_mean": 681.69, "time_this_iter_s": 28.048890113830566, "num_metric_batches_dropped": 0, "timesteps_total": 7549502, "episodes_total": 2422, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc952e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95e80>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227063, "episode_reward_max": 1564.0407851767368, "episodes_this_iter": 15, "time_total_s": 4580.595993518829, "time_since_restore": 4580.595993518829}
{"timesteps_since_restore": 7597237, "training_iteration": 168, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-04-51", "episode_reward_min": 61.39365537485794, "timesteps_this_iter": 47735, "episode_reward_mean": 1207.0639981060367, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 168, "custom_metrics": {"outflow_rate_max": 1534.9608717517776, "cost2_min": -218.5294515566818, "cost1_mean": 341.81438761754447, "cost2_mean": -190.69329183261792, "system_level_velocity_mean": 13.419214517165488, "cost1_max": 432.03685614039074, "cost1_min": 33.80314165780505, "cost2_max": -26.87909900305915, "outflow_rate_mean": 1172.003697704638, "system_level_velocity_min": 11.01864630010664, "outflow_rate_min": 319.94761241423953, "system_level_velocity_max": 18.84262319033727}, "info": {"num_steps_trained": 7597237, "load_time_ms": 13.533, "grad_time_ms": 10342.347, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015254038386046886, "total_loss": 4.173182487487793, "vf_loss": 4.176342010498047, "policy_loss": -0.006055572535842657, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9868663549423218, "entropy": 0.9188697338104248}, "update_time_ms": 8.741, "num_steps_sampled": 7597237, "sample_time_ms": 17231.376}, "episode_len_mean": 681.69, "time_this_iter_s": 28.15033197402954, "num_metric_batches_dropped": 0, "timesteps_total": 7597237, "episodes_total": 2432, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7358>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7eb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227091, "episode_reward_max": 1564.0407851767368, "episodes_this_iter": 10, "time_total_s": 4608.746325492859, "time_since_restore": 4608.746325492859}
{"timesteps_since_restore": 7642121, "training_iteration": 169, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-05-18", "episode_reward_min": 61.39365537485794, "timesteps_this_iter": 44884, "episode_reward_mean": 1214.4360925828953, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 169, "custom_metrics": {"outflow_rate_max": 1443.4614702356466, "cost2_min": -217.45068032997403, "cost1_mean": 341.3343896813728, "cost2_mean": -191.8566297806237, "system_level_velocity_mean": 13.22017648486687, "cost1_max": 414.7963248298617, "cost1_min": 33.80314165780505, "cost2_max": -26.87909900305915, "outflow_rate_mean": 1175.2438133186397, "system_level_velocity_min": 10.346118820899953, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.84262319033727}, "info": {"num_steps_trained": 7642121, "load_time_ms": 13.603, "grad_time_ms": 10315.428, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01446768082678318, "total_loss": 6.385415554046631, "vf_loss": 6.389010906219482, "policy_loss": -0.006342002190649509, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9841693043708801, "entropy": 0.9143429398536682}, "update_time_ms": 8.885, "num_steps_sampled": 7642121, "sample_time_ms": 17290.259}, "episode_len_mean": 688.17, "time_this_iter_s": 26.47209095954895, "num_metric_batches_dropped": 0, "timesteps_total": 7642121, "episodes_total": 2448, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91320>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc912e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91c18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227118, "episode_reward_max": 1564.0407851767368, "episodes_this_iter": 16, "time_total_s": 4635.218416452408, "time_since_restore": 4635.218416452408}
{"timesteps_since_restore": 7687740, "training_iteration": 170, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-05-46", "episode_reward_min": 61.39365537485794, "timesteps_this_iter": 45619, "episode_reward_mean": 1200.4274941306314, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 170, "custom_metrics": {"outflow_rate_max": 1443.4614702356466, "cost2_min": -217.45068032997403, "cost1_mean": 336.80319575535265, "cost2_mean": -190.0051867032165, "system_level_velocity_mean": 13.215071262445461, "cost1_max": 414.7963248298617, "cost1_min": 33.568328093211505, "cost2_max": -26.87909900305915, "outflow_rate_mean": 1163.3370636585616, "system_level_velocity_min": 10.346118820899953, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.84262319033727}, "info": {"num_steps_trained": 7687740, "load_time_ms": 13.484, "grad_time_ms": 10352.034, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015472614206373692, "total_loss": 7.010161399841309, "vf_loss": 7.013260364532471, "policy_loss": -0.006036220118403435, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.98117595911026, "entropy": 0.9201871752738953}, "update_time_ms": 8.646, "num_steps_sampled": 7687740, "sample_time_ms": 17298.966}, "episode_len_mean": 681.67, "time_this_iter_s": 28.20297908782959, "num_metric_batches_dropped": 0, "timesteps_total": 7687740, "episodes_total": 2463, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3470>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3940>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227146, "episode_reward_max": 1564.0407851767368, "episodes_this_iter": 15, "time_total_s": 4663.421395540237, "time_since_restore": 4663.421395540237}
{"timesteps_since_restore": 7733656, "training_iteration": 171, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-06-13", "episode_reward_min": 61.39365537485794, "timesteps_this_iter": 45916, "episode_reward_mean": 1198.945218547506, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 171, "custom_metrics": {"outflow_rate_max": 1441.8369082799557, "cost2_min": -217.45068032997403, "cost1_mean": 337.4475065230989, "cost2_mean": -188.69907230707543, "system_level_velocity_mean": 13.24412244237093, "cost1_max": 414.7963248298617, "cost1_min": 33.568328093211505, "cost2_max": -26.87909900305915, "outflow_rate_mean": 1162.289260546615, "system_level_velocity_min": 10.346118820899953, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.84262319033727}, "info": {"num_steps_trained": 7733656, "load_time_ms": 13.633, "grad_time_ms": 10378.095, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01764463633298874, "total_loss": 4.623684883117676, "vf_loss": 4.625512599945068, "policy_loss": -0.005177578888833523, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9880989789962769, "entropy": 0.9161765575408936}, "update_time_ms": 8.874, "num_steps_sampled": 7733656, "sample_time_ms": 17046.006}, "episode_len_mean": 681.67, "time_this_iter_s": 26.651942014694214, "num_metric_batches_dropped": 0, "timesteps_total": 7733656, "episodes_total": 2477, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3f28>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca39e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227173, "episode_reward_max": 1504.8804904013164, "episodes_this_iter": 14, "time_total_s": 4690.073337554932, "time_since_restore": 4690.073337554932}
{"timesteps_since_restore": 7778757, "training_iteration": 172, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-06-41", "episode_reward_min": 59.407117198003604, "timesteps_this_iter": 45101, "episode_reward_mean": 1187.488408914939, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 172, "custom_metrics": {"outflow_rate_max": 1441.8369082799557, "cost2_min": -220.1356017922828, "cost1_mean": 333.9433630316999, "cost2_mean": -185.7652835151552, "system_level_velocity_mean": 13.308587081410787, "cost1_max": 414.7963248298617, "cost1_min": 32.79552968430857, "cost2_max": -23.711744982147746, "outflow_rate_mean": 1156.2409027303447, "system_level_velocity_min": 10.346118820899953, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.89013630202772}, "info": {"num_steps_trained": 7778757, "load_time_ms": 13.686, "grad_time_ms": 10363.144, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.02414424903690815, "total_loss": 10.371011734008789, "vf_loss": 10.370598793029785, "policy_loss": -0.004170253407210112, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9731674194335938, "entropy": 0.9239000678062439}, "update_time_ms": 8.955, "num_steps_sampled": 7778757, "sample_time_ms": 17095.111}, "episode_len_mean": 674.54, "time_this_iter_s": 28.0522518157959, "num_metric_batches_dropped": 0, "timesteps_total": 7778757, "episodes_total": 2496, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95cc0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc956d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227201, "episode_reward_max": 1503.1677929991924, "episodes_this_iter": 19, "time_total_s": 4718.1255893707275, "time_since_restore": 4718.1255893707275}
{"timesteps_since_restore": 7826303, "training_iteration": 173, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-07-08", "episode_reward_min": 59.407117198003604, "timesteps_this_iter": 47546, "episode_reward_mean": 1193.318376867549, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 173, "custom_metrics": {"outflow_rate_max": 1441.8369082799557, "cost2_min": -220.1356017922828, "cost1_mean": 334.23114008711667, "cost2_mean": -186.64187344203918, "system_level_velocity_mean": 13.15280373981026, "cost1_max": 414.7963248298617, "cost1_min": 32.79552968430857, "cost2_max": -23.711744982147746, "outflow_rate_mean": 1156.7365187893179, "system_level_velocity_min": 10.346118820899953, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.89013630202772}, "info": {"num_steps_trained": 7826303, "load_time_ms": 13.736, "grad_time_ms": 10307.173, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01197773776948452, "total_loss": 3.8522534370422363, "vf_loss": 3.854112148284912, "policy_loss": -0.005269557703286409, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9884706735610962, "entropy": 0.9229137301445007}, "update_time_ms": 8.852, "num_steps_sampled": 7826303, "sample_time_ms": 17132.783}, "episode_len_mean": 681.04, "time_this_iter_s": 27.531192541122437, "num_metric_batches_dropped": 0, "timesteps_total": 7826303, "episodes_total": 2507, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91240>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91748>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227228, "episode_reward_max": 1503.1677929991924, "episodes_this_iter": 11, "time_total_s": 4745.65678191185, "time_since_restore": 4745.65678191185}
{"timesteps_since_restore": 7872873, "training_iteration": 174, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-07-36", "episode_reward_min": 59.407117198003604, "timesteps_this_iter": 46570, "episode_reward_mean": 1175.9499610765154, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 174, "custom_metrics": {"outflow_rate_max": 1434.3535156843157, "cost2_min": -220.1356017922828, "cost1_mean": 329.5241829044237, "cost2_mean": -183.25341922774626, "system_level_velocity_mean": 13.1255337616321, "cost1_max": 414.7963248298617, "cost1_min": 32.79552968430857, "cost2_max": -23.711744982147746, "outflow_rate_mean": 1142.8717018837565, "system_level_velocity_min": 8.626922948312385, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.89013630202772}, "info": {"num_steps_trained": 7872873, "load_time_ms": 13.686, "grad_time_ms": 10305.156, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012734733521938324, "total_loss": 5.688442707061768, "vf_loss": 5.690901756286621, "policy_loss": -0.0060846563428640366, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9845988154411316, "entropy": 0.9290642738342285}, "update_time_ms": 9.089, "num_steps_sampled": 7872873, "sample_time_ms": 17234.944}, "episode_len_mean": 675.12, "time_this_iter_s": 28.2355477809906, "num_metric_batches_dropped": 0, "timesteps_total": 7872873, "episodes_total": 2523, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3898>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb30f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3358>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227256, "episode_reward_max": 1452.9167369981494, "episodes_this_iter": 16, "time_total_s": 4773.892329692841, "time_since_restore": 4773.892329692841}
{"timesteps_since_restore": 7920486, "training_iteration": 175, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-08-06", "episode_reward_min": 59.407117198003604, "timesteps_this_iter": 47613, "episode_reward_mean": 1159.3807799666001, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 175, "custom_metrics": {"outflow_rate_max": 1434.3535156843157, "cost2_min": -231.1538826379208, "cost1_mean": 324.34695142887125, "cost2_mean": -181.28165689683274, "system_level_velocity_mean": 13.067544125042673, "cost1_max": 408.0461661776043, "cost1_min": 32.79552968430857, "cost2_max": -23.711744982147746, "outflow_rate_mean": 1128.6040793140369, "system_level_velocity_min": 8.626922948312385, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.89013630202772}, "info": {"num_steps_trained": 7920486, "load_time_ms": 14.055, "grad_time_ms": 10378.476, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013417020440101624, "total_loss": 7.592248439788818, "vf_loss": 7.595157146453857, "policy_loss": -0.006728985346853733, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9785279631614685, "entropy": 0.9073534607887268}, "update_time_ms": 9.156, "num_steps_sampled": 7920486, "sample_time_ms": 17301.466}, "episode_len_mean": 669.37, "time_this_iter_s": 29.1781222820282, "num_metric_batches_dropped": 0, "timesteps_total": 7920486, "episodes_total": 2538, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f98>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc910f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91e10>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227286, "episode_reward_max": 1452.9167369981494, "episodes_this_iter": 15, "time_total_s": 4803.070451974869, "time_since_restore": 4803.070451974869}
{"timesteps_since_restore": 7966528, "training_iteration": 176, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-08-33", "episode_reward_min": 59.407117198003604, "timesteps_this_iter": 46042, "episode_reward_mean": 1149.4168293849364, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 176, "custom_metrics": {"outflow_rate_max": 1434.3535156843157, "cost2_min": -231.1538826379208, "cost1_mean": 321.2579244275275, "cost2_mean": -178.31459065372002, "system_level_velocity_mean": 13.120207304773864, "cost1_max": 408.0461661776043, "cost1_min": 32.79552968430857, "cost2_max": -23.711744982147746, "outflow_rate_mean": 1119.6465543671281, "system_level_velocity_min": 8.626922948312385, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.89013630202772}, "info": {"num_steps_trained": 7966528, "load_time_ms": 14.164, "grad_time_ms": 10436.673, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014636273495852947, "total_loss": 6.543382167816162, "vf_loss": 6.5456085205078125, "policy_loss": -0.0063947089947760105, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9820785522460938, "entropy": 0.9215841293334961}, "update_time_ms": 9.246, "num_steps_sampled": 7966528, "sample_time_ms": 17188.37}, "episode_len_mean": 662.87, "time_this_iter_s": 26.89808964729309, "num_metric_batches_dropped": 0, "timesteps_total": 7966528, "episodes_total": 2552, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91c50>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f4a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227313, "episode_reward_max": 1452.9167369981494, "episodes_this_iter": 14, "time_total_s": 4829.968541622162, "time_since_restore": 4829.968541622162}
{"timesteps_since_restore": 8012184, "training_iteration": 177, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-09-01", "episode_reward_min": 59.407117198003604, "timesteps_this_iter": 45656, "episode_reward_mean": 1155.458048535254, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 177, "custom_metrics": {"outflow_rate_max": 1434.3535156843157, "cost2_min": -231.1538826379208, "cost1_mean": 320.14186222471454, "cost2_mean": -178.73734735401845, "system_level_velocity_mean": 12.90451100782635, "cost1_max": 408.0461661776043, "cost1_min": 32.79552968430857, "cost2_max": -23.711744982147746, "outflow_rate_mean": 1115.158124317034, "system_level_velocity_min": 8.626922948312385, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.89013630202772}, "info": {"num_steps_trained": 8012184, "load_time_ms": 14.173, "grad_time_ms": 10467.332, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012754763476550579, "total_loss": 4.519355773925781, "vf_loss": 4.5222392082214355, "policy_loss": -0.006515637040138245, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9881946444511414, "entropy": 0.9104123711585999}, "update_time_ms": 9.362, "num_steps_sampled": 8012184, "sample_time_ms": 17149.536}, "episode_len_mean": 669.37, "time_this_iter_s": 27.99313235282898, "num_metric_batches_dropped": 0, "timesteps_total": 8012184, "episodes_total": 2568, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3c18>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3a20>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227341, "episode_reward_max": 1429.3838582045598, "episodes_this_iter": 16, "time_total_s": 4857.961673974991, "time_since_restore": 4857.961673974991}
{"timesteps_since_restore": 8058658, "training_iteration": 178, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-09-29", "episode_reward_min": 59.407117198003604, "timesteps_this_iter": 46474, "episode_reward_mean": 1174.1229319840186, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 178, "custom_metrics": {"outflow_rate_max": 1502.779002256567, "cost2_min": -243.7438810395575, "cost1_mean": 323.3712900130489, "cost2_mean": -178.53212108462492, "system_level_velocity_mean": 12.851080568819533, "cost1_max": 408.0461661776043, "cost1_min": 32.79552968430857, "cost2_max": -23.711744982147746, "outflow_rate_mean": 1123.3101192502825, "system_level_velocity_min": 8.626922948312385, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.38165705031955}, "info": {"num_steps_trained": 8058658, "load_time_ms": 14.097, "grad_time_ms": 10527.992, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014010283164680004, "total_loss": 5.25228214263916, "vf_loss": 5.256037712097168, "policy_loss": -0.007745491806417704, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9856622815132141, "entropy": 0.9379370212554932}, "update_time_ms": 9.082, "num_steps_sampled": 8058658, "sample_time_ms": 17141.124}, "episode_len_mean": 675.33, "time_this_iter_s": 28.65448546409607, "num_metric_batches_dropped": 0, "timesteps_total": 8058658, "episodes_total": 2583, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f9e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc804e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227369, "episode_reward_max": 1579.109026089085, "episodes_this_iter": 15, "time_total_s": 4886.616159439087, "time_since_restore": 4886.616159439087}
{"timesteps_since_restore": 8106513, "training_iteration": 179, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-09-58", "episode_reward_min": 59.85887142143767, "timesteps_this_iter": 47855, "episode_reward_mean": 1184.6687190041764, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 179, "custom_metrics": {"outflow_rate_max": 1502.779002256567, "cost2_min": -243.7438810395575, "cost1_mean": 325.5646374647662, "cost2_mean": -179.73843413528354, "system_level_velocity_mean": 12.757851085800173, "cost1_max": 408.0461661776043, "cost1_min": 33.18097785727934, "cost2_max": -25.52200654125032, "outflow_rate_mean": 1127.60906561589, "system_level_velocity_min": 8.626922948312385, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.38165705031955}, "info": {"num_steps_trained": 8106513, "load_time_ms": 14.213, "grad_time_ms": 10571.616, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01240269560366869, "total_loss": 3.7137532234191895, "vf_loss": 3.7159337997436523, "policy_loss": -0.005712701007723808, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9889074563980103, "entropy": 0.9573902487754822}, "update_time_ms": 8.797, "num_steps_sampled": 8106513, "sample_time_ms": 17290.72}, "episode_len_mean": 681.83, "time_this_iter_s": 28.40923500061035, "num_metric_batches_dropped": 0, "timesteps_total": 8106513, "episodes_total": 2593, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3160>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3080>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227398, "episode_reward_max": 1579.109026089085, "episodes_this_iter": 10, "time_total_s": 4915.025394439697, "time_since_restore": 4915.025394439697}
{"timesteps_since_restore": 8151274, "training_iteration": 180, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-10-26", "episode_reward_min": 56.20595971195082, "timesteps_this_iter": 44761, "episode_reward_mean": 1181.9558483658482, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 180, "custom_metrics": {"outflow_rate_max": 1502.779002256567, "cost2_min": -243.7438810395575, "cost1_mean": 324.0719292003066, "cost2_mean": -179.32527422813976, "system_level_velocity_mean": 12.72283196638586, "cost1_max": 388.2995161056806, "cost1_min": 29.78981705243269, "cost2_max": -24.267263473403826, "outflow_rate_mean": 1114.5127207762923, "system_level_velocity_min": 8.626922948312385, "outflow_rate_min": 329.0289964895558, "system_level_velocity_max": 18.668739091758297}, "info": {"num_steps_trained": 8151274, "load_time_ms": 14.233, "grad_time_ms": 10477.006, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01318570226430893, "total_loss": 7.000610828399658, "vf_loss": 7.001692771911621, "policy_loss": -0.00483623007312417, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9836649894714355, "entropy": 0.9280593395233154}, "update_time_ms": 8.979, "num_steps_sampled": 8151274, "sample_time_ms": 17347.389}, "episode_len_mean": 681.19, "time_this_iter_s": 27.829081296920776, "num_metric_batches_dropped": 0, "timesteps_total": 8151274, "episodes_total": 2611, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7940>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb71d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227426, "episode_reward_max": 1579.109026089085, "episodes_this_iter": 18, "time_total_s": 4942.854475736618, "time_since_restore": 4942.854475736618}
{"timesteps_since_restore": 8195295, "training_iteration": 181, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-10-52", "episode_reward_min": 56.20595971195082, "timesteps_this_iter": 44021, "episode_reward_mean": 1182.742121578659, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 181, "custom_metrics": {"outflow_rate_max": 1502.779002256567, "cost2_min": -243.7438810395575, "cost1_mean": 324.5818621283764, "cost2_mean": -177.7080981887683, "system_level_velocity_mean": 12.750121394287852, "cost1_max": 392.67594114378903, "cost1_min": 29.78981705243269, "cost2_max": -24.267263473403826, "outflow_rate_mean": 1108.331228287957, "system_level_velocity_min": 9.273278780411454, "outflow_rate_min": 329.0289964895558, "system_level_velocity_max": 18.668739091758297}, "info": {"num_steps_trained": 8195295, "load_time_ms": 14.065, "grad_time_ms": 10428.352, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012941849417984486, "total_loss": 4.5359930992126465, "vf_loss": 4.537768363952637, "policy_loss": -0.0054603563621640205, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9884454011917114, "entropy": 0.9387461543083191}, "update_time_ms": 8.693, "num_steps_sampled": 8195295, "sample_time_ms": 17378.736}, "episode_len_mean": 681.19, "time_this_iter_s": 26.46724033355713, "num_metric_batches_dropped": 0, "timesteps_total": 8195295, "episodes_total": 2625, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f28>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3f28>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227452, "episode_reward_max": 1579.109026089085, "episodes_this_iter": 14, "time_total_s": 4969.321716070175, "time_since_restore": 4969.321716070175}
{"timesteps_since_restore": 8241684, "training_iteration": 182, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-11-20", "episode_reward_min": 56.20595971195082, "timesteps_this_iter": 46389, "episode_reward_mean": 1202.2725111266238, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 182, "custom_metrics": {"outflow_rate_max": 1502.779002256567, "cost2_min": -243.7438810395575, "cost1_mean": 331.5308341484893, "cost2_mean": -178.287150734014, "system_level_velocity_mean": 12.86505942686308, "cost1_max": 392.67594114378903, "cost1_min": 29.78981705243269, "cost2_max": -24.267263473403826, "outflow_rate_mean": 1123.837386789862, "system_level_velocity_min": 9.273278780411454, "outflow_rate_min": 329.0289964895558, "system_level_velocity_max": 18.668739091758297}, "info": {"num_steps_trained": 8241684, "load_time_ms": 13.976, "grad_time_ms": 10456.962, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012923003174364567, "total_loss": 4.453177452087402, "vf_loss": 4.455199241638184, "policy_loss": -0.005701559130102396, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9871569871902466, "entropy": 0.9479345679283142}, "update_time_ms": 8.677, "num_steps_sampled": 8241684, "sample_time_ms": 17330.95}, "episode_len_mean": 686.94, "time_this_iter_s": 27.869159936904907, "num_metric_batches_dropped": 0, "timesteps_total": 8241684, "episodes_total": 2638, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6d68>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3780>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227480, "episode_reward_max": 1579.109026089085, "episodes_this_iter": 13, "time_total_s": 4997.19087600708, "time_since_restore": 4997.19087600708}
{"timesteps_since_restore": 8287902, "training_iteration": 183, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-11-49", "episode_reward_min": 56.20595971195082, "timesteps_this_iter": 46218, "episode_reward_mean": 1189.2605139117231, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 183, "custom_metrics": {"outflow_rate_max": 1502.779002256567, "cost2_min": -243.7438810395575, "cost1_mean": 328.5688683216202, "cost2_mean": -178.6266145800282, "system_level_velocity_mean": 12.70531479371408, "cost1_max": 392.67594114378903, "cost1_min": 29.78981705243269, "cost2_max": -24.267263473403826, "outflow_rate_mean": 1111.0260207425827, "system_level_velocity_min": 9.273278780411454, "outflow_rate_min": 329.0289964895558, "system_level_velocity_max": 18.668739091758297}, "info": {"num_steps_trained": 8287902, "load_time_ms": 13.899, "grad_time_ms": 10458.5, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013039260171353817, "total_loss": 6.901376724243164, "vf_loss": 6.903834342956543, "policy_loss": -0.006170626729726791, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9813215732574463, "entropy": 0.945222020149231}, "update_time_ms": 8.619, "num_steps_sampled": 8287902, "sample_time_ms": 17482.635}, "episode_len_mean": 688.61, "time_this_iter_s": 29.08843207359314, "num_metric_batches_dropped": 0, "timesteps_total": 8287902, "episodes_total": 2654, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3f28>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3320>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227509, "episode_reward_max": 1579.109026089085, "episodes_this_iter": 16, "time_total_s": 5026.279308080673, "time_since_restore": 5026.279308080673}
{"timesteps_since_restore": 8334136, "training_iteration": 184, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-12-16", "episode_reward_min": 56.20595971195082, "timesteps_this_iter": 46234, "episode_reward_mean": 1189.9862842469288, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 184, "custom_metrics": {"outflow_rate_max": 1502.779002256567, "cost2_min": -243.7438810395575, "cost1_mean": 328.9855545705409, "cost2_mean": -177.83831552807885, "system_level_velocity_mean": 12.714203047867612, "cost1_max": 400.7551899876378, "cost1_min": 29.78981705243269, "cost2_max": -24.267263473403826, "outflow_rate_mean": 1114.540046534908, "system_level_velocity_min": 9.273278780411454, "outflow_rate_min": 329.0289964895558, "system_level_velocity_max": 18.668739091758297}, "info": {"num_steps_trained": 8334136, "load_time_ms": 13.352, "grad_time_ms": 10460.244, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012971946969628334, "total_loss": 6.902669906616211, "vf_loss": 6.906047344207764, "policy_loss": -0.007071253377944231, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9800902009010315, "entropy": 0.9407512545585632}, "update_time_ms": 8.426, "num_steps_sampled": 8334136, "sample_time_ms": 17366.105}, "episode_len_mean": 688.61, "time_this_iter_s": 27.07891607284546, "num_metric_batches_dropped": 0, "timesteps_total": 8334136, "episodes_total": 2667, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7d68>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb75f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227536, "episode_reward_max": 1579.109026089085, "episodes_this_iter": 13, "time_total_s": 5053.358224153519, "time_since_restore": 5053.358224153519}
{"timesteps_since_restore": 8380355, "training_iteration": 185, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-12-44", "episode_reward_min": 56.20595971195082, "timesteps_this_iter": 46219, "episode_reward_mean": 1179.2489907993524, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 185, "custom_metrics": {"outflow_rate_max": 1342.4235461362168, "cost2_min": -234.56416678631066, "cost1_mean": 327.23142221139074, "cost2_mean": -176.79160642967122, "system_level_velocity_mean": 12.725309418421757, "cost1_max": 400.7551899876378, "cost1_min": 29.78981705243269, "cost2_max": -24.267263473403826, "outflow_rate_mean": 1108.3370428812486, "system_level_velocity_min": 10.250133565755696, "outflow_rate_min": 329.0289964895558, "system_level_velocity_max": 18.668739091758297}, "info": {"num_steps_trained": 8380355, "load_time_ms": 12.547, "grad_time_ms": 10392.609, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01295518595725298, "total_loss": 4.499451160430908, "vf_loss": 4.4992170333862305, "policy_loss": -0.003455242607742548, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.987061083316803, "entropy": 0.9450680017471313}, "update_time_ms": 8.279, "num_steps_sampled": 8380355, "sample_time_ms": 17263.677}, "episode_len_mean": 684.78, "time_this_iter_s": 27.44845676422119, "num_metric_batches_dropped": 0, "timesteps_total": 8380355, "episodes_total": 2682, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7128>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7940>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227564, "episode_reward_max": 1414.7436395862123, "episodes_this_iter": 15, "time_total_s": 5080.80668091774, "time_since_restore": 5080.80668091774}
{"timesteps_since_restore": 8425118, "training_iteration": 186, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-13-11", "episode_reward_min": 56.20595971195082, "timesteps_this_iter": 44763, "episode_reward_mean": 1174.5740799779965, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 186, "custom_metrics": {"outflow_rate_max": 1342.4235461362168, "cost2_min": -234.56416678631066, "cost1_mean": 323.7538756790832, "cost2_mean": -177.78457932876012, "system_level_velocity_mean": 12.586872178877398, "cost1_max": 400.7551899876378, "cost1_min": 29.78981705243269, "cost2_max": -24.267263473403826, "outflow_rate_mean": 1100.5972752537, "system_level_velocity_min": 9.50469432455286, "outflow_rate_min": 329.0289964895558, "system_level_velocity_max": 18.668739091758297}, "info": {"num_steps_trained": 8425118, "load_time_ms": 12.612, "grad_time_ms": 10371.904, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014145555905997753, "total_loss": 4.451766014099121, "vf_loss": 4.455026149749756, "policy_loss": -0.007288818247616291, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.987837553024292, "entropy": 0.9833890199661255}, "update_time_ms": 8.18, "num_steps_sampled": 8425118, "sample_time_ms": 17306.959}, "episode_len_mean": 684.78, "time_this_iter_s": 27.127506732940674, "num_metric_batches_dropped": 0, "timesteps_total": 8425118, "episodes_total": 2696, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3780>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3470>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227591, "episode_reward_max": 1414.7436395862123, "episodes_this_iter": 14, "time_total_s": 5107.9341876506805, "time_since_restore": 5107.9341876506805}
{"timesteps_since_restore": 8470106, "training_iteration": 187, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-13-38", "episode_reward_min": 50.97951060315581, "timesteps_this_iter": 44988, "episode_reward_mean": 1174.9246846807268, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 187, "custom_metrics": {"outflow_rate_max": 1342.4235461362168, "cost2_min": -216.61081690543935, "cost1_mean": 323.48485114040653, "cost2_mean": -177.7506414947789, "system_level_velocity_mean": 12.566260926575984, "cost1_max": 400.7551899876378, "cost1_min": 29.06210580370432, "cost2_max": -28.08436712916107, "outflow_rate_mean": 1106.0813656960452, "system_level_velocity_min": 9.50469432455286, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.696999665798003}, "info": {"num_steps_trained": 8470106, "load_time_ms": 12.693, "grad_time_ms": 10270.608, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01271643303334713, "total_loss": 7.771481513977051, "vf_loss": 7.775357723236084, "policy_loss": -0.0074970051646232605, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9777035713195801, "entropy": 0.9605653882026672}, "update_time_ms": 8.188, "num_steps_sampled": 8470106, "sample_time_ms": 17313.533}, "episode_len_mean": 684.77, "time_this_iter_s": 27.027926921844482, "num_metric_batches_dropped": 0, "timesteps_total": 8470106, "episodes_total": 2714, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7c50>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7e48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227618, "episode_reward_max": 1414.7436395862123, "episodes_this_iter": 18, "time_total_s": 5134.962114572525, "time_since_restore": 5134.962114572525}
{"timesteps_since_restore": 8515930, "training_iteration": 188, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-14-07", "episode_reward_min": 50.97951060315581, "timesteps_this_iter": 45824, "episode_reward_mean": 1181.782772680552, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 188, "custom_metrics": {"outflow_rate_max": 1314.6246640888523, "cost2_min": -216.61081690543935, "cost1_mean": 321.29821545502716, "cost2_mean": -179.7695225397265, "system_level_velocity_mean": 12.469981568261032, "cost1_max": 400.7551899876378, "cost1_min": 29.06210580370432, "cost2_max": -28.08436712916107, "outflow_rate_mean": 1106.9621614357172, "system_level_velocity_min": 9.50469432455286, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.696999665798003}, "info": {"num_steps_trained": 8515930, "load_time_ms": 12.664, "grad_time_ms": 10181.658, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013253358192741871, "total_loss": 4.001274108886719, "vf_loss": 4.004513740539551, "policy_loss": -0.007013831287622452, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9886339902877808, "entropy": 0.9772412776947021}, "update_time_ms": 8.294, "num_steps_sampled": 8515930, "sample_time_ms": 17426.588}, "episode_len_mean": 684.77, "time_this_iter_s": 28.90485405921936, "num_metric_batches_dropped": 0, "timesteps_total": 8515930, "episodes_total": 2727, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3860>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca37b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3ac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227647, "episode_reward_max": 1414.7436395862123, "episodes_this_iter": 13, "time_total_s": 5163.866968631744, "time_since_restore": 5163.866968631744}
{"timesteps_since_restore": 8562248, "training_iteration": 189, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-14-34", "episode_reward_min": 50.97951060315581, "timesteps_this_iter": 46318, "episode_reward_mean": 1177.387257356017, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 189, "custom_metrics": {"outflow_rate_max": 1283.8610945054945, "cost2_min": -213.50036991074631, "cost1_mean": 318.65102635065995, "cost2_mean": -177.4096851163421, "system_level_velocity_mean": 12.47949904842822, "cost1_max": 400.7551899876378, "cost1_min": 29.06210580370432, "cost2_max": -28.08436712916107, "outflow_rate_mean": 1099.3629327826948, "system_level_velocity_min": 9.50469432455286, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.696999665798003}, "info": {"num_steps_trained": 8562248, "load_time_ms": 12.696, "grad_time_ms": 10101.553, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01366728637367487, "total_loss": 6.366805553436279, "vf_loss": 6.368741512298584, "policy_loss": -0.00582793029025197, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9821681976318359, "entropy": 0.9627333879470825}, "update_time_ms": 8.576, "num_steps_sampled": 8562248, "sample_time_ms": 17333.628}, "episode_len_mean": 679.94, "time_this_iter_s": 26.695451259613037, "num_metric_batches_dropped": 0, "timesteps_total": 8562248, "episodes_total": 2740, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7940>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7198>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227674, "episode_reward_max": 1413.2313429458475, "episodes_this_iter": 13, "time_total_s": 5190.562419891357, "time_since_restore": 5190.562419891357}
{"timesteps_since_restore": 8606111, "training_iteration": 190, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-15-00", "episode_reward_min": 50.97951060315581, "timesteps_this_iter": 43863, "episode_reward_mean": 1190.1595776669935, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 190, "custom_metrics": {"outflow_rate_max": 1283.8610945054945, "cost2_min": -213.50036991074631, "cost1_mean": 322.9850220288356, "cost2_mean": -176.75288012218218, "system_level_velocity_mean": 12.52318115595113, "cost1_max": 400.7551899876378, "cost1_min": 29.06210580370432, "cost2_max": -28.08436712916107, "outflow_rate_mean": 1103.2593680709415, "system_level_velocity_min": 9.50469432455286, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.696999665798003}, "info": {"num_steps_trained": 8606111, "load_time_ms": 12.605, "grad_time_ms": 10088.571, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013436362147331238, "total_loss": 4.525803089141846, "vf_loss": 4.528005599975586, "policy_loss": -0.0060281516052782536, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9880629777908325, "entropy": 0.9647166132926941}, "update_time_ms": 8.681, "num_steps_sampled": 8606111, "sample_time_ms": 17254.725}, "episode_len_mean": 684.77, "time_this_iter_s": 26.896930932998657, "num_metric_batches_dropped": 0, "timesteps_total": 8606111, "episodes_total": 2756, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0fd0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb09e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb04e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227700, "episode_reward_max": 1413.2313429458475, "episodes_this_iter": 16, "time_total_s": 5217.459350824356, "time_since_restore": 5217.459350824356}
{"timesteps_since_restore": 8650075, "training_iteration": 191, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-15-28", "episode_reward_min": 50.97951060315581, "timesteps_this_iter": 43964, "episode_reward_mean": 1184.291868717413, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 191, "custom_metrics": {"outflow_rate_max": 1283.8610945054945, "cost2_min": -213.50036991074631, "cost1_mean": 323.49871640445724, "cost2_mean": -176.17604409953273, "system_level_velocity_mean": 12.623971788976851, "cost1_max": 395.71425094855147, "cost1_min": 29.06210580370432, "cost2_max": -22.290314692437857, "outflow_rate_mean": 1095.425599611104, "system_level_velocity_min": 9.50469432455286, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 19.696999665798003}, "info": {"num_steps_trained": 8650075, "load_time_ms": 12.594, "grad_time_ms": 10138.606, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013161418959498405, "total_loss": 6.542952537536621, "vf_loss": 6.545956611633301, "policy_loss": -0.006752206478267908, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9818053245544434, "entropy": 0.9984296560287476}, "update_time_ms": 8.93, "num_steps_sampled": 8650075, "sample_time_ms": 17281.198}, "episode_len_mean": 682.04, "time_this_iter_s": 27.23602032661438, "num_metric_batches_dropped": 0, "timesteps_total": 8650075, "episodes_total": 2771, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3f60>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3ef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227728, "episode_reward_max": 1406.571807885983, "episodes_this_iter": 15, "time_total_s": 5244.6953711509705, "time_since_restore": 5244.6953711509705}
{"timesteps_since_restore": 8693882, "training_iteration": 192, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-15-55", "episode_reward_min": 50.97951060315581, "timesteps_this_iter": 43807, "episode_reward_mean": 1160.023735067679, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 192, "custom_metrics": {"outflow_rate_max": 1283.8610945054945, "cost2_min": -210.09836082955593, "cost1_mean": 318.8300541564458, "cost2_mean": -171.5156270618127, "system_level_velocity_mean": 12.787329652260384, "cost1_max": 395.71425094855147, "cost1_min": 29.06210580370432, "cost2_max": -22.290314692437857, "outflow_rate_mean": 1080.0633416786163, "system_level_velocity_min": 10.190244074162521, "outflow_rate_min": 323.4202989724614, "system_level_velocity_max": 19.696999665798003}, "info": {"num_steps_trained": 8693882, "load_time_ms": 12.575, "grad_time_ms": 10085.031, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012979093007743359, "total_loss": 10.717939376831055, "vf_loss": 10.721235275268555, "policy_loss": -0.0069916280917823315, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9704668521881104, "entropy": 1.018595814704895}, "update_time_ms": 8.77, "num_steps_sampled": 8693882, "sample_time_ms": 17307.24}, "episode_len_mean": 669.07, "time_this_iter_s": 27.602168560028076, "num_metric_batches_dropped": 0, "timesteps_total": 8693882, "episodes_total": 2789, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb74e0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb79e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7d68>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227755, "episode_reward_max": 1402.8265684518217, "episodes_this_iter": 18, "time_total_s": 5272.2975397109985, "time_since_restore": 5272.2975397109985}
{"timesteps_since_restore": 8737282, "training_iteration": 193, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-16-22", "episode_reward_min": 50.97951060315581, "timesteps_this_iter": 43400, "episode_reward_mean": 1157.6901764419497, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 193, "custom_metrics": {"outflow_rate_max": 1283.8610945054945, "cost2_min": -212.49753857008983, "cost1_mean": 320.3344493421983, "cost2_mean": -169.25743943846837, "system_level_velocity_mean": 12.850637325328151, "cost1_max": 395.71425094855147, "cost1_min": 29.06210580370432, "cost2_max": -22.290314692437857, "outflow_rate_mean": 1076.1803573094562, "system_level_velocity_min": 10.190244074162521, "outflow_rate_min": 323.4202989724614, "system_level_velocity_max": 19.696999665798003}, "info": {"num_steps_trained": 8737282, "load_time_ms": 12.683, "grad_time_ms": 10007.888, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013779240660369396, "total_loss": 6.306186676025391, "vf_loss": 6.309351444244385, "policy_loss": -0.0070885540917515755, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9808245301246643, "entropy": 1.010668396949768}, "update_time_ms": 8.825, "num_steps_sampled": 8737282, "sample_time_ms": 17145.998}, "episode_len_mean": 669.07, "time_this_iter_s": 26.680323362350464, "num_metric_batches_dropped": 0, "timesteps_total": 8737282, "episodes_total": 2802, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91588>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6320>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227782, "episode_reward_max": 1402.8265684518217, "episodes_this_iter": 13, "time_total_s": 5298.977863073349, "time_since_restore": 5298.977863073349}
{"timesteps_since_restore": 8779552, "training_iteration": 194, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-16-47", "episode_reward_min": 53.16792906954823, "timesteps_this_iter": 42270, "episode_reward_mean": 1161.7666467940967, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 194, "custom_metrics": {"outflow_rate_max": 1325.1653262737264, "cost2_min": -212.49753857008983, "cost1_mean": 321.0041188308011, "cost2_mean": -164.80054618927159, "system_level_velocity_mean": 12.973121685534927, "cost1_max": 395.71425094855147, "cost1_min": 28.343089747730858, "cost2_max": -21.293688405544877, "outflow_rate_mean": 1079.008704858883, "system_level_velocity_min": 10.685126495791833, "outflow_rate_min": 323.4202989724614, "system_level_velocity_max": 18.95850819813319}, "info": {"num_steps_trained": 8779552, "load_time_ms": 13.081, "grad_time_ms": 9929.251, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016139470040798187, "total_loss": 14.755803108215332, "vf_loss": 14.758454322814941, "policy_loss": -0.007246689405292273, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9563623666763306, "entropy": 1.0408415794372559}, "update_time_ms": 8.801, "num_steps_sampled": 8779552, "sample_time_ms": 17035.9}, "episode_len_mean": 664.34, "time_this_iter_s": 25.199769020080566, "num_metric_batches_dropped": 0, "timesteps_total": 8779552, "episodes_total": 2820, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91278>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91ef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227807, "episode_reward_max": 1429.9270305693638, "episodes_this_iter": 18, "time_total_s": 5324.17763209343, "time_since_restore": 5324.17763209343}
{"timesteps_since_restore": 8823289, "training_iteration": 195, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-17-14", "episode_reward_min": 53.16792906954823, "timesteps_this_iter": 43737, "episode_reward_mean": 1160.0283157868848, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 195, "custom_metrics": {"outflow_rate_max": 1325.1653262737264, "cost2_min": -212.49753857008983, "cost1_mean": 323.21480673292604, "cost2_mean": -161.76988954703586, "system_level_velocity_mean": 12.949788942069206, "cost1_max": 395.71425094855147, "cost1_min": 28.343089747730858, "cost2_max": -21.293688405544877, "outflow_rate_mean": 1077.6773399766173, "system_level_velocity_min": 10.685126495791833, "outflow_rate_min": 323.4202989724614, "system_level_velocity_max": 18.95850819813319}, "info": {"num_steps_trained": 8823289, "load_time_ms": 13.446, "grad_time_ms": 9902.099, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013290589675307274, "total_loss": 10.747603416442871, "vf_loss": 10.749953269958496, "policy_loss": -0.006134209223091602, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.966592013835907, "entropy": 1.0135209560394287}, "update_time_ms": 8.904, "num_steps_sampled": 8823289, "sample_time_ms": 16941.65}, "episode_len_mean": 669.17, "time_this_iter_s": 26.22798776626587, "num_metric_batches_dropped": 0, "timesteps_total": 8823289, "episodes_total": 2836, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3f98>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca39e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227834, "episode_reward_max": 1429.9270305693638, "episodes_this_iter": 16, "time_total_s": 5350.405619859695, "time_since_restore": 5350.405619859695}
{"timesteps_since_restore": 8865748, "training_iteration": 196, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-17-39", "episode_reward_min": 53.16792906954823, "timesteps_this_iter": 42459, "episode_reward_mean": 1161.2550798139457, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 196, "custom_metrics": {"outflow_rate_max": 1325.1653262737264, "cost2_min": -212.49753857008983, "cost1_mean": 324.4556554729067, "cost2_mean": -160.37826565691958, "system_level_velocity_mean": 12.98032899557295, "cost1_max": 395.71425094855147, "cost1_min": 28.343089747730858, "cost2_max": -21.293688405544877, "outflow_rate_mean": 1083.788427320215, "system_level_velocity_min": 10.685126495791833, "outflow_rate_min": 323.4202989724614, "system_level_velocity_max": 18.95850819813319}, "info": {"num_steps_trained": 8865748, "load_time_ms": 13.252, "grad_time_ms": 9857.485, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013720612972974777, "total_loss": 10.964956283569336, "vf_loss": 10.966705322265625, "policy_loss": -0.00565605703741312, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9641736745834351, "entropy": 1.0323295593261719}, "update_time_ms": 8.78, "num_steps_sampled": 8865748, "sample_time_ms": 16792.306}, "episode_len_mean": 669.17, "time_this_iter_s": 25.17118763923645, "num_metric_batches_dropped": 0, "timesteps_total": 8865748, "episodes_total": 2850, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7b00>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7ac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227859, "episode_reward_max": 1429.9270305693638, "episodes_this_iter": 14, "time_total_s": 5375.576807498932, "time_since_restore": 5375.576807498932}
{"timesteps_since_restore": 8908063, "training_iteration": 197, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-18-05", "episode_reward_min": 53.16792906954823, "timesteps_this_iter": 42315, "episode_reward_mean": 1163.0521863815438, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 197, "custom_metrics": {"outflow_rate_max": 1329.6398873126875, "cost2_min": -212.49753857008983, "cost1_mean": 325.4215401254695, "cost2_mean": -155.2822088923329, "system_level_velocity_mean": 13.020571765366025, "cost1_max": 393.7085694441363, "cost1_min": 28.343089747730858, "cost2_max": -21.293688405544877, "outflow_rate_mean": 1085.633866883828, "system_level_velocity_min": 10.685126495791833, "outflow_rate_min": 323.4202989724614, "system_level_velocity_max": 18.95850819813319}, "info": {"num_steps_trained": 8908063, "load_time_ms": 13.206, "grad_time_ms": 9947.715, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01491270400583744, "total_loss": 13.913285255432129, "vf_loss": 13.916582107543945, "policy_loss": -0.007542390376329422, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9548036456108093, "entropy": 1.054311990737915}, "update_time_ms": 8.809, "num_steps_sampled": 8908063, "sample_time_ms": 16606.896}, "episode_len_mean": 669.17, "time_this_iter_s": 26.065733671188354, "num_metric_batches_dropped": 0, "timesteps_total": 8908063, "episodes_total": 2866, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91e80>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91710>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227885, "episode_reward_max": 1438.431542218186, "episodes_this_iter": 16, "time_total_s": 5401.64254117012, "time_since_restore": 5401.64254117012}
{"timesteps_since_restore": 8952346, "training_iteration": 198, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-18-31", "episode_reward_min": 54.584218460256295, "timesteps_this_iter": 44283, "episode_reward_mean": 1174.5373036194705, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 198, "custom_metrics": {"outflow_rate_max": 1329.6398873126875, "cost2_min": -212.49753857008983, "cost1_mean": 329.92633477357975, "cost2_mean": -151.01167468306363, "system_level_velocity_mean": 13.027452327054588, "cost1_max": 393.7085694441363, "cost1_min": 28.343089747730858, "cost2_max": -21.293688405544877, "outflow_rate_mean": 1089.8567922225545, "system_level_velocity_min": 10.896858116537537, "outflow_rate_min": 323.4202989724614, "system_level_velocity_max": 18.95850819813319}, "info": {"num_steps_trained": 8952346, "load_time_ms": 13.106, "grad_time_ms": 9889.864, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013605820015072823, "total_loss": 13.64737606048584, "vf_loss": 13.649043083190918, "policy_loss": -0.0055403634905815125, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9524343013763428, "entropy": 1.0667636394500732}, "update_time_ms": 8.739, "num_steps_sampled": 8952346, "sample_time_ms": 16399.885}, "episode_len_mean": 675.73, "time_this_iter_s": 26.253393411636353, "num_metric_batches_dropped": 0, "timesteps_total": 8952346, "episodes_total": 2882, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb5c0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb978>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227911, "episode_reward_max": 1438.431542218186, "episodes_this_iter": 16, "time_total_s": 5427.895934581757, "time_since_restore": 5427.895934581757}
{"timesteps_since_restore": 8996534, "training_iteration": 199, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-18-57", "episode_reward_min": 54.584218460256295, "timesteps_this_iter": 44188, "episode_reward_mean": 1182.6412560417457, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 199, "custom_metrics": {"outflow_rate_max": 1329.6398873126875, "cost2_min": -206.67448905394068, "cost1_mean": 333.1133037493642, "cost2_mean": -152.7846463637838, "system_level_velocity_mean": 12.971374976868937, "cost1_max": 393.7085694441363, "cost1_min": 28.343089747730858, "cost2_max": -21.293688405544877, "outflow_rate_mean": 1092.9443306793835, "system_level_velocity_min": 10.669161825226245, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.95850819813319}, "info": {"num_steps_trained": 8996534, "load_time_ms": 12.415, "grad_time_ms": 9818.953, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012307464145123959, "total_loss": 9.098276138305664, "vf_loss": 9.101967811584473, "policy_loss": -0.007196300663053989, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.972157895565033, "entropy": 1.0712944269180298}, "update_time_ms": 8.601, "num_steps_sampled": 8996534, "sample_time_ms": 16377.548}, "episode_len_mean": 682.2, "time_this_iter_s": 25.709596395492554, "num_metric_batches_dropped": 0, "timesteps_total": 8996534, "episodes_total": 2897, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3b00>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca39e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca31d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227937, "episode_reward_max": 1438.431542218186, "episodes_this_iter": 15, "time_total_s": 5453.605530977249, "time_since_restore": 5453.605530977249}
{"timesteps_since_restore": 9038591, "training_iteration": 200, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-19-22", "episode_reward_min": 54.584218460256295, "timesteps_this_iter": 42057, "episode_reward_mean": 1174.8874217377384, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 200, "custom_metrics": {"outflow_rate_max": 1329.6398873126875, "cost2_min": -206.67448905394068, "cost1_mean": 330.7718917355989, "cost2_mean": -149.1780174685404, "system_level_velocity_mean": 13.003738033695292, "cost1_max": 393.7085694441363, "cost1_min": 28.343089747730858, "cost2_max": -21.293688405544877, "outflow_rate_mean": 1089.6307310155012, "system_level_velocity_min": 10.286732452421761, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.16194661002883}, "info": {"num_steps_trained": 9038591, "load_time_ms": 12.481, "grad_time_ms": 9692.544, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014572416432201862, "total_loss": 15.046429634094238, "vf_loss": 15.049610137939453, "policy_loss": -0.0073293824680149555, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9415099620819092, "entropy": 1.0908688306808472}, "update_time_ms": 8.222, "num_steps_sampled": 9038591, "sample_time_ms": 16301.13}, "episode_len_mean": 677.14, "time_this_iter_s": 24.85947823524475, "num_metric_batches_dropped": 0, "timesteps_total": 9038591, "episodes_total": 2913, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb78d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb76a0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227962, "episode_reward_max": 1438.431542218186, "episodes_this_iter": 16, "time_total_s": 5478.465009212494, "time_since_restore": 5478.465009212494}
{"timesteps_since_restore": 9081223, "training_iteration": 201, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-19-47", "episode_reward_min": 54.62989875063102, "timesteps_this_iter": 42632, "episode_reward_mean": 1181.1745638827972, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 201, "custom_metrics": {"outflow_rate_max": 1329.6398873126875, "cost2_min": -206.67448905394068, "cost1_mean": 332.78915324413555, "cost2_mean": -149.39815512004796, "system_level_velocity_mean": 12.88634964858201, "cost1_max": 393.7085694441363, "cost1_min": 28.636806733076636, "cost2_max": -24.15698312162797, "outflow_rate_mean": 1088.3211410889191, "system_level_velocity_min": 10.286732452421761, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.16194661002883}, "info": {"num_steps_trained": 9081223, "load_time_ms": 12.594, "grad_time_ms": 9586.261, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011656920425593853, "total_loss": 12.888968467712402, "vf_loss": 12.891962051391602, "policy_loss": -0.006315106526017189, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9495418667793274, "entropy": 1.118391513824463}, "update_time_ms": 8.033, "num_steps_sampled": 9081223, "sample_time_ms": 16245.082}, "episode_len_mean": 683.71, "time_this_iter_s": 25.59324359893799, "num_metric_batches_dropped": 0, "timesteps_total": 9081223, "episodes_total": 2928, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91080>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91470>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557227987, "episode_reward_max": 1438.431542218186, "episodes_this_iter": 15, "time_total_s": 5504.058252811432, "time_since_restore": 5504.058252811432}
{"timesteps_since_restore": 9124335, "training_iteration": 202, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-20-13", "episode_reward_min": 54.62989875063102, "timesteps_this_iter": 43112, "episode_reward_mean": 1174.381507241696, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 202, "custom_metrics": {"outflow_rate_max": 1329.6398873126875, "cost2_min": -206.67448905394068, "cost1_mean": 332.85192015894035, "cost2_mean": -143.59127095300536, "system_level_velocity_mean": 12.88986793228449, "cost1_max": 393.7085694441363, "cost1_min": 28.636806733076636, "cost2_max": -24.15698312162797, "outflow_rate_mean": 1086.011786611397, "system_level_velocity_min": 10.286732452421761, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.16194661002883}, "info": {"num_steps_trained": 9124335, "load_time_ms": 12.692, "grad_time_ms": 9482.944, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015815114602446556, "total_loss": 16.963863372802734, "vf_loss": 16.96624183654785, "policy_loss": -0.006882925983518362, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9370115399360657, "entropy": 1.1367701292037964}, "update_time_ms": 7.843, "num_steps_sampled": 9124335, "sample_time_ms": 16130.232}, "episode_len_mean": 683.71, "time_this_iter_s": 25.396013021469116, "num_metric_batches_dropped": 0, "timesteps_total": 9124335, "episodes_total": 2944, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb30f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228013, "episode_reward_max": 1438.431542218186, "episodes_this_iter": 16, "time_total_s": 5529.454265832901, "time_since_restore": 5529.454265832901}
{"timesteps_since_restore": 9166365, "training_iteration": 203, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-20-39", "episode_reward_min": 54.62989875063102, "timesteps_this_iter": 42030, "episode_reward_mean": 1164.856653837974, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 203, "custom_metrics": {"outflow_rate_max": 1290.1064223776225, "cost2_min": -206.42577635708193, "cost1_mean": 330.11209833164435, "cost2_mean": -140.7874333596898, "system_level_velocity_mean": 12.78887769173225, "cost1_max": 393.7085694441363, "cost1_min": 28.636806733076636, "cost2_max": -24.15698312162797, "outflow_rate_mean": 1077.5739051368714, "system_level_velocity_min": 10.286732452421761, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.16194661002883}, "info": {"num_steps_trained": 9166365, "load_time_ms": 12.356, "grad_time_ms": 9327.433, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014551769942045212, "total_loss": 12.558436393737793, "vf_loss": 12.561793327331543, "policy_loss": -0.007500955834984779, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9574241638183594, "entropy": 1.0961287021636963}, "update_time_ms": 7.632, "num_steps_sampled": 9166365, "sample_time_ms": 16196.224}, "episode_len_mean": 683.71, "time_this_iter_s": 25.76948642730713, "num_metric_batches_dropped": 0, "timesteps_total": 9166365, "episodes_total": 2960, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb470>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbba58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb9b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228039, "episode_reward_max": 1438.431542218186, "episodes_this_iter": 16, "time_total_s": 5555.223752260208, "time_since_restore": 5555.223752260208}
{"timesteps_since_restore": 9208168, "training_iteration": 204, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-21-06", "episode_reward_min": 54.62989875063102, "timesteps_this_iter": 41803, "episode_reward_mean": 1166.3308628587683, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 204, "custom_metrics": {"outflow_rate_max": 1266.0790471528471, "cost2_min": -206.42577635708193, "cost1_mean": 331.84067966328104, "cost2_mean": -140.55704813944288, "system_level_velocity_mean": 12.665191082330223, "cost1_max": 376.6343202378897, "cost1_min": 28.636806733076636, "cost2_max": -24.15698312162797, "outflow_rate_mean": 1083.8755833212483, "system_level_velocity_min": 10.286732452421761, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.16194661002883}, "info": {"num_steps_trained": 9208168, "load_time_ms": 12.478, "grad_time_ms": 9273.518, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013713398016989231, "total_loss": 13.107621192932129, "vf_loss": 13.110236167907715, "policy_loss": -0.006519968621432781, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9499608278274536, "entropy": 1.114137887954712}, "update_time_ms": 7.483, "num_steps_sampled": 9208168, "sample_time_ms": 16455.054}, "episode_len_mean": 690.21, "time_this_iter_s": 27.255200147628784, "num_metric_batches_dropped": 0, "timesteps_total": 9208168, "episodes_total": 2976, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6e48>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228066, "episode_reward_max": 1427.7840900629958, "episodes_this_iter": 16, "time_total_s": 5582.478952407837, "time_since_restore": 5582.478952407837}
{"timesteps_since_restore": 9250142, "training_iteration": 205, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-21-31", "episode_reward_min": 54.62989875063102, "timesteps_this_iter": 41974, "episode_reward_mean": 1150.6045305922516, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 205, "custom_metrics": {"outflow_rate_max": 1266.0790471528471, "cost2_min": -206.42577635708193, "cost1_mean": 329.82299613429285, "cost2_mean": -135.02634112977248, "system_level_velocity_mean": 12.690982240698737, "cost1_max": 384.6421358442452, "cost1_min": 28.636806733076636, "cost2_max": -24.15698312162797, "outflow_rate_mean": 1080.1808333277083, "system_level_velocity_min": 10.286732452421761, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.16194661002883}, "info": {"num_steps_trained": 9250142, "load_time_ms": 12.468, "grad_time_ms": 9159.885, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014116523787379265, "total_loss": 15.092411994934082, "vf_loss": 15.096282958984375, "policy_loss": -0.007889896631240845, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9347084164619446, "entropy": 1.118306279182434}, "update_time_ms": 7.641, "num_steps_sampled": 9250142, "sample_time_ms": 16472.662}, "episode_len_mean": 685.61, "time_this_iter_s": 25.268529653549194, "num_metric_batches_dropped": 0, "timesteps_total": 9250142, "episodes_total": 2991, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb5c0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228091, "episode_reward_max": 1427.7840900629958, "episodes_this_iter": 15, "time_total_s": 5607.747482061386, "time_since_restore": 5607.747482061386}
{"timesteps_since_restore": 9290698, "training_iteration": 206, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-21-56", "episode_reward_min": 355.1886328187072, "timesteps_this_iter": 40556, "episode_reward_mean": 1147.6836004251145, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 206, "custom_metrics": {"outflow_rate_max": 1250.8750909090909, "cost2_min": -206.42577635708193, "cost1_mean": 329.47864924927615, "cost2_mean": -130.77273260884058, "system_level_velocity_mean": 12.505031500892391, "cost1_max": 384.6421358442452, "cost1_min": 135.4032501902892, "cost2_max": -41.182320584363666, "outflow_rate_mean": 1071.9731403788915, "system_level_velocity_min": 10.286732452421761, "outflow_rate_min": 737.0544020445906, "system_level_velocity_max": 15.418690650032481}, "info": {"num_steps_trained": 9290698, "load_time_ms": 12.399, "grad_time_ms": 9029.175, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014692559838294983, "total_loss": 16.6175594329834, "vf_loss": 16.620426177978516, "policy_loss": -0.007050698157399893, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9319888949394226, "entropy": 1.1115812063217163}, "update_time_ms": 7.793, "num_steps_sampled": 9290698, "sample_time_ms": 16585.359}, "episode_len_mean": 692.18, "time_this_iter_s": 25.00922393798828, "num_metric_batches_dropped": 0, "timesteps_total": 9290698, "episodes_total": 3007, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3358>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb30f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228116, "episode_reward_max": 1362.191262263315, "episodes_this_iter": 16, "time_total_s": 5632.756705999374, "time_since_restore": 5632.756705999374}
{"timesteps_since_restore": 9331964, "training_iteration": 207, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-22-21", "episode_reward_min": 355.1886328187072, "timesteps_this_iter": 41266, "episode_reward_mean": 1139.402028412556, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 207, "custom_metrics": {"outflow_rate_max": 1250.8750909090909, "cost2_min": -200.95419503482054, "cost1_mean": 331.0955176074731, "cost2_mean": -122.46201484333608, "system_level_velocity_mean": 12.535237627771972, "cost1_max": 384.6421358442452, "cost1_min": 135.4032501902892, "cost2_max": -41.182320584363666, "outflow_rate_mean": 1070.9632965399264, "system_level_velocity_min": 10.694796301949053, "outflow_rate_min": 737.0544020445906, "system_level_velocity_max": 15.418690650032481}, "info": {"num_steps_trained": 9331964, "load_time_ms": 12.383, "grad_time_ms": 8853.404, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014670283533632755, "total_loss": 19.983983993530273, "vf_loss": 19.98809051513672, "policy_loss": -0.008282694034278393, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9082725048065186, "entropy": 1.1129332780838013}, "update_time_ms": 7.924, "num_steps_sampled": 9331964, "sample_time_ms": 16595.995}, "episode_len_mean": 695.4, "time_this_iter_s": 24.43033480644226, "num_metric_batches_dropped": 0, "timesteps_total": 9331964, "episodes_total": 3024, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc915f8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca39e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228141, "episode_reward_max": 1283.7646106267032, "episodes_this_iter": 17, "time_total_s": 5657.187040805817, "time_since_restore": 5657.187040805817}
{"timesteps_since_restore": 9372540, "training_iteration": 208, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-22-45", "episode_reward_min": 51.33282978261169, "timesteps_this_iter": 40576, "episode_reward_mean": 1122.8176694767951, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 208, "custom_metrics": {"outflow_rate_max": 1250.8750909090909, "cost2_min": -200.95419503482054, "cost1_mean": 328.7592855391301, "cost2_mean": -117.12012827381928, "system_level_velocity_mean": 12.643994908419625, "cost1_max": 384.6421358442452, "cost1_min": 28.992186127640263, "cost2_max": -25.43526713356957, "outflow_rate_mean": 1064.490765364867, "system_level_velocity_min": 10.694796301949053, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.63739153148029}, "info": {"num_steps_trained": 9372540, "load_time_ms": 12.452, "grad_time_ms": 8743.353, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012745522893965244, "total_loss": 22.456092834472656, "vf_loss": 22.45965003967285, "policy_loss": -0.007183907553553581, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.8877984285354614, "entropy": 1.111642599105835}, "update_time_ms": 7.801, "num_steps_sampled": 9372540, "sample_time_ms": 16473.449}, "episode_len_mean": 688.83, "time_this_iter_s": 23.944425344467163, "num_metric_batches_dropped": 0, "timesteps_total": 9372540, "episodes_total": 3041, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7550>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb77b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228165, "episode_reward_max": 1284.786638134025, "episodes_this_iter": 17, "time_total_s": 5681.131466150284, "time_since_restore": 5681.131466150284}
{"timesteps_since_restore": 9414446, "training_iteration": 209, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-23-10", "episode_reward_min": 51.33282978261169, "timesteps_this_iter": 41906, "episode_reward_mean": 1111.3012879177577, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 209, "custom_metrics": {"outflow_rate_max": 1250.8750909090909, "cost2_min": -200.95419503482054, "cost1_mean": 327.1025148411806, "cost2_mean": -110.55651513576102, "system_level_velocity_mean": 12.825867792465546, "cost1_max": 384.6421358442452, "cost1_min": 28.992186127640263, "cost2_max": -25.43526713356957, "outflow_rate_mean": 1060.0740300518248, "system_level_velocity_min": 11.146342211077675, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.63739153148029}, "info": {"num_steps_trained": 9414446, "load_time_ms": 12.828, "grad_time_ms": 8724.229, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013639976270496845, "total_loss": 18.176782608032227, "vf_loss": 18.180307388305664, "policy_loss": -0.007410839665681124, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9134510159492493, "entropy": 1.0755479335784912}, "update_time_ms": 8.02, "num_steps_sampled": 9414446, "sample_time_ms": 16405.757}, "episode_len_mean": 679.91, "time_this_iter_s": 24.885250568389893, "num_metric_batches_dropped": 0, "timesteps_total": 9414446, "episodes_total": 3058, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb0f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbba90>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228190, "episode_reward_max": 1284.786638134025, "episodes_this_iter": 17, "time_total_s": 5706.016716718674, "time_since_restore": 5706.016716718674}
{"timesteps_since_restore": 9455215, "training_iteration": 210, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-23-34", "episode_reward_min": 51.33282978261169, "timesteps_this_iter": 40769, "episode_reward_mean": 1080.025348264609, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 210, "custom_metrics": {"outflow_rate_max": 1292.6639184815185, "cost2_min": -200.95419503482054, "cost1_mean": 320.3305286824654, "cost2_mean": -105.2980444613321, "system_level_velocity_mean": 12.991295114572765, "cost1_max": 384.6421358442452, "cost1_min": 28.992186127640263, "cost2_max": -25.43526713356957, "outflow_rate_mean": 1043.3794623987874, "system_level_velocity_min": 11.146342211077675, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.63739153148029}, "info": {"num_steps_trained": 9455215, "load_time_ms": 12.72, "grad_time_ms": 8732.884, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01334621012210846, "total_loss": 23.847244262695312, "vf_loss": 23.850481033325195, "policy_loss": -0.007036978378891945, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.8936629295349121, "entropy": 1.0648759603500366}, "update_time_ms": 8.432, "num_steps_sampled": 9455215, "sample_time_ms": 16393.973}, "episode_len_mean": 662.46, "time_this_iter_s": 24.832217693328857, "num_metric_batches_dropped": 0, "timesteps_total": 9455215, "episodes_total": 3076, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3b38>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3048>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228214, "episode_reward_max": 1284.786638134025, "episodes_this_iter": 18, "time_total_s": 5730.848934412003, "time_since_restore": 5730.848934412003}
{"timesteps_since_restore": 9496223, "training_iteration": 211, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-23-58", "episode_reward_min": 51.33282978261169, "timesteps_this_iter": 41008, "episode_reward_mean": 1089.4370389741964, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 211, "custom_metrics": {"outflow_rate_max": 1292.6639184815185, "cost2_min": -183.5037083954934, "cost1_mean": 323.3309604390834, "cost2_mean": -103.86731220251471, "system_level_velocity_mean": 13.005007884155827, "cost1_max": 379.7815855988521, "cost1_min": 28.992186127640263, "cost2_max": -25.43526713356957, "outflow_rate_mean": 1053.6851194612586, "system_level_velocity_min": 11.146342211077675, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.63739153148029}, "info": {"num_steps_trained": 9496223, "load_time_ms": 12.548, "grad_time_ms": 8668.482, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014872239902615547, "total_loss": 17.30731773376465, "vf_loss": 17.31005859375, "policy_loss": -0.006975916214287281, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9204610586166382, "entropy": 1.0760523080825806}, "update_time_ms": 8.57, "num_steps_sampled": 9496223, "sample_time_ms": 16282.298}, "episode_len_mean": 667.06, "time_this_iter_s": 23.842606782913208, "num_metric_batches_dropped": 0, "timesteps_total": 9496223, "episodes_total": 3092, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91748>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc916d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228238, "episode_reward_max": 1284.786638134025, "episodes_this_iter": 16, "time_total_s": 5754.691541194916, "time_since_restore": 5754.691541194916}
{"timesteps_since_restore": 9537250, "training_iteration": 212, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-24-24", "episode_reward_min": 51.33282978261169, "timesteps_this_iter": 41027, "episode_reward_mean": 1078.5249271014359, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 212, "custom_metrics": {"outflow_rate_max": 1292.6639184815185, "cost2_min": -179.72309806569916, "cost1_mean": 321.70613486114377, "cost2_mean": -102.94529495068691, "system_level_velocity_mean": 13.19250390139424, "cost1_max": 377.9585211705306, "cost1_min": 28.863125887682514, "cost2_max": -23.569330807050708, "outflow_rate_mean": 1057.481467769289, "system_level_velocity_min": 11.329516193499037, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.63739153148029}, "info": {"num_steps_trained": 9537250, "load_time_ms": 11.933, "grad_time_ms": 8650.902, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014303343370556831, "total_loss": 22.817157745361328, "vf_loss": 22.819599151611328, "policy_loss": -0.006513806525617838, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9150856137275696, "entropy": 1.0959818363189697}, "update_time_ms": 8.692, "num_steps_sampled": 9537250, "sample_time_ms": 16296.704}, "episode_len_mean": 657.19, "time_this_iter_s": 25.352877855300903, "num_metric_batches_dropped": 0, "timesteps_total": 9537250, "episodes_total": 3111, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb06a0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0cc0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228264, "episode_reward_max": 1296.8480257694557, "episodes_this_iter": 19, "time_total_s": 5780.044419050217, "time_since_restore": 5780.044419050217}
{"timesteps_since_restore": 9579087, "training_iteration": 213, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-24-50", "episode_reward_min": 51.33282978261169, "timesteps_this_iter": 41837, "episode_reward_mean": 1074.4590712273625, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 213, "custom_metrics": {"outflow_rate_max": 1292.6639184815185, "cost2_min": -180.1060015908638, "cost1_mean": 319.26390232250014, "cost2_mean": -105.04616450982499, "system_level_velocity_mean": 13.265696030113133, "cost1_max": 372.95404823856063, "cost1_min": 28.863125887682514, "cost2_max": -23.569330807050708, "outflow_rate_mean": 1056.267976897926, "system_level_velocity_min": 11.329516193499037, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.63739153148029}, "info": {"num_steps_trained": 9579087, "load_time_ms": 12.207, "grad_time_ms": 8760.408, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014835557900369167, "total_loss": 13.58375358581543, "vf_loss": 13.586578369140625, "policy_loss": -0.0070512727834284306, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9401490092277527, "entropy": 1.0698031187057495}, "update_time_ms": 8.765, "num_steps_sampled": 9579087, "sample_time_ms": 16221.346}, "episode_len_mean": 650.62, "time_this_iter_s": 26.128236293792725, "num_metric_batches_dropped": 0, "timesteps_total": 9579087, "episodes_total": 3125, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c8d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ca20>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228290, "episode_reward_max": 1296.8480257694557, "episodes_this_iter": 14, "time_total_s": 5806.172655344009, "time_since_restore": 5806.172655344009}
{"timesteps_since_restore": 9619969, "training_iteration": 214, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-25-16", "episode_reward_min": 54.503203575289646, "timesteps_this_iter": 40882, "episode_reward_mean": 1084.465573690641, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 214, "custom_metrics": {"outflow_rate_max": 1292.6639184815185, "cost2_min": -180.18580578350668, "cost1_mean": 323.40301193215896, "cost2_mean": -108.68939984224751, "system_level_velocity_mean": 13.226532553755995, "cost1_max": 380.9453386091428, "cost1_min": 28.863125887682514, "cost2_max": -23.569330807050708, "outflow_rate_mean": 1066.7297869860722, "system_level_velocity_min": 11.311497518842259, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.505849547942873}, "info": {"num_steps_trained": 9619969, "load_time_ms": 12.103, "grad_time_ms": 8754.998, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014323871582746506, "total_loss": 17.516801834106445, "vf_loss": 17.520519256591797, "policy_loss": -0.007797060534358025, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9302362203598022, "entropy": 1.1023987531661987}, "update_time_ms": 8.856, "num_steps_sampled": 9619969, "sample_time_ms": 16120.276}, "episode_len_mean": 657.19, "time_this_iter_s": 26.172505140304565, "num_metric_batches_dropped": 0, "timesteps_total": 9619969, "episodes_total": 3142, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7160>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7f60>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228316, "episode_reward_max": 1296.8480257694557, "episodes_this_iter": 17, "time_total_s": 5832.345160484314, "time_since_restore": 5832.345160484314}
{"timesteps_since_restore": 9660271, "training_iteration": 215, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-25-41", "episode_reward_min": 54.503203575289646, "timesteps_this_iter": 40302, "episode_reward_mean": 1091.49045194624, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 215, "custom_metrics": {"outflow_rate_max": 1292.6639184815185, "cost2_min": -180.18580578350668, "cost1_mean": 327.49969276368114, "cost2_mean": -108.72371277167555, "system_level_velocity_mean": 13.152444054369607, "cost1_max": 380.9453386091428, "cost1_min": 28.863125887682514, "cost2_max": -23.569330807050708, "outflow_rate_mean": 1076.2501870423716, "system_level_velocity_min": 11.311497518842259, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.505849547942873}, "info": {"num_steps_trained": 9660271, "load_time_ms": 12.159, "grad_time_ms": 8728.289, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01249422412365675, "total_loss": 20.883573532104492, "vf_loss": 20.886734008789062, "policy_loss": -0.006718240678310394, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.8959571123123169, "entropy": 1.0932482481002808}, "update_time_ms": 8.62, "num_steps_sampled": 9660271, "sample_time_ms": 16118.591}, "episode_len_mean": 666.11, "time_this_iter_s": 24.980753898620605, "num_metric_batches_dropped": 0, "timesteps_total": 9660271, "episodes_total": 3158, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbd30>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228341, "episode_reward_max": 1296.8480257694557, "episodes_this_iter": 16, "time_total_s": 5857.325914382935, "time_since_restore": 5857.325914382935}
{"timesteps_since_restore": 9701031, "training_iteration": 216, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-26-06", "episode_reward_min": 54.503203575289646, "timesteps_this_iter": 40760, "episode_reward_mean": 1110.2583411032629, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 216, "custom_metrics": {"outflow_rate_max": 1272.897422977023, "cost2_min": -180.18580578350668, "cost1_mean": 332.55015654124065, "cost2_mean": -109.08548829460598, "system_level_velocity_mean": 13.072872885403196, "cost1_max": 380.9453386091428, "cost1_min": 28.863125887682514, "cost2_max": -23.569330807050708, "outflow_rate_mean": 1088.7051554149405, "system_level_velocity_min": 11.311497518842259, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.505849547942873}, "info": {"num_steps_trained": 9701031, "load_time_ms": 12.167, "grad_time_ms": 8809.603, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012972898781299591, "total_loss": 18.800216674804688, "vf_loss": 18.803565979003906, "policy_loss": -0.007042049430310726, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9121148586273193, "entropy": 1.1059948205947876}, "update_time_ms": 8.439, "num_steps_sampled": 9701031, "sample_time_ms": 16053.956}, "episode_len_mean": 678.15, "time_this_iter_s": 25.171178102493286, "num_metric_batches_dropped": 0, "timesteps_total": 9701031, "episodes_total": 3174, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3780>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228366, "episode_reward_max": 1296.8480257694557, "episodes_this_iter": 16, "time_total_s": 5882.497092485428, "time_since_restore": 5882.497092485428}
{"timesteps_since_restore": 9742044, "training_iteration": 217, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-26-31", "episode_reward_min": 54.503203575289646, "timesteps_this_iter": 41013, "episode_reward_mean": 1103.8266140215605, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 217, "custom_metrics": {"outflow_rate_max": 1272.897422977023, "cost2_min": -180.18580578350668, "cost1_mean": 333.3689890969981, "cost2_mean": -109.43511393236297, "system_level_velocity_mean": 13.134707456723023, "cost1_max": 381.16076456220924, "cost1_min": 28.863125887682514, "cost2_max": -23.569330807050708, "outflow_rate_mean": 1090.217677952297, "system_level_velocity_min": 11.311497518842259, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.505849547942873}, "info": {"num_steps_trained": 9742044, "load_time_ms": 12.115, "grad_time_ms": 8876.138, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01372479647397995, "total_loss": 21.522457122802734, "vf_loss": 21.526384353637695, "policy_loss": -0.00783485360443592, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9099767804145813, "entropy": 1.0636478662490845}, "update_time_ms": 8.194, "num_steps_sampled": 9742044, "sample_time_ms": 15999.574}, "episode_len_mean": 677.79, "time_this_iter_s": 24.5554678440094, "num_metric_batches_dropped": 0, "timesteps_total": 9742044, "episodes_total": 3192, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c828>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ce80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228391, "episode_reward_max": 1296.8480257694557, "episodes_this_iter": 18, "time_total_s": 5907.052560329437, "time_since_restore": 5907.052560329437}
{"timesteps_since_restore": 9783394, "training_iteration": 218, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-26-56", "episode_reward_min": 54.503203575289646, "timesteps_this_iter": 41350, "episode_reward_mean": 1110.7161322134157, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 218, "custom_metrics": {"outflow_rate_max": 1358.4263484515484, "cost2_min": -180.18580578350668, "cost1_mean": 336.05148709545057, "cost2_mean": -113.00075307872133, "system_level_velocity_mean": 13.177678360871221, "cost1_max": 395.0181149015747, "cost1_min": 28.863125887682514, "cost2_max": -23.569330807050708, "outflow_rate_mean": 1092.7464467289474, "system_level_velocity_min": 11.305597985802871, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.505849547942873}, "info": {"num_steps_trained": 9783394, "load_time_ms": 12.071, "grad_time_ms": 8966.624, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012210764922201633, "total_loss": 12.980447769165039, "vf_loss": 12.98450756072998, "policy_loss": -0.00753687834367156, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.956076979637146, "entropy": 1.0410923957824707}, "update_time_ms": 8.308, "num_steps_sampled": 9783394, "sample_time_ms": 16017.802}, "episode_len_mean": 681.09, "time_this_iter_s": 25.008450269699097, "num_metric_batches_dropped": 0, "timesteps_total": 9783394, "episodes_total": 3208, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6d68>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb30f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228416, "episode_reward_max": 1275.740515763341, "episodes_this_iter": 16, "time_total_s": 5932.061010599136, "time_since_restore": 5932.061010599136}
{"timesteps_since_restore": 9825081, "training_iteration": 219, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-27-21", "episode_reward_min": 66.37413519403252, "timesteps_this_iter": 41687, "episode_reward_mean": 1125.4964561252527, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 219, "custom_metrics": {"outflow_rate_max": 1358.4263484515484, "cost2_min": -180.18580578350668, "cost1_mean": 341.09650672946526, "cost2_mean": -115.36279091615079, "system_level_velocity_mean": 13.17927203772428, "cost1_max": 395.0181149015747, "cost1_min": 34.000310197735274, "cost2_max": -30.3163683560619, "outflow_rate_mean": 1108.4388786149689, "system_level_velocity_min": 11.305597985802871, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.857153838623063}, "info": {"num_steps_trained": 9825081, "load_time_ms": 12.129, "grad_time_ms": 9029.649, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0135422982275486, "total_loss": 16.308809280395508, "vf_loss": 16.3116397857666, "policy_loss": -0.006686923559755087, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9294482469558716, "entropy": 1.0490881204605103}, "update_time_ms": 8.192, "num_steps_sampled": 9825081, "sample_time_ms": 16010.032}, "episode_len_mean": 687.73, "time_this_iter_s": 25.411523818969727, "num_metric_batches_dropped": 0, "timesteps_total": 9825081, "episodes_total": 3224, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb470>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbf98>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228441, "episode_reward_max": 1324.7818804441479, "episodes_this_iter": 16, "time_total_s": 5957.472534418106, "time_since_restore": 5957.472534418106}
{"timesteps_since_restore": 9866666, "training_iteration": 220, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-27-46", "episode_reward_min": 66.37413519403252, "timesteps_this_iter": 41585, "episode_reward_mean": 1117.9405080868585, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 220, "custom_metrics": {"outflow_rate_max": 1358.4263484515484, "cost2_min": -174.2251249568002, "cost1_mean": 338.6341429217391, "cost2_mean": -116.37737671755535, "system_level_velocity_mean": 13.243321868897803, "cost1_max": 395.0181149015747, "cost1_min": 34.000310197735274, "cost2_max": -30.3163683560619, "outflow_rate_mean": 1101.9149047587691, "system_level_velocity_min": 11.305597985802871, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.857153838623063}, "info": {"num_steps_trained": 9866666, "load_time_ms": 12.472, "grad_time_ms": 9103.231, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012905815616250038, "total_loss": 13.011394500732422, "vf_loss": 13.015555381774902, "policy_loss": -0.00783556792885065, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9516422748565674, "entropy": 1.0642716884613037}, "update_time_ms": 7.918, "num_steps_sampled": 9866666, "sample_time_ms": 15884.711}, "episode_len_mean": 681.83, "time_this_iter_s": 24.341870069503784, "num_metric_batches_dropped": 0, "timesteps_total": 9866666, "episodes_total": 3239, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3518>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0ba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228466, "episode_reward_max": 1324.7818804441479, "episodes_this_iter": 15, "time_total_s": 5981.81440448761, "time_since_restore": 5981.81440448761}
{"timesteps_since_restore": 9907345, "training_iteration": 221, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-28-09", "episode_reward_min": 66.37413519403252, "timesteps_this_iter": 40679, "episode_reward_mean": 1125.458631533874, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 221, "custom_metrics": {"outflow_rate_max": 1358.4263484515484, "cost2_min": -174.2251249568002, "cost1_mean": 339.67566291501913, "cost2_mean": -119.69078418686479, "system_level_velocity_mean": 13.346129425277645, "cost1_max": 395.0181149015747, "cost1_min": 34.000310197735274, "cost2_max": -30.3163683560619, "outflow_rate_mean": 1107.92589027746, "system_level_velocity_min": 11.305597985802871, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.857153838623063}, "info": {"num_steps_trained": 9907345, "load_time_ms": 12.67, "grad_time_ms": 9165.612, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014738405123353004, "total_loss": 18.1097469329834, "vf_loss": 18.11249351501465, "policy_loss": -0.006940664257854223, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9153438806533813, "entropy": 1.1110764741897583}, "update_time_ms": 7.823, "num_steps_sampled": 9907345, "sample_time_ms": 15801.428}, "episode_len_mean": 678.64, "time_this_iter_s": 23.63431429862976, "num_metric_batches_dropped": 0, "timesteps_total": 9907345, "episodes_total": 3256, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c358>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cc18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228489, "episode_reward_max": 1324.7818804441479, "episodes_this_iter": 17, "time_total_s": 6005.44871878624, "time_since_restore": 6005.44871878624}
{"timesteps_since_restore": 9947765, "training_iteration": 222, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-28-34", "episode_reward_min": 66.37413519403252, "timesteps_this_iter": 40420, "episode_reward_mean": 1120.3107525018509, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 222, "custom_metrics": {"outflow_rate_max": 1358.4263484515484, "cost2_min": -174.2251249568002, "cost1_mean": 339.3755516997886, "cost2_mean": -119.04339580761226, "system_level_velocity_mean": 13.485798754651311, "cost1_max": 395.0181149015747, "cost1_min": 34.000310197735274, "cost2_max": -30.3163683560619, "outflow_rate_mean": 1108.6677051283962, "system_level_velocity_min": 11.305597985802871, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.857153838623063}, "info": {"num_steps_trained": 9947765, "load_time_ms": 13.297, "grad_time_ms": 9278.786, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01343549881130457, "total_loss": 19.351036071777344, "vf_loss": 19.354616165161133, "policy_loss": -0.007405531592667103, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9048158526420593, "entropy": 1.1018962860107422}, "update_time_ms": 7.822, "num_steps_sampled": 9947765, "sample_time_ms": 15601.065}, "episode_len_mean": 673.15, "time_this_iter_s": 24.525590896606445, "num_metric_batches_dropped": 0, "timesteps_total": 9947765, "episodes_total": 3273, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3d30>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3b38>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228514, "episode_reward_max": 1327.730071086109, "episodes_this_iter": 17, "time_total_s": 6029.974309682846, "time_since_restore": 6029.974309682846}
{"timesteps_since_restore": 9988867, "training_iteration": 223, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-28-59", "episode_reward_min": 66.37413519403252, "timesteps_this_iter": 41102, "episode_reward_mean": 1136.8527796565509, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 223, "custom_metrics": {"outflow_rate_max": 1358.4263484515484, "cost2_min": -174.2251249568002, "cost1_mean": 341.7352994614696, "cost2_mean": -121.72134961688053, "system_level_velocity_mean": 13.4131066933854, "cost1_max": 395.0181149015747, "cost1_min": 34.000310197735274, "cost2_max": -30.3163683560619, "outflow_rate_mean": 1117.147970630749, "system_level_velocity_min": 11.305597985802871, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.857153838623063}, "info": {"num_steps_trained": 9988867, "load_time_ms": 13.213, "grad_time_ms": 9355.834, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014765881933271885, "total_loss": 17.745384216308594, "vf_loss": 17.74781608581543, "policy_loss": -0.006636918056756258, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9249165654182434, "entropy": 1.0753175020217896}, "update_time_ms": 7.912, "num_steps_sampled": 9988867, "sample_time_ms": 15379.808}, "episode_len_mean": 678.92, "time_this_iter_s": 24.675164222717285, "num_metric_batches_dropped": 0, "timesteps_total": 9988867, "episodes_total": 3291, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0c18>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0128>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228539, "episode_reward_max": 1327.730071086109, "episodes_this_iter": 18, "time_total_s": 6054.649473905563, "time_since_restore": 6054.649473905563}
{"timesteps_since_restore": 10029626, "training_iteration": 224, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-29-24", "episode_reward_min": 66.37413519403252, "timesteps_this_iter": 40759, "episode_reward_mean": 1136.3097206933799, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 224, "custom_metrics": {"outflow_rate_max": 1335.1755304695303, "cost2_min": -174.2251249568002, "cost1_mean": 341.91802729431964, "cost2_mean": -121.92910735246492, "system_level_velocity_mean": 13.410506911555222, "cost1_max": 392.51799622568024, "cost1_min": 34.000310197735274, "cost2_max": -30.3163683560619, "outflow_rate_mean": 1116.7170167006789, "system_level_velocity_min": 11.305597985802871, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.857153838623063}, "info": {"num_steps_trained": 10029626, "load_time_ms": 13.228, "grad_time_ms": 9412.665, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014390301890671253, "total_loss": 10.18267822265625, "vf_loss": 10.186482429504395, "policy_loss": -0.007902023382484913, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9612081050872803, "entropy": 1.0491807460784912}, "update_time_ms": 7.998, "num_steps_sampled": 10029626, "sample_time_ms": 15219.639}, "episode_len_mean": 678.92, "time_this_iter_s": 25.144245147705078, "num_metric_batches_dropped": 0, "timesteps_total": 10029626, "episodes_total": 3305, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c240>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cf60>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228564, "episode_reward_max": 1327.730071086109, "episodes_this_iter": 14, "time_total_s": 6079.793719053268, "time_since_restore": 6079.793719053268}
{"timesteps_since_restore": 10070913, "training_iteration": 225, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-29-49", "episode_reward_min": 183.892499690449, "timesteps_this_iter": 41287, "episode_reward_mean": 1141.5328542827817, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 225, "custom_metrics": {"outflow_rate_max": 1362.7814725274727, "cost2_min": -172.87348900151665, "cost1_mean": 345.6048287835277, "cost2_mean": -120.68773332349336, "system_level_velocity_mean": 13.451233243868181, "cost1_max": 410.18584766918025, "cost1_min": 74.08984004880806, "cost2_max": -46.64822596586281, "outflow_rate_mean": 1129.0766023294861, "system_level_velocity_min": 11.309559147991992, "outflow_rate_min": 409.13887132309503, "system_level_velocity_max": 18.102120928279746}, "info": {"num_steps_trained": 10070913, "load_time_ms": 13.361, "grad_time_ms": 9505.971, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012433426454663277, "total_loss": 15.188155174255371, "vf_loss": 15.188502311706543, "policy_loss": -0.003888337407261133, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9472134709358215, "entropy": 1.051996111869812}, "update_time_ms": 8.183, "num_steps_sampled": 10070913, "sample_time_ms": 15158.192}, "episode_len_mean": 682.09, "time_this_iter_s": 25.306541442871094, "num_metric_batches_dropped": 0, "timesteps_total": 10070913, "episodes_total": 3321, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91748>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91fd0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228589, "episode_reward_max": 1327.730071086109, "episodes_this_iter": 16, "time_total_s": 6105.1002604961395, "time_since_restore": 6105.1002604961395}
{"timesteps_since_restore": 10113180, "training_iteration": 226, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-30-14", "episode_reward_min": 51.231485987468204, "timesteps_this_iter": 42267, "episode_reward_mean": 1142.9487597722398, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 226, "custom_metrics": {"outflow_rate_max": 1362.7814725274727, "cost2_min": -172.87348900151665, "cost1_mean": 345.6129169441702, "cost2_mean": -121.59545541027761, "system_level_velocity_mean": 13.485481199114327, "cost1_max": 410.18584766918025, "cost1_min": 28.984101646517743, "cost2_max": -25.933233258062092, "outflow_rate_mean": 1129.8741860855514, "system_level_velocity_min": 11.309559147991992, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.58723154120704}, "info": {"num_steps_trained": 10113180, "load_time_ms": 13.441, "grad_time_ms": 9582.178, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012455616146326065, "total_loss": 13.750142097473145, "vf_loss": 13.752937316894531, "policy_loss": -0.0063422489911317825, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9551498889923096, "entropy": 1.028882384300232}, "update_time_ms": 8.12, "num_steps_sampled": 10113180, "sample_time_ms": 15011.679}, "episode_len_mean": 681.42, "time_this_iter_s": 24.45405673980713, "num_metric_batches_dropped": 0, "timesteps_total": 10113180, "episodes_total": 3337, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7be0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228614, "episode_reward_max": 1327.730071086109, "episodes_this_iter": 16, "time_total_s": 6129.554317235947, "time_since_restore": 6129.554317235947}
{"timesteps_since_restore": 10153863, "training_iteration": 227, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-30-37", "episode_reward_min": 51.231485987468204, "timesteps_this_iter": 40683, "episode_reward_mean": 1147.24731342012, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 227, "custom_metrics": {"outflow_rate_max": 1362.7814725274727, "cost2_min": -168.99666753044966, "cost1_mean": 345.5145674568094, "cost2_mean": -121.12104021382993, "system_level_velocity_mean": 13.602091958926838, "cost1_max": 410.18584766918025, "cost1_min": 28.984101646517743, "cost2_max": -25.933233258062092, "outflow_rate_mean": 1135.0978267624305, "system_level_velocity_min": 11.309559147991992, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.755896092916853}, "info": {"num_steps_trained": 10153863, "load_time_ms": 13.436, "grad_time_ms": 9621.833, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013798002153635025, "total_loss": 20.69369125366211, "vf_loss": 20.69730567932129, "policy_loss": -0.007542102597653866, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9025436043739319, "entropy": 1.0294189453125}, "update_time_ms": 8.179, "num_steps_sampled": 10153863, "sample_time_ms": 14885.983}, "episode_len_mean": 678.04, "time_this_iter_s": 23.70146870613098, "num_metric_batches_dropped": 0, "timesteps_total": 10153863, "episodes_total": 3354, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3c88>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca37f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3ac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228637, "episode_reward_max": 1349.6790692061657, "episodes_this_iter": 17, "time_total_s": 6153.255785942078, "time_since_restore": 6153.255785942078}
{"timesteps_since_restore": 10195216, "training_iteration": 228, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-31-02", "episode_reward_min": 48.770960275926676, "timesteps_this_iter": 41353, "episode_reward_mean": 1153.9028633865134, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 228, "custom_metrics": {"outflow_rate_max": 1362.7814725274727, "cost2_min": -173.96780227315952, "cost1_mean": 346.1724467741195, "cost2_mean": -124.86263924513442, "system_level_velocity_mean": 13.661002148318149, "cost1_max": 410.18584766918025, "cost1_min": 28.984101646517743, "cost2_max": -25.933233258062092, "outflow_rate_mean": 1139.5979150541175, "system_level_velocity_min": 11.07183906627776, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.755896092916853}, "info": {"num_steps_trained": 10195216, "load_time_ms": 13.485, "grad_time_ms": 9708.43, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013493487611413002, "total_loss": 16.625228881835938, "vf_loss": 16.628076553344727, "policy_loss": -0.006689215544611216, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9502901434898376, "entropy": 1.005699872970581}, "update_time_ms": 7.984, "num_steps_sampled": 10195216, "sample_time_ms": 14804.421}, "episode_len_mean": 676.96, "time_this_iter_s": 25.06396508216858, "num_metric_batches_dropped": 0, "timesteps_total": 10195216, "episodes_total": 3374, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7eb8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb76d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228662, "episode_reward_max": 1368.0915479299608, "episodes_this_iter": 20, "time_total_s": 6178.319751024246, "time_since_restore": 6178.319751024246}
{"timesteps_since_restore": 10238079, "training_iteration": 229, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-31-27", "episode_reward_min": 48.770960275926676, "timesteps_this_iter": 42863, "episode_reward_mean": 1158.2130834756308, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 229, "custom_metrics": {"outflow_rate_max": 1362.7814725274727, "cost2_min": -173.96780227315952, "cost1_mean": 348.880548428636, "cost2_mean": -127.48134576197805, "system_level_velocity_mean": 13.762494741533233, "cost1_max": 410.18584766918025, "cost1_min": 28.984101646517743, "cost2_max": -25.933233258062092, "outflow_rate_mean": 1148.9580474257457, "system_level_velocity_min": 11.07183906627776, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.755896092916853}, "info": {"num_steps_trained": 10238079, "load_time_ms": 13.496, "grad_time_ms": 9790.277, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013991564512252808, "total_loss": 6.907678127288818, "vf_loss": 6.909968376159668, "policy_loss": -0.006275145802646875, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9783355593681335, "entropy": 1.0001171827316284}, "update_time_ms": 7.961, "num_steps_sampled": 10238079, "sample_time_ms": 14648.546}, "episode_len_mean": 676.96, "time_this_iter_s": 24.669986248016357, "num_metric_batches_dropped": 0, "timesteps_total": 10238079, "episodes_total": 3386, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb438>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbe80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbf98>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228687, "episode_reward_max": 1368.0915479299608, "episodes_this_iter": 12, "time_total_s": 6202.989737272263, "time_since_restore": 6202.989737272263}
{"timesteps_since_restore": 10281524, "training_iteration": 230, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-31-52", "episode_reward_min": 48.770960275926676, "timesteps_this_iter": 43445, "episode_reward_mean": 1147.9191369345422, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 230, "custom_metrics": {"outflow_rate_max": 1362.7814725274727, "cost2_min": -185.24087718600987, "cost1_mean": 344.2963810201907, "cost2_mean": -130.5343068733081, "system_level_velocity_mean": 13.907208099843645, "cost1_max": 410.18584766918025, "cost1_min": 28.984101646517743, "cost2_max": -25.933233258062092, "outflow_rate_mean": 1139.4510341061762, "system_level_velocity_min": 11.07183906627776, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.755896092916853}, "info": {"num_steps_trained": 10281524, "load_time_ms": 13.438, "grad_time_ms": 9857.279, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013199327513575554, "total_loss": 11.67091178894043, "vf_loss": 11.673786163330078, "policy_loss": -0.006634050980210304, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9646211862564087, "entropy": 0.9902179837226868}, "update_time_ms": 8.088, "num_steps_sampled": 10281524, "sample_time_ms": 14683.85}, "episode_len_mean": 664.93, "time_this_iter_s": 25.346076488494873, "num_metric_batches_dropped": 0, "timesteps_total": 10281524, "episodes_total": 3403, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3b70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228712, "episode_reward_max": 1368.0915479299608, "episodes_this_iter": 17, "time_total_s": 6228.335813760757, "time_since_restore": 6228.335813760757}
{"timesteps_since_restore": 10321907, "training_iteration": 231, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-32-16", "episode_reward_min": 48.770960275926676, "timesteps_this_iter": 40383, "episode_reward_mean": 1155.0987973946735, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 231, "custom_metrics": {"outflow_rate_max": 1342.860923076923, "cost2_min": -198.4307692400715, "cost1_mean": 343.85229721460377, "cost2_mean": -136.80029089495423, "system_level_velocity_mean": 13.821642326860083, "cost1_max": 399.647056748116, "cost1_min": 28.984101646517743, "cost2_max": -25.933233258062092, "outflow_rate_mean": 1138.1185964519564, "system_level_velocity_min": 11.07183906627776, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.755896092916853}, "info": {"num_steps_trained": 10321907, "load_time_ms": 13.377, "grad_time_ms": 9901.597, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013530046679079533, "total_loss": 7.560798168182373, "vf_loss": 7.5639848709106445, "policy_loss": -0.007038850802928209, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9794133305549622, "entropy": 1.0190316438674927}, "update_time_ms": 8.023, "num_steps_sampled": 10321907, "sample_time_ms": 14652.939}, "episode_len_mean": 668.26, "time_this_iter_s": 23.76265859603882, "num_metric_batches_dropped": 0, "timesteps_total": 10321907, "episodes_total": 3420, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3588>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca37f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228736, "episode_reward_max": 1368.0915479299608, "episodes_this_iter": 17, "time_total_s": 6252.098472356796, "time_since_restore": 6252.098472356796}
{"timesteps_since_restore": 10362666, "training_iteration": 232, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-32-41", "episode_reward_min": 48.770960275926676, "timesteps_this_iter": 40759, "episode_reward_mean": 1159.218225049905, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 232, "custom_metrics": {"outflow_rate_max": 1370.6686825174825, "cost2_min": -198.4307692400715, "cost1_mean": 344.25754423796445, "cost2_mean": -139.75213971414007, "system_level_velocity_mean": 13.791219572935654, "cost1_max": 399.647056748116, "cost1_min": 29.14314173103099, "cost2_max": -26.924726751443057, "outflow_rate_mean": 1142.4802828841428, "system_level_velocity_min": 11.07183906627776, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.755896092916853}, "info": {"num_steps_trained": 10362666, "load_time_ms": 13.26, "grad_time_ms": 9887.937, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012931287288665771, "total_loss": 13.647261619567871, "vf_loss": 13.650138854980469, "policy_loss": -0.006560241803526878, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9628458023071289, "entropy": 0.9996391534805298}, "update_time_ms": 7.931, "num_steps_sampled": 10362666, "sample_time_ms": 14667.271}, "episode_len_mean": 669.18, "time_this_iter_s": 24.492721557617188, "num_metric_batches_dropped": 0, "timesteps_total": 10362666, "episodes_total": 3437, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7160>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228761, "episode_reward_max": 1368.0915479299608, "episodes_this_iter": 17, "time_total_s": 6276.591193914413, "time_since_restore": 6276.591193914413}
{"timesteps_since_restore": 10405732, "training_iteration": 233, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-33-07", "episode_reward_min": 48.770960275926676, "timesteps_this_iter": 43066, "episode_reward_mean": 1157.0782623102546, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 233, "custom_metrics": {"outflow_rate_max": 1370.6686825174825, "cost2_min": -198.4307692400715, "cost1_mean": 346.4562118777457, "cost2_mean": -142.87726230292122, "system_level_velocity_mean": 13.76631809370673, "cost1_max": 412.04733028337034, "cost1_min": 29.14314173103099, "cost2_max": -27.574006729858297, "outflow_rate_mean": 1144.02671901447, "system_level_velocity_min": 11.07183906627776, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.57373468372164}, "info": {"num_steps_trained": 10405732, "load_time_ms": 13.205, "grad_time_ms": 9909.751, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01277379784733057, "total_loss": 10.21282958984375, "vf_loss": 10.21465015411377, "policy_loss": -0.005457805935293436, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9639607667922974, "entropy": 1.001824975013733}, "update_time_ms": 7.986, "num_steps_sampled": 10405732, "sample_time_ms": 14770.235}, "episode_len_mean": 672.06, "time_this_iter_s": 25.923715353012085, "num_metric_batches_dropped": 0, "timesteps_total": 10405732, "episodes_total": 3453, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c898>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cf98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c5c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228787, "episode_reward_max": 1368.0915479299608, "episodes_this_iter": 16, "time_total_s": 6302.5149092674255, "time_since_restore": 6302.5149092674255}
{"timesteps_since_restore": 10447654, "training_iteration": 234, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-33-31", "episode_reward_min": 48.770960275926676, "timesteps_this_iter": 41922, "episode_reward_mean": 1152.5688745907066, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 234, "custom_metrics": {"outflow_rate_max": 1370.6686825174825, "cost2_min": -198.4307692400715, "cost1_mean": 345.09642252176417, "cost2_mean": -143.19716297181677, "system_level_velocity_mean": 13.717237539244081, "cost1_max": 412.04733028337034, "cost1_min": 29.14314173103099, "cost2_max": -27.574006729858297, "outflow_rate_mean": 1140.8632605329515, "system_level_velocity_min": 11.07183906627776, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.57373468372164}, "info": {"num_steps_trained": 10447654, "load_time_ms": 13.379, "grad_time_ms": 10011.119, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012334875762462616, "total_loss": 9.139790534973145, "vf_loss": 9.141802787780762, "policy_loss": -0.005524334963411093, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9718502759933472, "entropy": 1.0044888257980347}, "update_time_ms": 7.74, "num_steps_sampled": 10447654, "sample_time_ms": 14621.406}, "episode_len_mean": 672.06, "time_this_iter_s": 24.6789608001709, "num_metric_batches_dropped": 0, "timesteps_total": 10447654, "episodes_total": 3464, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cdd8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cc50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c9b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228811, "episode_reward_max": 1361.3416466172428, "episodes_this_iter": 11, "time_total_s": 6327.193870067596, "time_since_restore": 6327.193870067596}
{"timesteps_since_restore": 10488724, "training_iteration": 235, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-33-57", "episode_reward_min": 60.405510107471734, "timesteps_this_iter": 41070, "episode_reward_mean": 1136.268189892612, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 235, "custom_metrics": {"outflow_rate_max": 1370.6686825174825, "cost2_min": -198.4307692400715, "cost1_mean": 338.3252954097395, "cost2_mean": -141.12668949036052, "system_level_velocity_mean": 13.671424021996952, "cost1_max": 412.04733028337034, "cost1_min": 33.92875991498586, "cost2_max": -30.28785766039135, "outflow_rate_mean": 1121.5427641260458, "system_level_velocity_min": 10.488743414621188, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.824609879163773}, "info": {"num_steps_trained": 10488724, "load_time_ms": 13.334, "grad_time_ms": 10032.797, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014189553447067738, "total_loss": 19.731090545654297, "vf_loss": 19.73379898071289, "policy_loss": -0.006748458836227655, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9451116323471069, "entropy": 1.0205615758895874}, "update_time_ms": 7.56, "num_steps_sampled": 10488724, "sample_time_ms": 14589.499}, "episode_len_mean": 662.73, "time_this_iter_s": 25.20383310317993, "num_metric_batches_dropped": 0, "timesteps_total": 10488724, "episodes_total": 3486, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc912e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91c18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228837, "episode_reward_max": 1361.3416466172428, "episodes_this_iter": 22, "time_total_s": 6352.397703170776, "time_since_restore": 6352.397703170776}
{"timesteps_since_restore": 10530209, "training_iteration": 236, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-34-21", "episode_reward_min": 230.2478445707313, "timesteps_this_iter": 41485, "episode_reward_mean": 1154.4428664563945, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 236, "custom_metrics": {"outflow_rate_max": 1370.6686825174825, "cost2_min": -198.4307692400715, "cost1_mean": 345.74858131592214, "cost2_mean": -139.27326867366838, "system_level_velocity_mean": 13.627929118589632, "cost1_max": 412.04733028337034, "cost1_min": 91.13842216841928, "cost2_max": -53.19956522037151, "outflow_rate_mean": 1138.7014865804802, "system_level_velocity_min": 10.488743414621188, "outflow_rate_min": 496.66560363482773, "system_level_velocity_max": 18.152135429327018}, "info": {"num_steps_trained": 10530209, "load_time_ms": 13.404, "grad_time_ms": 10047.454, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01381826214492321, "total_loss": 16.6119384765625, "vf_loss": 16.61542510986328, "policy_loss": -0.007421412039548159, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9489187598228455, "entropy": 1.016446590423584}, "update_time_ms": 7.868, "num_steps_sampled": 10530209, "sample_time_ms": 14583.684}, "episode_len_mean": 674.76, "time_this_iter_s": 24.55356192588806, "num_metric_batches_dropped": 0, "timesteps_total": 10530209, "episodes_total": 3503, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7c18>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb75f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228861, "episode_reward_max": 1395.2909296846565, "episodes_this_iter": 17, "time_total_s": 6376.951265096664, "time_since_restore": 6376.951265096664}
{"timesteps_since_restore": 10572819, "training_iteration": 237, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-34-46", "episode_reward_min": 54.181139830090764, "timesteps_this_iter": 42610, "episode_reward_mean": 1142.1815705141519, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 237, "custom_metrics": {"outflow_rate_max": 1370.6686825174825, "cost2_min": -197.4097156945594, "cost1_mean": 342.869468389493, "cost2_mean": -137.07731651459372, "system_level_velocity_mean": 13.701563438326062, "cost1_max": 419.70736551184336, "cost1_min": 29.037304144045255, "cost2_max": -26.963615431394523, "outflow_rate_mean": 1127.014683309517, "system_level_velocity_min": 10.488743414621188, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.659170495279614}, "info": {"num_steps_trained": 10572819, "load_time_ms": 13.398, "grad_time_ms": 10113.197, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013465014286339283, "total_loss": 9.577832221984863, "vf_loss": 9.581199645996094, "policy_loss": -0.007201434578746557, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.973751962184906, "entropy": 1.0166985988616943}, "update_time_ms": 8.021, "num_steps_sampled": 10572819, "sample_time_ms": 14647.718}, "episode_len_mean": 668.19, "time_this_iter_s": 24.968045234680176, "num_metric_batches_dropped": 0, "timesteps_total": 10572819, "episodes_total": 3516, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91dd8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0c18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228886, "episode_reward_max": 1395.2909296846565, "episodes_this_iter": 13, "time_total_s": 6401.919310331345, "time_since_restore": 6401.919310331345}
{"timesteps_since_restore": 10615102, "training_iteration": 238, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-35-11", "episode_reward_min": 54.181139830090764, "timesteps_this_iter": 42283, "episode_reward_mean": 1147.8025181110834, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 238, "custom_metrics": {"outflow_rate_max": 1370.6686825174825, "cost2_min": -197.4097156945594, "cost1_mean": 344.6542319431864, "cost2_mean": -137.21930264151982, "system_level_velocity_mean": 13.616723350897727, "cost1_max": 419.70736551184336, "cost1_min": 29.037304144045255, "cost2_max": -26.963615431394523, "outflow_rate_mean": 1132.1787840284132, "system_level_velocity_min": 10.488743414621188, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.659170495279614}, "info": {"num_steps_trained": 10615102, "load_time_ms": 13.35, "grad_time_ms": 10094.464, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012957549653947353, "total_loss": 11.202739715576172, "vf_loss": 11.206039428710938, "policy_loss": -0.006991155445575714, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9601947069168091, "entropy": 1.0358812808990479}, "update_time_ms": 8.0, "num_steps_sampled": 10615102, "sample_time_ms": 14663.962}, "episode_len_mean": 673.84, "time_this_iter_s": 25.02527379989624, "num_metric_batches_dropped": 0, "timesteps_total": 10615102, "episodes_total": 3534, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f0f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fa90>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228911, "episode_reward_max": 1395.2909296846565, "episodes_this_iter": 18, "time_total_s": 6426.944584131241, "time_since_restore": 6426.944584131241}
{"timesteps_since_restore": 10657117, "training_iteration": 239, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-35-36", "episode_reward_min": 54.181139830090764, "timesteps_this_iter": 42015, "episode_reward_mean": 1143.1376814670436, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 239, "custom_metrics": {"outflow_rate_max": 1333.2425722277721, "cost2_min": -185.05457724073165, "cost1_mean": 340.44929289226224, "cost2_mean": -135.51928160376923, "system_level_velocity_mean": 13.57826360791562, "cost1_max": 419.70736551184336, "cost1_min": 29.037304144045255, "cost2_max": -26.963615431394523, "outflow_rate_mean": 1124.584223614979, "system_level_velocity_min": 10.488743414621188, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.659170495279614}, "info": {"num_steps_trained": 10657117, "load_time_ms": 13.423, "grad_time_ms": 10107.443, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016409121453762054, "total_loss": 17.377511978149414, "vf_loss": 17.380535125732422, "policy_loss": -0.0076942965388298035, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9399797320365906, "entropy": 1.0379410982131958}, "update_time_ms": 7.861, "num_steps_sampled": 10657117, "sample_time_ms": 14612.945}, "episode_len_mean": 669.07, "time_this_iter_s": 24.292775869369507, "num_metric_batches_dropped": 0, "timesteps_total": 10657117, "episodes_total": 3547, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0fd0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228936, "episode_reward_max": 1395.2909296846565, "episodes_this_iter": 13, "time_total_s": 6451.23736000061, "time_since_restore": 6451.23736000061}
{"timesteps_since_restore": 10699274, "training_iteration": 240, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-36-00", "episode_reward_min": 54.181139830090764, "timesteps_this_iter": 42157, "episode_reward_mean": 1157.8604673356851, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 240, "custom_metrics": {"outflow_rate_max": 1331.2817174825175, "cost2_min": -185.05457724073165, "cost1_mean": 344.303806670916, "cost2_mean": -136.44303743407391, "system_level_velocity_mean": 13.616748646523696, "cost1_max": 419.70736551184336, "cost1_min": 29.037304144045255, "cost2_max": -26.963615431394523, "outflow_rate_mean": 1137.431775683421, "system_level_velocity_min": 10.488743414621188, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.659170495279614}, "info": {"num_steps_trained": 10699274, "load_time_ms": 13.403, "grad_time_ms": 10129.918, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013448418118059635, "total_loss": 16.65803337097168, "vf_loss": 16.66044044494629, "policy_loss": -0.006235987413674593, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9387626051902771, "entropy": 1.0415056943893433}, "update_time_ms": 7.677, "num_steps_sampled": 10699274, "sample_time_ms": 14516.396}, "episode_len_mean": 673.38, "time_this_iter_s": 24.610477447509766, "num_metric_batches_dropped": 0, "timesteps_total": 10699274, "episodes_total": 3565, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3128>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb32e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228960, "episode_reward_max": 1395.2909296846565, "episodes_this_iter": 18, "time_total_s": 6475.84783744812, "time_since_restore": 6475.84783744812}
{"timesteps_since_restore": 10740955, "training_iteration": 241, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-36-24", "episode_reward_min": 54.181139830090764, "timesteps_this_iter": 41681, "episode_reward_mean": 1169.8848795676392, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 241, "custom_metrics": {"outflow_rate_max": 1331.2817174825175, "cost2_min": -195.29143971632772, "cost1_mean": 348.6722364311698, "cost2_mean": -138.35679256898268, "system_level_velocity_mean": 13.632322668594234, "cost1_max": 419.70736551184336, "cost1_min": 29.037304144045255, "cost2_max": -26.963615431394523, "outflow_rate_mean": 1150.8034354581962, "system_level_velocity_min": 11.001651993942392, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.659170495279614}, "info": {"num_steps_trained": 10740955, "load_time_ms": 13.514, "grad_time_ms": 10219.353, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014689733274281025, "total_loss": 11.196630477905273, "vf_loss": 11.20028305053711, "policy_loss": -0.007836752571165562, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9674612879753113, "entropy": 1.022105097770691}, "update_time_ms": 7.567, "num_steps_sampled": 10740955, "sample_time_ms": 14453.931}, "episode_len_mean": 678.85, "time_this_iter_s": 24.04625701904297, "num_metric_batches_dropped": 0, "timesteps_total": 10740955, "episodes_total": 3582, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb75f8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb74e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7080>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557228984, "episode_reward_max": 1395.2909296846565, "episodes_this_iter": 17, "time_total_s": 6499.894094467163, "time_since_restore": 6499.894094467163}
{"timesteps_since_restore": 10782146, "training_iteration": 242, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-36-48", "episode_reward_min": 54.181139830090764, "timesteps_this_iter": 41191, "episode_reward_mean": 1168.3048466072892, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 242, "custom_metrics": {"outflow_rate_max": 1331.2817174825175, "cost2_min": -195.29143971632772, "cost1_mean": 347.96603295661765, "cost2_mean": -140.0425376712091, "system_level_velocity_mean": 13.67165147478642, "cost1_max": 419.70736551184336, "cost1_min": 28.911718858088072, "cost2_max": -26.39465909458133, "outflow_rate_mean": 1147.6856468778883, "system_level_velocity_min": 11.001651993942392, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.659170495279614}, "info": {"num_steps_trained": 10782146, "load_time_ms": 13.494, "grad_time_ms": 10256.566, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01417643390595913, "total_loss": 12.879852294921875, "vf_loss": 12.883390426635742, "policy_loss": -0.0075747352093458176, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9602020382881165, "entropy": 1.030889868736267}, "update_time_ms": 7.786, "num_steps_sampled": 10782146, "sample_time_ms": 14373.252}, "episode_len_mean": 677.14, "time_this_iter_s": 24.08228898048401, "num_metric_batches_dropped": 0, "timesteps_total": 10782146, "episodes_total": 3597, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f160>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fda0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229008, "episode_reward_max": 1395.2909296846565, "episodes_this_iter": 15, "time_total_s": 6523.976383447647, "time_since_restore": 6523.976383447647}
{"timesteps_since_restore": 10823884, "training_iteration": 243, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-37-13", "episode_reward_min": 54.73800754159094, "timesteps_this_iter": 41738, "episode_reward_mean": 1173.4407882516828, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 243, "custom_metrics": {"outflow_rate_max": 1343.4899568431567, "cost2_min": -195.29143971632772, "cost1_mean": 350.6629231514146, "cost2_mean": -141.36721850300503, "system_level_velocity_mean": 13.635596134903338, "cost1_max": 400.98414151979006, "cost1_min": 28.911718858088072, "cost2_max": -26.39465909458133, "outflow_rate_mean": 1158.416612344915, "system_level_velocity_min": 11.001651993942392, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.43564965363506}, "info": {"num_steps_trained": 10823884, "load_time_ms": 13.464, "grad_time_ms": 10260.62, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012652960605919361, "total_loss": 11.605735778808594, "vf_loss": 11.6088285446167, "policy_loss": -0.006695575546473265, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9663743376731873, "entropy": 1.0298608541488647}, "update_time_ms": 7.841, "num_steps_sampled": 10823884, "sample_time_ms": 14261.609}, "episode_len_mean": 681.93, "time_this_iter_s": 24.856380939483643, "num_metric_batches_dropped": 0, "timesteps_total": 10823884, "episodes_total": 3617, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fbe0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4feb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229033, "episode_reward_max": 1354.8613681570923, "episodes_this_iter": 20, "time_total_s": 6548.832764387131, "time_since_restore": 6548.832764387131}
{"timesteps_since_restore": 10865174, "training_iteration": 244, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-37-38", "episode_reward_min": 54.73800754159094, "timesteps_this_iter": 41290, "episode_reward_mean": 1156.6033261568512, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 244, "custom_metrics": {"outflow_rate_max": 1343.4899568431567, "cost2_min": -195.29143971632772, "cost1_mean": 345.6787191319972, "cost2_mean": -138.77572497057145, "system_level_velocity_mean": 13.75884176799653, "cost1_max": 400.98414151979006, "cost1_min": 28.911718858088072, "cost2_max": -26.39465909458133, "outflow_rate_mean": 1149.7416255669816, "system_level_velocity_min": 11.001651993942392, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.43564965363506}, "info": {"num_steps_trained": 10865174, "load_time_ms": 13.371, "grad_time_ms": 10275.076, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014840682968497276, "total_loss": 13.761503219604492, "vf_loss": 13.765445709228516, "policy_loss": -0.008170190267264843, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9534889459609985, "entropy": 1.056560754776001}, "update_time_ms": 8.102, "num_steps_sampled": 10865174, "sample_time_ms": 14241.721}, "episode_len_mean": 669.4, "time_this_iter_s": 24.640196084976196, "num_metric_batches_dropped": 0, "timesteps_total": 10865174, "episodes_total": 3629, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb208>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229058, "episode_reward_max": 1354.8613681570923, "episodes_this_iter": 12, "time_total_s": 6573.472960472107, "time_since_restore": 6573.472960472107}
{"timesteps_since_restore": 10906017, "training_iteration": 245, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-38-01", "episode_reward_min": 54.73800754159094, "timesteps_this_iter": 40843, "episode_reward_mean": 1162.241991581489, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 245, "custom_metrics": {"outflow_rate_max": 1346.9570565434565, "cost2_min": -195.29143971632772, "cost1_mean": 350.1875196801704, "cost2_mean": -137.04992683264453, "system_level_velocity_mean": 13.820736440631885, "cost1_max": 401.8087281697217, "cost1_min": 28.911718858088072, "cost2_max": -26.39465909458133, "outflow_rate_mean": 1160.75544810629, "system_level_velocity_min": 11.001651993942392, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.43564965363506}, "info": {"num_steps_trained": 10906017, "load_time_ms": 13.299, "grad_time_ms": 10306.16, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014911933802068233, "total_loss": 16.838027954101562, "vf_loss": 16.841629028320312, "policy_loss": -0.007845915853977203, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.93145751953125, "entropy": 1.092610478401184}, "update_time_ms": 8.384, "num_steps_sampled": 10906017, "sample_time_ms": 14033.394}, "episode_len_mean": 674.17, "time_this_iter_s": 23.442305326461792, "num_metric_batches_dropped": 0, "timesteps_total": 10906017, "episodes_total": 3646, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c550>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ce80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c6a0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229081, "episode_reward_max": 1354.8613681570923, "episodes_this_iter": 17, "time_total_s": 6596.915265798569, "time_since_restore": 6596.915265798569}
{"timesteps_since_restore": 10946093, "training_iteration": 246, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-38-26", "episode_reward_min": 54.73800754159094, "timesteps_this_iter": 40076, "episode_reward_mean": 1165.1983195343576, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 246, "custom_metrics": {"outflow_rate_max": 1346.9570565434565, "cost2_min": -195.29143971632772, "cost1_mean": 352.14366261542193, "cost2_mean": -133.59935533104542, "system_level_velocity_mean": 13.781474848900983, "cost1_max": 404.1714953865219, "cost1_min": 28.911718858088072, "cost2_max": -26.39465909458133, "outflow_rate_mean": 1161.2463120113025, "system_level_velocity_min": 11.450311425716482, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.43564965363506}, "info": {"num_steps_trained": 10946093, "load_time_ms": 13.29, "grad_time_ms": 10314.525, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01255456916987896, "total_loss": 18.942596435546875, "vf_loss": 18.945219039916992, "policy_loss": -0.006199047435075045, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9298147559165955, "entropy": 1.0955326557159424}, "update_time_ms": 8.211, "num_steps_sampled": 10946093, "sample_time_ms": 13977.292}, "episode_len_mean": 679.12, "time_this_iter_s": 24.072356939315796, "num_metric_batches_dropped": 0, "timesteps_total": 10946093, "episodes_total": 3664, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fe48>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fda0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229106, "episode_reward_max": 1346.5961540970252, "episodes_this_iter": 18, "time_total_s": 6620.9876227378845, "time_since_restore": 6620.9876227378845}
{"timesteps_since_restore": 10986278, "training_iteration": 247, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-38-51", "episode_reward_min": 54.73800754159094, "timesteps_this_iter": 40185, "episode_reward_mean": 1150.5440891171447, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 247, "custom_metrics": {"outflow_rate_max": 1351.2865782217784, "cost2_min": -191.47477382290805, "cost1_mean": 349.58059468812206, "cost2_mean": -128.15502008203234, "system_level_velocity_mean": 13.815065436578616, "cost1_max": 404.1714953865219, "cost1_min": 28.911718858088072, "cost2_max": -26.39465909458133, "outflow_rate_mean": 1159.3677607367151, "system_level_velocity_min": 11.848579090153235, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.43564965363506}, "info": {"num_steps_trained": 10986278, "load_time_ms": 12.843, "grad_time_ms": 10371.427, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014319401234388351, "total_loss": 26.01624870300293, "vf_loss": 26.019168853759766, "policy_loss": -0.006997864227741957, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.8807923793792725, "entropy": 1.1275267601013184}, "update_time_ms": 8.294, "num_steps_sampled": 10986278, "sample_time_ms": 13910.76}, "episode_len_mean": 674.28, "time_this_iter_s": 24.885735273361206, "num_metric_batches_dropped": 0, "timesteps_total": 10986278, "episodes_total": 3681, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f898>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ce10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cc18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229131, "episode_reward_max": 1330.9340995060072, "episodes_this_iter": 17, "time_total_s": 6645.873358011246, "time_since_restore": 6645.873358011246}
{"timesteps_since_restore": 11026332, "training_iteration": 248, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-39-17", "episode_reward_min": 48.76272525403941, "timesteps_this_iter": 40054, "episode_reward_mean": 1121.5654412668314, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 248, "custom_metrics": {"outflow_rate_max": 1351.2865782217784, "cost2_min": -191.47477382290805, "cost1_mean": 342.52282401054725, "cost2_mean": -119.88172805024413, "system_level_velocity_mean": 13.854795182439231, "cost1_max": 404.1714953865219, "cost1_min": 29.224329142724375, "cost2_max": -27.816452591270462, "outflow_rate_mean": 1142.9456607399284, "system_level_velocity_min": 11.848579090153235, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.72466071584985}, "info": {"num_steps_trained": 11026332, "load_time_ms": 12.704, "grad_time_ms": 10363.642, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013976827263832092, "total_loss": 27.697065353393555, "vf_loss": 27.70219612121582, "policy_loss": -0.00911287683993578, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.8945095539093018, "entropy": 1.1633895635604858}, "update_time_ms": 8.653, "num_steps_sampled": 11026332, "sample_time_ms": 14041.729}, "episode_len_mean": 662.93, "time_this_iter_s": 26.288314819335938, "num_metric_batches_dropped": 0, "timesteps_total": 11026332, "episodes_total": 3701, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0cc0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb03c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb02b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229157, "episode_reward_max": 1326.9822348244952, "episodes_this_iter": 20, "time_total_s": 6672.161672830582, "time_since_restore": 6672.161672830582}
{"timesteps_since_restore": 11067576, "training_iteration": 249, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-39-41", "episode_reward_min": 48.76272525403941, "timesteps_this_iter": 41244, "episode_reward_mean": 1116.6574099481033, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 249, "custom_metrics": {"outflow_rate_max": 1351.2865782217784, "cost2_min": -172.0850682512616, "cost1_mean": 341.6422248134639, "cost2_mean": -114.08277794426897, "system_level_velocity_mean": 13.831636194442037, "cost1_max": 404.1714953865219, "cost1_min": 29.224329142724375, "cost2_max": -27.816452591270462, "outflow_rate_mean": 1138.9116540466214, "system_level_velocity_min": 11.296553755312507, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.72466071584985}, "info": {"num_steps_trained": 11067576, "load_time_ms": 12.574, "grad_time_ms": 10308.412, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013294626958668232, "total_loss": 14.867960929870605, "vf_loss": 14.871685028076172, "policy_loss": -0.007509634364396334, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9334345459938049, "entropy": 1.1384795904159546}, "update_time_ms": 8.912, "num_steps_sampled": 11067576, "sample_time_ms": 14092.713}, "episode_len_mean": 662.93, "time_this_iter_s": 24.24689507484436, "num_metric_batches_dropped": 0, "timesteps_total": 11067576, "episodes_total": 3714, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c358>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c828>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229181, "episode_reward_max": 1326.9822348244952, "episodes_this_iter": 13, "time_total_s": 6696.408567905426, "time_since_restore": 6696.408567905426}
{"timesteps_since_restore": 11107766, "training_iteration": 250, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-40-05", "episode_reward_min": 48.76272525403941, "timesteps_this_iter": 40190, "episode_reward_mean": 1133.2308878915892, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 250, "custom_metrics": {"outflow_rate_max": 1351.2865782217784, "cost2_min": -172.0850682512616, "cost1_mean": 346.69210095489166, "cost2_mean": -110.80926557028914, "system_level_velocity_mean": 13.66942662292358, "cost1_max": 404.1714953865219, "cost1_min": 29.224329142724375, "cost2_max": -27.816452591270462, "outflow_rate_mean": 1148.320901054066, "system_level_velocity_min": 11.296553755312507, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.72466071584985}, "info": {"num_steps_trained": 11107766, "load_time_ms": 12.362, "grad_time_ms": 10232.409, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014935817569494247, "total_loss": 24.761018753051758, "vf_loss": 24.766403198242188, "policy_loss": -0.009639197960495949, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.8740715980529785, "entropy": 1.1662856340408325}, "update_time_ms": 9.17, "num_steps_sampled": 11107766, "sample_time_ms": 14121.733}, "episode_len_mean": 677.24, "time_this_iter_s": 24.13288378715515, "num_metric_batches_dropped": 0, "timesteps_total": 11107766, "episodes_total": 3731, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f3c8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f7b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229205, "episode_reward_max": 1295.8013233633587, "episodes_this_iter": 17, "time_total_s": 6720.541451692581, "time_since_restore": 6720.541451692581}
{"timesteps_since_restore": 11149146, "training_iteration": 251, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-40-30", "episode_reward_min": 48.76272525403941, "timesteps_this_iter": 41380, "episode_reward_mean": 1125.1459268260855, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 251, "custom_metrics": {"outflow_rate_max": 1351.2865782217784, "cost2_min": -160.89869191434133, "cost1_mean": 345.41557990849367, "cost2_mean": -106.71433881633499, "system_level_velocity_mean": 13.617022539950181, "cost1_max": 404.1714953865219, "cost1_min": 29.224329142724375, "cost2_max": -27.816452591270462, "outflow_rate_mean": 1141.8902316274928, "system_level_velocity_min": 11.296553755312507, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.72466071584985}, "info": {"num_steps_trained": 11149146, "load_time_ms": 12.277, "grad_time_ms": 10195.505, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014853976666927338, "total_loss": 19.880294799804688, "vf_loss": 19.884185791015625, "policy_loss": -0.008120741695165634, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9225670099258423, "entropy": 1.1726561784744263}, "update_time_ms": 9.437, "num_steps_sampled": 11149146, "sample_time_ms": 14207.442}, "episode_len_mean": 677.24, "time_this_iter_s": 24.531972885131836, "num_metric_batches_dropped": 0, "timesteps_total": 11149146, "episodes_total": 3748, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0908>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3710>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229230, "episode_reward_max": 1304.5896430928863, "episodes_this_iter": 17, "time_total_s": 6745.073424577713, "time_since_restore": 6745.073424577713}
{"timesteps_since_restore": 11189779, "training_iteration": 252, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-40-54", "episode_reward_min": 48.76272525403941, "timesteps_this_iter": 40633, "episode_reward_mean": 1111.5731733565308, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 252, "custom_metrics": {"outflow_rate_max": 1351.2865782217784, "cost2_min": -148.4882429839779, "cost1_mean": 340.08493353605445, "cost2_mean": -103.93590986223938, "system_level_velocity_mean": 13.502236669960999, "cost1_max": 393.0668206866588, "cost1_min": 29.224329142724375, "cost2_max": -27.816452591270462, "outflow_rate_mean": 1130.0204925338298, "system_level_velocity_min": 10.413824113234808, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.72466071584985}, "info": {"num_steps_trained": 11189779, "load_time_ms": 12.249, "grad_time_ms": 10137.131, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01370592787861824, "total_loss": 18.86097526550293, "vf_loss": 18.86711311340332, "policy_loss": -0.010040703229606152, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9294959306716919, "entropy": 1.1607258319854736}, "update_time_ms": 9.542, "num_steps_sampled": 11189779, "sample_time_ms": 14303.299}, "episode_len_mean": 673.07, "time_this_iter_s": 24.46457600593567, "num_metric_batches_dropped": 0, "timesteps_total": 11189779, "episodes_total": 3765, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0358>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0240>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229254, "episode_reward_max": 1304.5896430928863, "episodes_this_iter": 17, "time_total_s": 6769.538000583649, "time_since_restore": 6769.538000583649}
{"timesteps_since_restore": 11230599, "training_iteration": 253, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-41-18", "episode_reward_min": 48.76272525403941, "timesteps_this_iter": 40820, "episode_reward_mean": 1112.593242807588, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 253, "custom_metrics": {"outflow_rate_max": 1309.52974025974, "cost2_min": -141.77025221344383, "cost1_mean": 338.42477804977267, "cost2_mean": -103.18079540862873, "system_level_velocity_mean": 13.455592291252694, "cost1_max": 389.8254331297603, "cost1_min": 29.224329142724375, "cost2_max": -27.816452591270462, "outflow_rate_mean": 1120.2072281481128, "system_level_velocity_min": 10.413824113234808, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.72466071584985}, "info": {"num_steps_trained": 11230599, "load_time_ms": 12.427, "grad_time_ms": 10076.959, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016093052923679352, "total_loss": 22.70858383178711, "vf_loss": 22.7135009765625, "policy_loss": -0.009501422755420208, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9028947949409485, "entropy": 1.170181155204773}, "update_time_ms": 9.522, "num_steps_sampled": 11230599, "sample_time_ms": 14276.81}, "episode_len_mean": 672.02, "time_this_iter_s": 23.996731996536255, "num_metric_batches_dropped": 0, "timesteps_total": 11230599, "episodes_total": 3783, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca37f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3b70>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229278, "episode_reward_max": 1304.5896430928863, "episodes_this_iter": 18, "time_total_s": 6793.534732580185, "time_since_restore": 6793.534732580185}
{"timesteps_since_restore": 11272189, "training_iteration": 254, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-41-43", "episode_reward_min": 182.86431222330737, "timesteps_this_iter": 41590, "episode_reward_mean": 1136.1896025740077, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 254, "custom_metrics": {"outflow_rate_max": 1309.52974025974, "cost2_min": -141.77025221344383, "cost1_mean": 344.11460178231516, "cost2_mean": -104.16511247061493, "system_level_velocity_mean": 13.333350003342687, "cost1_max": 390.8715365496843, "cost1_min": 73.93680691343697, "cost2_max": -43.233145534102064, "outflow_rate_mean": 1136.282071040342, "system_level_velocity_min": 10.413824113234808, "outflow_rate_min": 426.9378825278412, "system_level_velocity_max": 17.829890192492226}, "info": {"num_steps_trained": 11272189, "load_time_ms": 12.355, "grad_time_ms": 9959.348, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012619725428521633, "total_loss": 21.27647590637207, "vf_loss": 21.280128479003906, "policy_loss": -0.007245974149554968, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.8910520672798157, "entropy": 1.1447930335998535}, "update_time_ms": 9.528, "num_steps_sampled": 11272189, "sample_time_ms": 14367.419}, "episode_len_mean": 684.09, "time_this_iter_s": 24.345583200454712, "num_metric_batches_dropped": 0, "timesteps_total": 11272189, "episodes_total": 3796, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c208>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cc18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229303, "episode_reward_max": 1304.5896430928863, "episodes_this_iter": 13, "time_total_s": 6817.88031578064, "time_since_restore": 6817.88031578064}
{"timesteps_since_restore": 11313951, "training_iteration": 255, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-42-07", "episode_reward_min": 182.86431222330737, "timesteps_this_iter": 41762, "episode_reward_mean": 1137.471561363678, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 255, "custom_metrics": {"outflow_rate_max": 1309.52974025974, "cost2_min": -141.77025221344383, "cost1_mean": 343.88082278741547, "cost2_mean": -103.6824962931155, "system_level_velocity_mean": 13.312726323760703, "cost1_max": 397.67282136897495, "cost1_min": 73.93680691343697, "cost2_max": -43.233145534102064, "outflow_rate_mean": 1134.1466782611215, "system_level_velocity_min": 10.413824113234808, "outflow_rate_min": 426.9378825278412, "system_level_velocity_max": 17.829890192492226}, "info": {"num_steps_trained": 11313951, "load_time_ms": 12.375, "grad_time_ms": 9910.762, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014507460407912731, "total_loss": 20.525915145874023, "vf_loss": 20.53042221069336, "policy_loss": -0.008638248778879642, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9321697354316711, "entropy": 1.1594979763031006}, "update_time_ms": 9.543, "num_steps_sampled": 11313951, "sample_time_ms": 14470.111}, "episode_len_mean": 684.09, "time_this_iter_s": 23.972564697265625, "num_metric_batches_dropped": 0, "timesteps_total": 11313951, "episodes_total": 3814, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc913c8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91c88>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229327, "episode_reward_max": 1304.5896430928863, "episodes_this_iter": 18, "time_total_s": 6841.852880477905, "time_since_restore": 6841.852880477905}
{"timesteps_since_restore": 11353140, "training_iteration": 256, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-42-30", "episode_reward_min": 49.03557397209465, "timesteps_this_iter": 39189, "episode_reward_mean": 1107.6786828171257, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 256, "custom_metrics": {"outflow_rate_max": 1290.3459356643357, "cost2_min": -162.86462185487514, "cost1_mean": 336.1636124258956, "cost2_mean": -101.97407487226914, "system_level_velocity_mean": 13.482879406271863, "cost1_max": 397.67282136897495, "cost1_min": 27.853136315374275, "cost2_max": -21.132250021198693, "outflow_rate_mean": 1113.2885592351613, "system_level_velocity_min": 10.413824113234808, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.633752080890176}, "info": {"num_steps_trained": 11353140, "load_time_ms": 12.221, "grad_time_ms": 9778.134, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01219848170876503, "total_loss": 28.42880630493164, "vf_loss": 28.43256950378418, "policy_loss": -0.007236228324472904, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.888983428478241, "entropy": 1.1725900173187256}, "update_time_ms": 9.727, "num_steps_sampled": 11353140, "sample_time_ms": 14549.873}, "episode_len_mean": 666.84, "time_this_iter_s": 23.541329860687256, "num_metric_batches_dropped": 0, "timesteps_total": 11353140, "episodes_total": 3834, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb03c8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0e80>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229350, "episode_reward_max": 1304.5896430928863, "episodes_this_iter": 20, "time_total_s": 6865.3942103385925, "time_since_restore": 6865.3942103385925}
{"timesteps_since_restore": 11392598, "training_iteration": 257, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-42-54", "episode_reward_min": 49.03557397209465, "timesteps_this_iter": 39458, "episode_reward_mean": 1104.5908871594047, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 257, "custom_metrics": {"outflow_rate_max": 1297.2278037962037, "cost2_min": -162.86462185487514, "cost1_mean": 335.20415067007707, "cost2_mean": -99.61708633757775, "system_level_velocity_mean": 13.455817571880745, "cost1_max": 397.67282136897495, "cost1_min": 27.853136315374275, "cost2_max": -21.132250021198693, "outflow_rate_mean": 1111.098824797599, "system_level_velocity_min": 10.413824113234808, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.633752080890176}, "info": {"num_steps_trained": 11392598, "load_time_ms": 12.585, "grad_time_ms": 9586.148, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015120347961783409, "total_loss": 32.1921501159668, "vf_loss": 32.19712448120117, "policy_loss": -0.00927518680691719, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.8340138792991638, "entropy": 1.1750566959381104}, "update_time_ms": 9.456, "num_steps_sampled": 11392598, "sample_time_ms": 14611.476}, "episode_len_mean": 666.84, "time_this_iter_s": 23.566022634506226, "num_metric_batches_dropped": 0, "timesteps_total": 11392598, "episodes_total": 3852, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb71d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7240>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229374, "episode_reward_max": 1279.3349715489862, "episodes_this_iter": 18, "time_total_s": 6888.960232973099, "time_since_restore": 6888.960232973099}
{"timesteps_since_restore": 11433729, "training_iteration": 258, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-43-19", "episode_reward_min": 49.03557397209465, "timesteps_this_iter": 41131, "episode_reward_mean": 1112.5107559046917, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 258, "custom_metrics": {"outflow_rate_max": 1297.2278037962037, "cost2_min": -162.86462185487514, "cost1_mean": 339.0061025657771, "cost2_mean": -98.5438216917284, "system_level_velocity_mean": 13.508784083025954, "cost1_max": 397.67282136897495, "cost1_min": 27.853136315374275, "cost2_max": -21.132250021198693, "outflow_rate_mean": 1123.8431443348186, "system_level_velocity_min": 10.94988306906405, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.633752080890176}, "info": {"num_steps_trained": 11433729, "load_time_ms": 12.739, "grad_time_ms": 9554.264, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014765809290111065, "total_loss": 25.291152954101562, "vf_loss": 25.29622459411621, "policy_loss": -0.00927669182419777, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.8513216972351074, "entropy": 1.153639793395996}, "update_time_ms": 9.403, "num_steps_sampled": 11433729, "sample_time_ms": 14543.514}, "episode_len_mean": 671.01, "time_this_iter_s": 25.29440951347351, "num_metric_batches_dropped": 0, "timesteps_total": 11433729, "episodes_total": 3870, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cef0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229399, "episode_reward_max": 1279.3349715489862, "episodes_this_iter": 18, "time_total_s": 6914.254642486572, "time_since_restore": 6914.254642486572}
{"timesteps_since_restore": 11475731, "training_iteration": 259, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-43-44", "episode_reward_min": 49.03557397209465, "timesteps_this_iter": 42002, "episode_reward_mean": 1119.3220499271029, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 259, "custom_metrics": {"outflow_rate_max": 1297.2278037962037, "cost2_min": -162.86462185487514, "cost1_mean": 341.50404715132805, "cost2_mean": -99.18433920068802, "system_level_velocity_mean": 13.45574043577587, "cost1_max": 397.67282136897495, "cost1_min": 27.853136315374275, "cost2_max": -21.132250021198693, "outflow_rate_mean": 1130.625192286831, "system_level_velocity_min": 10.94988306906405, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.633752080890176}, "info": {"num_steps_trained": 11475731, "load_time_ms": 12.818, "grad_time_ms": 9571.395, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015922512859106064, "total_loss": 13.627334594726562, "vf_loss": 13.631481170654297, "policy_loss": -0.008680091239511967, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9400035738945007, "entropy": 1.1343811750411987}, "update_time_ms": 9.367, "num_steps_sampled": 11475731, "sample_time_ms": 14533.062}, "episode_len_mean": 676.9, "time_this_iter_s": 24.325527906417847, "num_metric_batches_dropped": 0, "timesteps_total": 11475731, "episodes_total": 3879, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb278>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229424, "episode_reward_max": 1279.3349715489862, "episodes_this_iter": 9, "time_total_s": 6938.58017039299, "time_since_restore": 6938.58017039299}
{"timesteps_since_restore": 11516888, "training_iteration": 260, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-44-09", "episode_reward_min": 49.03557397209465, "timesteps_this_iter": 41157, "episode_reward_mean": 1131.0924642034327, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 260, "custom_metrics": {"outflow_rate_max": 1297.2278037962037, "cost2_min": -162.86462185487514, "cost1_mean": 342.5249923068604, "cost2_mean": -101.24244602230276, "system_level_velocity_mean": 13.338146921196687, "cost1_max": 397.67282136897495, "cost1_min": 27.853136315374275, "cost2_max": -21.132250021198693, "outflow_rate_mean": 1132.1480966503636, "system_level_velocity_min": 10.94988306906405, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.633752080890176}, "info": {"num_steps_trained": 11516888, "load_time_ms": 12.718, "grad_time_ms": 9600.207, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013421732932329178, "total_loss": 19.377634048461914, "vf_loss": 19.38260269165039, "policy_loss": -0.008790217339992523, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9162909388542175, "entropy": 1.1689502000808716}, "update_time_ms": 9.471, "num_steps_sampled": 11516888, "sample_time_ms": 14613.873}, "episode_len_mean": 682.75, "time_this_iter_s": 25.232667207717896, "num_metric_batches_dropped": 0, "timesteps_total": 11516888, "episodes_total": 3896, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbe48>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91a90>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229449, "episode_reward_max": 1284.9176704312958, "episodes_this_iter": 17, "time_total_s": 6963.812837600708, "time_since_restore": 6963.812837600708}
{"timesteps_since_restore": 11558423, "training_iteration": 261, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-44-36", "episode_reward_min": 49.03557397209465, "timesteps_this_iter": 41535, "episode_reward_mean": 1123.0219227998487, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 261, "custom_metrics": {"outflow_rate_max": 1297.2278037962037, "cost2_min": -162.86462185487514, "cost1_mean": 338.74706334458574, "cost2_mean": -101.83322413814896, "system_level_velocity_mean": 13.33891357848016, "cost1_max": 391.0397715139312, "cost1_min": 27.853136315374275, "cost2_max": -21.132250021198693, "outflow_rate_mean": 1124.5819991151288, "system_level_velocity_min": 10.94988306906405, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.633752080890176}, "info": {"num_steps_trained": 11558423, "load_time_ms": 12.691, "grad_time_ms": 9582.542, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013792113400995731, "total_loss": 22.821115493774414, "vf_loss": 22.826780319213867, "policy_loss": -0.009592229500412941, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9163786172866821, "entropy": 1.1678144931793213}, "update_time_ms": 9.491, "num_steps_sampled": 11558423, "sample_time_ms": 14865.221}, "episode_len_mean": 676.79, "time_this_iter_s": 26.893805265426636, "num_metric_batches_dropped": 0, "timesteps_total": 11558423, "episodes_total": 3915, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91c88>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229476, "episode_reward_max": 1284.9176704312958, "episodes_this_iter": 19, "time_total_s": 6990.706642866135, "time_since_restore": 6990.706642866135}
{"timesteps_since_restore": 11600284, "training_iteration": 262, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-45-01", "episode_reward_min": 172.00942192085824, "timesteps_this_iter": 41861, "episode_reward_mean": 1162.5179075961016, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 262, "custom_metrics": {"outflow_rate_max": 1297.2278037962037, "cost2_min": -171.80944428448566, "cost1_mean": 346.2425366353252, "cost2_mean": -108.14656632342593, "system_level_velocity_mean": 13.15057385938501, "cost1_max": 391.0397715139312, "cost1_min": 69.27943917975495, "cost2_max": -46.053048904913055, "outflow_rate_mean": 1144.6650056735568, "system_level_velocity_min": 11.075079720478357, "outflow_rate_min": 443.4793893336706, "system_level_velocity_max": 18.200405485081532}, "info": {"num_steps_trained": 11600284, "load_time_ms": 12.754, "grad_time_ms": 9607.824, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01418350636959076, "total_loss": 18.32246971130371, "vf_loss": 18.328136444091797, "policy_loss": -0.009706095792353153, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9341850876808167, "entropy": 1.1377922296524048}, "update_time_ms": 9.53, "num_steps_sampled": 11600284, "sample_time_ms": 14932.234}, "episode_len_mean": 694.04, "time_this_iter_s": 25.387826919555664, "num_metric_batches_dropped": 0, "timesteps_total": 11600284, "episodes_total": 3932, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c3c8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c240>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229501, "episode_reward_max": 1285.152896710745, "episodes_this_iter": 17, "time_total_s": 7016.09446978569, "time_since_restore": 7016.09446978569}
{"timesteps_since_restore": 11643101, "training_iteration": 263, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-45-27", "episode_reward_min": 172.00942192085824, "timesteps_this_iter": 42817, "episode_reward_mean": 1168.9437541725335, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 263, "custom_metrics": {"outflow_rate_max": 1285.6056567432568, "cost2_min": -171.80944428448566, "cost1_mean": 346.11179936600746, "cost2_mean": -115.41330257345686, "system_level_velocity_mean": 13.123652489744845, "cost1_max": 391.0397715139312, "cost1_min": 69.27943917975495, "cost2_max": -46.053048904913055, "outflow_rate_mean": 1144.143858077153, "system_level_velocity_min": 11.075079720478357, "outflow_rate_min": 443.4793893336706, "system_level_velocity_max": 18.200405485081532}, "info": {"num_steps_trained": 11643101, "load_time_ms": 12.521, "grad_time_ms": 9579.133, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013971594162285328, "total_loss": 17.533920288085938, "vf_loss": 17.539154052734375, "policy_loss": -0.009210155345499516, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9351967573165894, "entropy": 1.1360154151916504}, "update_time_ms": 9.325, "num_steps_sampled": 11643101, "sample_time_ms": 15108.625}, "episode_len_mean": 694.04, "time_this_iter_s": 25.45740294456482, "num_metric_batches_dropped": 0, "timesteps_total": 11643101, "episodes_total": 3949, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f828>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f7f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229527, "episode_reward_max": 1301.129663074834, "episodes_this_iter": 17, "time_total_s": 7041.551872730255, "time_since_restore": 7041.551872730255}
{"timesteps_since_restore": 11685922, "training_iteration": 264, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-45-51", "episode_reward_min": 33.45102496013871, "timesteps_this_iter": 42821, "episode_reward_mean": 1140.887628525782, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 264, "custom_metrics": {"outflow_rate_max": 1306.1302581418581, "cost2_min": -171.80944428448566, "cost1_mean": 336.0119131731206, "cost2_mean": -115.63417425621408, "system_level_velocity_mean": 13.286540163418254, "cost1_max": 427.9247325300122, "cost1_min": 18.010986744628468, "cost2_max": -17.53842535821078, "outflow_rate_mean": 1118.8660528941605, "system_level_velocity_min": 11.075079720478357, "outflow_rate_min": 317.5287350200169, "system_level_velocity_max": 19.761973105332917}, "info": {"num_steps_trained": 11685922, "load_time_ms": 12.139, "grad_time_ms": 9596.17, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013906304724514484, "total_loss": 16.75547981262207, "vf_loss": 16.759981155395508, "policy_loss": -0.008462857455015182, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9214760661125183, "entropy": 1.14536452293396}, "update_time_ms": 9.257, "num_steps_sampled": 11685922, "sample_time_ms": 15098.421}, "episode_len_mean": 674.17, "time_this_iter_s": 24.40573525428772, "num_metric_batches_dropped": 0, "timesteps_total": 11685922, "episodes_total": 3960, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ccc0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c710>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229551, "episode_reward_max": 1301.129663074834, "episodes_this_iter": 11, "time_total_s": 7065.957607984543, "time_since_restore": 7065.957607984543}
{"timesteps_since_restore": 11727310, "training_iteration": 265, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-46-15", "episode_reward_min": 33.45102496013871, "timesteps_this_iter": 41388, "episode_reward_mean": 1150.1199057034903, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 265, "custom_metrics": {"outflow_rate_max": 1330.9164143856144, "cost2_min": -171.80944428448566, "cost1_mean": 337.7467949897172, "cost2_mean": -120.33819085642818, "system_level_velocity_mean": 13.344031950572637, "cost1_max": 427.9247325300122, "cost1_min": 18.010986744628468, "cost2_max": -17.53842535821078, "outflow_rate_mean": 1123.0363578571971, "system_level_velocity_min": 11.075079720478357, "outflow_rate_min": 317.5287350200169, "system_level_velocity_max": 19.761973105332917}, "info": {"num_steps_trained": 11727310, "load_time_ms": 12.092, "grad_time_ms": 9580.354, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014745233580470085, "total_loss": 16.210060119628906, "vf_loss": 16.21510887145996, "policy_loss": -0.0092475526034832, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9324195384979248, "entropy": 1.1290736198425293}, "update_time_ms": 8.982, "num_steps_sampled": 11727310, "sample_time_ms": 15115.864}, "episode_len_mean": 674.17, "time_this_iter_s": 23.990088939666748, "num_metric_batches_dropped": 0, "timesteps_total": 11727310, "episodes_total": 3977, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc915f8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc910b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f60>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229575, "episode_reward_max": 1317.058205097799, "episodes_this_iter": 17, "time_total_s": 7089.94769692421, "time_since_restore": 7089.94769692421}
{"timesteps_since_restore": 11768023, "training_iteration": 266, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-46-40", "episode_reward_min": 33.45102496013871, "timesteps_this_iter": 40713, "episode_reward_mean": 1145.5817090780918, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 266, "custom_metrics": {"outflow_rate_max": 1330.9164143856144, "cost2_min": -171.80944428448566, "cost1_mean": 336.1860250400043, "cost2_mean": -123.4530772232626, "system_level_velocity_mean": 13.49539448765388, "cost1_max": 427.9247325300122, "cost1_min": 18.010986744628468, "cost2_max": -17.53842535821078, "outflow_rate_mean": 1119.5543575491756, "system_level_velocity_min": 11.318355243216255, "outflow_rate_min": 317.5287350200169, "system_level_velocity_max": 19.761973105332917}, "info": {"num_steps_trained": 11768023, "load_time_ms": 12.174, "grad_time_ms": 9645.489, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013316811062395573, "total_loss": 19.319753646850586, "vf_loss": 19.323585510253906, "policy_loss": -0.007623323239386082, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9272915124893188, "entropy": 1.1652987003326416}, "update_time_ms": 8.843, "num_steps_sampled": 11768023, "sample_time_ms": 15195.9}, "episode_len_mean": 665.1, "time_this_iter_s": 24.991888523101807, "num_metric_batches_dropped": 0, "timesteps_total": 11768023, "episodes_total": 3995, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb30f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229600, "episode_reward_max": 1354.5578848001492, "episodes_this_iter": 18, "time_total_s": 7114.939585447311, "time_since_restore": 7114.939585447311}
{"timesteps_since_restore": 11808747, "training_iteration": 267, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-47-05", "episode_reward_min": 33.45102496013871, "timesteps_this_iter": 40724, "episode_reward_mean": 1149.3614970196654, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 267, "custom_metrics": {"outflow_rate_max": 1330.9164143856144, "cost2_min": -171.80944428448566, "cost1_mean": 338.08519376790855, "cost2_mean": -125.61608789924676, "system_level_velocity_mean": 13.580570357202898, "cost1_max": 427.9247325300122, "cost1_min": 18.010986744628468, "cost2_max": -17.53842535821078, "outflow_rate_mean": 1130.4139762606726, "system_level_velocity_min": 11.318355243216255, "outflow_rate_min": 317.5287350200169, "system_level_velocity_max": 19.761973105332917}, "info": {"num_steps_trained": 11808747, "load_time_ms": 11.864, "grad_time_ms": 9713.69, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013928833417594433, "total_loss": 21.27619743347168, "vf_loss": 21.281063079833984, "policy_loss": -0.008830837905406952, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9167882800102234, "entropy": 1.1742764711380005}, "update_time_ms": 8.837, "num_steps_sampled": 11808747, "sample_time_ms": 15266.237}, "episode_len_mean": 664.56, "time_this_iter_s": 24.9777090549469, "num_metric_batches_dropped": 0, "timesteps_total": 11808747, "episodes_total": 4014, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb080>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb278>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229625, "episode_reward_max": 1354.5578848001492, "episodes_this_iter": 19, "time_total_s": 7139.917294502258, "time_since_restore": 7139.917294502258}
{"timesteps_since_restore": 11850209, "training_iteration": 268, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-47-31", "episode_reward_min": 33.45102496013871, "timesteps_this_iter": 41462, "episode_reward_mean": 1119.8485453875896, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 268, "custom_metrics": {"outflow_rate_max": 1330.9164143856144, "cost2_min": -164.38122797565597, "cost1_mean": 331.4370020971624, "cost2_mean": -122.26276438239053, "system_level_velocity_mean": 13.850372831579723, "cost1_max": 427.9247325300122, "cost1_min": 18.010986744628468, "cost2_max": -17.53842535821078, "outflow_rate_mean": 1114.8641784606145, "system_level_velocity_min": 11.426820773300745, "outflow_rate_min": 317.5287350200169, "system_level_velocity_max": 19.761973105332917}, "info": {"num_steps_trained": 11850209, "load_time_ms": 11.873, "grad_time_ms": 9755.919, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014104338362812996, "total_loss": 25.346628189086914, "vf_loss": 25.35264778137207, "policy_loss": -0.010037959553301334, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9026362895965576, "entropy": 1.1604734659194946}, "update_time_ms": 8.913, "num_steps_sampled": 11850209, "sample_time_ms": 15254.796}, "episode_len_mean": 645.58, "time_this_iter_s": 25.58102250099182, "num_metric_batches_dropped": 0, "timesteps_total": 11850209, "episodes_total": 4034, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ceb8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cfd0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229651, "episode_reward_max": 1354.5578848001492, "episodes_this_iter": 20, "time_total_s": 7165.49831700325, "time_since_restore": 7165.49831700325}
{"timesteps_since_restore": 11892063, "training_iteration": 269, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-47-56", "episode_reward_min": 33.45102496013871, "timesteps_this_iter": 41854, "episode_reward_mean": 1124.8267890608442, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 269, "custom_metrics": {"outflow_rate_max": 1330.9164143856144, "cost2_min": -159.13561059542644, "cost1_mean": 332.1357517613173, "cost2_mean": -120.87048301643905, "system_level_velocity_mean": 13.878919685323629, "cost1_max": 427.9247325300122, "cost1_min": 18.010986744628468, "cost2_max": -17.53842535821078, "outflow_rate_mean": 1121.5488157353402, "system_level_velocity_min": 11.205490459840332, "outflow_rate_min": 317.5287350200169, "system_level_velocity_max": 19.761973105332917}, "info": {"num_steps_trained": 11892063, "load_time_ms": 11.847, "grad_time_ms": 9678.585, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015015496872365475, "total_loss": 14.656890869140625, "vf_loss": 14.661471366882324, "policy_loss": -0.00885772705078125, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9278427958488464, "entropy": 1.1588777303695679}, "update_time_ms": 8.669, "num_steps_sampled": 11892063, "sample_time_ms": 15379.031}, "episode_len_mean": 645.58, "time_this_iter_s": 24.780341386795044, "num_metric_batches_dropped": 0, "timesteps_total": 11892063, "episodes_total": 4044, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91390>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f28>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229676, "episode_reward_max": 1354.5578848001492, "episodes_this_iter": 10, "time_total_s": 7190.278658390045, "time_since_restore": 7190.278658390045}
{"timesteps_since_restore": 11934403, "training_iteration": 270, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-48-20", "episode_reward_min": 60.78370130493542, "timesteps_this_iter": 42340, "episode_reward_mean": 1160.5663407735676, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 270, "custom_metrics": {"outflow_rate_max": 1330.9164143856144, "cost2_min": -159.13561059542644, "cost1_mean": 341.78673299365545, "cost2_mean": -123.35545669125744, "system_level_velocity_mean": 13.681669122691591, "cost1_max": 413.60979806082037, "cost1_min": 30.909700997481657, "cost2_max": -26.606141109513995, "outflow_rate_mean": 1147.379490668582, "system_level_velocity_min": 11.205490459840332, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.04924851759733}, "info": {"num_steps_trained": 11934403, "load_time_ms": 11.944, "grad_time_ms": 9622.6, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01336702611297369, "total_loss": 20.580646514892578, "vf_loss": 20.584331512451172, "policy_loss": -0.007491847034543753, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9120873808860779, "entropy": 1.168701171875}, "update_time_ms": 8.361, "num_steps_sampled": 11934403, "sample_time_ms": 15371.986}, "episode_len_mean": 665.45, "time_this_iter_s": 24.599669933319092, "num_metric_batches_dropped": 0, "timesteps_total": 11934403, "episodes_total": 4059, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3dd8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229700, "episode_reward_max": 1354.5578848001492, "episodes_this_iter": 15, "time_total_s": 7214.878328323364, "time_since_restore": 7214.878328323364}
{"timesteps_since_restore": 11975802, "training_iteration": 271, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-48-45", "episode_reward_min": 60.78370130493542, "timesteps_this_iter": 41399, "episode_reward_mean": 1161.0219288155074, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 271, "custom_metrics": {"outflow_rate_max": 1325.2627884115884, "cost2_min": -159.13561059542644, "cost1_mean": 340.8594294158474, "cost2_mean": -122.76770397575925, "system_level_velocity_mean": 13.6876427056309, "cost1_max": 413.60979806082037, "cost1_min": 30.909700997481657, "cost2_max": -26.606141109513995, "outflow_rate_mean": 1146.184257054215, "system_level_velocity_min": 11.205490459840332, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.04924851759733}, "info": {"num_steps_trained": 11975802, "load_time_ms": 11.973, "grad_time_ms": 9538.137, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0153058972209692, "total_loss": 23.14751625061035, "vf_loss": 23.15328025817871, "policy_loss": -0.010120787657797337, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9143047332763672, "entropy": 1.1607863903045654}, "update_time_ms": 8.153, "num_steps_sampled": 11975802, "sample_time_ms": 15278.504}, "episode_len_mean": 664.44, "time_this_iter_s": 25.08862590789795, "num_metric_batches_dropped": 0, "timesteps_total": 11975802, "episodes_total": 4078, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbfd0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229725, "episode_reward_max": 1354.5578848001492, "episodes_this_iter": 19, "time_total_s": 7239.966954231262, "time_since_restore": 7239.966954231262}
{"timesteps_since_restore": 12016375, "training_iteration": 272, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-49-10", "episode_reward_min": 60.78370130493542, "timesteps_this_iter": 40573, "episode_reward_mean": 1168.9872818269212, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 272, "custom_metrics": {"outflow_rate_max": 1325.2627884115884, "cost2_min": -154.86222664448889, "cost1_mean": 343.0219204042945, "cost2_mean": -123.34966437118584, "system_level_velocity_mean": 13.628000251234631, "cost1_max": 396.533990833306, "cost1_min": 30.909700997481657, "cost2_max": -26.606141109513995, "outflow_rate_mean": 1155.9326322099344, "system_level_velocity_min": 11.205490459840332, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.04924851759733}, "info": {"num_steps_trained": 12016375, "load_time_ms": 11.918, "grad_time_ms": 9539.894, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013854905031621456, "total_loss": 18.34248924255371, "vf_loss": 18.34722137451172, "policy_loss": -0.008677489124238491, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9345220327377319, "entropy": 1.135379672050476}, "update_time_ms": 8.08, "num_steps_sampled": 12016375, "sample_time_ms": 15209.857}, "episode_len_mean": 670.25, "time_this_iter_s": 24.701605319976807, "num_metric_batches_dropped": 0, "timesteps_total": 12016375, "episodes_total": 4095, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c160>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ca58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229750, "episode_reward_max": 1344.6582011112441, "episodes_this_iter": 17, "time_total_s": 7264.668559551239, "time_since_restore": 7264.668559551239}
{"timesteps_since_restore": 12058143, "training_iteration": 273, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-49-36", "episode_reward_min": 60.78370130493542, "timesteps_this_iter": 41768, "episode_reward_mean": 1187.7531880974802, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 273, "custom_metrics": {"outflow_rate_max": 1325.2627884115884, "cost2_min": -166.55743917654686, "cost1_mean": 347.2462991204024, "cost2_mean": -127.96446876205898, "system_level_velocity_mean": 13.61908903323822, "cost1_max": 393.9601013600649, "cost1_min": 30.909700997481657, "cost2_max": -26.606141109513995, "outflow_rate_mean": 1167.196605730975, "system_level_velocity_min": 11.205490459840332, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.04924851759733}, "info": {"num_steps_trained": 12058143, "load_time_ms": 12.036, "grad_time_ms": 9554.492, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013481322675943375, "total_loss": 14.704316139221191, "vf_loss": 14.708525657653809, "policy_loss": -0.00804988481104374, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9541542530059814, "entropy": 1.100131869316101}, "update_time_ms": 8.32, "num_steps_sampled": 12058143, "sample_time_ms": 15240.755}, "episode_len_mean": 676.75, "time_this_iter_s": 25.92244052886963, "num_metric_batches_dropped": 0, "timesteps_total": 12058143, "episodes_total": 4112, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54320>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb546a0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229776, "episode_reward_max": 1344.6582011112441, "episodes_this_iter": 17, "time_total_s": 7290.591000080109, "time_since_restore": 7290.591000080109}
{"timesteps_since_restore": 12102051, "training_iteration": 274, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-50-02", "episode_reward_min": 66.78343374058876, "timesteps_this_iter": 43908, "episode_reward_mean": 1205.1710216771316, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 274, "custom_metrics": {"outflow_rate_max": 1325.2627884115884, "cost2_min": -169.72254528672931, "cost1_mean": 350.7431653624223, "cost2_mean": -132.11513748352834, "system_level_velocity_mean": 13.571547028662769, "cost1_max": 394.851847698338, "cost1_min": 33.94255420724022, "cost2_max": -27.625547896203148, "outflow_rate_mean": 1177.4504292174904, "system_level_velocity_min": 11.205490459840332, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.770343135084502}, "info": {"num_steps_trained": 12102051, "load_time_ms": 12.514, "grad_time_ms": 9542.694, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014756008051335812, "total_loss": 13.218667030334473, "vf_loss": 13.22365665435791, "policy_loss": -0.009190787561237812, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9579075574874878, "entropy": 1.0913280248641968}, "update_time_ms": 8.325, "num_steps_sampled": 12102051, "sample_time_ms": 15447.025}, "episode_len_mean": 683.29, "time_this_iter_s": 26.382585287094116, "num_metric_batches_dropped": 0, "timesteps_total": 12102051, "episodes_total": 4123, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3f60>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229802, "episode_reward_max": 1354.4247645211096, "episodes_this_iter": 11, "time_total_s": 7316.973585367203, "time_since_restore": 7316.973585367203}
{"timesteps_since_restore": 12145100, "training_iteration": 275, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-50-28", "episode_reward_min": 53.28930631208523, "timesteps_this_iter": 43049, "episode_reward_mean": 1189.7497608890515, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 275, "custom_metrics": {"outflow_rate_max": 1325.2627884115884, "cost2_min": -170.84607737421175, "cost1_mean": 345.7566865587614, "cost2_mean": -134.84721358689245, "system_level_velocity_mean": 13.591436221285221, "cost1_max": 405.1288076514058, "cost1_min": 28.815983879928833, "cost2_max": -27.186960431466893, "outflow_rate_mean": 1165.0389464240577, "system_level_velocity_min": 10.927820454361456, "outflow_rate_min": 329.2505274600093, "system_level_velocity_max": 19.236133823860786}, "info": {"num_steps_trained": 12145100, "load_time_ms": 12.579, "grad_time_ms": 9558.117, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013598049990832806, "total_loss": 11.781718254089355, "vf_loss": 11.786087036132812, "policy_loss": -0.008241460658609867, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9676204919815063, "entropy": 1.1195197105407715}, "update_time_ms": 8.363, "num_steps_sampled": 12145100, "sample_time_ms": 15544.502}, "episode_len_mean": 676.15, "time_this_iter_s": 25.12734365463257, "num_metric_batches_dropped": 0, "timesteps_total": 12145100, "episodes_total": 4139, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fc88>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f550>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229828, "episode_reward_max": 1354.4247645211096, "episodes_this_iter": 16, "time_total_s": 7342.100929021835, "time_since_restore": 7342.100929021835}
{"timesteps_since_restore": 12186547, "training_iteration": 276, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-50-52", "episode_reward_min": 53.28930631208523, "timesteps_this_iter": 41447, "episode_reward_mean": 1183.6308501040332, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 276, "custom_metrics": {"outflow_rate_max": 1395.2037662337661, "cost2_min": -170.84607737421175, "cost1_mean": 345.6440692786744, "cost2_mean": -139.80144572533817, "system_level_velocity_mean": 13.592955880593422, "cost1_max": 407.72062157271824, "cost1_min": 28.815983879928833, "cost2_max": -27.186960431466893, "outflow_rate_mean": 1164.9774504160653, "system_level_velocity_min": 10.927820454361456, "outflow_rate_min": 329.2505274600093, "system_level_velocity_max": 19.236133823860786}, "info": {"num_steps_trained": 12186547, "load_time_ms": 12.609, "grad_time_ms": 9522.966, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01265584584325552, "total_loss": 10.96829605102539, "vf_loss": 10.97250747680664, "policy_loss": -0.007814657874405384, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9675776958465576, "entropy": 1.160565972328186}, "update_time_ms": 8.291, "num_steps_sampled": 12186547, "sample_time_ms": 15506.682}, "episode_len_mean": 676.15, "time_this_iter_s": 24.263549327850342, "num_metric_batches_dropped": 0, "timesteps_total": 12186547, "episodes_total": 4157, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91128>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c860>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229852, "episode_reward_max": 1354.4247645211096, "episodes_this_iter": 18, "time_total_s": 7366.364478349686, "time_since_restore": 7366.364478349686}
{"timesteps_since_restore": 12228332, "training_iteration": 277, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-51-18", "episode_reward_min": 52.29602057659326, "timesteps_this_iter": 41785, "episode_reward_mean": 1176.1485188611844, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 277, "custom_metrics": {"outflow_rate_max": 1395.2037662337661, "cost2_min": -170.84607737421175, "cost1_mean": 344.0963114630748, "cost2_mean": -142.9837249947188, "system_level_velocity_mean": 13.604056352938457, "cost1_max": 407.72062157271824, "cost1_min": 28.037717916977627, "cost2_max": -26.841896274989743, "outflow_rate_mean": 1162.448515370313, "system_level_velocity_min": 10.927820454361456, "outflow_rate_min": 329.2505274600093, "system_level_velocity_max": 19.236133823860786}, "info": {"num_steps_trained": 12228332, "load_time_ms": 12.92, "grad_time_ms": 9517.125, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013956372626125813, "total_loss": 14.893258094787598, "vf_loss": 14.897688865661621, "policy_loss": -0.008405977860093117, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.958228349685669, "entropy": 1.1403577327728271}, "update_time_ms": 8.344, "num_steps_sampled": 12228332, "sample_time_ms": 15669.229}, "episode_len_mean": 673.85, "time_this_iter_s": 26.52419877052307, "num_metric_batches_dropped": 0, "timesteps_total": 12228332, "episodes_total": 4174, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c8d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c320>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229878, "episode_reward_max": 1392.0492318189263, "episodes_this_iter": 17, "time_total_s": 7392.888677120209, "time_since_restore": 7392.888677120209}
{"timesteps_since_restore": 12269752, "training_iteration": 278, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-51-44", "episode_reward_min": 52.29602057659326, "timesteps_this_iter": 41420, "episode_reward_mean": 1169.5077748148499, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 278, "custom_metrics": {"outflow_rate_max": 1415.1781694305694, "cost2_min": -173.55689488034668, "cost1_mean": 343.3366410460351, "cost2_mean": -146.73633408766634, "system_level_velocity_mean": 13.67193341335683, "cost1_max": 432.5904362522328, "cost1_min": 28.037717916977627, "cost2_max": -26.841896274989743, "outflow_rate_mean": 1164.8524919126955, "system_level_velocity_min": 10.927820454361456, "outflow_rate_min": 329.2505274600093, "system_level_velocity_max": 19.236133823860786}, "info": {"num_steps_trained": 12269752, "load_time_ms": 12.812, "grad_time_ms": 9439.891, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013132009655237198, "total_loss": 14.996923446655273, "vf_loss": 15.001312255859375, "policy_loss": -0.008129049092531204, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9573411345481873, "entropy": 1.1310641765594482}, "update_time_ms": 8.154, "num_steps_sampled": 12269752, "sample_time_ms": 15736.344}, "episode_len_mean": 670.07, "time_this_iter_s": 25.477495908737183, "num_metric_batches_dropped": 0, "timesteps_total": 12269752, "episodes_total": 4192, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f240>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fdd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fe80>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229904, "episode_reward_max": 1402.435073595338, "episodes_this_iter": 18, "time_total_s": 7418.366173028946, "time_since_restore": 7418.366173028946}
{"timesteps_since_restore": 12312636, "training_iteration": 279, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-52-10", "episode_reward_min": 52.29602057659326, "timesteps_this_iter": 42884, "episode_reward_mean": 1170.445293042651, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 279, "custom_metrics": {"outflow_rate_max": 1415.1781694305694, "cost2_min": -173.55689488034668, "cost1_mean": 343.81045054963266, "cost2_mean": -148.63084129032592, "system_level_velocity_mean": 13.695935384010067, "cost1_max": 432.5904362522328, "cost1_min": 28.037717916977627, "cost2_max": -26.841896274989743, "outflow_rate_mean": 1168.1337879406676, "system_level_velocity_min": 10.927820454361456, "outflow_rate_min": 329.2505274600093, "system_level_velocity_max": 19.236133823860786}, "info": {"num_steps_trained": 12312636, "load_time_ms": 12.853, "grad_time_ms": 9487.306, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01350658480077982, "total_loss": 9.432852745056152, "vf_loss": 9.437607765197754, "policy_loss": -0.008601839654147625, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9702581763267517, "entropy": 1.1328420639038086}, "update_time_ms": 8.441, "num_steps_sampled": 12312636, "sample_time_ms": 15810.263}, "episode_len_mean": 670.07, "time_this_iter_s": 25.99358344078064, "num_metric_batches_dropped": 0, "timesteps_total": 12312636, "episodes_total": 4205, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54390>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb545c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229930, "episode_reward_max": 1402.435073595338, "episodes_this_iter": 13, "time_total_s": 7444.359756469727, "time_since_restore": 7444.359756469727}
{"timesteps_since_restore": 12355480, "training_iteration": 280, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-52-35", "episode_reward_min": 52.29602057659326, "timesteps_this_iter": 42844, "episode_reward_mean": 1155.7283491635308, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 280, "custom_metrics": {"outflow_rate_max": 1415.1781694305694, "cost2_min": -173.55689488034668, "cost1_mean": 340.808591340868, "cost2_mean": -149.2420400821339, "system_level_velocity_mean": 13.647055861138709, "cost1_max": 432.5904362522328, "cost1_min": 28.037717916977627, "cost2_max": -26.841896274989743, "outflow_rate_mean": 1164.5768869148867, "system_level_velocity_min": 10.927820454361456, "outflow_rate_min": 329.2505274600093, "system_level_velocity_max": 19.236133823860786}, "info": {"num_steps_trained": 12355480, "load_time_ms": 12.91, "grad_time_ms": 9508.239, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013071437366306782, "total_loss": 12.6845121383667, "vf_loss": 12.687865257263184, "policy_loss": -0.007077077403664589, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9641352891921997, "entropy": 1.1569405794143677}, "update_time_ms": 8.613, "num_steps_sampled": 12355480, "sample_time_ms": 15852.057}, "episode_len_mean": 666.95, "time_this_iter_s": 25.22486138343811, "num_metric_batches_dropped": 0, "timesteps_total": 12355480, "episodes_total": 4221, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c198>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c550>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229955, "episode_reward_max": 1402.435073595338, "episodes_this_iter": 16, "time_total_s": 7469.584617853165, "time_since_restore": 7469.584617853165}
{"timesteps_since_restore": 12398302, "training_iteration": 281, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-53-01", "episode_reward_min": 52.29602057659326, "timesteps_this_iter": 42822, "episode_reward_mean": 1173.2063301989292, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 281, "custom_metrics": {"outflow_rate_max": 1415.1781694305694, "cost2_min": -179.0363883691035, "cost1_mean": 345.29462862203656, "cost2_mean": -151.4049568998796, "system_level_velocity_mean": 13.540827457144912, "cost1_max": 432.5904362522328, "cost1_min": 28.037717916977627, "cost2_max": -26.841896274989743, "outflow_rate_mean": 1177.8093714145625, "system_level_velocity_min": 9.865345455841618, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.4933623800382}, "info": {"num_steps_trained": 12398302, "load_time_ms": 12.401, "grad_time_ms": 9550.564, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015102452598512173, "total_loss": 14.847185134887695, "vf_loss": 14.849943161010742, "policy_loss": -0.007058674935251474, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9510912895202637, "entropy": 1.1458731889724731}, "update_time_ms": 8.501, "num_steps_sampled": 12398302, "sample_time_ms": 15831.067}, "episode_len_mean": 676.63, "time_this_iter_s": 25.282729387283325, "num_metric_batches_dropped": 0, "timesteps_total": 12398302, "episodes_total": 4238, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cbe0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c358>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557229981, "episode_reward_max": 1402.435073595338, "episodes_this_iter": 17, "time_total_s": 7494.867347240448, "time_since_restore": 7494.867347240448}
{"timesteps_since_restore": 12440071, "training_iteration": 282, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-53-25", "episode_reward_min": 51.16090704024812, "timesteps_this_iter": 41769, "episode_reward_mean": 1152.2467236693283, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 282, "custom_metrics": {"outflow_rate_max": 1415.1781694305694, "cost2_min": -179.0363883691035, "cost1_mean": 339.5987877477853, "cost2_mean": -149.08902145107552, "system_level_velocity_mean": 13.646412281692733, "cost1_max": 432.5904362522328, "cost1_min": 28.037717916977627, "cost2_max": -26.38290008317973, "outflow_rate_mean": 1163.0015151937196, "system_level_velocity_min": 9.865345455841618, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.73529607658627}, "info": {"num_steps_trained": 12440071, "load_time_ms": 12.577, "grad_time_ms": 9441.705, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01339948084205389, "total_loss": 14.647218704223633, "vf_loss": 14.652545928955078, "policy_loss": -0.009140302427113056, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.955143392086029, "entropy": 1.169824481010437}, "update_time_ms": 8.273, "num_steps_sampled": 12440071, "sample_time_ms": 15953.598}, "episode_len_mean": 663.92, "time_this_iter_s": 24.824381351470947, "num_metric_batches_dropped": 0, "timesteps_total": 12440071, "episodes_total": 4255, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3f60>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb30f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230005, "episode_reward_max": 1402.435073595338, "episodes_this_iter": 17, "time_total_s": 7519.691728591919, "time_since_restore": 7519.691728591919}
{"timesteps_since_restore": 12482944, "training_iteration": 283, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-53-50", "episode_reward_min": 51.16090704024812, "timesteps_this_iter": 42873, "episode_reward_mean": 1161.9876979409514, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 283, "custom_metrics": {"outflow_rate_max": 1415.1781694305694, "cost2_min": -179.0363883691035, "cost1_mean": 342.67932713823166, "cost2_mean": -150.75402436170202, "system_level_velocity_mean": 13.585441308359341, "cost1_max": 432.5904362522328, "cost1_min": 28.998316403680477, "cost2_max": -26.38290008317973, "outflow_rate_mean": 1169.6942758512964, "system_level_velocity_min": 9.865345455841618, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.73529607658627}, "info": {"num_steps_trained": 12482944, "load_time_ms": 12.547, "grad_time_ms": 9333.536, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01310809887945652, "total_loss": 10.762950897216797, "vf_loss": 10.768025398254395, "policy_loss": -0.008806374855339527, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9650904536247253, "entropy": 1.1579400300979614}, "update_time_ms": 7.9, "num_steps_sampled": 12482944, "sample_time_ms": 15973.739}, "episode_len_mean": 670.49, "time_this_iter_s": 25.018747091293335, "num_metric_batches_dropped": 0, "timesteps_total": 12482944, "episodes_total": 4268, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb549b0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb544a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230030, "episode_reward_max": 1402.435073595338, "episodes_this_iter": 13, "time_total_s": 7544.710475683212, "time_since_restore": 7544.710475683212}
{"timesteps_since_restore": 12526389, "training_iteration": 284, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-54-16", "episode_reward_min": 51.16090704024812, "timesteps_this_iter": 43445, "episode_reward_mean": 1158.7850544489077, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 284, "custom_metrics": {"outflow_rate_max": 1415.1781694305694, "cost2_min": -179.0363883691035, "cost1_mean": 342.4223999793505, "cost2_mean": -149.8872880108641, "system_level_velocity_mean": 13.577259077635345, "cost1_max": 432.5904362522328, "cost1_min": 28.998316403680477, "cost2_max": -26.38290008317973, "outflow_rate_mean": 1165.8612818532943, "system_level_velocity_min": 9.865345455841618, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.73529607658627}, "info": {"num_steps_trained": 12526389, "load_time_ms": 12.524, "grad_time_ms": 9332.337, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01370225753635168, "total_loss": 11.02352523803711, "vf_loss": 11.027228355407715, "policy_loss": -0.007604632060974836, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9680962562561035, "entropy": 1.1424384117126465}, "update_time_ms": 7.606, "num_steps_sampled": 12526389, "sample_time_ms": 15878.529}, "episode_len_mean": 670.49, "time_this_iter_s": 25.386770963668823, "num_metric_batches_dropped": 0, "timesteps_total": 12526389, "episodes_total": 4284, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c278>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb549e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb542e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230056, "episode_reward_max": 1378.086977528138, "episodes_this_iter": 16, "time_total_s": 7570.097246646881, "time_since_restore": 7570.097246646881}
{"timesteps_since_restore": 12568344, "training_iteration": 285, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-54-41", "episode_reward_min": 51.16090704024812, "timesteps_this_iter": 41955, "episode_reward_mean": 1159.978207575555, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 285, "custom_metrics": {"outflow_rate_max": 1388.6853002997004, "cost2_min": -185.96408512702712, "cost1_mean": 341.1235312866827, "cost2_mean": -150.85467000394635, "system_level_velocity_mean": 13.510504312521626, "cost1_max": 410.8663085418897, "cost1_min": 28.998316403680477, "cost2_max": -26.38290008317973, "outflow_rate_mean": 1157.950433590172, "system_level_velocity_min": 9.865345455841618, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.73529607658627}, "info": {"num_steps_trained": 12568344, "load_time_ms": 12.461, "grad_time_ms": 9261.29, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013260088860988617, "total_loss": 10.392679214477539, "vf_loss": 10.396327018737793, "policy_loss": -0.007423424161970615, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9711641669273376, "entropy": 1.1514383554458618}, "update_time_ms": 7.591, "num_steps_sampled": 12568344, "sample_time_ms": 15898.771}, "episode_len_mean": 670.92, "time_this_iter_s": 24.611539840698242, "num_metric_batches_dropped": 0, "timesteps_total": 12568344, "episodes_total": 4302, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54860>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb540b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230081, "episode_reward_max": 1378.086977528138, "episodes_this_iter": 18, "time_total_s": 7594.708786487579, "time_since_restore": 7594.708786487579}
{"timesteps_since_restore": 12610555, "training_iteration": 286, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-55-06", "episode_reward_min": 51.16090704024812, "timesteps_this_iter": 42211, "episode_reward_mean": 1173.2872984001683, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 286, "custom_metrics": {"outflow_rate_max": 1388.6853002997004, "cost2_min": -185.96408512702712, "cost1_mean": 344.7638589380474, "cost2_mean": -151.90956602438004, "system_level_velocity_mean": 13.547446552373499, "cost1_max": 410.8663085418897, "cost1_min": 28.998316403680477, "cost2_max": -26.38290008317973, "outflow_rate_mean": 1169.2765449066874, "system_level_velocity_min": 9.865345455841618, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.73529607658627}, "info": {"num_steps_trained": 12610555, "load_time_ms": 12.622, "grad_time_ms": 9238.588, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015268195420503616, "total_loss": 11.91093635559082, "vf_loss": 11.9157133102417, "policy_loss": -0.0091255409643054, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.963381290435791, "entropy": 1.116538166999817}, "update_time_ms": 7.614, "num_steps_sampled": 12610555, "sample_time_ms": 15999.329}, "episode_len_mean": 675.52, "time_this_iter_s": 25.038953065872192, "num_metric_batches_dropped": 0, "timesteps_total": 12610555, "episodes_total": 4319, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0a58>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f860>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230106, "episode_reward_max": 1378.086977528138, "episodes_this_iter": 17, "time_total_s": 7619.7477395534515, "time_since_restore": 7619.7477395534515}
{"timesteps_since_restore": 12652850, "training_iteration": 287, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-55-31", "episode_reward_min": 51.16090704024812, "timesteps_this_iter": 42295, "episode_reward_mean": 1172.6255028163255, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 287, "custom_metrics": {"outflow_rate_max": 1388.6853002997004, "cost2_min": -185.96408512702712, "cost1_mean": 346.12454975276023, "cost2_mean": -152.6162380790615, "system_level_velocity_mean": 13.706244126187485, "cost1_max": 410.8663085418897, "cost1_min": 28.72242408545475, "cost2_max": -22.48872257956679, "outflow_rate_mean": 1171.0997177003533, "system_level_velocity_min": 10.099170301352574, "outflow_rate_min": 335.00641501256877, "system_level_velocity_max": 19.73529607658627}, "info": {"num_steps_trained": 12652850, "load_time_ms": 12.788, "grad_time_ms": 9316.76, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013139951974153519, "total_loss": 9.314393997192383, "vf_loss": 9.318839073181152, "policy_loss": -0.008186513558030128, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9740593433380127, "entropy": 1.1583272218704224}, "update_time_ms": 7.529, "num_steps_sampled": 12652850, "sample_time_ms": 15766.709}, "episode_len_mean": 672.35, "time_this_iter_s": 24.980355978012085, "num_metric_batches_dropped": 0, "timesteps_total": 12652850, "episodes_total": 4333, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54978>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb548d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54780>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230131, "episode_reward_max": 1378.086977528138, "episodes_this_iter": 14, "time_total_s": 7644.728095531464, "time_since_restore": 7644.728095531464}
{"timesteps_since_restore": 12696296, "training_iteration": 288, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-55-56", "episode_reward_min": 51.16090704024812, "timesteps_this_iter": 43446, "episode_reward_mean": 1179.3144894875434, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 288, "custom_metrics": {"outflow_rate_max": 1415.5375644355645, "cost2_min": -185.96408512702712, "cost1_mean": 348.1128240128594, "cost2_mean": -154.4938436053346, "system_level_velocity_mean": 13.71406790813337, "cost1_max": 417.23410388804245, "cost1_min": 28.72242408545475, "cost2_max": -22.48872257956679, "outflow_rate_mean": 1177.0027720386877, "system_level_velocity_min": 10.099170301352574, "outflow_rate_min": 335.00641501256877, "system_level_velocity_max": 19.73529607658627}, "info": {"num_steps_trained": 12696296, "load_time_ms": 12.852, "grad_time_ms": 9392.435, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014294266700744629, "total_loss": 9.6497163772583, "vf_loss": 9.654417991638184, "policy_loss": -0.008771811611950397, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9756898880004883, "entropy": 1.1216987371444702}, "update_time_ms": 7.402, "num_steps_sampled": 12696296, "sample_time_ms": 15641.315}, "episode_len_mean": 675.84, "time_this_iter_s": 24.980406284332275, "num_metric_batches_dropped": 0, "timesteps_total": 12696296, "episodes_total": 4347, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c358>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c198>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230156, "episode_reward_max": 1378.086977528138, "episodes_this_iter": 14, "time_total_s": 7669.708501815796, "time_since_restore": 7669.708501815796}
{"timesteps_since_restore": 12737675, "training_iteration": 289, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-56-20", "episode_reward_min": 51.318116721696974, "timesteps_this_iter": 41379, "episode_reward_mean": 1182.4753847745674, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 289, "custom_metrics": {"outflow_rate_max": 1415.5375644355645, "cost2_min": -186.42472294265164, "cost1_mean": 349.048871358568, "cost2_mean": -157.96140621506993, "system_level_velocity_mean": 13.653798542249124, "cost1_max": 417.23410388804245, "cost1_min": 28.72242408545475, "cost2_max": -22.48872257956679, "outflow_rate_mean": 1183.0419519611253, "system_level_velocity_min": 10.099170301352574, "outflow_rate_min": 335.00641501256877, "system_level_velocity_max": 19.28599705341369}, "info": {"num_steps_trained": 12737675, "load_time_ms": 12.834, "grad_time_ms": 9344.93, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013717236928641796, "total_loss": 10.29293441772461, "vf_loss": 10.297001838684082, "policy_loss": -0.007973641157150269, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9692810773849487, "entropy": 1.1679257154464722}, "update_time_ms": 7.262, "num_steps_sampled": 12737675, "sample_time_ms": 15499.485}, "episode_len_mean": 679.37, "time_this_iter_s": 24.10287308692932, "num_metric_batches_dropped": 0, "timesteps_total": 12737675, "episodes_total": 4364, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54198>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230180, "episode_reward_max": 1362.4021090205154, "episodes_this_iter": 17, "time_total_s": 7693.811374902725, "time_since_restore": 7693.811374902725}
{"timesteps_since_restore": 12779500, "training_iteration": 290, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-56-45", "episode_reward_min": 51.318116721696974, "timesteps_this_iter": 41825, "episode_reward_mean": 1177.3053552837532, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 290, "custom_metrics": {"outflow_rate_max": 1415.5375644355645, "cost2_min": -186.42472294265164, "cost1_mean": 348.72759644352186, "cost2_mean": -159.81731200818112, "system_level_velocity_mean": 13.785464519303886, "cost1_max": 417.23410388804245, "cost1_min": 28.72242408545475, "cost2_max": -22.48872257956679, "outflow_rate_mean": 1186.1767768232937, "system_level_velocity_min": 10.592048075559351, "outflow_rate_min": 335.00641501256877, "system_level_velocity_max": 19.28599705341369}, "info": {"num_steps_trained": 12779500, "load_time_ms": 12.859, "grad_time_ms": 9265.256, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014995639212429523, "total_loss": 11.700037002563477, "vf_loss": 11.704874992370605, "policy_loss": -0.009108834899961948, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.968981146812439, "entropy": 1.1735948324203491}, "update_time_ms": 7.161, "num_steps_sampled": 12779500, "sample_time_ms": 15548.62}, "episode_len_mean": 673.98, "time_this_iter_s": 24.917527198791504, "num_metric_batches_dropped": 0, "timesteps_total": 12779500, "episodes_total": 4382, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d518>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d0f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230205, "episode_reward_max": 1442.1563978865386, "episodes_this_iter": 18, "time_total_s": 7718.728902101517, "time_since_restore": 7718.728902101517}
{"timesteps_since_restore": 12821343, "training_iteration": 291, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-57-10", "episode_reward_min": 51.318116721696974, "timesteps_this_iter": 41843, "episode_reward_mean": 1172.556310795666, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 291, "custom_metrics": {"outflow_rate_max": 1415.5375644355645, "cost2_min": -204.32743344771478, "cost1_mean": 347.24293145771344, "cost2_mean": -161.64127314045945, "system_level_velocity_mean": 13.782516907784695, "cost1_max": 417.23410388804245, "cost1_min": 28.72242408545475, "cost2_max": -22.48872257956679, "outflow_rate_mean": 1189.5592542627808, "system_level_velocity_min": 10.728195647620504, "outflow_rate_min": 335.00641501256877, "system_level_velocity_max": 19.28599705341369}, "info": {"num_steps_trained": 12821343, "load_time_ms": 12.855, "grad_time_ms": 9155.019, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014844678342342377, "total_loss": 13.145334243774414, "vf_loss": 13.148193359375, "policy_loss": -0.00708659878000617, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9624757170677185, "entropy": 1.1843345165252686}, "update_time_ms": 7.22, "num_steps_sampled": 12821343, "sample_time_ms": 15675.703}, "episode_len_mean": 672.56, "time_this_iter_s": 25.45048952102661, "num_metric_batches_dropped": 0, "timesteps_total": 12821343, "episodes_total": 4398, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c748>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230230, "episode_reward_max": 1442.1563978865386, "episodes_this_iter": 16, "time_total_s": 7744.179391622543, "time_since_restore": 7744.179391622543}
{"timesteps_since_restore": 12865016, "training_iteration": 292, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-57-36", "episode_reward_min": 50.64643471131998, "timesteps_this_iter": 43673, "episode_reward_mean": 1161.4418657726687, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 292, "custom_metrics": {"outflow_rate_max": 1426.3708, "cost2_min": -204.32743344771478, "cost1_mean": 346.48019341509956, "cost2_mean": -161.28968026761694, "system_level_velocity_mean": 13.82312491022748, "cost1_max": 418.25306030487434, "cost1_min": 28.72242408545475, "cost2_max": -22.48872257956679, "outflow_rate_mean": 1185.4305932023044, "system_level_velocity_min": 10.728195647620504, "outflow_rate_min": 335.00641501256877, "system_level_velocity_max": 19.534011717102718}, "info": {"num_steps_trained": 12865016, "load_time_ms": 12.729, "grad_time_ms": 9083.17, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014982480555772781, "total_loss": 10.502581596374512, "vf_loss": 10.507425308227539, "policy_loss": -0.009108757600188255, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9674604535102844, "entropy": 1.1642770767211914}, "update_time_ms": 7.246, "num_steps_sampled": 12865016, "sample_time_ms": 15821.048}, "episode_len_mean": 671.01, "time_this_iter_s": 25.566964387893677, "num_metric_batches_dropped": 0, "timesteps_total": 12865016, "episodes_total": 4411, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb4e0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca35c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230256, "episode_reward_max": 1442.1563978865386, "episodes_this_iter": 13, "time_total_s": 7769.746356010437, "time_since_restore": 7769.746356010437}
{"timesteps_since_restore": 12906561, "training_iteration": 293, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-58-01", "episode_reward_min": 50.64643471131998, "timesteps_this_iter": 41545, "episode_reward_mean": 1162.206063058905, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 293, "custom_metrics": {"outflow_rate_max": 1426.3708, "cost2_min": -204.32743344771478, "cost1_mean": 345.6108481989777, "cost2_mean": -160.96826272906432, "system_level_velocity_mean": 13.782399276746306, "cost1_max": 418.25306030487434, "cost1_min": 28.72242408545475, "cost2_max": -22.48872257956679, "outflow_rate_mean": 1178.407905837669, "system_level_velocity_min": 10.230822752206084, "outflow_rate_min": 335.00641501256877, "system_level_velocity_max": 19.534011717102718}, "info": {"num_steps_trained": 12906561, "load_time_ms": 12.815, "grad_time_ms": 9050.315, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013119662180542946, "total_loss": 11.0008544921875, "vf_loss": 11.004243850708008, "policy_loss": -0.007125641219317913, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.970940113067627, "entropy": 1.1781927347183228}, "update_time_ms": 7.578, "num_steps_sampled": 12906561, "sample_time_ms": 15887.006}, "episode_len_mean": 671.01, "time_this_iter_s": 25.365159273147583, "num_metric_batches_dropped": 0, "timesteps_total": 12906561, "episodes_total": 4428, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f518>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ff28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230281, "episode_reward_max": 1442.1563978865386, "episodes_this_iter": 17, "time_total_s": 7795.111515283585, "time_since_restore": 7795.111515283585}
{"timesteps_since_restore": 12948243, "training_iteration": 294, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-58-26", "episode_reward_min": 50.64643471131998, "timesteps_this_iter": 41682, "episode_reward_mean": 1170.736914752525, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 294, "custom_metrics": {"outflow_rate_max": 1442.4991136863139, "cost2_min": -204.32743344771478, "cost1_mean": 348.6034816924211, "cost2_mean": -161.73989660363378, "system_level_velocity_mean": 13.699624514380691, "cost1_max": 418.25306030487434, "cost1_min": 28.87888085088129, "cost2_max": -27.983449794356268, "outflow_rate_mean": 1190.8941047305007, "system_level_velocity_min": 10.230822752206084, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.534011717102718}, "info": {"num_steps_trained": 12948243, "load_time_ms": 12.831, "grad_time_ms": 8947.817, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013379731215536594, "total_loss": 12.052322387695312, "vf_loss": 12.055097579956055, "policy_loss": -0.0065850550308823586, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9650143384933472, "entropy": 1.172614336013794}, "update_time_ms": 7.723, "num_steps_sampled": 12948243, "sample_time_ms": 15959.952}, "episode_len_mean": 677.58, "time_this_iter_s": 25.09768772125244, "num_metric_batches_dropped": 0, "timesteps_total": 12948243, "episodes_total": 4443, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c8d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ce80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c358>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230306, "episode_reward_max": 1442.1563978865386, "episodes_this_iter": 15, "time_total_s": 7820.209203004837, "time_since_restore": 7820.209203004837}
{"timesteps_since_restore": 12989459, "training_iteration": 295, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-58-51", "episode_reward_min": 50.64643471131998, "timesteps_this_iter": 41216, "episode_reward_mean": 1166.0084328209505, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 295, "custom_metrics": {"outflow_rate_max": 1442.4991136863139, "cost2_min": -204.32743344771478, "cost1_mean": 346.4386571525912, "cost2_mean": -160.6101592730819, "system_level_velocity_mean": 13.71506155586693, "cost1_max": 418.25306030487434, "cost1_min": 28.87888085088129, "cost2_max": -27.983449794356268, "outflow_rate_mean": 1186.0441020666474, "system_level_velocity_min": 10.230822752206084, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.534011717102718}, "info": {"num_steps_trained": 12989459, "load_time_ms": 12.738, "grad_time_ms": 8855.972, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013014346361160278, "total_loss": 16.094009399414062, "vf_loss": 16.09867286682129, "policy_loss": -0.008370878174901009, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9529961347579956, "entropy": 1.1655515432357788}, "update_time_ms": 7.566, "num_steps_sampled": 12989459, "sample_time_ms": 16076.675}, "episode_len_mean": 673.37, "time_this_iter_s": 24.842616319656372, "num_metric_batches_dropped": 0, "timesteps_total": 12989459, "episodes_total": 4460, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7320>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7b00>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230331, "episode_reward_max": 1442.1563978865386, "episodes_this_iter": 17, "time_total_s": 7845.051819324493, "time_since_restore": 7845.051819324493}
{"timesteps_since_restore": 13032141, "training_iteration": 296, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-59-16", "episode_reward_min": 50.64643471131998, "timesteps_this_iter": 42682, "episode_reward_mean": 1172.588621186374, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 296, "custom_metrics": {"outflow_rate_max": 1451.8714381618383, "cost2_min": -204.32743344771478, "cost1_mean": 351.1432017279898, "cost2_mean": -160.33458388961427, "system_level_velocity_mean": 13.75053609396095, "cost1_max": 418.25306030487434, "cost1_min": 28.87888085088129, "cost2_max": -27.983449794356268, "outflow_rate_mean": 1201.452821780964, "system_level_velocity_min": 10.230822752206084, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.534011717102718}, "info": {"num_steps_trained": 13032141, "load_time_ms": 12.717, "grad_time_ms": 8869.521, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012813659384846687, "total_loss": 11.251710891723633, "vf_loss": 11.254884719848633, "policy_loss": -0.006823342759162188, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9661544561386108, "entropy": 1.1552339792251587}, "update_time_ms": 7.448, "num_steps_sampled": 13032141, "sample_time_ms": 16039.533}, "episode_len_mean": 679.06, "time_this_iter_s": 24.79949450492859, "num_metric_batches_dropped": 0, "timesteps_total": 13032141, "episodes_total": 4473, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cb00>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230356, "episode_reward_max": 1434.956163185069, "episodes_this_iter": 13, "time_total_s": 7869.851313829422, "time_since_restore": 7869.851313829422}
{"timesteps_since_restore": 13074214, "training_iteration": 297, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_11-59-51", "episode_reward_min": 50.64643471131998, "timesteps_this_iter": 42073, "episode_reward_mean": 1157.8463031886895, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 297, "custom_metrics": {"outflow_rate_max": 1451.8714381618383, "cost2_min": -193.94848254573253, "cost1_mean": 345.721768906749, "cost2_mean": -157.58827496950914, "system_level_velocity_mean": 13.847344637272549, "cost1_max": 418.25306030487434, "cost1_min": 28.87888085088129, "cost2_max": -22.358730292054187, "outflow_rate_mean": 1185.673283932087, "system_level_velocity_min": 10.230822752206084, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 19.534011717102718}, "info": {"num_steps_trained": 13074214, "load_time_ms": 13.812, "grad_time_ms": 9417.343, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014997738413512707, "total_loss": 20.312490463256836, "vf_loss": 20.315874099731445, "policy_loss": -0.007652369327843189, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.94176185131073, "entropy": 1.1625016927719116}, "update_time_ms": 7.375, "num_steps_sampled": 13074214, "sample_time_ms": 16433.258}, "episode_len_mean": 667.51, "time_this_iter_s": 34.539483070373535, "num_metric_batches_dropped": 0, "timesteps_total": 13074214, "episodes_total": 4493, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd69e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6ef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230391, "episode_reward_max": 1434.956163185069, "episodes_this_iter": 20, "time_total_s": 7904.3907968997955, "time_since_restore": 7904.3907968997955}
{"timesteps_since_restore": 13117526, "training_iteration": 298, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_12-00-31", "episode_reward_min": 57.05893826449218, "timesteps_this_iter": 43312, "episode_reward_mean": 1166.8999540802645, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 298, "custom_metrics": {"outflow_rate_max": 1451.8714381618383, "cost2_min": -193.94848254573253, "cost1_mean": 347.27290487360625, "cost2_mean": -159.6398887699144, "system_level_velocity_mean": 13.661634168977944, "cost1_max": 413.648548027455, "cost1_min": 29.360945995674495, "cost2_max": -22.358730292054187, "outflow_rate_mean": 1187.3081756501688, "system_level_velocity_min": 10.230822752206084, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.208465053271322}, "info": {"num_steps_trained": 13117526, "load_time_ms": 16.773, "grad_time_ms": 9411.287, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015276407822966576, "total_loss": 10.742321968078613, "vf_loss": 10.746062278747559, "policy_loss": -0.008091090247035027, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.971687912940979, "entropy": 1.143386960029602}, "update_time_ms": 9.327, "num_steps_sampled": 13117526, "sample_time_ms": 17948.45}, "episode_len_mean": 676.27, "time_this_iter_s": 40.132643699645996, "num_metric_batches_dropped": 0, "timesteps_total": 13117526, "episodes_total": 4509, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54a58>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb549e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54198>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230431, "episode_reward_max": 1411.704893660184, "episodes_this_iter": 16, "time_total_s": 7944.5234405994415, "time_since_restore": 7944.5234405994415}
{"timesteps_since_restore": 13160319, "training_iteration": 299, "done": false, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_12-00-55", "episode_reward_min": 57.05893826449218, "timesteps_this_iter": 42793, "episode_reward_mean": 1155.4115393833035, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 299, "custom_metrics": {"outflow_rate_max": 1451.8714381618383, "cost2_min": -193.94848254573253, "cost1_mean": 342.5659212827202, "cost2_mean": -159.70842354131352, "system_level_velocity_mean": 13.603915318681416, "cost1_max": 413.648548027455, "cost1_min": 29.360945995674495, "cost2_max": -22.358730292054187, "outflow_rate_mean": 1182.9707558303157, "system_level_velocity_min": 10.04703492433319, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.208465053271322}, "info": {"num_steps_trained": 13160319, "load_time_ms": 17.767, "grad_time_ms": 9430.028, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013569746166467667, "total_loss": 10.802495956420898, "vf_loss": 10.806632995605469, "policy_loss": -0.008000555448234081, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9692593216896057, "entropy": 1.1610110998153687}, "update_time_ms": 9.304, "num_steps_sampled": 13160319, "sample_time_ms": 17963.263}, "episode_len_mean": 671.47, "time_this_iter_s": 24.469736576080322, "num_metric_batches_dropped": 0, "timesteps_total": 13160319, "episodes_total": 4522, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5db00>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d6d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230455, "episode_reward_max": 1411.704893660184, "episodes_this_iter": 13, "time_total_s": 7968.993177175522, "time_since_restore": 7968.993177175522}
{"timesteps_since_restore": 13202506, "training_iteration": 300, "done": true, "node_ip": "10.138.0.2", "pid": 27127, "date": "2019-05-07_12-01-21", "episode_reward_min": 57.05893826449218, "timesteps_this_iter": 42187, "episode_reward_mean": 1149.0290562237356, "experiment_id": "10a24207d86f46c488b46b8ff23e18bd", "policy_reward_mean": {}, "iterations_since_restore": 300, "custom_metrics": {"outflow_rate_max": 1451.8714381618383, "cost2_min": -193.94848254573253, "cost1_mean": 341.8043435241595, "cost2_mean": -161.1462335939848, "system_level_velocity_mean": 13.585203264250694, "cost1_max": 415.5589574190413, "cost1_min": 29.360945995674495, "cost2_max": -22.358730292054187, "outflow_rate_mean": 1180.9273746934525, "system_level_velocity_min": 10.04703492433319, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.208465053271322}, "info": {"num_steps_trained": 13202506, "load_time_ms": 17.566, "grad_time_ms": 9496.672, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01372082531452179, "total_loss": 11.120559692382812, "vf_loss": 11.126410484313965, "policy_loss": -0.009759100154042244, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9674667119979858, "entropy": 1.1691513061523438}, "update_time_ms": 9.408, "num_steps_sampled": 13202506, "sample_time_ms": 18029.205}, "episode_len_mean": 671.47, "time_this_iter_s": 26.24812936782837, "num_metric_batches_dropped": 0, "timesteps_total": 13202506, "episodes_total": 4538, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "zero_mean": true, "custom_model": null, "framestack": true, "channel_major": false, "fcnet_hiddens": [100, 50, 25], "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d860>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5dc50>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "timestamp": 1557230481, "episode_reward_max": 1411.704893660184, "episodes_this_iter": 16, "time_total_s": 7995.24130654335, "time_since_restore": 7995.24130654335}

{"timesteps_since_restore": 52535, "training_iteration": 1, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_11-55-49", "episode_reward_min": NaN, "timesteps_this_iter": 52535, "episode_reward_mean": NaN, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 30.392822980880737, "policy_reward_mean": {}, "iterations_since_restore": 1, "custom_metrics": {}, "info": {"num_steps_trained": 52535, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0006352216005325317, "total_loss": 2.045280694961548, "vf_loss": 2.0455899238586426, "policy_loss": -0.00043629901483654976, "cur_kl_coeff": 0.20000003278255463, "vf_explained_var": 0.8999412059783936, "entropy": 1.4238635301589966}, "grad_time_ms": 11928.254, "load_time_ms": 73.356, "update_time_ms": 746.643, "num_steps_sampled": 52535, "sample_time_ms": 17507.688}, "episodes_this_iter": 0, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb03c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb06a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0710>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 52535, "hostname": "flow-main", "episodes_total": 0, "timestamp": 1557230149, "episode_reward_max": NaN, "episode_len_mean": NaN, "time_total_s": 30.392822980880737, "time_since_restore": 30.392822980880737}
{"timesteps_since_restore": 98141, "training_iteration": 2, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_11-56-17", "episode_reward_min": 67.51031901491092, "timesteps_this_iter": 45606, "episode_reward_mean": 586.9112259721153, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 27.1519832611084, "policy_reward_mean": {}, "iterations_since_restore": 2, "custom_metrics": {"outflow_rate_max": 670.4191428571428, "cost2_mean": -70.91508633379406, "cost1_mean": 212.76650089368005, "system_level_velocity_mean": 8.916128355723416, "cost2_min": -102.71130285295826, "cost1_max": 278.4939720234079, "cost1_min": 33.73727033629062, "cost2_max": -7.8967202147008075, "outflow_rate_mean": 430.21978739746345, "system_level_velocity_min": 6.401500295985588, "outflow_rate_min": 164.42725714285712, "system_level_velocity_max": 18.2179902224008}, "info": {"num_steps_trained": 98141, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0018633108120411634, "total_loss": 1.7122329473495483, "vf_loss": 1.7123329639434814, "policy_loss": -0.0002863092813640833, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.9649155735969543, "entropy": 1.4321449995040894}, "grad_time_ms": 11112.922, "load_time_ms": 44.643, "update_time_ms": 378.277, "num_steps_sampled": 98141, "sample_time_ms": 17126.808}, "episodes_this_iter": 21, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb75c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfde48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7eb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 98141, "hostname": "flow-main", "episodes_total": 21, "timestamp": 1557230177, "episode_reward_max": 770.9446775573165, "episode_len_mean": 669.0952380952381, "time_total_s": 57.544806241989136, "time_since_restore": 57.544806241989136}
{"timesteps_since_restore": 149337, "training_iteration": 3, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_11-56-45", "episode_reward_min": 67.51031901491092, "timesteps_this_iter": 51196, "episode_reward_mean": 580.8213303103988, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 28.159407138824463, "policy_reward_mean": {}, "iterations_since_restore": 3, "custom_metrics": {"outflow_rate_max": 670.4191428571428, "cost2_mean": -67.40411387147311, "cost1_mean": 206.40926457235182, "system_level_velocity_mean": 8.354366111394835, "cost2_min": -102.71130285295826, "cost1_max": 278.4939720234079, "cost1_min": 33.73727033629062, "cost2_max": -7.8967202147008075, "outflow_rate_mean": 395.28622746630737, "system_level_velocity_min": 6.352181924717079, "outflow_rate_min": 138.8814285714286, "system_level_velocity_max": 18.2179902224008}, "info": {"num_steps_trained": 149337, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007486163638532162, "total_loss": 0.993440568447113, "vf_loss": 0.9949600696563721, "policy_loss": -0.001893730484880507, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.965485692024231, "entropy": 1.4268202781677246}, "grad_time_ms": 10983.669, "load_time_ms": 35.778, "update_time_ms": 254.917, "num_steps_sampled": 149337, "sample_time_ms": 17187.629}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fbe0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 149337, "hostname": "flow-main", "episodes_total": 35, "timestamp": 1557230205, "episode_reward_max": 770.9446775573165, "episode_len_mean": 681.4571428571429, "time_total_s": 85.7042133808136, "time_since_restore": 85.7042133808136}
{"timesteps_since_restore": 194994, "training_iteration": 4, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_11-57-10", "episode_reward_min": 58.724050538634714, "timesteps_this_iter": 45657, "episode_reward_mean": 577.1229514098663, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.60747194290161, "policy_reward_mean": {}, "iterations_since_restore": 4, "custom_metrics": {"outflow_rate_max": 670.4191428571428, "cost2_mean": -66.42645009042197, "cost1_mean": 203.80485455217, "system_level_velocity_mean": 8.580062429617598, "cost2_min": -102.71130285295826, "cost1_max": 278.4939720234079, "cost1_min": 33.13144123565843, "cost2_max": -7.8967202147008075, "outflow_rate_mean": 398.97906630098305, "system_level_velocity_min": 6.352181924717079, "outflow_rate_min": 138.8814285714286, "system_level_velocity_max": 18.66058487299931}, "info": {"num_steps_trained": 194994, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009451882913708687, "total_loss": 1.476493239402771, "vf_loss": 1.4804574251174927, "policy_loss": -0.004436615854501724, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9785396456718445, "entropy": 1.4237178564071655}, "grad_time_ms": 10706.162, "load_time_ms": 30.403, "update_time_ms": 193.365, "num_steps_sampled": 194994, "sample_time_ms": 16798.129}, "episodes_this_iter": 7, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 194994, "hostname": "flow-main", "episodes_total": 42, "timestamp": 1557230230, "episode_reward_max": 770.9446775573165, "episode_len_mean": 669.0714285714286, "time_total_s": 111.31168532371521, "time_since_restore": 111.31168532371521}
{"timesteps_since_restore": 238422, "training_iteration": 5, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_11-57-36", "episode_reward_min": 58.724050538634714, "timesteps_this_iter": 43428, "episode_reward_mean": 569.6990969064564, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.215243339538574, "policy_reward_mean": {}, "iterations_since_restore": 5, "custom_metrics": {"outflow_rate_max": 670.4191428571428, "cost2_mean": -59.58611613606984, "cost1_mean": 196.18759703549904, "system_level_velocity_mean": 8.043389251741685, "cost2_min": -102.71130285295826, "cost1_max": 278.4939720234079, "cost1_min": 33.13144123565843, "cost2_max": -7.8967202147008075, "outflow_rate_mean": 401.59462734258835, "system_level_velocity_min": 5.597582866758744, "outflow_rate_min": 138.8814285714286, "system_level_velocity_max": 18.66058487299931}, "info": {"num_steps_trained": 238422, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011706462129950523, "total_loss": 2.6392340660095215, "vf_loss": 2.643883466720581, "policy_loss": -0.0052346098236739635, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9640302062034607, "entropy": 1.4044438600540161}, "grad_time_ms": 10300.633, "load_time_ms": 26.785, "update_time_ms": 156.187, "num_steps_sampled": 238422, "sample_time_ms": 16727.55}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 238422, "hostname": "flow-main", "episodes_total": 59, "timestamp": 1557230256, "episode_reward_max": 770.9446775573165, "episode_len_mean": 677.9830508474577, "time_total_s": 136.52692866325378, "time_since_restore": 136.52692866325378}
{"timesteps_since_restore": 281737, "training_iteration": 6, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_11-58-02", "episode_reward_min": 58.724050538634714, "timesteps_this_iter": 43315, "episode_reward_mean": 591.8000758089894, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 26.657259702682495, "policy_reward_mean": {}, "iterations_since_restore": 6, "custom_metrics": {"outflow_rate_max": 670.4191428571428, "cost2_mean": -54.01803678294187, "cost1_mean": 196.1703462330688, "system_level_velocity_mean": 7.888651319465424, "cost2_min": -102.71130285295826, "cost1_max": 278.4939720234079, "cost1_min": 33.13144123565843, "cost2_max": -7.8967202147008075, "outflow_rate_mean": 423.28115527363457, "system_level_velocity_min": 5.5754125601091475, "outflow_rate_min": 138.8814285714286, "system_level_velocity_max": 18.66058487299931}, "info": {"num_steps_trained": 281737, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011205215007066727, "total_loss": 3.7202329635620117, "vf_loss": 3.723567008972168, "policy_loss": -0.003894106252118945, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9278982281684875, "entropy": 1.378920555114746}, "grad_time_ms": 10088.444, "load_time_ms": 24.432, "update_time_ms": 131.212, "num_steps_sampled": 281737, "sample_time_ms": 16862.05}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5deb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d198>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 281737, "hostname": "flow-main", "episodes_total": 77, "timestamp": 1557230282, "episode_reward_max": 770.9446775573165, "episode_len_mean": 683.1298701298701, "time_total_s": 163.18418836593628, "time_since_restore": 163.18418836593628}
{"timesteps_since_restore": 326238, "training_iteration": 7, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_11-58-27", "episode_reward_min": 58.724050538634714, "timesteps_this_iter": 44501, "episode_reward_mean": 605.448058976957, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.109264135360718, "policy_reward_mean": {}, "iterations_since_restore": 7, "custom_metrics": {"outflow_rate_max": 670.4191428571428, "cost2_mean": -51.552595091651035, "cost1_mean": 196.4472618564001, "system_level_velocity_mean": 7.841106753329741, "cost2_min": -102.71130285295826, "cost1_max": 278.4939720234079, "cost1_min": 33.13144123565843, "cost2_max": -7.8967202147008075, "outflow_rate_mean": 435.26700845928406, "system_level_velocity_min": 5.5754125601091475, "outflow_rate_min": 138.8814285714286, "system_level_velocity_max": 18.66058487299931}, "info": {"num_steps_trained": 326238, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011649726890027523, "total_loss": 2.959312915802002, "vf_loss": 2.961757183074951, "policy_loss": -0.0030268626287579536, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9451428651809692, "entropy": 1.371042251586914}, "grad_time_ms": 9863.045, "load_time_ms": 22.733, "update_time_ms": 113.441, "num_steps_sampled": 326238, "sample_time_ms": 16809.761}, "episodes_this_iter": 9, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c7f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 326238, "hostname": "flow-main", "episodes_total": 86, "timestamp": 1557230307, "episode_reward_max": 790.6376092423691, "episode_len_mean": 684.8953488372093, "time_total_s": 188.293452501297, "time_since_restore": 188.293452501297}
{"timesteps_since_restore": 371271, "training_iteration": 8, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_11-58-56", "episode_reward_min": 58.724050538634714, "timesteps_this_iter": 45033, "episode_reward_mean": 662.2450027430806, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 28.69137740135193, "policy_reward_mean": {}, "iterations_since_restore": 8, "custom_metrics": {"outflow_rate_max": 803.8046493506494, "cost2_mean": -46.87789332221635, "cost1_mean": 200.86924358811234, "system_level_velocity_mean": 7.913345621659197, "cost2_min": -89.0062622590639, "cost1_max": 278.4939720234079, "cost1_min": 33.13144123565843, "cost2_max": -7.8967202147008075, "outflow_rate_mean": 484.7712843658933, "system_level_velocity_min": 5.5754125601091475, "outflow_rate_min": 138.8814285714286, "system_level_velocity_max": 18.66058487299931}, "info": {"num_steps_trained": 371271, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007576160132884979, "total_loss": 6.642916202545166, "vf_loss": 6.643517017364502, "policy_loss": -0.0009793071076273918, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.881373941898346, "entropy": 1.364411473274231}, "grad_time_ms": 9798.208, "load_time_ms": 21.507, "update_time_ms": 100.143, "num_steps_sampled": 371271, "sample_time_ms": 17114.769}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cf28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ce48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 371271, "hostname": "flow-main", "episodes_total": 105, "timestamp": 1557230336, "episode_reward_max": 1025.1163350770878, "episode_len_mean": 687.01, "time_total_s": 216.98482990264893, "time_since_restore": 216.98482990264893}
{"timesteps_since_restore": 414356, "training_iteration": 9, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_11-59-24", "episode_reward_min": 58.724050538634714, "timesteps_this_iter": 43085, "episode_reward_mean": 719.102960626438, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 27.597251892089844, "policy_reward_mean": {}, "iterations_since_restore": 9, "custom_metrics": {"outflow_rate_max": 941.7780467532468, "cost2_mean": -41.81226385239117, "cost1_mean": 205.39943319484775, "system_level_velocity_mean": 7.877182799494067, "cost2_min": -89.0062622590639, "cost1_max": 266.1819191867437, "cost1_min": 33.13144123565843, "cost2_max": -10.898025088643582, "outflow_rate_mean": 533.9430144669716, "system_level_velocity_min": 5.5754125601091475, "outflow_rate_min": 138.8814285714286, "system_level_velocity_max": 18.66058487299931}, "info": {"num_steps_trained": 414356, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00941560324281454, "total_loss": 6.128261089324951, "vf_loss": 6.130141258239746, "policy_loss": -0.002350919647142291, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.8706820607185364, "entropy": 1.3489474058151245}, "grad_time_ms": 9832.271, "load_time_ms": 20.444, "update_time_ms": 89.815, "num_steps_sampled": 414356, "sample_time_ms": 17145.54}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5dc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f94611464e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 414356, "hostname": "flow-main", "episodes_total": 119, "timestamp": 1557230364, "episode_reward_max": 1096.5484978041684, "episode_len_mean": 693.5, "time_total_s": 244.58208179473877, "time_since_restore": 244.58208179473877}
{"timesteps_since_restore": 458675, "training_iteration": 10, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-00-08", "episode_reward_min": 58.724050538634714, "timesteps_this_iter": 44319, "episode_reward_mean": 755.8725656374596, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 43.83466911315918, "policy_reward_mean": {}, "iterations_since_restore": 10, "custom_metrics": {"outflow_rate_max": 941.7780467532468, "cost2_mean": -38.44922550835305, "cost1_mean": 210.8093208418295, "system_level_velocity_mean": 8.053357322595879, "cost2_min": -89.0062622590639, "cost1_max": 280.69551771843345, "cost1_min": 33.13144123565843, "cost2_max": -10.898025088643582, "outflow_rate_mean": 578.5342415838546, "system_level_velocity_min": 5.5754125601091475, "outflow_rate_min": 286.40485714285717, "system_level_velocity_max": 18.66058487299931}, "info": {"num_steps_trained": 458675, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009371536783874035, "total_loss": 5.237818241119385, "vf_loss": 5.23953914642334, "policy_loss": -0.002189365914091468, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9146363139152527, "entropy": 1.3387027978897095}, "grad_time_ms": 10510.966, "load_time_ms": 23.267, "update_time_ms": 81.654, "num_steps_sampled": 458675, "sample_time_ms": 18126.708}, "episodes_this_iter": 9, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb542e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 458675, "hostname": "flow-main", "episodes_total": 128, "timestamp": 1557230408, "episode_reward_max": 1096.5484978041684, "episode_len_mean": 693.5, "time_total_s": 288.41675090789795, "time_since_restore": 288.41675090789795}
{"timesteps_since_restore": 501012, "training_iteration": 11, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-00-38", "episode_reward_min": 425.81285052076845, "timesteps_this_iter": 42337, "episode_reward_mean": 853.5819709236671, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 30.020427942276, "policy_reward_mean": {}, "iterations_since_restore": 11, "custom_metrics": {"outflow_rate_max": 1024.8622181818182, "cost2_mean": -34.33501236132366, "cost1_mean": 228.83483569708085, "system_level_velocity_mean": 8.513652406220581, "cost2_min": -67.61657481818985, "cost1_max": 312.8768508140374, "cost1_min": 147.15405752203975, "cost2_max": -17.16912614155608, "outflow_rate_mean": 678.0818334905096, "system_level_velocity_min": 5.5754125601091475, "outflow_rate_min": 319.2342857142857, "system_level_velocity_max": 11.594194672901471}, "info": {"num_steps_trained": 501012, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008163911290466785, "total_loss": 10.141702651977539, "vf_loss": 10.143028259277344, "policy_loss": -0.0017347647808492184, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.8780242204666138, "entropy": 1.3184934854507446}, "grad_time_ms": 10281.778, "load_time_ms": 19.614, "update_time_ms": 8.319, "num_steps_sampled": 501012, "sample_time_ms": 18401.267}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbe48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 501012, "hostname": "flow-main", "episodes_total": 147, "timestamp": 1557230438, "episode_reward_max": 1200.0294748544825, "episode_len_mean": 700.0, "time_total_s": 318.43717885017395, "time_since_restore": 318.43717885017395}
{"timesteps_since_restore": 543772, "training_iteration": 12, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-01-03", "episode_reward_min": 571.1934120688604, "timesteps_this_iter": 42760, "episode_reward_mean": 947.7561468090431, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.250319004058838, "policy_reward_mean": {}, "iterations_since_restore": 12, "custom_metrics": {"outflow_rate_max": 1201.6897926073927, "cost2_mean": -32.979293224465216, "cost1_mean": 249.39375307387334, "system_level_velocity_mean": 9.248295463902332, "cost2_min": -54.82106233674239, "cost1_max": 327.3516929603867, "cost1_min": 147.15405752203975, "cost2_max": -17.16912614155608, "outflow_rate_mean": 772.8704024655343, "system_level_velocity_min": 5.5754125601091475, "outflow_rate_min": 391.80971428571434, "system_level_velocity_max": 12.112078015923926}, "info": {"num_steps_trained": 543772, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009189266711473465, "total_loss": 8.886090278625488, "vf_loss": 8.888200759887695, "policy_loss": -0.0025694435462355614, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9110366702079773, "entropy": 1.3203659057617188}, "grad_time_ms": 10259.694, "load_time_ms": 19.195, "update_time_ms": 8.028, "num_steps_sampled": 543772, "sample_time_ms": 18234.538}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cf60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c978>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 543772, "hostname": "flow-main", "episodes_total": 164, "timestamp": 1557230463, "episode_reward_max": 1244.009609372011, "episode_len_mean": 700.0, "time_total_s": 343.6874978542328, "time_since_restore": 343.6874978542328}
{"timesteps_since_restore": 587547, "training_iteration": 13, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-01-28", "episode_reward_min": 238.95070245518534, "timesteps_this_iter": 43775, "episode_reward_mean": 1009.008096774061, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.25459885597229, "policy_reward_mean": {}, "iterations_since_restore": 13, "custom_metrics": {"outflow_rate_max": 1201.6897926073927, "cost2_mean": -33.07345206435355, "cost1_mean": 265.4374766602167, "system_level_velocity_mean": 9.964281138619246, "cost2_min": -54.82106233674239, "cost1_max": 345.6473412829108, "cost1_min": 98.64148127078414, "cost2_max": -17.16912614155608, "outflow_rate_mean": 846.4247221186928, "system_level_velocity_min": 6.457631786942337, "outflow_rate_min": 470.7214285714286, "system_level_velocity_max": 17.539692990943767}, "info": {"num_steps_trained": 587547, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009005608037114143, "total_loss": 6.804470062255859, "vf_loss": 6.805815696716309, "policy_loss": -0.0017964616417884827, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9501921534538269, "entropy": 1.3363474607467651}, "grad_time_ms": 10158.114, "load_time_ms": 19.825, "update_time_ms": 7.926, "num_steps_sampled": 587547, "sample_time_ms": 18047.367}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf1d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 587547, "hostname": "flow-main", "episodes_total": 180, "timestamp": 1557230488, "episode_reward_max": 1292.7907767907668, "episode_len_mean": 694.5, "time_total_s": 368.9420967102051, "time_since_restore": 368.9420967102051}
{"timesteps_since_restore": 632416, "training_iteration": 14, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-01-53", "episode_reward_min": 238.95070245518534, "timesteps_this_iter": 44869, "episode_reward_mean": 1053.7599918925134, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.22662329673767, "policy_reward_mean": {}, "iterations_since_restore": 14, "custom_metrics": {"outflow_rate_max": 1233.744883916084, "cost2_mean": -33.90324965138509, "cost1_mean": 280.8529766243562, "system_level_velocity_mean": 10.541842405277041, "cost2_min": -48.9624676534134, "cost1_max": 366.9735016557614, "cost1_min": 98.64148127078414, "cost2_max": -18.45173152941731, "outflow_rate_mean": 902.9912140667448, "system_level_velocity_min": 7.604769716215927, "outflow_rate_min": 526.0448776035448, "system_level_velocity_max": 17.539692990943767}, "info": {"num_steps_trained": 632416, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010731147602200508, "total_loss": 6.272705554962158, "vf_loss": 6.2754316329956055, "policy_loss": -0.0032621268182992935, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.952086329460144, "entropy": 1.3137497901916504}, "grad_time_ms": 10260.72, "load_time_ms": 19.576, "update_time_ms": 7.668, "num_steps_sampled": 632416, "sample_time_ms": 17808.139}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 632416, "hostname": "flow-main", "episodes_total": 195, "timestamp": 1557230513, "episode_reward_max": 1341.377999747169, "episode_len_mean": 694.5, "time_total_s": 393.16872000694275, "time_since_restore": 393.16872000694275}
{"timesteps_since_restore": 677708, "training_iteration": 15, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-02-17", "episode_reward_min": 58.23053311966497, "timesteps_this_iter": 45292, "episode_reward_mean": 1072.3721948542543, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.19642734527588, "policy_reward_mean": {}, "iterations_since_restore": 15, "custom_metrics": {"outflow_rate_max": 1233.744883916084, "cost2_mean": -34.13754201911236, "cost1_mean": 289.1120877478411, "system_level_velocity_mean": 11.034913921519637, "cost2_min": -46.846071566598184, "cost1_max": 366.9735016557614, "cost1_min": 31.102691186575793, "cost2_max": -13.749747772823826, "outflow_rate_mean": 935.2897846561538, "system_level_velocity_min": 8.286697999768768, "outflow_rate_min": 336.6490541456901, "system_level_velocity_max": 19.348168029636437}, "info": {"num_steps_trained": 677708, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008592233993113041, "total_loss": 6.248287677764893, "vf_loss": 6.2492594718933105, "policy_loss": -0.0014012833125889301, "cur_kl_coeff": 0.05000000447034836, "vf_explained_var": 0.9522653818130493, "entropy": 1.3127691745758057}, "grad_time_ms": 10475.6, "load_time_ms": 19.59, "update_time_ms": 7.98, "num_steps_sampled": 677708, "sample_time_ms": 17489.936}, "episodes_this_iter": 12, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfde48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 677708, "hostname": "flow-main", "episodes_total": 207, "timestamp": 1557230537, "episode_reward_max": 1341.377999747169, "episode_len_mean": 687.96, "time_total_s": 417.3651473522186, "time_since_restore": 417.3651473522186}
{"timesteps_since_restore": 720753, "training_iteration": 16, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-02-41", "episode_reward_min": 58.23053311966497, "timesteps_this_iter": 43045, "episode_reward_mean": 1101.8768974387076, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.051145792007446, "policy_reward_mean": {}, "iterations_since_restore": 16, "custom_metrics": {"outflow_rate_max": 1233.744883916084, "cost2_mean": -34.29216482207906, "cost1_mean": 300.86491252805985, "system_level_velocity_mean": 11.4896495954051, "cost2_min": -46.846071566598184, "cost1_max": 366.9735016557614, "cost1_min": 31.102691186575793, "cost2_max": -13.749747772823826, "outflow_rate_mean": 968.5191235612485, "system_level_velocity_min": 8.560611692520345, "outflow_rate_min": 336.6490541456901, "system_level_velocity_max": 19.348168029636437}, "info": {"num_steps_trained": 720753, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006663630250841379, "total_loss": 6.289113521575928, "vf_loss": 6.289775848388672, "policy_loss": -0.0009966986253857613, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9635186791419983, "entropy": 1.3186873197555542}, "grad_time_ms": 10649.644, "load_time_ms": 19.567, "update_time_ms": 8.114, "num_steps_sampled": 720753, "sample_time_ms": 17054.28}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6e48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 720753, "hostname": "flow-main", "episodes_total": 222, "timestamp": 1557230561, "episode_reward_max": 1341.377999747169, "episode_len_mean": 687.96, "time_total_s": 441.4162931442261, "time_since_restore": 441.4162931442261}
{"timesteps_since_restore": 761576, "training_iteration": 17, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-03-04", "episode_reward_min": 58.23053311966497, "timesteps_this_iter": 40823, "episode_reward_mean": 1119.0006151201183, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.14495325088501, "policy_reward_mean": {}, "iterations_since_restore": 17, "custom_metrics": {"outflow_rate_max": 1233.744883916084, "cost2_mean": -34.005968645663344, "cost1_mean": 309.7991763587725, "system_level_velocity_mean": 11.84962997668645, "cost2_min": -46.846071566598184, "cost1_max": 366.9735016557614, "cost1_min": 31.102691186575793, "cost2_max": -13.749747772823826, "outflow_rate_mean": 995.6021530397699, "system_level_velocity_min": 9.37911883305012, "outflow_rate_min": 336.6490541456901, "system_level_velocity_max": 19.348168029636437}, "info": {"num_steps_trained": 761576, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00798327848315239, "total_loss": 9.472915649414062, "vf_loss": 9.474311828613281, "policy_loss": -0.0017933774506673217, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9456921219825745, "entropy": 1.3139346837997437}, "grad_time_ms": 10792.994, "load_time_ms": 19.657, "update_time_ms": 8.264, "num_steps_sampled": 761576, "sample_time_ms": 16715.517}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f94611509e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461150d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f94611506d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 761576, "hostname": "flow-main", "episodes_total": 241, "timestamp": 1557230584, "episode_reward_max": 1341.377999747169, "episode_len_mean": 687.96, "time_total_s": 464.5612463951111, "time_since_restore": 464.5612463951111}
{"timesteps_since_restore": 805693, "training_iteration": 18, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-03-29", "episode_reward_min": 58.23053311966497, "timesteps_this_iter": 44117, "episode_reward_mean": 1131.2108321588964, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.875873804092407, "policy_reward_mean": {}, "iterations_since_restore": 18, "custom_metrics": {"outflow_rate_max": 1233.744883916084, "cost2_mean": -33.709259443111534, "cost1_mean": 314.58793501823595, "system_level_velocity_mean": 12.035393289725498, "cost2_min": -46.846071566598184, "cost1_max": 366.9735016557614, "cost1_min": 31.102691186575793, "cost2_max": -13.749747772823826, "outflow_rate_mean": 1012.4590673814284, "system_level_velocity_min": 9.37911883305012, "outflow_rate_min": 336.6490541456901, "system_level_velocity_max": 19.348168029636437}, "info": {"num_steps_trained": 805693, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006831181701272726, "total_loss": 6.185057163238525, "vf_loss": 6.185631275177002, "policy_loss": -0.0009161351481452584, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.956701397895813, "entropy": 1.3135956525802612}, "grad_time_ms": 10952.575, "load_time_ms": 20.113, "update_time_ms": 8.354, "num_steps_sampled": 805693, "sample_time_ms": 16172.526}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461150be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7b00>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 805693, "hostname": "flow-main", "episodes_total": 255, "timestamp": 1557230609, "episode_reward_max": 1341.377999747169, "episode_len_mean": 687.96, "time_total_s": 489.4371201992035, "time_since_restore": 489.4371201992035}
{"timesteps_since_restore": 849340, "training_iteration": 19, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-03-52", "episode_reward_min": 58.23053311966497, "timesteps_this_iter": 43647, "episode_reward_mean": 1130.7158797609634, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.789933443069458, "policy_reward_mean": {}, "iterations_since_restore": 19, "custom_metrics": {"outflow_rate_max": 1233.744883916084, "cost2_mean": -33.16951802157129, "cost1_mean": 314.69721277261476, "system_level_velocity_mean": 12.22477989223845, "cost2_min": -46.846071566598184, "cost1_max": 366.9735016557614, "cost1_min": 31.102691186575793, "cost2_max": -10.198055200059713, "outflow_rate_mean": 1011.4981134887597, "system_level_velocity_min": 9.37911883305012, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.348168029636437}, "info": {"num_steps_trained": 849340, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010336268693208694, "total_loss": 6.791171550750732, "vf_loss": 6.793567657470703, "policy_loss": -0.0029120445251464844, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.959514319896698, "entropy": 1.2842837572097778}, "grad_time_ms": 10782.466, "load_time_ms": 20.279, "update_time_ms": 8.206, "num_steps_sampled": 849340, "sample_time_ms": 15862.308}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d5f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 849340, "hostname": "flow-main", "episodes_total": 269, "timestamp": 1557230632, "episode_reward_max": 1341.377999747169, "episode_len_mean": 681.46, "time_total_s": 512.227053642273, "time_since_restore": 512.227053642273}
{"timesteps_since_restore": 894611, "training_iteration": 20, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-04-15", "episode_reward_min": 58.23053311966497, "timesteps_this_iter": 45271, "episode_reward_mean": 1154.5919308846476, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.945241689682007, "policy_reward_mean": {}, "iterations_since_restore": 20, "custom_metrics": {"outflow_rate_max": 1233.744883916084, "cost2_mean": -32.60599173053864, "cost1_mean": 319.70866904596784, "system_level_velocity_mean": 12.277352006412876, "cost2_min": -46.846071566598184, "cost1_max": 366.9735016557614, "cost1_min": 31.102691186575793, "cost2_max": -10.198055200059713, "outflow_rate_mean": 1025.7536365009357, "system_level_velocity_min": 9.57020970361534, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.348168029636437}, "info": {"num_steps_trained": 894611, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007452644407749176, "total_loss": 6.0873942375183105, "vf_loss": 6.088763236999512, "policy_loss": -0.0017425984842702746, "cur_kl_coeff": 0.05000000447034836, "vf_explained_var": 0.9673454761505127, "entropy": 1.2807800769805908}, "grad_time_ms": 9948.831, "load_time_ms": 17.05, "update_time_ms": 8.03, "num_steps_sampled": 894611, "sample_time_ms": 14622.949}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc915f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91080>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 894611, "hostname": "flow-main", "episodes_total": 285, "timestamp": 1557230655, "episode_reward_max": 1358.8346488953487, "episode_len_mean": 686.96, "time_total_s": 535.172295331955, "time_since_restore": 535.172295331955}
{"timesteps_since_restore": 937948, "training_iteration": 21, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-04-37", "episode_reward_min": 58.23053311966497, "timesteps_this_iter": 43337, "episode_reward_mean": 1163.7355383755144, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.607099294662476, "policy_reward_mean": {}, "iterations_since_restore": 21, "custom_metrics": {"outflow_rate_max": 1277.091741058941, "cost2_mean": -32.55846723996521, "cost1_mean": 321.6095298171187, "system_level_velocity_mean": 12.356485682741756, "cost2_min": -46.846071566598184, "cost1_max": 384.6510514183415, "cost1_min": 31.102691186575793, "cost2_max": -10.198055200059713, "outflow_rate_mean": 1033.7849717257113, "system_level_velocity_min": 10.228259639838011, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.348168029636437}, "info": {"num_steps_trained": 937948, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00838523730635643, "total_loss": 4.080618381500244, "vf_loss": 4.082723140716553, "policy_loss": -0.002523744245991111, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9818732738494873, "entropy": 1.258762001991272}, "grad_time_ms": 9948.56, "load_time_ms": 14.718, "update_time_ms": 7.281, "num_steps_sampled": 937948, "sample_time_ms": 13885.414}, "episodes_this_iter": 12, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91dd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 937948, "hostname": "flow-main", "episodes_total": 297, "timestamp": 1557230677, "episode_reward_max": 1358.8346488953487, "episode_len_mean": 686.96, "time_total_s": 557.7793946266174, "time_since_restore": 557.7793946266174}
{"timesteps_since_restore": 982126, "training_iteration": 22, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-05-03", "episode_reward_min": 65.3069643400351, "timesteps_this_iter": 44178, "episode_reward_mean": 1182.238508017982, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.268153190612793, "policy_reward_mean": {}, "iterations_since_restore": 22, "custom_metrics": {"outflow_rate_max": 1288.749878921079, "cost2_mean": -33.643455422687424, "cost1_mean": 327.68627243476834, "system_level_velocity_mean": 12.410565401927581, "cost2_min": -59.88244024988721, "cost1_max": 389.5848072744076, "cost1_min": 33.548050994159055, "cost2_max": -10.198055200059713, "outflow_rate_mean": 1055.5441292521864, "system_level_velocity_min": 10.013641099450565, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.613981926917017}, "info": {"num_steps_trained": 982126, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008849038742482662, "total_loss": 3.8788959980010986, "vf_loss": 3.880650520324707, "policy_loss": -0.0021969438530504704, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9853575825691223, "entropy": 1.2832967042922974}, "grad_time_ms": 10003.577, "load_time_ms": 15.106, "update_time_ms": 7.281, "num_steps_sampled": 982126, "sample_time_ms": 13831.175}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf02e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 982126, "hostname": "flow-main", "episodes_total": 314, "timestamp": 1557230703, "episode_reward_max": 1423.138047827813, "episode_len_mean": 693.5, "time_total_s": 583.0475478172302, "time_since_restore": 583.0475478172302}
{"timesteps_since_restore": 1024966, "training_iteration": 23, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-05-28", "episode_reward_min": 65.3069643400351, "timesteps_this_iter": 42840, "episode_reward_mean": 1184.99811776871, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.34618854522705, "policy_reward_mean": {}, "iterations_since_restore": 23, "custom_metrics": {"outflow_rate_max": 1288.749878921079, "cost2_mean": -34.04713764962034, "cost1_mean": 329.26514992622646, "system_level_velocity_mean": 12.472997573316228, "cost2_min": -59.88244024988721, "cost1_max": 389.5848072744076, "cost1_min": 33.548050994159055, "cost2_max": -10.198055200059713, "outflow_rate_mean": 1061.9681785548837, "system_level_velocity_min": 10.013641099450565, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.613981926917017}, "info": {"num_steps_trained": 1024966, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008651906624436378, "total_loss": 3.898773431777954, "vf_loss": 3.9006102085113525, "policy_loss": -0.0022696980740875006, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9859065413475037, "entropy": 1.2555296421051025}, "grad_time_ms": 10090.806, "load_time_ms": 14.05, "update_time_ms": 7.232, "num_steps_sampled": 1024966, "sample_time_ms": 13753.432}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91eb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1024966, "hostname": "flow-main", "episodes_total": 329, "timestamp": 1557230728, "episode_reward_max": 1423.138047827813, "episode_len_mean": 693.5, "time_total_s": 608.3937363624573, "time_since_restore": 608.3937363624573}
{"timesteps_since_restore": 1069841, "training_iteration": 24, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-05-54", "episode_reward_min": 60.91532138584961, "timesteps_this_iter": 44875, "episode_reward_mean": 1174.5654380188375, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 26.169161081314087, "policy_reward_mean": {}, "iterations_since_restore": 24, "custom_metrics": {"outflow_rate_max": 1332.4558785214783, "cost2_mean": -34.278049141034536, "cost1_mean": 326.88302560082826, "system_level_velocity_mean": 12.694006339152484, "cost2_min": -59.88244024988721, "cost1_max": 419.4824294416734, "cost1_min": 33.548050994159055, "cost2_max": -10.198055200059713, "outflow_rate_mean": 1059.6401603600277, "system_level_velocity_min": 10.013641099450565, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 18.613981926917017}, "info": {"num_steps_trained": 1069841, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010433287359774113, "total_loss": 7.378532886505127, "vf_loss": 7.379443168640137, "policy_loss": -0.0014323331415653229, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9646883606910706, "entropy": 1.23771333694458}, "grad_time_ms": 10004.181, "load_time_ms": 14.27, "update_time_ms": 7.357, "num_steps_sampled": 1069841, "sample_time_ms": 14032.658}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1069841, "hostname": "flow-main", "episodes_total": 343, "timestamp": 1557230754, "episode_reward_max": 1423.138047827813, "episode_len_mean": 681.74, "time_total_s": 634.5628974437714, "time_since_restore": 634.5628974437714}
{"timesteps_since_restore": 1113160, "training_iteration": 25, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-06-21", "episode_reward_min": 60.91532138584961, "timesteps_this_iter": 43319, "episode_reward_mean": 1175.1541517428661, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 26.832200288772583, "policy_reward_mean": {}, "iterations_since_restore": 25, "custom_metrics": {"outflow_rate_max": 1332.4558785214783, "cost2_mean": -34.406299717550574, "cost1_mean": 326.57591990236085, "system_level_velocity_mean": 12.691033048315665, "cost2_min": -59.88244024988721, "cost1_max": 419.4824294416734, "cost1_min": 33.548050994159055, "cost2_max": -10.198055200059713, "outflow_rate_mean": 1055.8835262701175, "system_level_velocity_min": 10.013641099450565, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 18.613981926917017}, "info": {"num_steps_trained": 1113160, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012265536934137344, "total_loss": 6.31201171875, "vf_loss": 6.314998626708984, "policy_loss": -0.003600268391892314, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9716488122940063, "entropy": 1.2287386655807495}, "grad_time_ms": 9906.436, "load_time_ms": 14.44, "update_time_ms": 7.015, "num_steps_sampled": 1113160, "sample_time_ms": 14393.735}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91080>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1113160, "hostname": "flow-main", "episodes_total": 359, "timestamp": 1557230781, "episode_reward_max": 1423.138047827813, "episode_len_mean": 681.74, "time_total_s": 661.395097732544, "time_since_restore": 661.395097732544}
{"timesteps_since_restore": 1155049, "training_iteration": 26, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-06-47", "episode_reward_min": 50.423672240054145, "timesteps_this_iter": 41889, "episode_reward_mean": 1153.114623519707, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.8381507396698, "policy_reward_mean": {}, "iterations_since_restore": 26, "custom_metrics": {"outflow_rate_max": 1332.4558785214783, "cost2_mean": -33.83833285895942, "cost1_mean": 323.4693837591126, "system_level_velocity_mean": 12.916386333283219, "cost2_min": -59.88244024988721, "cost1_max": 419.4824294416734, "cost1_min": 28.560533225877403, "cost2_max": -9.229249584892322, "outflow_rate_mean": 1050.7227834402102, "system_level_velocity_min": 10.013641099450565, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 19.212071984937207}, "info": {"num_steps_trained": 1155049, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008377740159630775, "total_loss": 13.859406471252441, "vf_loss": 13.860330581665039, "policy_loss": -0.0013432656414806843, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9293136596679688, "entropy": 1.1972249746322632}, "grad_time_ms": 9803.955, "load_time_ms": 14.837, "update_time_ms": 7.041, "num_steps_sampled": 1155049, "sample_time_ms": 14674.194}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1155049, "hostname": "flow-main", "episodes_total": 377, "timestamp": 1557230807, "episode_reward_max": 1423.138047827813, "episode_len_mean": 669.5, "time_total_s": 687.2332484722137, "time_since_restore": 687.2332484722137}
{"timesteps_since_restore": 1196824, "training_iteration": 27, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-07-12", "episode_reward_min": 50.423672240054145, "timesteps_this_iter": 41775, "episode_reward_mean": 1162.1636798799843, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.689143657684326, "policy_reward_mean": {}, "iterations_since_restore": 27, "custom_metrics": {"outflow_rate_max": 1348.4217962037962, "cost2_mean": -33.961418297621364, "cost1_mean": 328.10612989189957, "system_level_velocity_mean": 13.107814626239053, "cost2_min": -59.88244024988721, "cost1_max": 419.4824294416734, "cost1_min": 28.560533225877403, "cost2_max": -9.229249584892322, "outflow_rate_mean": 1066.981159472178, "system_level_velocity_min": 10.013641099450565, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 19.212071984937207}, "info": {"num_steps_trained": 1196824, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009767694398760796, "total_loss": 8.794808387756348, "vf_loss": 8.797313690185547, "policy_loss": -0.0029944689013063908, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9594422578811646, "entropy": 1.224432349205017}, "grad_time_ms": 9767.811, "load_time_ms": 14.815, "update_time_ms": 6.889, "num_steps_sampled": 1196824, "sample_time_ms": 14863.089}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc914e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91dd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1196824, "hostname": "flow-main", "episodes_total": 393, "timestamp": 1557230832, "episode_reward_max": 1423.138047827813, "episode_len_mean": 669.5, "time_total_s": 711.9223921298981, "time_since_restore": 711.9223921298981}
{"timesteps_since_restore": 1239419, "training_iteration": 28, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-07-38", "episode_reward_min": 50.423672240054145, "timesteps_this_iter": 42595, "episode_reward_mean": 1143.141195001838, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 26.256660223007202, "policy_reward_mean": {}, "iterations_since_restore": 28, "custom_metrics": {"outflow_rate_max": 1348.4217962037962, "cost2_mean": -31.838951249876374, "cost1_mean": 324.7855496173509, "system_level_velocity_mean": 13.288603021529656, "cost2_min": -40.393607490864895, "cost1_max": 419.4824294416734, "cost1_min": 28.560533225877403, "cost2_max": -9.229249584892322, "outflow_rate_mean": 1058.1876077988177, "system_level_velocity_min": 10.16714552695967, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 19.212071984937207}, "info": {"num_steps_trained": 1239419, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010708408430218697, "total_loss": 10.5643310546875, "vf_loss": 10.566056251525879, "policy_loss": -0.0022601692471653223, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9576256275177002, "entropy": 1.2186059951782227}, "grad_time_ms": 9762.708, "load_time_ms": 14.466, "update_time_ms": 6.894, "num_steps_sampled": 1239419, "sample_time_ms": 15007.143}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5db38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d550>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1239419, "hostname": "flow-main", "episodes_total": 411, "timestamp": 1557230858, "episode_reward_max": 1367.0214783183114, "episode_len_mean": 658.91, "time_total_s": 738.1790523529053, "time_since_restore": 738.1790523529053}
{"timesteps_since_restore": 1283987, "training_iteration": 29, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-08-05", "episode_reward_min": 50.423672240054145, "timesteps_this_iter": 44568, "episode_reward_mean": 1155.6118828598937, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 26.549540758132935, "policy_reward_mean": {}, "iterations_since_restore": 29, "custom_metrics": {"outflow_rate_max": 1348.4217962037962, "cost2_mean": -30.83075206911172, "cost1_mean": 326.75200048674617, "system_level_velocity_mean": 13.371829341940689, "cost2_min": -40.393607490864895, "cost1_max": 419.4824294416734, "cost1_min": 28.560533225877403, "cost2_max": -9.229249584892322, "outflow_rate_mean": 1070.1310851294868, "system_level_velocity_min": 10.16714552695967, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 19.212071984937207}, "info": {"num_steps_trained": 1283987, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008740861900150776, "total_loss": 6.683980941772461, "vf_loss": 6.685360908508301, "policy_loss": -0.0018172281561419368, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9678759574890137, "entropy": 1.2076407670974731}, "grad_time_ms": 10091.065, "load_time_ms": 14.728, "update_time_ms": 7.209, "num_steps_sampled": 1283987, "sample_time_ms": 15052.276}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f94611705f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f94611703c8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1283987, "hostname": "flow-main", "episodes_total": 425, "timestamp": 1557230885, "episode_reward_max": 1371.8149556461221, "episode_len_mean": 658.91, "time_total_s": 764.7285931110382, "time_since_restore": 764.7285931110382}
{"timesteps_since_restore": 1327271, "training_iteration": 30, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-08-30", "episode_reward_min": 50.423672240054145, "timesteps_this_iter": 43284, "episode_reward_mean": 1173.1779716477183, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.075206756591797, "policy_reward_mean": {}, "iterations_since_restore": 30, "custom_metrics": {"outflow_rate_max": 1348.4217962037962, "cost2_mean": -30.25524076779568, "cost1_mean": 331.28765205083363, "system_level_velocity_mean": 13.379867459874038, "cost2_min": -40.393607490864895, "cost1_max": 395.34021405921357, "cost1_min": 28.560533225877403, "cost2_max": -9.229249584892322, "outflow_rate_mean": 1076.6369315773152, "system_level_velocity_min": 10.16714552695967, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 19.212071984937207}, "info": {"num_steps_trained": 1327271, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007794962730258703, "total_loss": 5.920139789581299, "vf_loss": 5.921839714050293, "policy_loss": -0.0020893579348921776, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9751246571540833, "entropy": 1.1769465208053589}, "grad_time_ms": 10357.853, "load_time_ms": 14.545, "update_time_ms": 7.378, "num_steps_sampled": 1327271, "sample_time_ms": 14997.343}, "episodes_this_iter": 13, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cb00>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1327271, "hostname": "flow-main", "episodes_total": 438, "timestamp": 1557230910, "episode_reward_max": 1371.8149556461221, "episode_len_mean": 665.4, "time_total_s": 789.80379986763, "time_since_restore": 789.80379986763}
{"timesteps_since_restore": 1371497, "training_iteration": 31, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-08-54", "episode_reward_min": 50.423672240054145, "timesteps_this_iter": 44226, "episode_reward_mean": 1191.2263695906418, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.5137677192688, "policy_reward_mean": {}, "iterations_since_restore": 31, "custom_metrics": {"outflow_rate_max": 1348.4217962037962, "cost2_mean": -29.22791639044798, "cost1_mean": 337.7620118204296, "system_level_velocity_mean": 13.5000540523668, "cost2_min": -40.393607490864895, "cost1_max": 395.34021405921357, "cost1_min": 28.560533225877403, "cost2_max": -9.229249584892322, "outflow_rate_mean": 1098.19389224742, "system_level_velocity_min": 10.597381371898543, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 19.212071984937207}, "info": {"num_steps_trained": 1371497, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010046199895441532, "total_loss": 9.391114234924316, "vf_loss": 9.393165588378906, "policy_loss": -0.0025530641432851553, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9525195360183716, "entropy": 1.175369381904602}, "grad_time_ms": 10432.726, "load_time_ms": 14.671, "update_time_ms": 7.471, "num_steps_sampled": 1371497, "sample_time_ms": 15111.716}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1371497, "hostname": "flow-main", "episodes_total": 454, "timestamp": 1557230934, "episode_reward_max": 1413.0909239450687, "episode_len_mean": 670.67, "time_total_s": 814.3175675868988, "time_since_restore": 814.3175675868988}
{"timesteps_since_restore": 1413360, "training_iteration": 32, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-09-17", "episode_reward_min": 50.423672240054145, "timesteps_this_iter": 41863, "episode_reward_mean": 1203.3295919043019, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.949050903320312, "policy_reward_mean": {}, "iterations_since_restore": 32, "custom_metrics": {"outflow_rate_max": 1348.4217962037962, "cost2_mean": -28.55737292202025, "cost1_mean": 341.32283079072266, "system_level_velocity_mean": 13.494475802777252, "cost2_min": -40.393607490864895, "cost1_max": 398.5911741250984, "cost1_min": 28.560533225877403, "cost2_max": -9.229249584892322, "outflow_rate_mean": 1105.530686663507, "system_level_velocity_min": 10.597381371898543, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.212071984937207}, "info": {"num_steps_trained": 1413360, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013378308154642582, "total_loss": 10.041356086730957, "vf_loss": 10.043704986572266, "policy_loss": -0.0030186306685209274, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9585013389587402, "entropy": 1.173485279083252}, "grad_time_ms": 10301.885, "load_time_ms": 14.518, "update_time_ms": 7.644, "num_steps_sampled": 1413360, "sample_time_ms": 15010.83}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6e48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1413360, "hostname": "flow-main", "episodes_total": 470, "timestamp": 1557230957, "episode_reward_max": 1413.0909239450687, "episode_len_mean": 676.34, "time_total_s": 837.2666184902191, "time_since_restore": 837.2666184902191}
{"timesteps_since_restore": 1454876, "training_iteration": 33, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-09-42", "episode_reward_min": 67.58748310637576, "timesteps_this_iter": 41516, "episode_reward_mean": 1219.2985426000396, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.327088594436646, "policy_reward_mean": {}, "iterations_since_restore": 33, "custom_metrics": {"outflow_rate_max": 1342.1461914085914, "cost2_mean": -27.34680904173199, "cost1_mean": 345.0024794405038, "system_level_velocity_mean": 13.440554091220429, "cost2_min": -40.393607490864895, "cost1_max": 404.3581600385455, "cost1_min": 33.53366317836828, "cost2_max": -10.696080132757618, "outflow_rate_mean": 1115.3708147536513, "system_level_velocity_min": 10.597381371898543, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.711161598144766}, "info": {"num_steps_trained": 1454876, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01204527448862791, "total_loss": 10.929072380065918, "vf_loss": 10.93222713470459, "policy_loss": -0.00375743443146348, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9487225413322449, "entropy": 1.1425180435180664}, "grad_time_ms": 10324.909, "load_time_ms": 14.591, "update_time_ms": 7.622, "num_steps_sampled": 1454876, "sample_time_ms": 14985.488}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cf60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cfd0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1454876, "hostname": "flow-main", "episodes_total": 488, "timestamp": 1557230982, "episode_reward_max": 1413.0909239450687, "episode_len_mean": 682.91, "time_total_s": 862.5937070846558, "time_since_restore": 862.5937070846558}
{"timesteps_since_restore": 1497745, "training_iteration": 34, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-10-08", "episode_reward_min": 67.58748310637576, "timesteps_this_iter": 42869, "episode_reward_mean": 1228.401248908681, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.580240726470947, "policy_reward_mean": {}, "iterations_since_restore": 34, "custom_metrics": {"outflow_rate_max": 1342.1461914085914, "cost2_mean": -25.721628004193395, "cost1_mean": 344.0349316456372, "system_level_velocity_mean": 13.377371875575138, "cost2_min": -34.96966762316572, "cost1_max": 404.3581600385455, "cost1_min": 33.53366317836828, "cost2_max": -10.696080132757618, "outflow_rate_mean": 1114.8596465378669, "system_level_velocity_min": 10.597381371898543, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.711161598144766}, "info": {"num_steps_trained": 1497745, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009672868996858597, "total_loss": 8.924854278564453, "vf_loss": 8.925745964050293, "policy_loss": -0.0013765271287411451, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9545920491218567, "entropy": 1.1317205429077148}, "grad_time_ms": 10412.982, "load_time_ms": 14.695, "update_time_ms": 7.753, "num_steps_sampled": 1497745, "sample_time_ms": 14837.294}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbe48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1497745, "hostname": "flow-main", "episodes_total": 503, "timestamp": 1557231008, "episode_reward_max": 1413.0909239450687, "episode_len_mean": 682.91, "time_total_s": 888.1739478111267, "time_since_restore": 888.1739478111267}
{"timesteps_since_restore": 1539870, "training_iteration": 35, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-10-33", "episode_reward_min": 67.58748310637576, "timesteps_this_iter": 42125, "episode_reward_mean": 1249.2749484244177, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.551189661026, "policy_reward_mean": {}, "iterations_since_restore": 35, "custom_metrics": {"outflow_rate_max": 1342.1461914085914, "cost2_mean": -24.979408955504265, "cost1_mean": 349.3420462959356, "system_level_velocity_mean": 13.28460955487362, "cost2_min": -34.859864780690074, "cost1_max": 404.3581600385455, "cost1_min": 33.53366317836828, "cost2_max": -10.696080132757618, "outflow_rate_mean": 1124.6141499754629, "system_level_velocity_min": 10.597381371898543, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.711161598144766}, "info": {"num_steps_trained": 1539870, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010358385741710663, "total_loss": 8.039690017700195, "vf_loss": 8.041247367858887, "policy_loss": -0.002075386932119727, "cur_kl_coeff": 0.05000000074505806, "vf_explained_var": 0.9595263004302979, "entropy": 1.114410161972046}, "grad_time_ms": 10367.637, "load_time_ms": 14.75, "update_time_ms": 7.81, "num_steps_sampled": 1539870, "sample_time_ms": 14654.213}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1539870, "hostname": "flow-main", "episodes_total": 517, "timestamp": 1557231033, "episode_reward_max": 1413.0909239450687, "episode_len_mean": 693.5, "time_total_s": 912.7251374721527, "time_since_restore": 912.7251374721527}
{"timesteps_since_restore": 1582390, "training_iteration": 36, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-10-58", "episode_reward_min": 67.58748310637576, "timesteps_this_iter": 42520, "episode_reward_mean": 1251.5122115910985, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.937030792236328, "policy_reward_mean": {}, "iterations_since_restore": 36, "custom_metrics": {"outflow_rate_max": 1342.1461914085914, "cost2_mean": -24.0491429880281, "cost1_mean": 347.9939983642273, "system_level_velocity_mean": 13.320631145163077, "cost2_min": -34.859864780690074, "cost1_max": 404.3581600385455, "cost1_min": 33.53366317836828, "cost2_max": -10.696080132757618, "outflow_rate_mean": 1126.2130070193673, "system_level_velocity_min": 11.078414073169679, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.711161598144766}, "info": {"num_steps_trained": 1582390, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011411009356379509, "total_loss": 11.970193862915039, "vf_loss": 11.970532417297363, "policy_loss": -0.0009089909144677222, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9488115310668945, "entropy": 1.1406598091125488}, "grad_time_ms": 10307.532, "load_time_ms": 14.801, "update_time_ms": 7.7, "num_steps_sampled": 1582390, "sample_time_ms": 14623.866}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1582390, "hostname": "flow-main", "episodes_total": 534, "timestamp": 1557231058, "episode_reward_max": 1413.0909239450687, "episode_len_mean": 688.84, "time_total_s": 937.662168264389, "time_since_restore": 937.662168264389}
{"timesteps_since_restore": 1624286, "training_iteration": 37, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-11-22", "episode_reward_min": 52.58737188226377, "timesteps_this_iter": 41896, "episode_reward_mean": 1232.9249136575331, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.331307888031006, "policy_reward_mean": {}, "iterations_since_restore": 37, "custom_metrics": {"outflow_rate_max": 1342.1461914085914, "cost2_mean": -23.13156599548096, "cost1_mean": 342.9667170856197, "system_level_velocity_mean": 13.297440649799455, "cost2_min": -29.98878300140761, "cost1_max": 404.3581600385455, "cost1_min": 29.171210776525786, "cost2_max": -7.277781373599765, "outflow_rate_mean": 1116.2261634725467, "system_level_velocity_min": 10.689949084282768, "outflow_rate_min": 327.0037939693038, "system_level_velocity_max": 19.02021992075616}, "info": {"num_steps_trained": 1624286, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011725310236215591, "total_loss": 8.858839988708496, "vf_loss": 8.860391616821289, "policy_loss": -0.0021372155752032995, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9536170363426208, "entropy": 1.1048405170440674}, "grad_time_ms": 10198.256, "load_time_ms": 14.86, "update_time_ms": 7.686, "num_steps_sampled": 1624286, "sample_time_ms": 14698.063}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1624286, "hostname": "flow-main", "episodes_total": 548, "timestamp": 1557231082, "episode_reward_max": 1396.1689079668747, "episode_len_mean": 682.28, "time_total_s": 961.99347615242, "time_since_restore": 961.99347615242}
{"timesteps_since_restore": 1666067, "training_iteration": 38, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-11-46", "episode_reward_min": 51.64045713512735, "timesteps_this_iter": 41781, "episode_reward_mean": 1233.8344978588211, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.72243905067444, "policy_reward_mean": {}, "iterations_since_restore": 38, "custom_metrics": {"outflow_rate_max": 1313.9273914085916, "cost2_mean": -21.953527745140562, "cost1_mean": 343.3037279895727, "system_level_velocity_mean": 13.313234460967324, "cost2_min": -27.373599647742545, "cost1_max": 404.3581600385455, "cost1_min": 28.83086773373795, "cost2_max": -7.277781373599765, "outflow_rate_mean": 1121.087308731615, "system_level_velocity_min": 10.689949084282768, "outflow_rate_min": 327.0037939693038, "system_level_velocity_max": 19.387035864927615}, "info": {"num_steps_trained": 1666067, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011658230796456337, "total_loss": 13.61057186126709, "vf_loss": 13.612310409545898, "policy_loss": -0.0023206633049994707, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9247509837150574, "entropy": 1.0998122692108154}, "grad_time_ms": 9915.278, "load_time_ms": 14.727, "update_time_ms": 7.623, "num_steps_sampled": 1666067, "sample_time_ms": 14728.606}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f160>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1666067, "hostname": "flow-main", "episodes_total": 566, "timestamp": 1557231106, "episode_reward_max": 1396.1689079668747, "episode_len_mean": 682.21, "time_total_s": 985.7159152030945, "time_since_restore": 985.7159152030945}
{"timesteps_since_restore": 1706510, "training_iteration": 39, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-12-09", "episode_reward_min": 51.64045713512735, "timesteps_this_iter": 40443, "episode_reward_mean": 1232.5672617621444, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.3667573928833, "policy_reward_mean": {}, "iterations_since_restore": 39, "custom_metrics": {"outflow_rate_max": 1313.086513086913, "cost2_mean": -20.66296149170678, "cost1_mean": 341.26112849653947, "system_level_velocity_mean": 13.232764725416166, "cost2_min": -27.373599647742545, "cost1_max": 395.95327576412143, "cost1_min": 28.83086773373795, "cost2_max": -7.277781373599765, "outflow_rate_mean": 1123.2101005637826, "system_level_velocity_min": 10.689949084282768, "outflow_rate_min": 327.0037939693038, "system_level_velocity_max": 19.387035864927615}, "info": {"num_steps_trained": 1706510, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014201887883245945, "total_loss": 21.084196090698242, "vf_loss": 21.086790084838867, "policy_loss": -0.003306102007627487, "cur_kl_coeff": 0.05000000447034836, "vf_explained_var": 0.8776339292526245, "entropy": 1.1098896265029907}, "grad_time_ms": 9606.527, "load_time_ms": 14.563, "update_time_ms": 7.362, "num_steps_sampled": 1706510, "sample_time_ms": 14721.489}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5dfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f94611704a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d978>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1706510, "hostname": "flow-main", "episodes_total": 584, "timestamp": 1557231129, "episode_reward_max": 1396.1689079668747, "episode_len_mean": 682.21, "time_total_s": 1009.0826725959778, "time_since_restore": 1009.0826725959778}
{"timesteps_since_restore": 1747910, "training_iteration": 40, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-12-33", "episode_reward_min": 51.64045713512735, "timesteps_this_iter": 41400, "episode_reward_mean": 1218.2783900141615, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.12677001953125, "policy_reward_mean": {}, "iterations_since_restore": 40, "custom_metrics": {"outflow_rate_max": 1313.086513086913, "cost2_mean": -20.12804817838015, "cost1_mean": 339.450149246776, "system_level_velocity_mean": 13.29530423404772, "cost2_min": -27.034049257248164, "cost1_max": 395.95327576412143, "cost1_min": 28.83086773373795, "cost2_max": -7.277781373599765, "outflow_rate_mean": 1123.9146365307424, "system_level_velocity_min": 10.689949084282768, "outflow_rate_min": 327.0037939693038, "system_level_velocity_max": 19.387035864927615}, "info": {"num_steps_trained": 1747910, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01547242235392332, "total_loss": 16.045209884643555, "vf_loss": 16.04734230041504, "policy_loss": -0.0029076996725052595, "cur_kl_coeff": 0.05000000447034836, "vf_explained_var": 0.9093545079231262, "entropy": 1.108778476715088}, "grad_time_ms": 9386.209, "load_time_ms": 14.527, "update_time_ms": 7.235, "num_steps_sampled": 1747910, "sample_time_ms": 14847.554}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d0f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1747910, "hostname": "flow-main", "episodes_total": 600, "timestamp": 1557231153, "episode_reward_max": 1396.1689079668747, "episode_len_mean": 677.28, "time_total_s": 1033.209442615509, "time_since_restore": 1033.209442615509}
{"timesteps_since_restore": 1790640, "training_iteration": 41, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-12-59", "episode_reward_min": 51.64045713512735, "timesteps_this_iter": 42730, "episode_reward_mean": 1211.7254375660527, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.62346386909485, "policy_reward_mean": {}, "iterations_since_restore": 41, "custom_metrics": {"outflow_rate_max": 1297.0989546453548, "cost2_mean": -19.765253538959474, "cost1_mean": 338.2731102439965, "system_level_velocity_mean": 13.250359164705797, "cost2_min": -27.034049257248164, "cost1_max": 395.95327576412143, "cost1_min": 28.83086773373795, "cost2_max": -7.277781373599765, "outflow_rate_mean": 1122.8367096576158, "system_level_velocity_min": 10.689949084282768, "outflow_rate_min": 327.0037939693038, "system_level_velocity_max": 19.387035864927615}, "info": {"num_steps_trained": 1790640, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008909122087061405, "total_loss": 11.40841293334961, "vf_loss": 11.41002082824707, "policy_loss": -0.0020531255286186934, "cur_kl_coeff": 0.05000000447034836, "vf_explained_var": 0.9462196230888367, "entropy": 1.1251695156097412}, "grad_time_ms": 9304.485, "load_time_ms": 14.612, "update_time_ms": 7.271, "num_steps_sampled": 1790640, "sample_time_ms": 15040.71}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f94611709e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f94611705f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1790640, "hostname": "flow-main", "episodes_total": 617, "timestamp": 1557231179, "episode_reward_max": 1396.1689079668747, "episode_len_mean": 677.28, "time_total_s": 1058.8329064846039, "time_since_restore": 1058.8329064846039}
{"timesteps_since_restore": 1833163, "training_iteration": 42, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-13-24", "episode_reward_min": 51.64045713512735, "timesteps_this_iter": 42523, "episode_reward_mean": 1213.0002786365667, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.402196884155273, "policy_reward_mean": {}, "iterations_since_restore": 42, "custom_metrics": {"outflow_rate_max": 1297.0989546453548, "cost2_mean": -19.79155123946889, "cost1_mean": 340.1393052112191, "system_level_velocity_mean": 13.219358071561903, "cost2_min": -27.804311416711847, "cost1_max": 390.1741556291644, "cost1_min": 28.83086773373795, "cost2_max": -7.277781373599765, "outflow_rate_mean": 1129.7130526217036, "system_level_velocity_min": 10.689949084282768, "outflow_rate_min": 327.0037939693038, "system_level_velocity_max": 19.387035864927615}, "info": {"num_steps_trained": 1833163, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010131181217730045, "total_loss": 8.122224807739258, "vf_loss": 8.12326431274414, "policy_loss": -0.0015453888336196542, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9599570035934448, "entropy": 1.1067709922790527}, "grad_time_ms": 9367.184, "load_time_ms": 14.79, "update_time_ms": 7.349, "num_steps_sampled": 1833163, "sample_time_ms": 15221.743}, "episodes_this_iter": 12, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1833163, "hostname": "flow-main", "episodes_total": 629, "timestamp": 1557231204, "episode_reward_max": 1396.1689079668747, "episode_len_mean": 681.94, "time_total_s": 1084.2351033687592, "time_since_restore": 1084.2351033687592}
{"timesteps_since_restore": 1874120, "training_iteration": 43, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-13-49", "episode_reward_min": 51.64045713512735, "timesteps_this_iter": 40957, "episode_reward_mean": 1209.3454474636585, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.77377223968506, "policy_reward_mean": {}, "iterations_since_restore": 43, "custom_metrics": {"outflow_rate_max": 1297.0989546453548, "cost2_mean": -19.541032746371396, "cost1_mean": 340.6874172325448, "system_level_velocity_mean": 13.250999593469132, "cost2_min": -27.804311416711847, "cost1_max": 397.15597337415005, "cost1_min": 28.83086773373795, "cost2_max": -7.277781373599765, "outflow_rate_mean": 1131.8519632350901, "system_level_velocity_min": 11.335263630357959, "outflow_rate_min": 327.0037939693038, "system_level_velocity_max": 19.387035864927615}, "info": {"num_steps_trained": 1874120, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011584113352000713, "total_loss": 16.11598777770996, "vf_loss": 16.1180362701416, "policy_loss": -0.002628532238304615, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9185454249382019, "entropy": 1.1313716173171997}, "grad_time_ms": 9326.151, "load_time_ms": 14.72, "update_time_ms": 7.381, "num_steps_sampled": 1874120, "sample_time_ms": 15206.897}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5de10>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1874120, "hostname": "flow-main", "episodes_total": 647, "timestamp": 1557231229, "episode_reward_max": 1361.3124075305168, "episode_len_mean": 681.94, "time_total_s": 1109.0088756084442, "time_since_restore": 1109.0088756084442}
{"timesteps_since_restore": 1914468, "training_iteration": 44, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-14-13", "episode_reward_min": 360.9648238614231, "timesteps_this_iter": 40348, "episode_reward_mean": 1230.3346942173691, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.18058681488037, "policy_reward_mean": {}, "iterations_since_restore": 44, "custom_metrics": {"outflow_rate_max": 1297.0989546453548, "cost2_mean": -19.752538297181967, "cost1_mean": 345.15555903654933, "system_level_velocity_mean": 13.068213795503231, "cost2_min": -27.804311416711847, "cost1_max": 397.15597337415005, "cost1_min": 126.29146647855133, "cost2_max": -13.513524625483063, "outflow_rate_mean": 1142.0176917232034, "system_level_velocity_min": 11.335263630357959, "outflow_rate_min": 693.1095451475384, "system_level_velocity_max": 16.42170601586859}, "info": {"num_steps_trained": 1914468, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010506154969334602, "total_loss": 15.7758150100708, "vf_loss": 15.777670860290527, "policy_loss": -0.002381757600232959, "cur_kl_coeff": 0.05000000447034836, "vf_explained_var": 0.9245808720588684, "entropy": 1.134218692779541}, "grad_time_ms": 9232.527, "load_time_ms": 14.466, "update_time_ms": 7.412, "num_steps_sampled": 1914468, "sample_time_ms": 15161.764}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd343c8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1914468, "hostname": "flow-main", "episodes_total": 664, "timestamp": 1557231253, "episode_reward_max": 1361.3124075305168, "episode_len_mean": 695.07, "time_total_s": 1133.1894624233246, "time_since_restore": 1133.1894624233246}
{"timesteps_since_restore": 1955342, "training_iteration": 45, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-14-39", "episode_reward_min": 360.9648238614231, "timesteps_this_iter": 40874, "episode_reward_mean": 1225.5722322293443, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.28406548500061, "policy_reward_mean": {}, "iterations_since_restore": 45, "custom_metrics": {"outflow_rate_max": 1297.0989546453548, "cost2_mean": -20.096105964755235, "cost1_mean": 346.31177606768483, "system_level_velocity_mean": 13.1183780733924, "cost2_min": -27.804311416711847, "cost1_max": 397.15597337415005, "cost1_min": 126.29146647855133, "cost2_max": -13.513524625483063, "outflow_rate_mean": 1143.2676862526741, "system_level_velocity_min": 11.335263630357959, "outflow_rate_min": 693.1095451475384, "system_level_velocity_max": 16.42170601586859}, "info": {"num_steps_trained": 1955342, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011852058582007885, "total_loss": 11.700700759887695, "vf_loss": 11.703134536743164, "policy_loss": -0.0030279080383479595, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9420535564422607, "entropy": 1.118690013885498}, "grad_time_ms": 9418.118, "load_time_ms": 14.178, "update_time_ms": 7.344, "num_steps_sampled": 1955342, "sample_time_ms": 15050.556}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cf60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1955342, "hostname": "flow-main", "episodes_total": 680, "timestamp": 1557231279, "episode_reward_max": 1361.3124075305168, "episode_len_mean": 695.07, "time_total_s": 1158.4735279083252, "time_since_restore": 1158.4735279083252}
{"timesteps_since_restore": 1997222, "training_iteration": 46, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-15-08", "episode_reward_min": 367.4197169593969, "timesteps_this_iter": 41880, "episode_reward_mean": 1220.8104881902375, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 29.557945489883423, "policy_reward_mean": {}, "iterations_since_restore": 46, "custom_metrics": {"outflow_rate_max": 1286.3695372627374, "cost2_mean": -20.361351295002276, "cost1_mean": 348.35422188548006, "system_level_velocity_mean": 13.202409462591964, "cost2_min": -27.804311416711847, "cost1_max": 397.15597337415005, "cost1_min": 136.40080678090192, "cost2_max": -14.757409367433151, "outflow_rate_mean": 1143.9200597116576, "system_level_velocity_min": 11.335263630357959, "outflow_rate_min": 743.9418988380843, "system_level_velocity_max": 16.89239057582639}, "info": {"num_steps_trained": 1997222, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010038746520876884, "total_loss": 13.8846435546875, "vf_loss": 13.885391235351562, "policy_loss": -0.0012500417651608586, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9317728877067566, "entropy": 1.102565884590149}, "grad_time_ms": 9679.039, "load_time_ms": 13.998, "update_time_ms": 7.473, "num_steps_sampled": 1997222, "sample_time_ms": 15252.362}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 1997222, "hostname": "flow-main", "episodes_total": 698, "timestamp": 1557231308, "episode_reward_max": 1361.3124075305168, "episode_len_mean": 695.19, "time_total_s": 1188.0314733982086, "time_since_restore": 1188.0314733982086}
{"timesteps_since_restore": 2039148, "training_iteration": 47, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-15-32", "episode_reward_min": 162.86271413615975, "timesteps_this_iter": 41926, "episode_reward_mean": 1209.877055076574, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.532499313354492, "policy_reward_mean": {}, "iterations_since_restore": 47, "custom_metrics": {"outflow_rate_max": 1311.4145982017983, "cost2_mean": -20.267703900416414, "cost1_mean": 347.44195176334114, "system_level_velocity_mean": 13.340012320442389, "cost2_min": -27.804311416711847, "cost1_max": 398.3364203925087, "cost1_min": 78.07276128374521, "cost2_max": -13.186714165830232, "outflow_rate_mean": 1143.4161245552195, "system_level_velocity_min": 11.335263630357959, "outflow_rate_min": 472.613060580004, "system_level_velocity_max": 19.063829269622538}, "info": {"num_steps_trained": 2039148, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011400116607546806, "total_loss": 13.611946105957031, "vf_loss": 13.614290237426758, "policy_loss": -0.0029132773634046316, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9129124283790588, "entropy": 1.0849298238754272}, "grad_time_ms": 9911.845, "load_time_ms": 13.725, "update_time_ms": 7.595, "num_steps_sampled": 2039148, "sample_time_ms": 14938.725}, "episodes_this_iter": 12, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6710>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2039148, "hostname": "flow-main", "episodes_total": 710, "timestamp": 1557231332, "episode_reward_max": 1361.3124075305168, "episode_len_mean": 689.32, "time_total_s": 1211.563972711563, "time_since_restore": 1211.563972711563}
{"timesteps_since_restore": 2080532, "training_iteration": 48, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-15-55", "episode_reward_min": 162.86271413615975, "timesteps_this_iter": 41384, "episode_reward_mean": 1192.5968530273512, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.297610998153687, "policy_reward_mean": {}, "iterations_since_restore": 48, "custom_metrics": {"outflow_rate_max": 1311.4145982017983, "cost2_mean": -20.077145823227557, "cost1_mean": 345.0380514700979, "system_level_velocity_mean": 13.529545105259672, "cost2_min": -24.936557971614434, "cost1_max": 425.3587127818338, "cost1_min": 72.22432955732329, "cost2_max": -13.186714165830232, "outflow_rate_mean": 1140.7267427422119, "system_level_velocity_min": 11.645269421581181, "outflow_rate_min": 416.8799608069854, "system_level_velocity_max": 19.063829269622538}, "info": {"num_steps_trained": 2080532, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012584947980940342, "total_loss": 23.270217895507812, "vf_loss": 23.271453857421875, "policy_loss": -0.0018632275750860572, "cur_kl_coeff": 0.05000000447034836, "vf_explained_var": 0.8829019069671631, "entropy": 1.0861338376998901}, "grad_time_ms": 10169.776, "load_time_ms": 13.76, "update_time_ms": 7.565, "num_steps_sampled": 2080532, "sample_time_ms": 14638.05}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fda0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fcf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2080532, "hostname": "flow-main", "episodes_total": 728, "timestamp": 1557231355, "episode_reward_max": 1465.2976466081468, "episode_len_mean": 678.49, "time_total_s": 1234.8615837097168, "time_since_restore": 1234.8615837097168}
{"timesteps_since_restore": 2120686, "training_iteration": 49, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-16-19", "episode_reward_min": 162.86271413615975, "timesteps_this_iter": 40154, "episode_reward_mean": 1175.8604533568398, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.82612633705139, "policy_reward_mean": {}, "iterations_since_restore": 49, "custom_metrics": {"outflow_rate_max": 1384.7037398601399, "cost2_mean": -19.93308991749257, "cost1_mean": 343.76042138023, "system_level_velocity_mean": 13.631197686446676, "cost2_min": -24.375615019643444, "cost1_max": 431.6103921452004, "cost1_min": 72.22432955732329, "cost2_max": -13.186714165830232, "outflow_rate_mean": 1136.04772356575, "system_level_velocity_min": 11.459803589377659, "outflow_rate_min": 416.8799608069854, "system_level_velocity_max": 19.063829269622538}, "info": {"num_steps_trained": 2120686, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013920904137194157, "total_loss": 24.78765869140625, "vf_loss": 24.791208267211914, "policy_loss": -0.004243130795657635, "cur_kl_coeff": 0.05000000447034836, "vf_explained_var": 0.8895856738090515, "entropy": 1.0942599773406982}, "grad_time_ms": 10362.887, "load_time_ms": 13.654, "update_time_ms": 7.753, "num_steps_sampled": 2120686, "sample_time_ms": 14490.42}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6748>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2120686, "hostname": "flow-main", "episodes_total": 748, "timestamp": 1557231379, "episode_reward_max": 1465.2976466081468, "episode_len_mean": 673.48, "time_total_s": 1258.6877100467682, "time_since_restore": 1258.6877100467682}
{"timesteps_since_restore": 2162465, "training_iteration": 50, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-16-43", "episode_reward_min": 162.86271413615975, "timesteps_this_iter": 41779, "episode_reward_mean": 1177.4249125617685, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.24487280845642, "policy_reward_mean": {}, "iterations_since_restore": 50, "custom_metrics": {"outflow_rate_max": 1384.7037398601399, "cost2_mean": -20.171581208136946, "cost1_mean": 345.8835033807129, "system_level_velocity_mean": 13.708244011133889, "cost2_min": -24.375615019643444, "cost1_max": 433.62033628484517, "cost1_min": 72.22432955732329, "cost2_max": -13.186714165830232, "outflow_rate_mean": 1142.443442534781, "system_level_velocity_min": 11.459803589377659, "outflow_rate_min": 416.8799608069854, "system_level_velocity_max": 19.063829269622538}, "info": {"num_steps_trained": 2162465, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010978993959724903, "total_loss": 16.453386306762695, "vf_loss": 16.454727172851562, "policy_loss": -0.001890238025225699, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9104902744293213, "entropy": 1.1041994094848633}, "grad_time_ms": 10564.54, "load_time_ms": 13.699, "update_time_ms": 7.779, "num_steps_sampled": 2162465, "sample_time_ms": 14300.289}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fe10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116feb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2162465, "hostname": "flow-main", "episodes_total": 765, "timestamp": 1557231403, "episode_reward_max": 1465.2976466081468, "episode_len_mean": 673.48, "time_total_s": 1282.9325828552246, "time_since_restore": 1282.9325828552246}
{"timesteps_since_restore": 2204433, "training_iteration": 51, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-17-08", "episode_reward_min": 51.058865168158974, "timesteps_this_iter": 41968, "episode_reward_mean": 1139.135153080213, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.896049976348877, "policy_reward_mean": {}, "iterations_since_restore": 51, "custom_metrics": {"outflow_rate_max": 1384.7037398601399, "cost2_mean": -20.145074540590276, "cost1_mean": 335.7299757309125, "system_level_velocity_mean": 13.904419866074265, "cost2_min": -28.45057569051533, "cost1_max": 433.62033628484517, "cost1_min": 28.599795356993454, "cost2_max": -8.233368918655838, "outflow_rate_mean": 1115.2101242275467, "system_level_velocity_min": 11.281184147147128, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.316971795531256}, "info": {"num_steps_trained": 2204433, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.02199794165790081, "total_loss": 19.965072631835938, "vf_loss": 19.968782424926758, "policy_loss": -0.00480997608974576, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9045060873031616, "entropy": 1.112331748008728}, "grad_time_ms": 10665.413, "load_time_ms": 13.532, "update_time_ms": 7.848, "num_steps_sampled": 2204433, "sample_time_ms": 14126.219}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd69e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2204433, "hostname": "flow-main", "episodes_total": 783, "timestamp": 1557231428, "episode_reward_max": 1465.2976466081468, "episode_len_mean": 651.55, "time_total_s": 1307.8286328315735, "time_since_restore": 1307.8286328315735}
{"timesteps_since_restore": 2246532, "training_iteration": 52, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-17-32", "episode_reward_min": 51.058865168158974, "timesteps_this_iter": 42099, "episode_reward_mean": 1149.4441113874393, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.900798559188843, "policy_reward_mean": {}, "iterations_since_restore": 52, "custom_metrics": {"outflow_rate_max": 1384.7037398601399, "cost2_mean": -20.21427450807317, "cost1_mean": 337.7836207989541, "system_level_velocity_mean": 13.863557313021436, "cost2_min": -28.45057569051533, "cost1_max": 433.62033628484517, "cost1_min": 28.599795356993454, "cost2_max": -8.233368918655838, "outflow_rate_mean": 1121.7877341582468, "system_level_velocity_min": 11.281184147147128, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.316971795531256}, "info": {"num_steps_trained": 2246532, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013367163017392159, "total_loss": 15.303133010864258, "vf_loss": 15.305546760559082, "policy_loss": -0.003415805986151099, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9142396450042725, "entropy": 1.1400885581970215}, "grad_time_ms": 10608.754, "load_time_ms": 13.525, "update_time_ms": 7.605, "num_steps_sampled": 2246532, "sample_time_ms": 14034.163}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf4a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2246532, "hostname": "flow-main", "episodes_total": 797, "timestamp": 1557231452, "episode_reward_max": 1465.2976466081468, "episode_len_mean": 656.36, "time_total_s": 1331.7294313907623, "time_since_restore": 1331.7294313907623}
{"timesteps_since_restore": 2288725, "training_iteration": 53, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-17-55", "episode_reward_min": 51.058865168158974, "timesteps_this_iter": 42193, "episode_reward_mean": 1160.8221906452734, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.449020385742188, "policy_reward_mean": {}, "iterations_since_restore": 53, "custom_metrics": {"outflow_rate_max": 1384.7037398601399, "cost2_mean": -20.15490232946387, "cost1_mean": 338.3339984432818, "system_level_velocity_mean": 13.713648962380448, "cost2_min": -28.45057569051533, "cost1_max": 433.62033628484517, "cost1_min": 28.599795356993454, "cost2_max": -8.233368918655838, "outflow_rate_mean": 1122.410285898101, "system_level_velocity_min": 11.281184147147128, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.316971795531256}, "info": {"num_steps_trained": 2288725, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01235273014754057, "total_loss": 13.19588851928711, "vf_loss": 13.198081970214844, "policy_loss": -0.003119481261819601, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9355453848838806, "entropy": 1.1308226585388184}, "grad_time_ms": 10432.235, "load_time_ms": 13.533, "update_time_ms": 7.593, "num_steps_sampled": 2288725, "sample_time_ms": 13979.531}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fa90>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2288725, "hostname": "flow-main", "episodes_total": 813, "timestamp": 1557231475, "episode_reward_max": 1465.2976466081468, "episode_len_mean": 662.23, "time_total_s": 1354.1784517765045, "time_since_restore": 1354.1784517765045}
{"timesteps_since_restore": 2330037, "training_iteration": 54, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-18-17", "episode_reward_min": 51.058865168158974, "timesteps_this_iter": 41312, "episode_reward_mean": 1180.8829713715254, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.317130088806152, "policy_reward_mean": {}, "iterations_since_restore": 54, "custom_metrics": {"outflow_rate_max": 1384.7037398601399, "cost2_mean": -20.308465564107586, "cost1_mean": 341.12788755444194, "system_level_velocity_mean": 13.5942010215797, "cost2_min": -28.45057569051533, "cost1_max": 433.62033628484517, "cost1_min": 28.599795356993454, "cost2_max": -8.233368918655838, "outflow_rate_mean": 1125.1390357588273, "system_level_velocity_min": 10.941152276598975, "outflow_rate_min": 328.8103444682708, "system_level_velocity_max": 19.316971795531256}, "info": {"num_steps_trained": 2330037, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011464769020676613, "total_loss": 16.99180793762207, "vf_loss": 16.99392318725586, "policy_loss": -0.002974648727104068, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9205768704414368, "entropy": 1.1204015016555786}, "grad_time_ms": 10272.682, "load_time_ms": 13.574, "update_time_ms": 7.337, "num_steps_sampled": 2330037, "sample_time_ms": 13954.159}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf09e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf05f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ccc0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2330037, "hostname": "flow-main", "episodes_total": 830, "timestamp": 1557231497, "episode_reward_max": 1408.3653888962672, "episode_len_mean": 671.53, "time_total_s": 1376.4955818653107, "time_since_restore": 1376.4955818653107}
{"timesteps_since_restore": 2371522, "training_iteration": 55, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-18-40", "episode_reward_min": 51.058865168158974, "timesteps_this_iter": 41485, "episode_reward_mean": 1176.4746540223512, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.537511348724365, "policy_reward_mean": {}, "iterations_since_restore": 55, "custom_metrics": {"outflow_rate_max": 1377.3368347652347, "cost2_mean": -20.649514816170477, "cost1_mean": 337.13579735419296, "system_level_velocity_mean": 13.597492729939086, "cost2_min": -28.45057569051533, "cost1_max": 433.62033628484517, "cost1_min": 28.599795356993454, "cost2_max": -8.233368918655838, "outflow_rate_mean": 1118.477115712312, "system_level_velocity_min": 10.941152276598975, "outflow_rate_min": 328.8103444682708, "system_level_velocity_max": 19.316971795531256}, "info": {"num_steps_trained": 2371522, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012007424607872963, "total_loss": 17.403188705444336, "vf_loss": 17.406349182128906, "policy_loss": -0.004061580635607243, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.918866753578186, "entropy": 1.1153124570846558}, "grad_time_ms": 10018.471, "load_time_ms": 13.724, "update_time_ms": 7.301, "num_steps_sampled": 2371522, "sample_time_ms": 13934.642}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf02e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2371522, "hostname": "flow-main", "episodes_total": 848, "timestamp": 1557231520, "episode_reward_max": 1416.6237161893735, "episode_len_mean": 665.03, "time_total_s": 1399.033093214035, "time_since_restore": 1399.033093214035}
{"timesteps_since_restore": 2414436, "training_iteration": 56, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-19-02", "episode_reward_min": 51.058865168158974, "timesteps_this_iter": 42914, "episode_reward_mean": 1185.9220976007173, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.993110418319702, "policy_reward_mean": {}, "iterations_since_restore": 56, "custom_metrics": {"outflow_rate_max": 1377.3368347652347, "cost2_mean": -21.230918932460636, "cost1_mean": 338.8402821436463, "system_level_velocity_mean": 13.658963598116916, "cost2_min": -31.50900977246872, "cost1_max": 408.9409099537022, "cost1_min": 28.599795356993454, "cost2_max": -8.233368918655838, "outflow_rate_mean": 1128.0689558242002, "system_level_velocity_min": 10.941152276598975, "outflow_rate_min": 328.8103444682708, "system_level_velocity_max": 19.316971795531256}, "info": {"num_steps_trained": 2414436, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010736090131103992, "total_loss": 11.38447093963623, "vf_loss": 11.386575698852539, "policy_loss": -0.0029104168061167, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9387737512588501, "entropy": 1.0959043502807617}, "grad_time_ms": 9752.937, "load_time_ms": 13.834, "update_time_ms": 7.21, "num_steps_sampled": 2414436, "sample_time_ms": 13444.026}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f240>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2414436, "hostname": "flow-main", "episodes_total": 862, "timestamp": 1557231542, "episode_reward_max": 1416.6237161893735, "episode_len_mean": 665.03, "time_total_s": 1421.0262036323547, "time_since_restore": 1421.0262036323547}
{"timesteps_since_restore": 2456599, "training_iteration": 57, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-19-24", "episode_reward_min": 60.825952677559705, "timesteps_this_iter": 42163, "episode_reward_mean": 1225.6257243762236, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.875873565673828, "policy_reward_mean": {}, "iterations_since_restore": 57, "custom_metrics": {"outflow_rate_max": 1377.3368347652347, "cost2_mean": -21.81684443768022, "cost1_mean": 346.61911293280554, "system_level_velocity_mean": 13.487001130165787, "cost2_min": -31.50900977246872, "cost1_max": 408.9409099537022, "cost1_min": 30.85437514661445, "cost2_max": -8.542061023913808, "outflow_rate_mean": 1150.3068981952947, "system_level_velocity_min": 10.941152276598975, "outflow_rate_min": 328.8103444682708, "system_level_velocity_max": 18.955911388970446}, "info": {"num_steps_trained": 2456599, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012189958244562149, "total_loss": 11.768924713134766, "vf_loss": 11.771918296813965, "policy_loss": -0.003908678889274597, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.945949912071228, "entropy": 1.1005780696868896}, "grad_time_ms": 9573.161, "load_time_ms": 14.051, "update_time_ms": 7.034, "num_steps_sampled": 2456599, "sample_time_ms": 13560.161}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf6a0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2456599, "hostname": "flow-main", "episodes_total": 877, "timestamp": 1557231564, "episode_reward_max": 1416.6237161893735, "episode_len_mean": 682.08, "time_total_s": 1443.9020771980286, "time_since_restore": 1443.9020771980286}
{"timesteps_since_restore": 2497615, "training_iteration": 58, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-19-49", "episode_reward_min": 60.825952677559705, "timesteps_this_iter": 41016, "episode_reward_mean": 1229.5031205529754, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.211562871932983, "policy_reward_mean": {}, "iterations_since_restore": 58, "custom_metrics": {"outflow_rate_max": 1376.2087996003995, "cost2_mean": -21.658503079782513, "cost1_mean": 346.51194274317953, "system_level_velocity_mean": 13.443327029813506, "cost2_min": -31.50900977246872, "cost1_max": 408.9409099537022, "cost1_min": 30.85437514661445, "cost2_max": -8.542061023913808, "outflow_rate_mean": 1151.401650095176, "system_level_velocity_min": 10.941152276598975, "outflow_rate_min": 328.8103444682708, "system_level_velocity_max": 18.955911388970446}, "info": {"num_steps_trained": 2497615, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011899144388735294, "total_loss": 13.0513334274292, "vf_loss": 13.052441596984863, "policy_loss": -0.0019988855347037315, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9487596750259399, "entropy": 1.0864534378051758}, "grad_time_ms": 9516.541, "load_time_ms": 14.249, "update_time_ms": 7.009, "num_steps_sampled": 2497615, "sample_time_ms": 13708.576}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2497615, "hostname": "flow-main", "episodes_total": 895, "timestamp": 1557231589, "episode_reward_max": 1416.6237161893735, "episode_len_mean": 683.22, "time_total_s": 1468.1136400699615, "time_since_restore": 1468.1136400699615}
{"timesteps_since_restore": 2539431, "training_iteration": 59, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-20-14", "episode_reward_min": 60.825952677559705, "timesteps_this_iter": 41816, "episode_reward_mean": 1231.4970132037147, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.86150622367859, "policy_reward_mean": {}, "iterations_since_restore": 59, "custom_metrics": {"outflow_rate_max": 1404.8963628371628, "cost2_mean": -21.96385241805435, "cost1_mean": 348.36408794091057, "system_level_velocity_mean": 13.5132259022285, "cost2_min": -31.50900977246872, "cost1_max": 413.2965491481086, "cost1_min": 30.85437514661445, "cost2_max": -8.542061023913808, "outflow_rate_mean": 1158.9597369043668, "system_level_velocity_min": 10.941152276598975, "outflow_rate_min": 328.8103444682708, "system_level_velocity_max": 18.955911388970446}, "info": {"num_steps_trained": 2539431, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011828440241515636, "total_loss": 9.935050964355469, "vf_loss": 9.936957359313965, "policy_loss": -0.0027942280285060406, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9595812559127808, "entropy": 1.0972795486450195}, "grad_time_ms": 9633.03, "load_time_ms": 14.144, "update_time_ms": 6.937, "num_steps_sampled": 2539431, "sample_time_ms": 13695.098}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5da20>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2539431, "hostname": "flow-main", "episodes_total": 911, "timestamp": 1557231614, "episode_reward_max": 1416.6237161893735, "episode_len_mean": 683.22, "time_total_s": 1492.9751462936401, "time_since_restore": 1492.9751462936401}
{"timesteps_since_restore": 2582027, "training_iteration": 60, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-20-37", "episode_reward_min": 57.05210757098841, "timesteps_this_iter": 42596, "episode_reward_mean": 1219.6962298757114, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.097975492477417, "policy_reward_mean": {}, "iterations_since_restore": 60, "custom_metrics": {"outflow_rate_max": 1404.8963628371628, "cost2_mean": -21.93973120030286, "cost1_mean": 346.70607973763146, "system_level_velocity_mean": 13.578419819941846, "cost2_min": -32.207071210910875, "cost1_max": 413.2965491481086, "cost1_min": 31.740862577218465, "cost2_max": -9.050625158710814, "outflow_rate_mean": 1157.3655984253137, "system_level_velocity_min": 11.09873886226773, "outflow_rate_min": 331.6099134487595, "system_level_velocity_max": 18.60492977216203}, "info": {"num_steps_trained": 2582027, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011809997260570526, "total_loss": 14.427902221679688, "vf_loss": 14.430190086364746, "policy_loss": -0.0031742884311825037, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9400684237480164, "entropy": 1.1024255752563477}, "grad_time_ms": 9444.99, "load_time_ms": 14.073, "update_time_ms": 7.037, "num_steps_sampled": 2582027, "sample_time_ms": 13769.473}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f748>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2582027, "hostname": "flow-main", "episodes_total": 928, "timestamp": 1557231637, "episode_reward_max": 1416.6237161893735, "episode_len_mean": 678.52, "time_total_s": 1516.0731217861176, "time_since_restore": 1516.0731217861176}
{"timesteps_since_restore": 2624367, "training_iteration": 61, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-21-01", "episode_reward_min": 57.05210757098841, "timesteps_this_iter": 42340, "episode_reward_mean": 1227.9510925910783, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.219003200531006, "policy_reward_mean": {}, "iterations_since_restore": 61, "custom_metrics": {"outflow_rate_max": 1404.8963628371628, "cost2_mean": -21.706404641264275, "cost1_mean": 348.9476478267125, "system_level_velocity_mean": 13.50569900536303, "cost2_min": -32.207071210910875, "cost1_max": 413.2965491481086, "cost1_min": 31.740862577218465, "cost2_max": -9.050625158710814, "outflow_rate_mean": 1164.65298379051, "system_level_velocity_min": 11.09873886226773, "outflow_rate_min": 331.6099134487595, "system_level_velocity_max": 18.60492977216203}, "info": {"num_steps_trained": 2624367, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012250900268554688, "total_loss": 9.75156021118164, "vf_loss": 9.755210876464844, "policy_loss": -0.004570609889924526, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9606707692146301, "entropy": 1.0827890634536743}, "grad_time_ms": 9436.131, "load_time_ms": 14.014, "update_time_ms": 7.024, "num_steps_sampled": 2624367, "sample_time_ms": 13711.337}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f94611700f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5df28>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2624367, "hostname": "flow-main", "episodes_total": 943, "timestamp": 1557231661, "episode_reward_max": 1408.4755112473088, "episode_len_mean": 685.02, "time_total_s": 1540.2921249866486, "time_since_restore": 1540.2921249866486}
{"timesteps_since_restore": 2666228, "training_iteration": 62, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-21-24", "episode_reward_min": 57.05210757098841, "timesteps_this_iter": 41861, "episode_reward_mean": 1215.8951651429556, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.210543155670166, "policy_reward_mean": {}, "iterations_since_restore": 62, "custom_metrics": {"outflow_rate_max": 1404.8963628371628, "cost2_mean": -21.465449776140126, "cost1_mean": 346.72692758544525, "system_level_velocity_mean": 13.423540748937548, "cost2_min": -32.207071210910875, "cost1_max": 417.2132798829552, "cost1_min": 31.740862577218465, "cost2_max": -9.050625158710814, "outflow_rate_mean": 1158.1892060842163, "system_level_velocity_min": 10.575501063148584, "outflow_rate_min": 331.6099134487595, "system_level_velocity_max": 18.60492977216203}, "info": {"num_steps_trained": 2666228, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014432048425078392, "total_loss": 8.663293838500977, "vf_loss": 8.667132377624512, "policy_loss": -0.004921977408230305, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9673736095428467, "entropy": 1.0946015119552612}, "grad_time_ms": 9410.542, "load_time_ms": 13.821, "update_time_ms": 6.995, "num_steps_sampled": 2666228, "sample_time_ms": 13667.627}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbbe0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2666228, "hostname": "flow-main", "episodes_total": 958, "timestamp": 1557231684, "episode_reward_max": 1408.4755112473088, "episode_len_mean": 685.02, "time_total_s": 1563.5026681423187, "time_since_restore": 1563.5026681423187}
{"timesteps_since_restore": 2706480, "training_iteration": 63, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-21-47", "episode_reward_min": 57.05210757098841, "timesteps_this_iter": 40252, "episode_reward_mean": 1194.108465782745, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.13429284095764, "policy_reward_mean": {}, "iterations_since_restore": 63, "custom_metrics": {"outflow_rate_max": 1404.8963628371628, "cost2_mean": -20.44812444014708, "cost1_mean": 343.3615895630666, "system_level_velocity_mean": 13.30791134989567, "cost2_min": -32.207071210910875, "cost1_max": 417.2132798829552, "cost1_min": 31.740862577218465, "cost2_max": -9.050625158710814, "outflow_rate_mean": 1145.6646463319685, "system_level_velocity_min": 10.575501063148584, "outflow_rate_min": 331.6099134487595, "system_level_velocity_max": 18.60492977216203}, "info": {"num_steps_trained": 2706480, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011872833594679832, "total_loss": 10.478053092956543, "vf_loss": 10.481082916259766, "policy_loss": -0.00392096908763051, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9631288647651672, "entropy": 1.0838193893432617}, "grad_time_ms": 9516.795, "load_time_ms": 13.851, "update_time_ms": 7.089, "num_steps_sampled": 2706480, "sample_time_ms": 13630.047}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fcf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f5c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2706480, "hostname": "flow-main", "episodes_total": 975, "timestamp": 1557231707, "episode_reward_max": 1376.4471250701613, "episode_len_mean": 685.02, "time_total_s": 1586.6369609832764, "time_since_restore": 1586.6369609832764}
{"timesteps_since_restore": 2746848, "training_iteration": 64, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-22-10", "episode_reward_min": 57.05210757098841, "timesteps_this_iter": 40368, "episode_reward_mean": 1180.4133517859502, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.495020866394043, "policy_reward_mean": {}, "iterations_since_restore": 64, "custom_metrics": {"outflow_rate_max": 1404.8963628371628, "cost2_mean": -19.928218103154684, "cost1_mean": 343.877364397909, "system_level_velocity_mean": 13.47705462434381, "cost2_min": -32.207071210910875, "cost1_max": 417.2132798829552, "cost1_min": 31.740862577218465, "cost2_max": -9.050625158710814, "outflow_rate_mean": 1152.278293317418, "system_level_velocity_min": 10.575501063148584, "outflow_rate_min": 331.6099134487595, "system_level_velocity_max": 18.60492977216203}, "info": {"num_steps_trained": 2746848, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012242842465639114, "total_loss": 16.191547393798828, "vf_loss": 16.1954288482666, "policy_loss": -0.004800423979759216, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9327132701873779, "entropy": 1.0657507181167603}, "grad_time_ms": 9555.023, "load_time_ms": 13.856, "update_time_ms": 7.131, "num_steps_sampled": 2746848, "sample_time_ms": 13609.92}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5dc18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5db00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2746848, "hostname": "flow-main", "episodes_total": 990, "timestamp": 1557231730, "episode_reward_max": 1376.4471250701613, "episode_len_mean": 680.73, "time_total_s": 1609.1319818496704, "time_since_restore": 1609.1319818496704}
{"timesteps_since_restore": 2788268, "training_iteration": 65, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-22-31", "episode_reward_min": 57.05210757098841, "timesteps_this_iter": 41420, "episode_reward_mean": 1171.8197406382446, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.392075061798096, "policy_reward_mean": {}, "iterations_since_restore": 65, "custom_metrics": {"outflow_rate_max": 1401.1051496503499, "cost2_mean": -19.42535221396782, "cost1_mean": 343.42796057938443, "system_level_velocity_mean": 13.397143779065356, "cost2_min": -32.207071210910875, "cost1_max": 417.2132798829552, "cost1_min": 31.740862577218465, "cost2_max": -9.050625158710814, "outflow_rate_mean": 1146.1561811858444, "system_level_velocity_min": 10.575501063148584, "outflow_rate_min": 331.6099134487595, "system_level_velocity_max": 18.60492977216203}, "info": {"num_steps_trained": 2788268, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011579476296901703, "total_loss": 9.803789138793945, "vf_loss": 9.807655334472656, "policy_loss": -0.00473279133439064, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.963756263256073, "entropy": 1.0555157661437988}, "grad_time_ms": 9478.105, "load_time_ms": 13.922, "update_time_ms": 7.284, "num_steps_sampled": 2788268, "sample_time_ms": 13571.694}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fb00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fc18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2788268, "hostname": "flow-main", "episodes_total": 1006, "timestamp": 1557231751, "episode_reward_max": 1376.4471250701613, "episode_len_mean": 684.47, "time_total_s": 1630.5240569114685, "time_since_restore": 1630.5240569114685}
{"timesteps_since_restore": 2828512, "training_iteration": 66, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-22-52", "episode_reward_min": 182.17053342981788, "timesteps_this_iter": 40244, "episode_reward_mean": 1173.5856399501413, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 20.651758909225464, "policy_reward_mean": {}, "iterations_since_restore": 66, "custom_metrics": {"outflow_rate_max": 1342.4392711288713, "cost2_mean": -18.99333330625735, "cost1_mean": 347.51085292607377, "system_level_velocity_mean": 13.456642209672324, "cost2_min": -31.764248845490776, "cost1_max": 417.2132798829552, "cost1_min": 73.34995623589893, "cost2_max": -10.464053440069586, "outflow_rate_mean": 1155.2620518932747, "system_level_velocity_min": 10.575501063148584, "outflow_rate_min": 440.8060228504747, "system_level_velocity_max": 18.356889831647855}, "info": {"num_steps_trained": 2828512, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012476064264774323, "total_loss": 16.57297706604004, "vf_loss": 16.575773239135742, "policy_loss": -0.0037318228278309107, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9370577931404114, "entropy": 1.0473130941390991}, "grad_time_ms": 9366.466, "load_time_ms": 13.605, "update_time_ms": 7.154, "num_steps_sampled": 2828512, "sample_time_ms": 13550.808}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fcf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fd30>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2828512, "hostname": "flow-main", "episodes_total": 1024, "timestamp": 1557231772, "episode_reward_max": 1376.4471250701613, "episode_len_mean": 689.8, "time_total_s": 1651.175815820694, "time_since_restore": 1651.175815820694}
{"timesteps_since_restore": 2869252, "training_iteration": 67, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-23-15", "episode_reward_min": 182.17053342981788, "timesteps_this_iter": 40740, "episode_reward_mean": 1167.6803958496196, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.928502321243286, "policy_reward_mean": {}, "iterations_since_restore": 67, "custom_metrics": {"outflow_rate_max": 1342.4392711288713, "cost2_mean": -18.835334924410756, "cost1_mean": 349.72644127363725, "system_level_velocity_mean": 13.575238549926112, "cost2_min": -31.764248845490776, "cost1_max": 417.2132798829552, "cost1_min": 73.34995623589893, "cost2_max": -10.464053440069586, "outflow_rate_mean": 1160.5927281370311, "system_level_velocity_min": 10.575501063148584, "outflow_rate_min": 440.8060228504747, "system_level_velocity_max": 18.356889831647855}, "info": {"num_steps_trained": 2869252, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012526760809123516, "total_loss": 10.27486515045166, "vf_loss": 10.277932167053223, "policy_loss": -0.004005955997854471, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9658113121986389, "entropy": 1.0902053117752075}, "grad_time_ms": 9480.085, "load_time_ms": 13.763, "update_time_ms": 7.12, "num_steps_sampled": 2869252, "sample_time_ms": 13442.849}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116ff28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f128>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2869252, "hostname": "flow-main", "episodes_total": 1041, "timestamp": 1557231795, "episode_reward_max": 1376.4471250701613, "episode_len_mean": 689.8, "time_total_s": 1674.1043181419373, "time_since_restore": 1674.1043181419373}
{"timesteps_since_restore": 2909677, "training_iteration": 68, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-23-37", "episode_reward_min": 182.17053342981788, "timesteps_this_iter": 40425, "episode_reward_mean": 1169.3565065669472, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.490943908691406, "policy_reward_mean": {}, "iterations_since_restore": 68, "custom_metrics": {"outflow_rate_max": 1485.9200343656344, "cost2_mean": -18.570835399921826, "cost1_mean": 352.80407838056954, "system_level_velocity_mean": 13.735934077735953, "cost2_min": -25.21160471926086, "cost1_max": 410.18411526145695, "cost1_min": 73.34995623589893, "cost2_max": -10.464053440069586, "outflow_rate_mean": 1173.527751309858, "system_level_velocity_min": 11.224933424102693, "outflow_rate_min": 440.8060228504747, "system_level_velocity_max": 18.356889831647855}, "info": {"num_steps_trained": 2909677, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013346238993108273, "total_loss": 13.197798728942871, "vf_loss": 13.202388763427734, "policy_loss": -0.005591126624494791, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9593891501426697, "entropy": 1.0958974361419678}, "grad_time_ms": 9477.498, "load_time_ms": 13.625, "update_time_ms": 7.052, "num_steps_sampled": 2909677, "sample_time_ms": 13274.292}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fa20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc914e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2909677, "hostname": "flow-main", "episodes_total": 1059, "timestamp": 1557231817, "episode_reward_max": 1356.9017677390395, "episode_len_mean": 689.8, "time_total_s": 1696.5952620506287, "time_since_restore": 1696.5952620506287}
{"timesteps_since_restore": 2950136, "training_iteration": 69, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-24-00", "episode_reward_min": 182.17053342981788, "timesteps_this_iter": 40459, "episode_reward_mean": 1176.5651572105476, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.801098585128784, "policy_reward_mean": {}, "iterations_since_restore": 69, "custom_metrics": {"outflow_rate_max": 1485.9200343656344, "cost2_mean": -18.47397343585196, "cost1_mean": 358.59254548911673, "system_level_velocity_mean": 14.003274805271117, "cost2_min": -25.21160471926086, "cost1_max": 430.03095644094515, "cost1_min": 73.34995623589893, "cost2_max": -10.464053440069586, "outflow_rate_mean": 1193.5443462589092, "system_level_velocity_min": 11.293142399868044, "outflow_rate_min": 440.8060228504747, "system_level_velocity_max": 18.356889831647855}, "info": {"num_steps_trained": 2950136, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015053216367959976, "total_loss": 14.144648551940918, "vf_loss": 14.148998260498047, "policy_loss": -0.005480221938341856, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9508742094039917, "entropy": 1.092023491859436}, "grad_time_ms": 9309.059, "load_time_ms": 13.701, "update_time_ms": 6.887, "num_steps_sampled": 2950136, "sample_time_ms": 13236.328}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fe80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fa58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2950136, "hostname": "flow-main", "episodes_total": 1074, "timestamp": 1557231840, "episode_reward_max": 1356.9017677390395, "episode_len_mean": 689.8, "time_total_s": 1719.3963606357574, "time_since_restore": 1719.3963606357574}
{"timesteps_since_restore": 2991558, "training_iteration": 70, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-24-21", "episode_reward_min": 182.17053342981788, "timesteps_this_iter": 41422, "episode_reward_mean": 1186.9055774307124, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.185317516326904, "policy_reward_mean": {}, "iterations_since_restore": 70, "custom_metrics": {"outflow_rate_max": 1485.9200343656344, "cost2_mean": -18.454812439660717, "cost1_mean": 361.6973999879268, "system_level_velocity_mean": 14.02663783538716, "cost2_min": -25.21160471926086, "cost1_max": 430.03095644094515, "cost1_min": 73.34995623589893, "cost2_max": -10.464053440069586, "outflow_rate_mean": 1199.3379913294038, "system_level_velocity_min": 11.293142399868044, "outflow_rate_min": 440.8060228504747, "system_level_velocity_max": 18.356889831647855}, "info": {"num_steps_trained": 2991558, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013933630660176277, "total_loss": 14.153338432312012, "vf_loss": 14.156575202941895, "policy_loss": -0.004281284753233194, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9429143667221069, "entropy": 1.1167973279953003}, "grad_time_ms": 9289.419, "load_time_ms": 13.734, "update_time_ms": 6.718, "num_steps_sampled": 2991558, "sample_time_ms": 13065.319}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fc18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 2991558, "hostname": "flow-main", "episodes_total": 1090, "timestamp": 1557231861, "episode_reward_max": 1356.9017677390395, "episode_len_mean": 694.09, "time_total_s": 1740.5816781520844, "time_since_restore": 1740.5816781520844}
{"timesteps_since_restore": 3032902, "training_iteration": 71, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-24-45", "episode_reward_min": 59.584266003991175, "timesteps_this_iter": 41344, "episode_reward_mean": 1180.913561705707, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.85658860206604, "policy_reward_mean": {}, "iterations_since_restore": 71, "custom_metrics": {"outflow_rate_max": 1485.9200343656344, "cost2_mean": -18.400258044568513, "cost1_mean": 361.2604974582141, "system_level_velocity_mean": 14.214422069973946, "cost2_min": -25.21160471926086, "cost1_max": 430.03095644094515, "cost1_min": 32.11893394987809, "cost2_max": -10.464053440069586, "outflow_rate_mean": 1200.7346267114604, "system_level_velocity_min": 11.293142399868044, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.356889831647855}, "info": {"num_steps_trained": 3032902, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014700435101985931, "total_loss": 17.689098358154297, "vf_loss": 17.693927764892578, "policy_loss": -0.005935109686106443, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9350935816764832, "entropy": 1.1089940071105957}, "grad_time_ms": 9263.618, "load_time_ms": 13.283, "update_time_ms": 6.617, "num_steps_sampled": 3032902, "sample_time_ms": 13056.575}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3a90>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3032902, "hostname": "flow-main", "episodes_total": 1108, "timestamp": 1557231885, "episode_reward_max": 1356.9017677390395, "episode_len_mean": 687.59, "time_total_s": 1764.4382667541504, "time_since_restore": 1764.4382667541504}
{"timesteps_since_restore": 3073482, "training_iteration": 72, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-25-08", "episode_reward_min": 51.00298119536483, "timesteps_this_iter": 40580, "episode_reward_mean": 1155.584949720133, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.126712560653687, "policy_reward_mean": {}, "iterations_since_restore": 72, "custom_metrics": {"outflow_rate_max": 1485.9200343656344, "cost2_mean": -17.999164233629607, "cost1_mean": 350.9614679991721, "system_level_velocity_mean": 14.154012827626723, "cost2_min": -25.21160471926086, "cost1_max": 430.03095644094515, "cost1_min": 28.615987446306214, "cost2_max": -7.737154511299951, "outflow_rate_mean": 1173.232517213868, "system_level_velocity_min": 11.293142399868044, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.367116035297236}, "info": {"num_steps_trained": 3073482, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01551025826483965, "total_loss": 20.40697479248047, "vf_loss": 20.41097640991211, "policy_loss": -0.0051673040725290775, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9279325008392334, "entropy": 1.086150050163269}, "grad_time_ms": 9345.671, "load_time_ms": 13.198, "update_time_ms": 6.541, "num_steps_sampled": 3073482, "sample_time_ms": 12967.269}, "episodes_this_iter": 21, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f4e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3073482, "hostname": "flow-main", "episodes_total": 1129, "timestamp": 1557231908, "episode_reward_max": 1356.9017677390395, "episode_len_mean": 675.62, "time_total_s": 1787.564979314804, "time_since_restore": 1787.564979314804}
{"timesteps_since_restore": 3114738, "training_iteration": 73, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-25-31", "episode_reward_min": 51.00298119536483, "timesteps_this_iter": 41256, "episode_reward_mean": 1155.2303072006237, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.74839210510254, "policy_reward_mean": {}, "iterations_since_restore": 73, "custom_metrics": {"outflow_rate_max": 1485.9200343656344, "cost2_mean": -17.805202288502766, "cost1_mean": 350.0771059933141, "system_level_velocity_mean": 14.127299746607905, "cost2_min": -23.560365150934985, "cost1_max": 430.03095644094515, "cost1_min": 28.615987446306214, "cost2_max": -7.737154511299951, "outflow_rate_mean": 1171.605988986096, "system_level_velocity_min": 11.401007998103665, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.367116035297236}, "info": {"num_steps_trained": 3114738, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013422498479485512, "total_loss": 9.76158332824707, "vf_loss": 9.764532089233398, "policy_loss": -0.003955511376261711, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.96232008934021, "entropy": 1.1053216457366943}, "grad_time_ms": 9268.899, "load_time_ms": 13.0, "update_time_ms": 6.421, "num_steps_sampled": 3114738, "sample_time_ms": 13006.092}, "episodes_this_iter": 13, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3114738, "hostname": "flow-main", "episodes_total": 1142, "timestamp": 1557231931, "episode_reward_max": 1356.9017677390395, "episode_len_mean": 675.62, "time_total_s": 1810.3133714199066, "time_since_restore": 1810.3133714199066}
{"timesteps_since_restore": 3156367, "training_iteration": 74, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-25-54", "episode_reward_min": 51.00298119536483, "timesteps_this_iter": 41629, "episode_reward_mean": 1145.6066887405266, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.33397150039673, "policy_reward_mean": {}, "iterations_since_restore": 74, "custom_metrics": {"outflow_rate_max": 1457.5750593406594, "cost2_mean": -17.807148411241027, "cost1_mean": 346.8021228185109, "system_level_velocity_mean": 14.26789618473897, "cost2_min": -24.985903752166735, "cost1_max": 430.03095644094515, "cost1_min": 28.615987446306214, "cost2_max": -7.737154511299951, "outflow_rate_mean": 1161.4977647911253, "system_level_velocity_min": 11.401007998103665, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.367116035297236}, "info": {"num_steps_trained": 3156367, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014602301642298698, "total_loss": 17.828765869140625, "vf_loss": 17.83272361755371, "policy_loss": -0.005052831023931503, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9303979277610779, "entropy": 1.1081793308258057}, "grad_time_ms": 9319.257, "load_time_ms": 13.046, "update_time_ms": 6.391, "num_steps_sampled": 3156367, "sample_time_ms": 12939.2}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fcf8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3156367, "hostname": "flow-main", "episodes_total": 1160, "timestamp": 1557231954, "episode_reward_max": 1345.5139836081046, "episode_len_mean": 664.56, "time_total_s": 1832.6473429203033, "time_since_restore": 1832.6473429203033}
{"timesteps_since_restore": 3196728, "training_iteration": 75, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-26-16", "episode_reward_min": 51.00298119536483, "timesteps_this_iter": 40361, "episode_reward_mean": 1127.217556725926, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.667521476745605, "policy_reward_mean": {}, "iterations_since_restore": 75, "custom_metrics": {"outflow_rate_max": 1457.5750593406594, "cost2_mean": -18.07664187991572, "cost1_mean": 339.2208383739074, "system_level_velocity_mean": 14.132748998318661, "cost2_min": -25.843221150332454, "cost1_max": 422.5588054438015, "cost1_min": 28.615987446306214, "cost2_max": -7.226078707624846, "outflow_rate_mean": 1136.493788734043, "system_level_velocity_min": 11.401007998103665, "outflow_rate_min": 329.0289964895558, "system_level_velocity_max": 19.367116035297236}, "info": {"num_steps_trained": 3196728, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.019329098984599113, "total_loss": 14.5259428024292, "vf_loss": 14.531609535217285, "policy_loss": -0.007117525674402714, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9490814805030823, "entropy": 1.0986136198043823}, "grad_time_ms": 9552.207, "load_time_ms": 12.982, "update_time_ms": 6.12, "num_steps_sampled": 3196728, "sample_time_ms": 12833.223}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc914e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cdd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3196728, "hostname": "flow-main", "episodes_total": 1176, "timestamp": 1557231976, "episode_reward_max": 1342.2640100787394, "episode_len_mean": 658.0, "time_total_s": 1855.314864397049, "time_since_restore": 1855.314864397049}
{"timesteps_since_restore": 3236445, "training_iteration": 76, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-26-39", "episode_reward_min": 51.00298119536483, "timesteps_this_iter": 39717, "episode_reward_mean": 1123.661993014616, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.65816593170166, "policy_reward_mean": {}, "iterations_since_restore": 76, "custom_metrics": {"outflow_rate_max": 1466.8680571428572, "cost2_mean": -18.15891460621994, "cost1_mean": 338.2028871503857, "system_level_velocity_mean": 14.19499497747167, "cost2_min": -25.843221150332454, "cost1_max": 433.6303146279711, "cost1_min": 28.615987446306214, "cost2_max": -7.226078707624846, "outflow_rate_mean": 1139.1349727949814, "system_level_velocity_min": 11.324339410734032, "outflow_rate_min": 329.0289964895558, "system_level_velocity_max": 19.367116035297236}, "info": {"num_steps_trained": 3236445, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018018130213022232, "total_loss": 20.634441375732422, "vf_loss": 20.638599395751953, "policy_loss": -0.005510739050805569, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9183991551399231, "entropy": 1.1047554016113281}, "grad_time_ms": 9762.381, "load_time_ms": 12.857, "update_time_ms": 6.276, "num_steps_sampled": 3236445, "sample_time_ms": 12823.688}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fe48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3236445, "hostname": "flow-main", "episodes_total": 1194, "timestamp": 1557231999, "episode_reward_max": 1380.5218376389398, "episode_len_mean": 653.22, "time_total_s": 1877.9730303287506, "time_since_restore": 1877.9730303287506}
{"timesteps_since_restore": 3276453, "training_iteration": 77, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-27-02", "episode_reward_min": 51.00298119536483, "timesteps_this_iter": 40008, "episode_reward_mean": 1134.4267011807694, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.10067081451416, "policy_reward_mean": {}, "iterations_since_restore": 77, "custom_metrics": {"outflow_rate_max": 1466.8680571428572, "cost2_mean": -18.245795136597604, "cost1_mean": 342.0325854153253, "system_level_velocity_mean": 14.158516335009583, "cost2_min": -25.843221150332454, "cost1_max": 433.6303146279711, "cost1_min": 28.615987446306214, "cost2_max": -7.226078707624846, "outflow_rate_mean": 1147.4959126885815, "system_level_velocity_min": 10.72152449483809, "outflow_rate_min": 329.0289964895558, "system_level_velocity_max": 19.367116035297236}, "info": {"num_steps_trained": 3276453, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015023157000541687, "total_loss": 19.339649200439453, "vf_loss": 19.342212677001953, "policy_loss": -0.003691303776577115, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9328323602676392, "entropy": 1.1122881174087524}, "grad_time_ms": 9777.486, "load_time_ms": 12.729, "update_time_ms": 6.424, "num_steps_sampled": 3276453, "sample_time_ms": 12824.978}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fe80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fe10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3276453, "hostname": "flow-main", "episodes_total": 1213, "timestamp": 1557232022, "episode_reward_max": 1380.5218376389398, "episode_len_mean": 659.05, "time_total_s": 1901.0737011432648, "time_since_restore": 1901.0737011432648}
{"timesteps_since_restore": 3316910, "training_iteration": 78, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-27-25", "episode_reward_min": 53.04092876597004, "timesteps_this_iter": 40457, "episode_reward_mean": 1165.0493830770065, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.801222562789917, "policy_reward_mean": {}, "iterations_since_restore": 78, "custom_metrics": {"outflow_rate_max": 1466.8680571428572, "cost2_mean": -19.02773492470553, "cost1_mean": 351.54109372256045, "system_level_velocity_mean": 14.141959900448612, "cost2_min": -25.843221150332454, "cost1_max": 433.6303146279711, "cost1_min": 29.39070189761729, "cost2_max": -7.226078707624846, "outflow_rate_mean": 1174.7635524645098, "system_level_velocity_min": 10.72152449483809, "outflow_rate_min": 329.0289964895558, "system_level_velocity_max": 19.125387016957713}, "info": {"num_steps_trained": 3316910, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013602078892290592, "total_loss": 17.660917282104492, "vf_loss": 17.663599014282227, "policy_loss": -0.0037016107235103846, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9297806024551392, "entropy": 1.1274147033691406}, "grad_time_ms": 9759.812, "load_time_ms": 12.828, "update_time_ms": 6.476, "num_steps_sampled": 3316910, "sample_time_ms": 12872.17}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fda0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fcc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3316910, "hostname": "flow-main", "episodes_total": 1230, "timestamp": 1557232045, "episode_reward_max": 1387.0369490279186, "episode_len_mean": 672.17, "time_total_s": 1923.8749237060547, "time_since_restore": 1923.8749237060547}
{"timesteps_since_restore": 3358580, "training_iteration": 79, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-27-46", "episode_reward_min": 53.04092876597004, "timesteps_this_iter": 41670, "episode_reward_mean": 1160.979437086398, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.301106214523315, "policy_reward_mean": {}, "iterations_since_restore": 79, "custom_metrics": {"outflow_rate_max": 1466.8680571428572, "cost2_mean": -19.362725736344544, "cost1_mean": 354.54186261805825, "system_level_velocity_mean": 14.266601420782086, "cost2_min": -31.4583286129108, "cost1_max": 449.53367834303793, "cost1_min": 29.39070189761729, "cost2_max": -7.226078707624846, "outflow_rate_mean": 1177.396161843131, "system_level_velocity_min": 10.72152449483809, "outflow_rate_min": 329.0289964895558, "system_level_velocity_max": 19.125387016957713}, "info": {"num_steps_trained": 3358580, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011619364842772484, "total_loss": 12.49165153503418, "vf_loss": 12.495291709899902, "policy_loss": -0.004510929808020592, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9511408805847168, "entropy": 1.1301320791244507}, "grad_time_ms": 9625.456, "load_time_ms": 12.891, "update_time_ms": 6.544, "num_steps_sampled": 3358580, "sample_time_ms": 12858.317}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f5f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3358580, "hostname": "flow-main", "episodes_total": 1246, "timestamp": 1557232066, "episode_reward_max": 1387.0369490279186, "episode_len_mean": 672.17, "time_total_s": 1945.176029920578, "time_since_restore": 1945.176029920578}
{"timesteps_since_restore": 3399714, "training_iteration": 80, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-28-10", "episode_reward_min": 53.04092876597004, "timesteps_this_iter": 41134, "episode_reward_mean": 1172.0748317986454, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.203883409500122, "policy_reward_mean": {}, "iterations_since_restore": 80, "custom_metrics": {"outflow_rate_max": 1466.8680571428572, "cost2_mean": -19.484196508649223, "cost1_mean": 356.2465328741126, "system_level_velocity_mean": 14.053273656590394, "cost2_min": -31.4583286129108, "cost1_max": 449.53367834303793, "cost1_min": 29.39070189761729, "cost2_max": -7.226078707624846, "outflow_rate_mean": 1177.4240603877518, "system_level_velocity_min": 10.72152449483809, "outflow_rate_min": 329.0289964895558, "system_level_velocity_max": 19.125387016957713}, "info": {"num_steps_trained": 3399714, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01409564632922411, "total_loss": 12.740523338317871, "vf_loss": 12.744601249694824, "policy_loss": -0.0051352716982364655, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9483243227005005, "entropy": 1.124660611152649}, "grad_time_ms": 9785.717, "load_time_ms": 13.045, "update_time_ms": 6.514, "num_steps_sampled": 3399714, "sample_time_ms": 12899.844}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb544e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fe10>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3399714, "hostname": "flow-main", "episodes_total": 1260, "timestamp": 1557232090, "episode_reward_max": 1387.0369490279186, "episode_len_mean": 683.23, "time_total_s": 1968.3799133300781, "time_since_restore": 1968.3799133300781}
{"timesteps_since_restore": 3440757, "training_iteration": 81, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-28-33", "episode_reward_min": 53.48590057716935, "timesteps_this_iter": 41043, "episode_reward_mean": 1173.2355664413808, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.97868847846985, "policy_reward_mean": {}, "iterations_since_restore": 81, "custom_metrics": {"outflow_rate_max": 1466.8680571428572, "cost2_mean": -19.52718984747673, "cost1_mean": 355.4702405725731, "system_level_velocity_mean": 14.034018225650518, "cost2_min": -31.4583286129108, "cost1_max": 449.53367834303793, "cost1_min": 28.30186890913665, "cost2_max": -8.887379562619476, "outflow_rate_mean": 1172.6384094855594, "system_level_velocity_min": 10.72152449483809, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.891482846693236}, "info": {"num_steps_trained": 3440757, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014295225031673908, "total_loss": 18.186555862426758, "vf_loss": 18.19097900390625, "policy_loss": -0.005495822988450527, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9326804876327515, "entropy": 1.1340811252593994}, "grad_time_ms": 9793.581, "load_time_ms": 13.621, "update_time_ms": 6.383, "num_steps_sampled": 3440757, "sample_time_ms": 12802.271}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbbe0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3440757, "hostname": "flow-main", "episodes_total": 1278, "timestamp": 1557232113, "episode_reward_max": 1387.0369490279186, "episode_len_mean": 683.22, "time_total_s": 1991.358601808548, "time_since_restore": 1991.358601808548}
{"timesteps_since_restore": 3481051, "training_iteration": 82, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-28-55", "episode_reward_min": 53.48590057716935, "timesteps_this_iter": 40294, "episode_reward_mean": 1183.6726286649628, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.83976912498474, "policy_reward_mean": {}, "iterations_since_restore": 82, "custom_metrics": {"outflow_rate_max": 1450.5149538461537, "cost2_mean": -20.608552717490465, "cost1_mean": 357.7978707831286, "system_level_velocity_mean": 13.871731947966232, "cost2_min": -32.838464113078544, "cost1_max": 450.5706432058829, "cost1_min": 28.30186890913665, "cost2_max": -8.887379562619476, "outflow_rate_mean": 1174.5737569088567, "system_level_velocity_min": 10.710791082253596, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.891482846693236}, "info": {"num_steps_trained": 3481051, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013316200114786625, "total_loss": 13.22170639038086, "vf_loss": 13.22566032409668, "policy_loss": -0.004953366704285145, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9531006217002869, "entropy": 1.1177828311920166}, "grad_time_ms": 9830.053, "load_time_ms": 13.837, "update_time_ms": 6.451, "num_steps_sampled": 3481051, "sample_time_ms": 12737.333}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116ff60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fe48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3481051, "hostname": "flow-main", "episodes_total": 1295, "timestamp": 1557232135, "episode_reward_max": 1520.8476002118969, "episode_len_mean": 693.43, "time_total_s": 2014.1983709335327, "time_since_restore": 2014.1983709335327}
{"timesteps_since_restore": 3522428, "training_iteration": 83, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-29-18", "episode_reward_min": 53.48590057716935, "timesteps_this_iter": 41377, "episode_reward_mean": 1185.6540437976726, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.09053897857666, "policy_reward_mean": {}, "iterations_since_restore": 83, "custom_metrics": {"outflow_rate_max": 1427.2570865134865, "cost2_mean": -21.474585966466925, "cost1_mean": 359.0026986045582, "system_level_velocity_mean": 13.920859328313174, "cost2_min": -32.872798571941914, "cost1_max": 450.5706432058829, "cost1_min": 28.30186890913665, "cost2_max": -8.887379562619476, "outflow_rate_mean": 1174.9204646371286, "system_level_velocity_min": 10.710791082253596, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.891482846693236}, "info": {"num_steps_trained": 3522428, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015069902874529362, "total_loss": 13.335087776184082, "vf_loss": 13.339619636535645, "policy_loss": -0.005662682466208935, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9490207433700562, "entropy": 1.110223650932312}, "grad_time_ms": 9957.907, "load_time_ms": 13.974, "update_time_ms": 6.481, "num_steps_sampled": 3522428, "sample_time_ms": 12643.304}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbbe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf4a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3522428, "hostname": "flow-main", "episodes_total": 1311, "timestamp": 1557232158, "episode_reward_max": 1520.8476002118969, "episode_len_mean": 693.43, "time_total_s": 2037.2889099121094, "time_since_restore": 2037.2889099121094}
{"timesteps_since_restore": 3564635, "training_iteration": 84, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-29-42", "episode_reward_min": 53.48590057716935, "timesteps_this_iter": 42207, "episode_reward_mean": 1171.3847191117563, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.120439052581787, "policy_reward_mean": {}, "iterations_since_restore": 84, "custom_metrics": {"outflow_rate_max": 1416.835922077922, "cost2_mean": -22.538430701418143, "cost1_mean": 354.3006378801472, "system_level_velocity_mean": 13.851950066911114, "cost2_min": -39.192278572436365, "cost1_max": 450.5706432058829, "cost1_min": 28.30186890913665, "cost2_max": -8.887379562619476, "outflow_rate_mean": 1163.9424589938592, "system_level_velocity_min": 10.710791082253596, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.891482846693236}, "info": {"num_steps_trained": 3564635, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014180024154484272, "total_loss": 13.089628219604492, "vf_loss": 13.094284057617188, "policy_loss": -0.005720219109207392, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9512805938720703, "entropy": 1.1111630201339722}, "grad_time_ms": 10092.682, "load_time_ms": 14.182, "update_time_ms": 6.519, "num_steps_sampled": 3564635, "sample_time_ms": 12587.071}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fcc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fc50>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3564635, "hostname": "flow-main", "episodes_total": 1327, "timestamp": 1557232182, "episode_reward_max": 1520.8476002118969, "episode_len_mean": 688.6, "time_total_s": 2060.409348964691, "time_since_restore": 2060.409348964691}
{"timesteps_since_restore": 3606816, "training_iteration": 85, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-30-06", "episode_reward_min": 53.48590057716935, "timesteps_this_iter": 42181, "episode_reward_mean": 1173.8567822073676, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.247217416763306, "policy_reward_mean": {}, "iterations_since_restore": 85, "custom_metrics": {"outflow_rate_max": 1416.835922077922, "cost2_mean": -23.37467924931062, "cost1_mean": 354.3029846130246, "system_level_velocity_mean": 13.840684887550703, "cost2_min": -39.192278572436365, "cost1_max": 450.5706432058829, "cost1_min": 28.30186890913665, "cost2_max": -8.887379562619476, "outflow_rate_mean": 1166.5774716252274, "system_level_velocity_min": 10.710791082253596, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.891482846693236}, "info": {"num_steps_trained": 3606816, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016148734837770462, "total_loss": 10.369796752929688, "vf_loss": 10.375275611877441, "policy_loss": -0.006690628360956907, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.959276556968689, "entropy": 1.1130541563034058}, "grad_time_ms": 10194.25, "load_time_ms": 13.74, "update_time_ms": 6.574, "num_steps_sampled": 3606816, "sample_time_ms": 12639.878}, "episodes_this_iter": 13, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb691d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69cc0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3606816, "hostname": "flow-main", "episodes_total": 1340, "timestamp": 1557232206, "episode_reward_max": 1520.8476002118969, "episode_len_mean": 688.6, "time_total_s": 2084.6565663814545, "time_since_restore": 2084.6565663814545}
{"timesteps_since_restore": 3649194, "training_iteration": 86, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-30-32", "episode_reward_min": 53.48590057716935, "timesteps_this_iter": 42378, "episode_reward_mean": 1172.521189024736, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 26.126524448394775, "policy_reward_mean": {}, "iterations_since_restore": 86, "custom_metrics": {"outflow_rate_max": 1401.0664843156842, "cost2_mean": -24.223872493687658, "cost1_mean": 350.1445974180961, "system_level_velocity_mean": 13.802174511687312, "cost2_min": -39.192278572436365, "cost1_max": 450.5706432058829, "cost1_min": 28.30186890913665, "cost2_max": -8.887379562619476, "outflow_rate_mean": 1161.8809557527377, "system_level_velocity_min": 10.710791082253596, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.891482846693236}, "info": {"num_steps_trained": 3649194, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014986947178840637, "total_loss": 13.409354209899902, "vf_loss": 13.41358757019043, "policy_loss": -0.005356202367693186, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9478846192359924, "entropy": 1.1069920063018799}, "grad_time_ms": 10359.019, "load_time_ms": 14.082, "update_time_ms": 7.07, "num_steps_sampled": 3649194, "sample_time_ms": 12820.254}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fe48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5da20>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3649194, "hostname": "flow-main", "episodes_total": 1357, "timestamp": 1557232232, "episode_reward_max": 1520.8476002118969, "episode_len_mean": 683.81, "time_total_s": 2110.7830908298492, "time_since_restore": 2110.7830908298492}
{"timesteps_since_restore": 3690983, "training_iteration": 87, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-30-56", "episode_reward_min": 384.45257668522845, "timesteps_this_iter": 41789, "episode_reward_mean": 1186.0482808697373, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.761141300201416, "policy_reward_mean": {}, "iterations_since_restore": 87, "custom_metrics": {"outflow_rate_max": 1444.3166917082917, "cost2_mean": -26.362899161879287, "cost1_mean": 354.93942972965556, "system_level_velocity_mean": 13.804689084799396, "cost2_min": -39.192278572436365, "cost1_max": 450.5706432058829, "cost1_min": 144.7274946412235, "cost2_max": -17.790740225435, "outflow_rate_mean": 1182.116874769955, "system_level_velocity_min": 10.710791082253596, "outflow_rate_min": 755.3468041046164, "system_level_velocity_max": 17.972189413211286}, "info": {"num_steps_trained": 3690983, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016790835186839104, "total_loss": 12.281136512756348, "vf_loss": 12.286073684692383, "policy_loss": -0.006197397131472826, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9604201912879944, "entropy": 1.0831619501113892}, "grad_time_ms": 10356.978, "load_time_ms": 14.106, "update_time_ms": 7.225, "num_steps_sampled": 3690983, "sample_time_ms": 12887.937}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fc50>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3690983, "hostname": "flow-main", "episodes_total": 1375, "timestamp": 1557232256, "episode_reward_max": 1520.8476002118969, "episode_len_mean": 690.38, "time_total_s": 2134.5442321300507, "time_since_restore": 2134.5442321300507}
{"timesteps_since_restore": 3732660, "training_iteration": 88, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-31-19", "episode_reward_min": 194.23632420983145, "timesteps_this_iter": 41677, "episode_reward_mean": 1182.6117085753692, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.249032735824585, "policy_reward_mean": {}, "iterations_since_restore": 88, "custom_metrics": {"outflow_rate_max": 1444.3166917082917, "cost2_mean": -28.200144669248235, "cost1_mean": 354.79051443193794, "system_level_velocity_mean": 13.968704850190512, "cost2_min": -41.14862107690845, "cost1_max": 447.1297870239033, "cost1_min": 89.81757075970373, "cost2_max": -16.836757903411517, "outflow_rate_mean": 1186.1707039169146, "system_level_velocity_min": 11.24658741793675, "outflow_rate_min": 521.6251988118496, "system_level_velocity_max": 19.214920431756585}, "info": {"num_steps_trained": 3732660, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015714824199676514, "total_loss": 14.221672058105469, "vf_loss": 14.225991249084473, "policy_loss": -0.005497951526194811, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9527705907821655, "entropy": 1.107055902481079}, "grad_time_ms": 10396.298, "load_time_ms": 13.813, "update_time_ms": 7.3, "num_steps_sampled": 3732660, "sample_time_ms": 12893.604}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb696d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb699b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69da0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3732660, "hostname": "flow-main", "episodes_total": 1393, "timestamp": 1557232279, "episode_reward_max": 1383.496131878279, "episode_len_mean": 684.68, "time_total_s": 2157.7932648658752, "time_since_restore": 2157.7932648658752}
{"timesteps_since_restore": 3774852, "training_iteration": 89, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-31-41", "episode_reward_min": 194.23632420983145, "timesteps_this_iter": 42192, "episode_reward_mean": 1177.6893143425063, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.29751753807068, "policy_reward_mean": {}, "iterations_since_restore": 89, "custom_metrics": {"outflow_rate_max": 1444.3166917082917, "cost2_mean": -29.17422146831843, "cost1_mean": 352.7296183632891, "system_level_velocity_mean": 13.913434605145177, "cost2_min": -41.14862107690845, "cost1_max": 447.1297870239033, "cost1_min": 89.81757075970373, "cost2_max": -16.836757903411517, "outflow_rate_mean": 1180.6865210837477, "system_level_velocity_min": 11.24658741793675, "outflow_rate_min": 521.6251988118496, "system_level_velocity_max": 19.214920431756585}, "info": {"num_steps_trained": 3774852, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018036605790257454, "total_loss": 8.015738487243652, "vf_loss": 8.02070140838623, "policy_loss": -0.006316090933978558, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9728638529777527, "entropy": 1.1087490320205688}, "grad_time_ms": 10376.294, "load_time_ms": 13.808, "update_time_ms": 7.404, "num_steps_sampled": 3774852, "sample_time_ms": 13011.837}, "episodes_this_iter": 13, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fbe0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3774852, "hostname": "flow-main", "episodes_total": 1406, "timestamp": 1557232301, "episode_reward_max": 1383.496131878279, "episode_len_mean": 684.68, "time_total_s": 2180.090782403946, "time_since_restore": 2180.090782403946}
{"timesteps_since_restore": 3815530, "training_iteration": 90, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-32-04", "episode_reward_min": 50.009998295286906, "timesteps_this_iter": 40678, "episode_reward_mean": 1179.8275126784035, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.266929388046265, "policy_reward_mean": {}, "iterations_since_restore": 90, "custom_metrics": {"outflow_rate_max": 1467.6603490509492, "cost2_mean": -29.16401881709507, "cost1_mean": 353.89720113119904, "system_level_velocity_mean": 14.033027221835082, "cost2_min": -41.14862107690845, "cost1_max": 444.07792208049636, "cost1_min": 28.403678740429775, "cost2_max": -9.361962904931277, "outflow_rate_mean": 1181.6370962280246, "system_level_velocity_min": 11.24658741793675, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.214920431756585}, "info": {"num_steps_trained": 3815530, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.019544385373592377, "total_loss": 15.839714050292969, "vf_loss": 15.845190048217773, "policy_loss": -0.006940566934645176, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9463266134262085, "entropy": 1.0911355018615723}, "grad_time_ms": 10192.123, "load_time_ms": 13.637, "update_time_ms": 7.49, "num_steps_sampled": 3815530, "sample_time_ms": 13101.48}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3815530, "hostname": "flow-main", "episodes_total": 1423, "timestamp": 1557232324, "episode_reward_max": 1496.5724646707554, "episode_len_mean": 682.94, "time_total_s": 2202.357711791992, "time_since_restore": 2202.357711791992}
{"timesteps_since_restore": 3855427, "training_iteration": 91, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-32-25", "episode_reward_min": 50.009998295286906, "timesteps_this_iter": 39897, "episode_reward_mean": 1148.998614813763, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.237513303756714, "policy_reward_mean": {}, "iterations_since_restore": 91, "custom_metrics": {"outflow_rate_max": 1467.6603490509492, "cost2_mean": -28.09378598309463, "cost1_mean": 350.62594948722307, "system_level_velocity_mean": 14.448548810295643, "cost2_min": -41.14862107690845, "cost1_max": 453.4904691858927, "cost1_min": 28.403678740429775, "cost2_max": -8.158255574946956, "outflow_rate_mean": 1175.3978301576103, "system_level_velocity_min": 11.24658741793675, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.214920431756585}, "info": {"num_steps_trained": 3855427, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01673145592212677, "total_loss": 26.392616271972656, "vf_loss": 26.39732551574707, "policy_loss": -0.005966988392174244, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9110679626464844, "entropy": 1.1034460067749023}, "grad_time_ms": 9991.645, "load_time_ms": 13.531, "update_time_ms": 7.564, "num_steps_sampled": 3855427, "sample_time_ms": 13128.939}, "episodes_this_iter": 22, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb699e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3855427, "hostname": "flow-main", "episodes_total": 1445, "timestamp": 1557232345, "episode_reward_max": 1496.5724646707554, "episode_len_mean": 665.22, "time_total_s": 2223.595225095749, "time_since_restore": 2223.595225095749}
{"timesteps_since_restore": 3896357, "training_iteration": 92, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-32-48", "episode_reward_min": 50.009998295286906, "timesteps_this_iter": 40930, "episode_reward_mean": 1153.6257546176512, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.085500240325928, "policy_reward_mean": {}, "iterations_since_restore": 92, "custom_metrics": {"outflow_rate_max": 1467.6603490509492, "cost2_mean": -27.57869575664313, "cost1_mean": 354.47266913976654, "system_level_velocity_mean": 14.52055775847921, "cost2_min": -41.14862107690845, "cost1_max": 453.4904691858927, "cost1_min": 28.403678740429775, "cost2_max": -8.158255574946956, "outflow_rate_mean": 1182.2227994686618, "system_level_velocity_min": 11.24658741793675, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.214920431756585}, "info": {"num_steps_trained": 3896357, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015982018783688545, "total_loss": 14.595047950744629, "vf_loss": 14.600163459777832, "policy_loss": -0.006315720267593861, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9447461366653442, "entropy": 1.1337337493896484}, "grad_time_ms": 9979.876, "load_time_ms": 13.676, "update_time_ms": 7.558, "num_steps_sampled": 3896357, "sample_time_ms": 13163.667}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f94611705f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3896357, "hostname": "flow-main", "episodes_total": 1462, "timestamp": 1557232368, "episode_reward_max": 1496.5724646707554, "episode_len_mean": 670.01, "time_total_s": 2246.680725336075, "time_since_restore": 2246.680725336075}
{"timesteps_since_restore": 3938081, "training_iteration": 93, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-33-12", "episode_reward_min": 50.009998295286906, "timesteps_this_iter": 41724, "episode_reward_mean": 1151.1041166796922, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.742493629455566, "policy_reward_mean": {}, "iterations_since_restore": 93, "custom_metrics": {"outflow_rate_max": 1467.6603490509492, "cost2_mean": -27.192811215967172, "cost1_mean": 355.47155813526695, "system_level_velocity_mean": 14.59399391537933, "cost2_min": -41.14862107690845, "cost1_max": 453.4904691858927, "cost1_min": 28.403678740429775, "cost2_max": -8.158255574946956, "outflow_rate_mean": 1180.3780540720584, "system_level_velocity_min": 11.645017351605022, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.214920431756585}, "info": {"num_steps_trained": 3938081, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016440141946077347, "total_loss": 9.292316436767578, "vf_loss": 9.297957420349121, "policy_loss": -0.006873317062854767, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9698570966720581, "entropy": 1.133476972579956}, "grad_time_ms": 9983.247, "load_time_ms": 13.908, "update_time_ms": 7.668, "num_steps_sampled": 3938081, "sample_time_ms": 13224.576}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb695c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb697f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69470>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3938081, "hostname": "flow-main", "episodes_total": 1477, "timestamp": 1557232392, "episode_reward_max": 1496.5724646707554, "episode_len_mean": 670.01, "time_total_s": 2270.4232189655304, "time_since_restore": 2270.4232189655304}
{"timesteps_since_restore": 3979291, "training_iteration": 94, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-33-35", "episode_reward_min": 50.009998295286906, "timesteps_this_iter": 41210, "episode_reward_mean": 1149.5467510803696, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.995928525924683, "policy_reward_mean": {}, "iterations_since_restore": 94, "custom_metrics": {"outflow_rate_max": 1467.6603490509492, "cost2_mean": -26.330525624436902, "cost1_mean": 357.13815224856023, "system_level_velocity_mean": 14.612490350161918, "cost2_min": -38.020979789707944, "cost1_max": 453.4904691858927, "cost1_min": 28.403678740429775, "cost2_max": -8.158255574946956, "outflow_rate_mean": 1181.6861863758234, "system_level_velocity_min": 11.645017351605022, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.969846096931327}, "info": {"num_steps_trained": 3979291, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01637139357626438, "total_loss": 14.003497123718262, "vf_loss": 14.007599830627441, "policy_loss": -0.00533016724511981, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9500978589057922, "entropy": 1.1005115509033203}, "grad_time_ms": 9949.299, "load_time_ms": 13.737, "update_time_ms": 7.63, "num_steps_sampled": 3979291, "sample_time_ms": 13246.37}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb699b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb696d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 3979291, "hostname": "flow-main", "episodes_total": 1491, "timestamp": 1557232415, "episode_reward_max": 1496.5724646707554, "episode_len_mean": 673.04, "time_total_s": 2293.419147491455, "time_since_restore": 2293.419147491455}
{"timesteps_since_restore": 4020755, "training_iteration": 95, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-33-59", "episode_reward_min": 50.009998295286906, "timesteps_this_iter": 41464, "episode_reward_mean": 1149.9131245597696, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.60798406600952, "policy_reward_mean": {}, "iterations_since_restore": 95, "custom_metrics": {"outflow_rate_max": 1467.6603490509492, "cost2_mean": -25.3875834799935, "cost1_mean": 355.6395993005299, "system_level_velocity_mean": 14.605452729918229, "cost2_min": -37.997783595201426, "cost1_max": 453.4904691858927, "cost1_min": 28.403678740429775, "cost2_max": -8.158255574946956, "outflow_rate_mean": 1180.0258648533456, "system_level_velocity_min": 11.866490372249071, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.969846096931327}, "info": {"num_steps_trained": 4020755, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017990903928875923, "total_loss": 13.93828010559082, "vf_loss": 13.942785263061523, "policy_loss": -0.005854486953467131, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9469990134239197, "entropy": 1.0987664461135864}, "grad_time_ms": 9899.651, "load_time_ms": 14.214, "update_time_ms": 7.673, "num_steps_sampled": 4020755, "sample_time_ms": 13236.69}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fc50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170f28>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4020755, "hostname": "flow-main", "episodes_total": 1510, "timestamp": 1557232439, "episode_reward_max": 1496.5724646707554, "episode_len_mean": 671.64, "time_total_s": 2317.0271315574646, "time_since_restore": 2317.0271315574646}
{"timesteps_since_restore": 4061837, "training_iteration": 96, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-34-22", "episode_reward_min": 61.42218977866589, "timesteps_this_iter": 41082, "episode_reward_mean": 1154.9678382855368, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.33660864830017, "policy_reward_mean": {}, "iterations_since_restore": 96, "custom_metrics": {"outflow_rate_max": 1471.462776823177, "cost2_mean": -25.240002091480395, "cost1_mean": 353.8686920320816, "system_level_velocity_mean": 14.36009945426106, "cost2_min": -37.997783595201426, "cost1_max": 453.4904691858927, "cost1_min": 31.915589678500982, "cost2_max": -8.158255574946956, "outflow_rate_mean": 1175.616645146544, "system_level_velocity_min": 11.45851384002458, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.969846096931327}, "info": {"num_steps_trained": 4061837, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014518064446747303, "total_loss": 11.306020736694336, "vf_loss": 11.310379028320312, "policy_loss": -0.005446785129606724, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9628609418869019, "entropy": 1.0853370428085327}, "grad_time_ms": 9746.083, "load_time_ms": 14.476, "update_time_ms": 7.057, "num_steps_sampled": 4061837, "sample_time_ms": 13111.606}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4061837, "hostname": "flow-main", "episodes_total": 1525, "timestamp": 1557232462, "episode_reward_max": 1320.9409473666071, "episode_len_mean": 678.19, "time_total_s": 2340.3637402057648, "time_since_restore": 2340.3637402057648}
{"timesteps_since_restore": 4102593, "training_iteration": 97, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-34-45", "episode_reward_min": 61.42218977866589, "timesteps_this_iter": 40756, "episode_reward_mean": 1172.4552281441875, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.807404041290283, "policy_reward_mean": {}, "iterations_since_restore": 97, "custom_metrics": {"outflow_rate_max": 1493.8745822177823, "cost2_mean": -25.707572762970727, "cost1_mean": 358.1128290277432, "system_level_velocity_mean": 14.23804280170732, "cost2_min": -37.997783595201426, "cost1_max": 435.28395807514084, "cost1_min": 31.915589678500982, "cost2_max": -8.158255574946956, "outflow_rate_mean": 1185.1337357418715, "system_level_velocity_min": 11.45851384002458, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 17.774011920650647}, "info": {"num_steps_trained": 4102593, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.019411489367485046, "total_loss": 15.11392593383789, "vf_loss": 15.118453979492188, "policy_loss": -0.0059827473014593124, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9474772214889526, "entropy": 1.072962999343872}, "grad_time_ms": 9735.488, "load_time_ms": 14.649, "update_time_ms": 6.893, "num_steps_sampled": 4102593, "sample_time_ms": 13026.902}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69240>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4102593, "hostname": "flow-main", "episodes_total": 1542, "timestamp": 1557232485, "episode_reward_max": 1331.1251167769692, "episode_len_mean": 689.41, "time_total_s": 2363.171144247055, "time_since_restore": 2363.171144247055}
{"timesteps_since_restore": 4144410, "training_iteration": 98, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-35-10", "episode_reward_min": 68.49433001887729, "timesteps_this_iter": 41817, "episode_reward_mean": 1169.74347155172, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.34653949737549, "policy_reward_mean": {}, "iterations_since_restore": 98, "custom_metrics": {"outflow_rate_max": 1493.8745822177823, "cost2_mean": -25.59595457960068, "cost1_mean": 357.5844937647066, "system_level_velocity_mean": 14.365381201463292, "cost2_min": -43.7641569474601, "cost1_max": 434.7761641814032, "cost1_min": 33.38380997450582, "cost2_max": -8.676694449827066, "outflow_rate_mean": 1184.3577785287, "system_level_velocity_min": 11.45851384002458, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.590163786686766}, "info": {"num_steps_trained": 4144410, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.019477086141705513, "total_loss": 16.515411376953125, "vf_loss": 16.520444869995117, "policy_loss": -0.006493051536381245, "cur_kl_coeff": 0.07499998807907104, "vf_explained_var": 0.9386476874351501, "entropy": 1.0728143453598022}, "grad_time_ms": 9719.047, "load_time_ms": 14.972, "update_time_ms": 6.915, "num_steps_sampled": 4144410, "sample_time_ms": 13252.268}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69320>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4144410, "hostname": "flow-main", "episodes_total": 1560, "timestamp": 1557232510, "episode_reward_max": 1331.1251167769692, "episode_len_mean": 684.49, "time_total_s": 2388.5176837444305, "time_since_restore": 2388.5176837444305}
{"timesteps_since_restore": 4185135, "training_iteration": 99, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-35-32", "episode_reward_min": 68.49433001887729, "timesteps_this_iter": 40725, "episode_reward_mean": 1151.1284748497012, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.383073091506958, "policy_reward_mean": {}, "iterations_since_restore": 99, "custom_metrics": {"outflow_rate_max": 1493.8745822177823, "cost2_mean": -25.572916307145483, "cost1_mean": 350.3238070130079, "system_level_velocity_mean": 14.485341777888209, "cost2_min": -43.7641569474601, "cost1_max": 455.11817814386876, "cost1_min": 33.38380997450582, "cost2_max": -6.264619683965304, "outflow_rate_mean": 1169.9278998872608, "system_level_velocity_min": 11.45851384002458, "outflow_rate_min": 308.8706893373165, "system_level_velocity_max": 18.590163786686766}, "info": {"num_steps_trained": 4185135, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.022596294060349464, "total_loss": 17.582530975341797, "vf_loss": 17.58756446838379, "policy_loss": -0.006728286389261484, "cur_kl_coeff": 0.07499999552965164, "vf_explained_var": 0.9378241896629333, "entropy": 1.0555227994918823}, "grad_time_ms": 9647.903, "load_time_ms": 14.977, "update_time_ms": 6.841, "num_steps_sampled": 4185135, "sample_time_ms": 13232.973}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4185135, "hostname": "flow-main", "episodes_total": 1578, "timestamp": 1557232532, "episode_reward_max": 1462.969276542802, "episode_len_mean": 668.57, "time_total_s": 2409.9007568359375, "time_since_restore": 2409.9007568359375}
{"timesteps_since_restore": 4226364, "training_iteration": 100, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-35-54", "episode_reward_min": 68.49433001887729, "timesteps_this_iter": 41229, "episode_reward_mean": 1160.9114297282545, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.49577808380127, "policy_reward_mean": {}, "iterations_since_restore": 100, "custom_metrics": {"outflow_rate_max": 1493.8745822177823, "cost2_mean": -25.47763172778531, "cost1_mean": 348.9862252974116, "system_level_velocity_mean": 14.433602816927895, "cost2_min": -43.7641569474601, "cost1_max": 455.11817814386876, "cost1_min": 33.38380997450582, "cost2_max": -6.264619683965304, "outflow_rate_mean": 1164.0769870536947, "system_level_velocity_min": 11.45851384002458, "outflow_rate_min": 308.8706893373165, "system_level_velocity_max": 18.590163786686766}, "info": {"num_steps_trained": 4226364, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01525808684527874, "total_loss": 13.038910865783691, "vf_loss": 13.042131423950195, "policy_loss": -0.004937105346471071, "cur_kl_coeff": 0.11249999701976776, "vf_explained_var": 0.9554531574249268, "entropy": 1.094378113746643}, "grad_time_ms": 9645.444, "load_time_ms": 15.001, "update_time_ms": 6.804, "num_steps_sampled": 4226364, "sample_time_ms": 13258.048}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb698d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69dd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4226364, "hostname": "flow-main", "episodes_total": 1598, "timestamp": 1557232554, "episode_reward_max": 1462.969276542802, "episode_len_mean": 667.16, "time_total_s": 2432.3965349197388, "time_since_restore": 2432.3965349197388}
{"timesteps_since_restore": 4268853, "training_iteration": 101, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-36-18", "episode_reward_min": 68.49433001887729, "timesteps_this_iter": 42489, "episode_reward_mean": 1167.1127281477598, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.605002880096436, "policy_reward_mean": {}, "iterations_since_restore": 101, "custom_metrics": {"outflow_rate_max": 1493.8745822177823, "cost2_mean": -25.203368466915446, "cost1_mean": 350.9345372923955, "system_level_velocity_mean": 14.508877622257257, "cost2_min": -43.7641569474601, "cost1_max": 478.211634900513, "cost1_min": 33.38380997450582, "cost2_max": -6.264619683965304, "outflow_rate_mean": 1169.367203553195, "system_level_velocity_min": 11.45851384002458, "outflow_rate_min": 308.8706893373165, "system_level_velocity_max": 18.590163786686766}, "info": {"num_steps_trained": 4268853, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01621651090681553, "total_loss": 14.992953300476074, "vf_loss": 14.996167182922363, "policy_loss": -0.005039013922214508, "cur_kl_coeff": 0.11249999701976776, "vf_explained_var": 0.944060742855072, "entropy": 1.0570310354232788}, "grad_time_ms": 9881.44, "load_time_ms": 15.396, "update_time_ms": 6.788, "num_steps_sampled": 4268853, "sample_time_ms": 13256.905}, "episodes_this_iter": 11, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4268853, "hostname": "flow-main", "episodes_total": 1609, "timestamp": 1557232578, "episode_reward_max": 1462.969276542802, "episode_len_mean": 667.16, "time_total_s": 2456.001537799835, "time_since_restore": 2456.001537799835}
{"timesteps_since_restore": 4309101, "training_iteration": 102, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-36-39", "episode_reward_min": 68.49433001887729, "timesteps_this_iter": 40248, "episode_reward_mean": 1167.0925395655222, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.376211404800415, "policy_reward_mean": {}, "iterations_since_restore": 102, "custom_metrics": {"outflow_rate_max": 1493.8745822177823, "cost2_mean": -24.883820205711903, "cost1_mean": 351.1001964870684, "system_level_velocity_mean": 14.628893533045837, "cost2_min": -43.7641569474601, "cost1_max": 478.211634900513, "cost1_min": 33.38380997450582, "cost2_max": -6.264619683965304, "outflow_rate_mean": 1168.5706322490626, "system_level_velocity_min": 11.837639173841339, "outflow_rate_min": 308.8706893373165, "system_level_velocity_max": 18.590163786686766}, "info": {"num_steps_trained": 4309101, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016145693138241768, "total_loss": 12.403642654418945, "vf_loss": 12.407662391662598, "policy_loss": -0.005836885888129473, "cur_kl_coeff": 0.11250000447034836, "vf_explained_var": 0.9619268774986267, "entropy": 1.0395612716674805}, "grad_time_ms": 9677.068, "load_time_ms": 14.997, "update_time_ms": 6.773, "num_steps_sampled": 4309101, "sample_time_ms": 13292.137}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fa58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4309101, "hostname": "flow-main", "episodes_total": 1626, "timestamp": 1557232599, "episode_reward_max": 1462.969276542802, "episode_len_mean": 662.45, "time_total_s": 2477.3777492046356, "time_since_restore": 2477.3777492046356}
{"timesteps_since_restore": 4350053, "training_iteration": 103, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-37-02", "episode_reward_min": 68.49433001887729, "timesteps_this_iter": 40952, "episode_reward_mean": 1181.146076842243, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.745204210281372, "policy_reward_mean": {}, "iterations_since_restore": 103, "custom_metrics": {"outflow_rate_max": 1461.2033586413588, "cost2_mean": -24.463411299952167, "cost1_mean": 352.2879325166785, "system_level_velocity_mean": 14.536893725383363, "cost2_min": -43.7641569474601, "cost1_max": 478.211634900513, "cost1_min": 33.38380997450582, "cost2_max": -6.264619683965304, "outflow_rate_mean": 1166.5717754922046, "system_level_velocity_min": 11.402289636995253, "outflow_rate_min": 308.8706893373165, "system_level_velocity_max": 18.590163786686766}, "info": {"num_steps_trained": 4350053, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01509770192205906, "total_loss": 15.616719245910645, "vf_loss": 15.620190620422363, "policy_loss": -0.005171581637114286, "cur_kl_coeff": 0.11250001192092896, "vf_explained_var": 0.9520198702812195, "entropy": 1.0646437406539917}, "grad_time_ms": 9661.982, "load_time_ms": 14.888, "update_time_ms": 6.659, "num_steps_sampled": 4350053, "sample_time_ms": 13208.158}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb695c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb694a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4350053, "hostname": "flow-main", "episodes_total": 1645, "timestamp": 1557232622, "episode_reward_max": 1462.969276542802, "episode_len_mean": 667.37, "time_total_s": 2500.122953414917, "time_since_restore": 2500.122953414917}
{"timesteps_since_restore": 4391262, "training_iteration": 104, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-37-25", "episode_reward_min": 71.0339478511516, "timesteps_this_iter": 41209, "episode_reward_mean": 1193.533283873341, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.42187213897705, "policy_reward_mean": {}, "iterations_since_restore": 104, "custom_metrics": {"outflow_rate_max": 1471.7785122877121, "cost2_mean": -24.20636972694134, "cost1_mean": 354.9404545624966, "system_level_velocity_mean": 14.456252278877663, "cost2_min": -39.357936134156745, "cost1_max": 478.211634900513, "cost1_min": 34.92195167258603, "cost2_max": -6.264619683965304, "outflow_rate_mean": 1179.1576763818766, "system_level_velocity_min": 11.402289636995253, "outflow_rate_min": 308.8706893373165, "system_level_velocity_max": 18.474254500691423}, "info": {"num_steps_trained": 4391262, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015925316140055656, "total_loss": 15.290568351745605, "vf_loss": 15.29459285736084, "policy_loss": -0.005817877594381571, "cur_kl_coeff": 0.11249999701976776, "vf_explained_var": 0.9447614550590515, "entropy": 1.0600203275680542}, "grad_time_ms": 9649.404, "load_time_ms": 14.996, "update_time_ms": 6.686, "num_steps_sampled": 4391262, "sample_time_ms": 13262.55}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc914e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4391262, "hostname": "flow-main", "episodes_total": 1660, "timestamp": 1557232645, "episode_reward_max": 1462.969276542802, "episode_len_mean": 673.87, "time_total_s": 2523.544825553894, "time_since_restore": 2523.544825553894}
{"timesteps_since_restore": 4432054, "training_iteration": 105, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-37-49", "episode_reward_min": 235.87968528663436, "timesteps_this_iter": 40792, "episode_reward_mean": 1218.8601933705038, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.389861822128296, "policy_reward_mean": {}, "iterations_since_restore": 105, "custom_metrics": {"outflow_rate_max": 1471.7785122877121, "cost2_mean": -22.651818966982397, "cost1_mean": 361.8898296805242, "system_level_velocity_mean": 14.32732107890176, "cost2_min": -32.366919881063424, "cost1_max": 478.211634900513, "cost1_min": 102.39471357270936, "cost2_max": -11.159563623937437, "outflow_rate_mean": 1197.1513714389, "system_level_velocity_min": 11.402289636995253, "outflow_rate_min": 549.8241831943451, "system_level_velocity_max": 18.4111824493153}, "info": {"num_steps_trained": 4432054, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016407402232289314, "total_loss": 17.923309326171875, "vf_loss": 17.92791175842285, "policy_loss": -0.006449135486036539, "cur_kl_coeff": 0.11250000447034836, "vf_explained_var": 0.9417169690132141, "entropy": 1.0676684379577637}, "grad_time_ms": 9588.343, "load_time_ms": 15.172, "update_time_ms": 6.688, "num_steps_sampled": 4432054, "sample_time_ms": 13301.874}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb695f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69710>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4432054, "hostname": "flow-main", "episodes_total": 1678, "timestamp": 1557232669, "episode_reward_max": 1429.3047616837591, "episode_len_mean": 689.79, "time_total_s": 2546.9346873760223, "time_since_restore": 2546.9346873760223}
{"timesteps_since_restore": 4472825, "training_iteration": 106, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-38-13", "episode_reward_min": 235.87968528663436, "timesteps_this_iter": 40771, "episode_reward_mean": 1207.672536737539, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.999832153320312, "policy_reward_mean": {}, "iterations_since_restore": 106, "custom_metrics": {"outflow_rate_max": 1471.7785122877121, "cost2_mean": -21.608087919013187, "cost1_mean": 362.1943469484336, "system_level_velocity_mean": 14.361029593687332, "cost2_min": -32.15949363491097, "cost1_max": 478.211634900513, "cost1_min": 102.39471357270936, "cost2_max": -11.159563623937437, "outflow_rate_mean": 1197.181952641697, "system_level_velocity_min": 11.402289636995253, "outflow_rate_min": 549.8241831943451, "system_level_velocity_max": 18.4111824493153}, "info": {"num_steps_trained": 4472825, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017525948584079742, "total_loss": 11.869104385375977, "vf_loss": 11.873960494995117, "policy_loss": -0.006826714146882296, "cur_kl_coeff": 0.11250000447034836, "vf_explained_var": 0.9604293704032898, "entropy": 1.089356780052185}, "grad_time_ms": 9573.269, "load_time_ms": 14.331, "update_time_ms": 6.657, "num_steps_sampled": 4472825, "sample_time_ms": 13384.872}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f2e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4472825, "hostname": "flow-main", "episodes_total": 1694, "timestamp": 1557232693, "episode_reward_max": 1429.3047616837591, "episode_len_mean": 689.79, "time_total_s": 2570.9345195293427, "time_since_restore": 2570.9345195293427}
{"timesteps_since_restore": 4513784, "training_iteration": 107, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-38-34", "episode_reward_min": 367.1153506574872, "timesteps_this_iter": 40959, "episode_reward_mean": 1212.1250031584736, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.14027762413025, "policy_reward_mean": {}, "iterations_since_restore": 107, "custom_metrics": {"outflow_rate_max": 1471.7785122877121, "cost2_mean": -20.985691045449467, "cost1_mean": 362.95473561050215, "system_level_velocity_mean": 14.26727093305891, "cost2_min": -32.15949363491097, "cost1_max": 438.0188837859048, "cost1_min": 148.05683806418105, "cost2_max": -12.712864131126931, "outflow_rate_mean": 1199.2912385939696, "system_level_velocity_min": 11.402289636995253, "outflow_rate_min": 823.4266805757785, "system_level_velocity_max": 18.348485087367347}, "info": {"num_steps_trained": 4513784, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016351087018847466, "total_loss": 12.234156608581543, "vf_loss": 12.237629890441895, "policy_loss": -0.005313251167535782, "cur_kl_coeff": 0.11250001192092896, "vf_explained_var": 0.9579488635063171, "entropy": 1.0904576778411865}, "grad_time_ms": 9404.421, "load_time_ms": 14.43, "update_time_ms": 6.654, "num_steps_sampled": 4513784, "sample_time_ms": 13386.57}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fb38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f7f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4513784, "hostname": "flow-main", "episodes_total": 1710, "timestamp": 1557232714, "episode_reward_max": 1348.0229245806918, "episode_len_mean": 695.27, "time_total_s": 2592.074797153473, "time_since_restore": 2592.074797153473}
{"timesteps_since_restore": 4554941, "training_iteration": 108, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-38-57", "episode_reward_min": 1097.9694127400874, "timesteps_this_iter": 41157, "episode_reward_mean": 1213.1227717774511, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.858049869537354, "policy_reward_mean": {}, "iterations_since_restore": 108, "custom_metrics": {"outflow_rate_max": 1471.7785122877121, "cost2_mean": -20.743779966390566, "cost1_mean": 366.69693039213735, "system_level_velocity_mean": 14.327139368514084, "cost2_min": -32.15949363491097, "cost1_max": 438.0188837859048, "cost1_min": 299.8932906257639, "cost2_max": -13.264104094022263, "outflow_rate_mean": 1208.665507828172, "system_level_velocity_min": 11.402289636995253, "outflow_rate_min": 1030.485974025974, "system_level_velocity_max": 17.25391229306836}, "info": {"num_steps_trained": 4554941, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01687016896903515, "total_loss": 11.4088134765625, "vf_loss": 11.413805961608887, "policy_loss": -0.0068910131230950356, "cur_kl_coeff": 0.11249999701976776, "vf_explained_var": 0.9577898979187012, "entropy": 1.1014158725738525}, "grad_time_ms": 9450.361, "load_time_ms": 14.39, "update_time_ms": 6.526, "num_steps_sampled": 4554941, "sample_time_ms": 13092.519}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb695f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb693c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69240>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4554941, "hostname": "flow-main", "episodes_total": 1725, "timestamp": 1557232737, "episode_reward_max": 1348.0229245806918, "episode_len_mean": 700.0, "time_total_s": 2614.9328470230103, "time_since_restore": 2614.9328470230103}
{"timesteps_since_restore": 4595654, "training_iteration": 109, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-39-20", "episode_reward_min": 1109.6376103497353, "timesteps_this_iter": 40713, "episode_reward_mean": 1208.918154010368, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.565067291259766, "policy_reward_mean": {}, "iterations_since_restore": 109, "custom_metrics": {"outflow_rate_max": 1471.7785122877121, "cost2_mean": -20.390641138653056, "cost1_mean": 365.59747710894226, "system_level_velocity_mean": 14.293476375403307, "cost2_min": -29.947555282367194, "cost1_max": 430.76224268681835, "cost1_min": 304.05264513497866, "cost2_max": -13.264104094022263, "outflow_rate_mean": 1207.4076764595404, "system_level_velocity_min": 11.590898444367802, "outflow_rate_min": 1040.8583496503497, "system_level_velocity_max": 16.965926757389077}, "info": {"num_steps_trained": 4595654, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016994057223200798, "total_loss": 10.51204776763916, "vf_loss": 10.516616821289062, "policy_loss": -0.006480684969574213, "cur_kl_coeff": 0.11250000447034836, "vf_explained_var": 0.9685195684432983, "entropy": 1.1124565601348877}, "grad_time_ms": 9711.067, "load_time_ms": 14.438, "update_time_ms": 6.608, "num_steps_sampled": 4595654, "sample_time_ms": 13049.533}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4595654, "hostname": "flow-main", "episodes_total": 1743, "timestamp": 1557232760, "episode_reward_max": 1348.0229245806918, "episode_len_mean": 700.0, "time_total_s": 2638.49791431427, "time_since_restore": 2638.49791431427}
{"timesteps_since_restore": 4636287, "training_iteration": 110, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-39-44", "episode_reward_min": 60.477814704740126, "timesteps_this_iter": 40633, "episode_reward_mean": 1191.64976131609, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.40372085571289, "policy_reward_mean": {}, "iterations_since_restore": 110, "custom_metrics": {"outflow_rate_max": 1437.3413574425576, "cost2_mean": -20.56178792784676, "cost1_mean": 361.4953956472315, "system_level_velocity_mean": 14.37938830842066, "cost2_min": -31.44634520709768, "cost1_max": 422.49885907206567, "cost1_min": 33.54710898729054, "cost2_max": -9.3216486529632, "outflow_rate_mean": 1190.8811997830896, "system_level_velocity_min": 11.944424722028982, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.669501860697224}, "info": {"num_steps_trained": 4636287, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01695101708173752, "total_loss": 14.333605766296387, "vf_loss": 14.339313507080078, "policy_loss": -0.007615645881742239, "cur_kl_coeff": 0.11249999701976776, "vf_explained_var": 0.9561007022857666, "entropy": 1.1018704175949097}, "grad_time_ms": 9878.079, "load_time_ms": 14.668, "update_time_ms": 6.638, "num_steps_sampled": 4636287, "sample_time_ms": 12972.841}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb697b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb695c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4636287, "hostname": "flow-main", "episodes_total": 1763, "timestamp": 1557232784, "episode_reward_max": 1348.0229245806918, "episode_len_mean": 690.26, "time_total_s": 2661.901635169983, "time_since_restore": 2661.901635169983}
{"timesteps_since_restore": 4678260, "training_iteration": 111, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-40-07", "episode_reward_min": 60.477814704740126, "timesteps_this_iter": 41973, "episode_reward_mean": 1192.1373555622922, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.620458841323853, "policy_reward_mean": {}, "iterations_since_restore": 111, "custom_metrics": {"outflow_rate_max": 1453.6151252747252, "cost2_mean": -21.079704074718837, "cost1_mean": 360.58491380582024, "system_level_velocity_mean": 14.336371220450081, "cost2_min": -31.44634520709768, "cost1_max": 430.72016428473376, "cost1_min": 33.54710898729054, "cost2_max": -9.3216486529632, "outflow_rate_mean": 1187.2299585403325, "system_level_velocity_min": 11.944424722028982, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.669501860697224}, "info": {"num_steps_trained": 4678260, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01943310722708702, "total_loss": 12.716126441955566, "vf_loss": 12.720024108886719, "policy_loss": -0.0060832202434539795, "cur_kl_coeff": 0.11250000447034836, "vf_explained_var": 0.9575002789497375, "entropy": 1.1364513635635376}, "grad_time_ms": 9828.533, "load_time_ms": 14.339, "update_time_ms": 6.681, "num_steps_sampled": 4678260, "sample_time_ms": 13024.866}, "episodes_this_iter": 13, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fdd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fa58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f860>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4678260, "hostname": "flow-main", "episodes_total": 1776, "timestamp": 1557232807, "episode_reward_max": 1365.3958539035784, "episode_len_mean": 690.26, "time_total_s": 2685.5220940113068, "time_since_restore": 2685.5220940113068}
{"timesteps_since_restore": 4718486, "training_iteration": 112, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-40-30", "episode_reward_min": 60.477814704740126, "timesteps_this_iter": 40226, "episode_reward_mean": 1183.7519160164356, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.85383701324463, "policy_reward_mean": {}, "iterations_since_restore": 112, "custom_metrics": {"outflow_rate_max": 1461.4308000000003, "cost2_mean": -21.27802360105609, "cost1_mean": 358.33965857647524, "system_level_velocity_mean": 14.437897251939487, "cost2_min": -31.44634520709768, "cost1_max": 430.72016428473376, "cost1_min": 33.54710898729054, "cost2_max": -9.3216486529632, "outflow_rate_mean": 1185.5596598116472, "system_level_velocity_min": 11.660852832527304, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.669501860697224}, "info": {"num_steps_trained": 4718486, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01737559214234352, "total_loss": 15.055477142333984, "vf_loss": 15.057929992675781, "policy_loss": -0.004406232386827469, "cur_kl_coeff": 0.11250000447034836, "vf_explained_var": 0.9509359002113342, "entropy": 1.1107779741287231}, "grad_time_ms": 9996.317, "load_time_ms": 14.204, "update_time_ms": 6.672, "num_steps_sampled": 4718486, "sample_time_ms": 13005.02}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4718486, "hostname": "flow-main", "episodes_total": 1793, "timestamp": 1557232830, "episode_reward_max": 1365.3958539035784, "episode_len_mean": 682.49, "time_total_s": 2708.3759310245514, "time_since_restore": 2708.3759310245514}
{"timesteps_since_restore": 4758916, "training_iteration": 113, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-40-55", "episode_reward_min": 60.477814704740126, "timesteps_this_iter": 40430, "episode_reward_mean": 1174.6403330549024, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.629334211349487, "policy_reward_mean": {}, "iterations_since_restore": 113, "custom_metrics": {"outflow_rate_max": 1461.4308000000003, "cost2_mean": -21.33673169399076, "cost1_mean": 356.2790969761216, "system_level_velocity_mean": 14.46612247637992, "cost2_min": -31.44634520709768, "cost1_max": 430.72016428473376, "cost1_min": 33.54710898729054, "cost2_max": -9.3216486529632, "outflow_rate_mean": 1181.175046954042, "system_level_velocity_min": 11.660852832527304, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.669501860697224}, "info": {"num_steps_trained": 4758916, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01633051224052906, "total_loss": 16.407100677490234, "vf_loss": 16.410354614257812, "policy_loss": -0.00509108230471611, "cur_kl_coeff": 0.11249999701976776, "vf_explained_var": 0.9442915916442871, "entropy": 1.1106363534927368}, "grad_time_ms": 10099.367, "load_time_ms": 14.009, "update_time_ms": 6.754, "num_steps_sampled": 4758916, "sample_time_ms": 13091.101}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fb70>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4758916, "hostname": "flow-main", "episodes_total": 1810, "timestamp": 1557232855, "episode_reward_max": 1365.3958539035784, "episode_len_mean": 678.3, "time_total_s": 2733.005265235901, "time_since_restore": 2733.005265235901}
{"timesteps_since_restore": 4798384, "training_iteration": 114, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-41-16", "episode_reward_min": 45.46409221257766, "timesteps_this_iter": 39468, "episode_reward_mean": 1152.224574053404, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.16394305229187, "policy_reward_mean": {}, "iterations_since_restore": 114, "custom_metrics": {"outflow_rate_max": 1461.4308000000003, "cost2_mean": -21.333216383926757, "cost1_mean": 350.1161829838952, "system_level_velocity_mean": 14.59258155186887, "cost2_min": -31.44634520709768, "cost1_max": 430.72016428473376, "cost1_min": 28.952322274023714, "cost2_max": -7.312554933626057, "outflow_rate_mean": 1165.5354618583417, "system_level_velocity_min": 11.660852832527304, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.78884345395501}, "info": {"num_steps_trained": 4798384, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017894431948661804, "total_loss": 16.890609741210938, "vf_loss": 16.89482307434082, "policy_loss": -0.006228294223546982, "cur_kl_coeff": 0.11250000447034836, "vf_explained_var": 0.9467993378639221, "entropy": 1.1315935850143433}, "grad_time_ms": 9906.462, "load_time_ms": 13.73, "update_time_ms": 6.786, "num_steps_sampled": 4798384, "sample_time_ms": 13058.474}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fdd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4798384, "hostname": "flow-main", "episodes_total": 1830, "timestamp": 1557232876, "episode_reward_max": 1365.3958539035784, "episode_len_mean": 665.23, "time_total_s": 2754.1692082881927, "time_since_restore": 2754.1692082881927}
{"timesteps_since_restore": 4839263, "training_iteration": 115, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-41-40", "episode_reward_min": 45.46409221257766, "timesteps_this_iter": 40879, "episode_reward_mean": 1130.529199230541, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.03078317642212, "policy_reward_mean": {}, "iterations_since_restore": 115, "custom_metrics": {"outflow_rate_max": 1461.4308000000003, "cost2_mean": -20.78560305567702, "cost1_mean": 344.9083453015039, "system_level_velocity_mean": 14.69235182349586, "cost2_min": -31.181663641604676, "cost1_max": 430.72016428473376, "cost1_min": 28.952322274023714, "cost2_max": -7.312554933626057, "outflow_rate_mean": 1151.93085075251, "system_level_velocity_min": 11.660852832527304, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.78884345395501}, "info": {"num_steps_trained": 4839263, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016977373510599136, "total_loss": 21.08243751525879, "vf_loss": 21.08670997619629, "policy_loss": -0.006182358134537935, "cur_kl_coeff": 0.11250001192092896, "vf_explained_var": 0.9324124455451965, "entropy": 1.1224498748779297}, "grad_time_ms": 9889.5, "load_time_ms": 13.462, "update_time_ms": 6.822, "num_steps_sampled": 4839263, "sample_time_ms": 13139.814}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fbe0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4839263, "hostname": "flow-main", "episodes_total": 1850, "timestamp": 1557232900, "episode_reward_max": 1365.3958539035784, "episode_len_mean": 654.64, "time_total_s": 2778.199991464615, "time_since_restore": 2778.199991464615}
{"timesteps_since_restore": 4880110, "training_iteration": 116, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-42-04", "episode_reward_min": 45.46409221257766, "timesteps_this_iter": 40847, "episode_reward_mean": 1143.852893364382, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.846145391464233, "policy_reward_mean": {}, "iterations_since_restore": 116, "custom_metrics": {"outflow_rate_max": 1461.4308000000003, "cost2_mean": -20.201488964133134, "cost1_mean": 350.4127033545465, "system_level_velocity_mean": 14.677199708676476, "cost2_min": -27.97266377651904, "cost1_max": 430.72016428473376, "cost1_min": 28.952322274023714, "cost2_max": -7.312554933626057, "outflow_rate_mean": 1167.4999142861036, "system_level_velocity_min": 11.660852832527304, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.78884345395501}, "info": {"num_steps_trained": 4880110, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.02153201960027218, "total_loss": 16.248502731323242, "vf_loss": 16.252023696899414, "policy_loss": -0.00594362011179328, "cur_kl_coeff": 0.11250001192092896, "vf_explained_var": 0.9370302557945251, "entropy": 1.1307005882263184}, "grad_time_ms": 9888.003, "load_time_ms": 13.254, "update_time_ms": 6.825, "num_steps_sampled": 4880110, "sample_time_ms": 13125.484}, "episodes_this_iter": 13, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb694a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb690b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69f60>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4880110, "hostname": "flow-main", "episodes_total": 1863, "timestamp": 1557232924, "episode_reward_max": 1365.3958539035784, "episode_len_mean": 664.38, "time_total_s": 2802.046136856079, "time_since_restore": 2802.046136856079}
{"timesteps_since_restore": 4920818, "training_iteration": 117, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-42-26", "episode_reward_min": 45.46409221257766, "timesteps_this_iter": 40708, "episode_reward_mean": 1139.121846474996, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.611382007598877, "policy_reward_mean": {}, "iterations_since_restore": 117, "custom_metrics": {"outflow_rate_max": 1461.4308000000003, "cost2_mean": -19.495904728780516, "cost1_mean": 348.87218288802205, "system_level_velocity_mean": 14.650132936277448, "cost2_min": -27.72010823262216, "cost1_max": 425.0183943364573, "cost1_min": 28.952322274023714, "cost2_max": -7.312554933626057, "outflow_rate_mean": 1161.0270414863155, "system_level_velocity_min": 11.73084228928237, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.78884345395501}, "info": {"num_steps_trained": 4920818, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015033362433314323, "total_loss": 14.503780364990234, "vf_loss": 14.50770378112793, "policy_loss": -0.0064596920274198055, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9526348114013672, "entropy": 1.1518124341964722}, "grad_time_ms": 9885.316, "load_time_ms": 13.038, "update_time_ms": 6.841, "num_steps_sampled": 4920818, "sample_time_ms": 13176.025}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f320>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4920818, "hostname": "flow-main", "episodes_total": 1882, "timestamp": 1557232946, "episode_reward_max": 1334.6627615474442, "episode_len_mean": 663.67, "time_total_s": 2823.657518863678, "time_since_restore": 2823.657518863678}
{"timesteps_since_restore": 4961236, "training_iteration": 118, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-42-48", "episode_reward_min": 45.46409221257766, "timesteps_this_iter": 40418, "episode_reward_mean": 1121.6470608606862, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.613714933395386, "policy_reward_mean": {}, "iterations_since_restore": 118, "custom_metrics": {"outflow_rate_max": 1433.9049406593406, "cost2_mean": -19.04185285733882, "cost1_mean": 344.22801759001703, "system_level_velocity_mean": 14.688561994212812, "cost2_min": -27.72010823262216, "cost1_max": 425.0183943364573, "cost1_min": 28.42711568637039, "cost2_max": -7.312554933626057, "outflow_rate_mean": 1151.6327485291176, "system_level_velocity_min": 11.73084228928237, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.78884345395501}, "info": {"num_steps_trained": 4961236, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01750827766954899, "total_loss": 17.748794555664062, "vf_loss": 17.752208709716797, "policy_loss": -0.006371013820171356, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.942290186882019, "entropy": 1.1405481100082397}, "grad_time_ms": 9821.986, "load_time_ms": 12.919, "update_time_ms": 6.866, "num_steps_sampled": 4961236, "sample_time_ms": 13215.659}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f048>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 4961236, "hostname": "flow-main", "episodes_total": 1899, "timestamp": 1557232968, "episode_reward_max": 1334.6627615474442, "episode_len_mean": 656.1, "time_total_s": 2846.2712337970734, "time_since_restore": 2846.2712337970734}
{"timesteps_since_restore": 5003115, "training_iteration": 119, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-43-12", "episode_reward_min": 53.017768068448696, "timesteps_this_iter": 41879, "episode_reward_mean": 1144.5710141537058, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.646326065063477, "policy_reward_mean": {}, "iterations_since_restore": 119, "custom_metrics": {"outflow_rate_max": 1451.0898477522478, "cost2_mean": -19.193990458389777, "cost1_mean": 351.8792371113606, "system_level_velocity_mean": 14.522227655666379, "cost2_min": -27.783137811559776, "cost1_max": 425.0183943364573, "cost1_min": 28.42711568637039, "cost2_max": -8.78170760156873, "outflow_rate_mean": 1168.9994909699353, "system_level_velocity_min": 11.73084228928237, "outflow_rate_min": 336.28295196858994, "system_level_velocity_max": 19.166357745876095}, "info": {"num_steps_trained": 5003115, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016661513596773148, "total_loss": 14.644832611083984, "vf_loss": 14.646672248840332, "policy_loss": -0.004649768117815256, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9495250582695007, "entropy": 1.121157169342041}, "grad_time_ms": 9809.931, "load_time_ms": 12.942, "update_time_ms": 6.771, "num_steps_sampled": 5003115, "sample_time_ms": 13235.808}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb694a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5003115, "hostname": "flow-main", "episodes_total": 1915, "timestamp": 1557232992, "episode_reward_max": 1322.2426619197531, "episode_len_mean": 673.36, "time_total_s": 2869.917559862137, "time_since_restore": 2869.917559862137}
{"timesteps_since_restore": 5043649, "training_iteration": 120, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-43-34", "episode_reward_min": 53.017768068448696, "timesteps_this_iter": 40534, "episode_reward_mean": 1130.6609559556643, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.674983024597168, "policy_reward_mean": {}, "iterations_since_restore": 120, "custom_metrics": {"outflow_rate_max": 1451.0898477522478, "cost2_mean": -18.593427352709323, "cost1_mean": 347.0742488373224, "system_level_velocity_mean": 14.48219203887707, "cost2_min": -27.783137811559776, "cost1_max": 425.0183943364573, "cost1_min": 28.42711568637039, "cost2_max": -4.298918359430183, "outflow_rate_mean": 1154.9520319851867, "system_level_velocity_min": 11.510673916393644, "outflow_rate_min": 308.8706893373165, "system_level_velocity_max": 19.166357745876095}, "info": {"num_steps_trained": 5043649, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01692727766931057, "total_loss": 13.437482833862305, "vf_loss": 13.442621231079102, "policy_loss": -0.007993432693183422, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9583089351654053, "entropy": 1.1130191087722778}, "grad_time_ms": 9616.306, "load_time_ms": 12.616, "update_time_ms": 6.786, "num_steps_sampled": 5043649, "sample_time_ms": 13258.174}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6efd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ecf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e4a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5043649, "hostname": "flow-main", "episodes_total": 1933, "timestamp": 1557233014, "episode_reward_max": 1322.2426619197531, "episode_len_mean": 666.88, "time_total_s": 2891.592542886734, "time_since_restore": 2891.592542886734}
{"timesteps_since_restore": 5084689, "training_iteration": 121, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-43-55", "episode_reward_min": 53.017768068448696, "timesteps_this_iter": 41040, "episode_reward_mean": 1148.3983389891887, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.384985208511353, "policy_reward_mean": {}, "iterations_since_restore": 121, "custom_metrics": {"outflow_rate_max": 1451.0898477522478, "cost2_mean": -18.693438259817516, "cost1_mean": 352.76453972808554, "system_level_velocity_mean": 14.409327240129834, "cost2_min": -27.783137811559776, "cost1_max": 417.12877967146756, "cost1_min": 28.42711568637039, "cost2_max": -4.298918359430183, "outflow_rate_mean": 1171.0829125695402, "system_level_velocity_min": 11.510673916393644, "outflow_rate_min": 308.8706893373165, "system_level_velocity_max": 19.166357745876095}, "info": {"num_steps_trained": 5084689, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015358221717178822, "total_loss": 12.828607559204102, "vf_loss": 12.832118034362793, "policy_loss": -0.006101605482399464, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9540626406669617, "entropy": 1.1221563816070557}, "grad_time_ms": 9446.186, "load_time_ms": 12.369, "update_time_ms": 6.763, "num_steps_sampled": 5084689, "sample_time_ms": 13205.524}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6eba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fc88>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5084689, "hostname": "flow-main", "episodes_total": 1948, "timestamp": 1557233035, "episode_reward_max": 1298.6544145212158, "episode_len_mean": 677.47, "time_total_s": 2912.9775280952454, "time_since_restore": 2912.9775280952454}
{"timesteps_since_restore": 5125922, "training_iteration": 122, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-44-17", "episode_reward_min": 53.017768068448696, "timesteps_this_iter": 41233, "episode_reward_mean": 1145.4630984547357, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.589155673980713, "policy_reward_mean": {}, "iterations_since_restore": 122, "custom_metrics": {"outflow_rate_max": 1451.0898477522478, "cost2_mean": -18.488024687742964, "cost1_mean": 349.4252363531005, "system_level_velocity_mean": 14.279063827327992, "cost2_min": -27.783137811559776, "cost1_max": 417.12877967146756, "cost1_min": 28.42711568637039, "cost2_max": -4.298918359430183, "outflow_rate_mean": 1160.3939249443056, "system_level_velocity_min": 11.510673916393644, "outflow_rate_min": 308.8706893373165, "system_level_velocity_max": 19.166357745876095}, "info": {"num_steps_trained": 5125922, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01453035231679678, "total_loss": 13.605259895324707, "vf_loss": 13.60863208770752, "policy_loss": -0.005824973341077566, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9499310851097107, "entropy": 1.1403522491455078}, "grad_time_ms": 9332.547, "load_time_ms": 12.819, "update_time_ms": 6.742, "num_steps_sampled": 5125922, "sample_time_ms": 13190.834}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ea58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6edd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e1d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5125922, "hostname": "flow-main", "episodes_total": 1968, "timestamp": 1557233057, "episode_reward_max": 1312.6889086027923, "episode_len_mean": 675.82, "time_total_s": 2934.566683769226, "time_since_restore": 2934.566683769226}
{"timesteps_since_restore": 5167622, "training_iteration": 123, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-44-41", "episode_reward_min": 53.017768068448696, "timesteps_this_iter": 41700, "episode_reward_mean": 1139.095552776322, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.24694848060608, "policy_reward_mean": {}, "iterations_since_restore": 123, "custom_metrics": {"outflow_rate_max": 1451.0898477522478, "cost2_mean": -18.093748796362455, "cost1_mean": 344.42132629424856, "system_level_velocity_mean": 14.21121576138803, "cost2_min": -27.783137811559776, "cost1_max": 417.12877967146756, "cost1_min": 28.42711568637039, "cost2_max": -4.298918359430183, "outflow_rate_mean": 1148.014587291397, "system_level_velocity_min": 10.778401291757046, "outflow_rate_min": 308.8706893373165, "system_level_velocity_max": 19.166357745876095}, "info": {"num_steps_trained": 5167622, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013660792261362076, "total_loss": 14.894059181213379, "vf_loss": 14.898016929626465, "policy_loss": -0.006260316353291273, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9457018375396729, "entropy": 1.1459709405899048}, "grad_time_ms": 9241.15, "load_time_ms": 12.997, "update_time_ms": 6.676, "num_steps_sampled": 5167622, "sample_time_ms": 13243.614}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ecf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5167622, "hostname": "flow-main", "episodes_total": 1984, "timestamp": 1557233081, "episode_reward_max": 1366.532234766388, "episode_len_mean": 669.32, "time_total_s": 2958.813632249832, "time_since_restore": 2958.813632249832}
{"timesteps_since_restore": 5209271, "training_iteration": 124, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-45-04", "episode_reward_min": 57.381499030166744, "timesteps_this_iter": 41649, "episode_reward_mean": 1143.0582763054567, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.301449298858643, "policy_reward_mean": {}, "iterations_since_restore": 124, "custom_metrics": {"outflow_rate_max": 1451.0898477522478, "cost2_mean": -18.210941664408324, "cost1_mean": 345.2503478731045, "system_level_velocity_mean": 14.175743551514618, "cost2_min": -27.783137811559776, "cost1_max": 417.12877967146756, "cost1_min": 29.299640813701988, "cost2_max": -4.298918359430183, "outflow_rate_mean": 1147.7575591433842, "system_level_velocity_min": 10.778401291757046, "outflow_rate_min": 308.8706893373165, "system_level_velocity_max": 18.63949759122877}, "info": {"num_steps_trained": 5209271, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013854830525815487, "total_loss": 14.225420951843262, "vf_loss": 14.228189468383789, "policy_loss": -0.005106790456920862, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9487771391868591, "entropy": 1.1292142868041992}, "grad_time_ms": 9443.202, "load_time_ms": 12.969, "update_time_ms": 6.737, "num_steps_sampled": 5209271, "sample_time_ms": 13254.746}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb546d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb544e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5209271, "hostname": "flow-main", "episodes_total": 2000, "timestamp": 1557233104, "episode_reward_max": 1366.532234766388, "episode_len_mean": 670.19, "time_total_s": 2982.115081548691, "time_since_restore": 2982.115081548691}
{"timesteps_since_restore": 5250087, "training_iteration": 125, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-45-27", "episode_reward_min": 57.381499030166744, "timesteps_this_iter": 40816, "episode_reward_mean": 1132.1717556991873, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.421626806259155, "policy_reward_mean": {}, "iterations_since_restore": 125, "custom_metrics": {"outflow_rate_max": 1392.5840963036962, "cost2_mean": -17.458549827322297, "cost1_mean": 338.9138602774819, "system_level_velocity_mean": 14.192462701618362, "cost2_min": -25.47156732679037, "cost1_max": 412.09381534305817, "cost1_min": 29.299640813701988, "cost2_max": -4.298918359430183, "outflow_rate_mean": 1131.7607321413977, "system_level_velocity_min": 10.778401291757046, "outflow_rate_min": 308.8706893373165, "system_level_velocity_max": 18.63949759122877}, "info": {"num_steps_trained": 5250087, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01354899536818266, "total_loss": 17.382572174072266, "vf_loss": 17.38636589050293, "policy_loss": -0.0060804677195847034, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9426022171974182, "entropy": 1.1371781826019287}, "grad_time_ms": 9344.598, "load_time_ms": 13.167, "update_time_ms": 6.771, "num_steps_sampled": 5250087, "sample_time_ms": 13191.076}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ee48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5250087, "hostname": "flow-main", "episodes_total": 2019, "timestamp": 1557233127, "episode_reward_max": 1366.532234766388, "episode_len_mean": 657.87, "time_total_s": 3004.53670835495, "time_since_restore": 3004.53670835495}
{"timesteps_since_restore": 5290534, "training_iteration": 126, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-45-50", "episode_reward_min": 57.381499030166744, "timesteps_this_iter": 40447, "episode_reward_mean": 1143.5717376101036, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.90724015235901, "policy_reward_mean": {}, "iterations_since_restore": 126, "custom_metrics": {"outflow_rate_max": 1452.86093986014, "cost2_mean": -17.105379408313084, "cost1_mean": 343.0931057068333, "system_level_velocity_mean": 14.158653191006414, "cost2_min": -24.94103057556773, "cost1_max": 451.69354911915383, "cost1_min": 29.299640813701988, "cost2_max": -4.406516969652138, "outflow_rate_mean": 1145.9963371521205, "system_level_velocity_min": 10.778401291757046, "outflow_rate_min": 323.31724101201013, "system_level_velocity_max": 18.63949759122877}, "info": {"num_steps_trained": 5290534, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014070653356611729, "total_loss": 15.397384643554688, "vf_loss": 15.401007652282715, "policy_loss": -0.0059979939833283424, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9488658308982849, "entropy": 1.1396931409835815}, "grad_time_ms": 9350.515, "load_time_ms": 13.542, "update_time_ms": 6.879, "num_steps_sampled": 5290534, "sample_time_ms": 13091.725}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f320>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5290534, "hostname": "flow-main", "episodes_total": 2035, "timestamp": 1557233150, "episode_reward_max": 1366.532234766388, "episode_len_mean": 664.35, "time_total_s": 3027.443948507309, "time_since_restore": 3027.443948507309}
{"timesteps_since_restore": 5330170, "training_iteration": 127, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-46-14", "episode_reward_min": 57.381499030166744, "timesteps_this_iter": 39636, "episode_reward_mean": 1139.940410748042, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.26697087287903, "policy_reward_mean": {}, "iterations_since_restore": 127, "custom_metrics": {"outflow_rate_max": 1452.86093986014, "cost2_mean": -16.727696142832738, "cost1_mean": 338.22870233714514, "system_level_velocity_mean": 14.069730300824503, "cost2_min": -23.08176278887238, "cost1_max": 451.69354911915383, "cost1_min": 29.299640813701988, "cost2_max": -4.406516969652138, "outflow_rate_mean": 1127.3978474786609, "system_level_velocity_min": 10.778401291757046, "outflow_rate_min": 323.31724101201013, "system_level_velocity_max": 18.63949759122877}, "info": {"num_steps_trained": 5330170, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016220364719629288, "total_loss": 15.367705345153809, "vf_loss": 15.37328052520752, "policy_loss": -0.008312096819281578, "cur_kl_coeff": 0.16875000298023224, "vf_explained_var": 0.9562032222747803, "entropy": 1.1490265130996704}, "grad_time_ms": 9508.955, "load_time_ms": 13.62, "update_time_ms": 6.878, "num_steps_sampled": 5330170, "sample_time_ms": 13199.001}, "episodes_this_iter": 21, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fe48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5330170, "hostname": "flow-main", "episodes_total": 2056, "timestamp": 1557233174, "episode_reward_max": 1366.532234766388, "episode_len_mean": 658.94, "time_total_s": 3051.710919380188, "time_since_restore": 3051.710919380188}
{"timesteps_since_restore": 5372106, "training_iteration": 128, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-46-37", "episode_reward_min": 60.383418624882495, "timesteps_this_iter": 41936, "episode_reward_mean": 1144.2790126562647, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.172523021697998, "policy_reward_mean": {}, "iterations_since_restore": 128, "custom_metrics": {"outflow_rate_max": 1452.86093986014, "cost2_mean": -16.641813557012938, "cost1_mean": 341.25072453303386, "system_level_velocity_mean": 14.183490733387595, "cost2_min": -23.08176278887238, "cost1_max": 451.69354911915383, "cost1_min": 33.35040291633933, "cost2_max": -8.096343756671132, "outflow_rate_mean": 1137.2517433692963, "system_level_velocity_min": 10.778401291757046, "outflow_rate_min": 326.22109501059714, "system_level_velocity_max": 18.770760329646777}, "info": {"num_steps_trained": 5372106, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01571069099009037, "total_loss": 12.593670845031738, "vf_loss": 12.600042343139648, "policy_loss": -0.009023086167871952, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9429933428764343, "entropy": 1.159142017364502}, "grad_time_ms": 9563.264, "load_time_ms": 13.76, "update_time_ms": 6.955, "num_steps_sampled": 5372106, "sample_time_ms": 13199.047}, "episodes_this_iter": 13, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ec18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e4e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5372106, "hostname": "flow-main", "episodes_total": 2069, "timestamp": 1557233197, "episode_reward_max": 1366.532234766388, "episode_len_mean": 659.0, "time_total_s": 3074.883442401886, "time_since_restore": 3074.883442401886}
{"timesteps_since_restore": 5413254, "training_iteration": 129, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-46-59", "episode_reward_min": 60.383418624882495, "timesteps_this_iter": 41148, "episode_reward_mean": 1142.0520165933492, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.739814281463623, "policy_reward_mean": {}, "iterations_since_restore": 129, "custom_metrics": {"outflow_rate_max": 1452.86093986014, "cost2_mean": -16.705165761932523, "cost1_mean": 343.64652498764605, "system_level_velocity_mean": 14.293585632405387, "cost2_min": -25.521707028582785, "cost1_max": 451.69354911915383, "cost1_min": 31.563911005620408, "cost2_max": -7.136813592530835, "outflow_rate_mean": 1145.146531337504, "system_level_velocity_min": 10.786971412281389, "outflow_rate_min": 326.22109501059714, "system_level_velocity_max": 18.770760329646777}, "info": {"num_steps_trained": 5413254, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013545291498303413, "total_loss": 17.52994728088379, "vf_loss": 17.5340518951416, "policy_loss": -0.006389754358679056, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9370762705802917, "entropy": 1.141159176826477}, "grad_time_ms": 9370.489, "load_time_ms": 13.817, "update_time_ms": 6.925, "num_steps_sampled": 5413254, "sample_time_ms": 13201.533}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5db00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d400>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5413254, "hostname": "flow-main", "episodes_total": 2087, "timestamp": 1557233219, "episode_reward_max": 1345.174166633326, "episode_len_mean": 658.64, "time_total_s": 3096.6232566833496, "time_since_restore": 3096.6232566833496}
{"timesteps_since_restore": 5454343, "training_iteration": 130, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-47-22", "episode_reward_min": 48.61954692304878, "timesteps_this_iter": 41089, "episode_reward_mean": 1141.0047080034121, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.047268390655518, "policy_reward_mean": {}, "iterations_since_restore": 130, "custom_metrics": {"outflow_rate_max": 1452.86093986014, "cost2_mean": -16.510439091475902, "cost1_mean": 344.0059221504229, "system_level_velocity_mean": 14.406177547336359, "cost2_min": -25.521707028582785, "cost1_max": 451.69354911915383, "cost1_min": 28.711549263432794, "cost2_max": -7.136813592530835, "outflow_rate_mean": 1146.7842057134048, "system_level_velocity_min": 10.786971412281389, "outflow_rate_min": 326.22109501059714, "system_level_velocity_max": 19.410617212933822}, "info": {"num_steps_trained": 5454343, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015709660947322845, "total_loss": 13.754849433898926, "vf_loss": 13.759786605834961, "policy_loss": -0.00758737325668335, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9524807333946228, "entropy": 1.148087501525879}, "grad_time_ms": 9608.628, "load_time_ms": 13.322, "update_time_ms": 6.802, "num_steps_sampled": 5454343, "sample_time_ms": 13100.295}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fc50>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5454343, "hostname": "flow-main", "episodes_total": 2105, "timestamp": 1557233242, "episode_reward_max": 1345.174166633326, "episode_len_mean": 655.98, "time_total_s": 3119.670525074005, "time_since_restore": 3119.670525074005}
{"timesteps_since_restore": 5495430, "training_iteration": 131, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-47-45", "episode_reward_min": 48.61954692304878, "timesteps_this_iter": 41087, "episode_reward_mean": 1144.2796642958099, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.8045711517334, "policy_reward_mean": {}, "iterations_since_restore": 131, "custom_metrics": {"outflow_rate_max": 1452.86093986014, "cost2_mean": -17.16476668543643, "cost1_mean": 345.8430236146227, "system_level_velocity_mean": 14.444522400582853, "cost2_min": -25.521707028582785, "cost1_max": 451.69354911915383, "cost1_min": 28.711549263432794, "cost2_max": -7.136813592530835, "outflow_rate_mean": 1149.1447895288322, "system_level_velocity_min": 11.301714294294596, "outflow_rate_min": 326.22109501059714, "system_level_velocity_max": 19.410617212933822}, "info": {"num_steps_trained": 5495430, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014403820037841797, "total_loss": 12.162811279296875, "vf_loss": 12.166421890258789, "policy_loss": -0.006041719112545252, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9605016708374023, "entropy": 1.1542985439300537}, "grad_time_ms": 9774.301, "load_time_ms": 13.82, "update_time_ms": 6.871, "num_steps_sampled": 5495430, "sample_time_ms": 13075.932}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5495430, "hostname": "flow-main", "episodes_total": 2123, "timestamp": 1557233265, "episode_reward_max": 1345.174166633326, "episode_len_mean": 656.81, "time_total_s": 3142.4750962257385, "time_since_restore": 3142.4750962257385}
{"timesteps_since_restore": 5536576, "training_iteration": 132, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-48-07", "episode_reward_min": 48.61954692304878, "timesteps_this_iter": 41146, "episode_reward_mean": 1149.558077418385, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.68889880180359, "policy_reward_mean": {}, "iterations_since_restore": 132, "custom_metrics": {"outflow_rate_max": 1420.3635692307694, "cost2_mean": -17.592501325118086, "cost1_mean": 347.00901108518866, "system_level_velocity_mean": 14.498623807014965, "cost2_min": -25.521707028582785, "cost1_max": 435.99008706361894, "cost1_min": 28.711549263432794, "cost2_max": -7.136813592530835, "outflow_rate_mean": 1147.7822654928684, "system_level_velocity_min": 11.301714294294596, "outflow_rate_min": 326.22109501059714, "system_level_velocity_max": 19.410617212933822}, "info": {"num_steps_trained": 5536576, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01391184888780117, "total_loss": 8.003620147705078, "vf_loss": 8.00793743133545, "policy_loss": -0.006664169020950794, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.977086067199707, "entropy": 1.1625429391860962}, "grad_time_ms": 9779.2, "load_time_ms": 13.627, "update_time_ms": 6.919, "num_steps_sampled": 5536576, "sample_time_ms": 13082.144}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb546d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb544e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fe48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5536576, "hostname": "flow-main", "episodes_total": 2140, "timestamp": 1557233287, "episode_reward_max": 1345.174166633326, "episode_len_mean": 656.81, "time_total_s": 3164.163995027542, "time_since_restore": 3164.163995027542}
{"timesteps_since_restore": 5577546, "training_iteration": 133, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-48-30", "episode_reward_min": 48.61954692304878, "timesteps_this_iter": 40970, "episode_reward_mean": 1147.5525438318632, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.979168176651, "policy_reward_mean": {}, "iterations_since_restore": 133, "custom_metrics": {"outflow_rate_max": 1420.3635692307694, "cost2_mean": -18.017482045929754, "cost1_mean": 347.0185316633027, "system_level_velocity_mean": 14.510282397390576, "cost2_min": -25.521707028582785, "cost1_max": 435.99008706361894, "cost1_min": 28.711549263432794, "cost2_max": -7.136813592530835, "outflow_rate_mean": 1151.9832317076016, "system_level_velocity_min": 11.301714294294596, "outflow_rate_min": 326.22109501059714, "system_level_velocity_max": 19.410617212933822}, "info": {"num_steps_trained": 5577546, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01753487065434456, "total_loss": 14.459622383117676, "vf_loss": 14.463160514831543, "policy_loss": -0.006497328169643879, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.949705958366394, "entropy": 1.140673041343689}, "grad_time_ms": 9778.511, "load_time_ms": 13.635, "update_time_ms": 6.805, "num_steps_sampled": 5577546, "sample_time_ms": 12955.663}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6eb38>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5577546, "hostname": "flow-main", "episodes_total": 2156, "timestamp": 1557233310, "episode_reward_max": 1345.174166633326, "episode_len_mean": 656.63, "time_total_s": 3187.143163204193, "time_since_restore": 3187.143163204193}
{"timesteps_since_restore": 5618351, "training_iteration": 134, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-48-52", "episode_reward_min": 48.61954692304878, "timesteps_this_iter": 40805, "episode_reward_mean": 1166.0998666552196, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.669660329818726, "policy_reward_mean": {}, "iterations_since_restore": 134, "custom_metrics": {"outflow_rate_max": 1420.3635692307694, "cost2_mean": -18.680199790365062, "cost1_mean": 352.25754245586825, "system_level_velocity_mean": 14.384463535124068, "cost2_min": -31.186966412412595, "cost1_max": 435.99008706361894, "cost1_min": 28.711549263432794, "cost2_max": -7.136813592530835, "outflow_rate_mean": 1162.5700826260793, "system_level_velocity_min": 11.301714294294596, "outflow_rate_min": 334.62201022295307, "system_level_velocity_max": 19.410617212933822}, "info": {"num_steps_trained": 5618351, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014515217393636703, "total_loss": 10.322622299194336, "vf_loss": 10.327282905578613, "policy_loss": -0.007110072299838066, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9677001237869263, "entropy": 1.1679507493972778}, "grad_time_ms": 9757.201, "load_time_ms": 13.754, "update_time_ms": 6.681, "num_steps_sampled": 5618351, "sample_time_ms": 12914.483}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69978>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5618351, "hostname": "flow-main", "episodes_total": 2173, "timestamp": 1557233332, "episode_reward_max": 1341.0529524426154, "episode_len_mean": 668.88, "time_total_s": 3209.812823534012, "time_since_restore": 3209.812823534012}
{"timesteps_since_restore": 5658245, "training_iteration": 135, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-49-15", "episode_reward_min": 48.61954692304878, "timesteps_this_iter": 39894, "episode_reward_mean": 1155.0027751066325, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.024643898010254, "policy_reward_mean": {}, "iterations_since_restore": 135, "custom_metrics": {"outflow_rate_max": 1453.5874005994006, "cost2_mean": -18.98558376187975, "cost1_mean": 350.3304508690978, "system_level_velocity_mean": 14.444651923294094, "cost2_min": -32.01420803885784, "cost1_max": 423.42346294542773, "cost1_min": 28.711549263432794, "cost2_max": -8.396600133510082, "outflow_rate_mean": 1153.7821052812506, "system_level_velocity_min": 11.301714294294596, "outflow_rate_min": 338.35525222187107, "system_level_velocity_max": 19.410617212933822}, "info": {"num_steps_trained": 5658245, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016044996678829193, "total_loss": 15.836573600769043, "vf_loss": 15.840264320373535, "policy_loss": -0.006397247780114412, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9564221501350403, "entropy": 1.147202491760254}, "grad_time_ms": 9837.498, "load_time_ms": 13.618, "update_time_ms": 6.541, "num_steps_sampled": 5658245, "sample_time_ms": 12895.418}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ecf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ef60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e7b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5658245, "hostname": "flow-main", "episodes_total": 2191, "timestamp": 1557233355, "episode_reward_max": 1341.0529524426154, "episode_len_mean": 664.59, "time_total_s": 3232.837467432022, "time_since_restore": 3232.837467432022}
{"timesteps_since_restore": 5698585, "training_iteration": 136, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-49-38", "episode_reward_min": 60.044898284826765, "timesteps_this_iter": 40340, "episode_reward_mean": 1157.826129917758, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.956809282302856, "policy_reward_mean": {}, "iterations_since_restore": 136, "custom_metrics": {"outflow_rate_max": 1453.5874005994006, "cost2_mean": -19.25396953165688, "cost1_mean": 354.2598784666965, "system_level_velocity_mean": 14.422282175394706, "cost2_min": -32.01420803885784, "cost1_max": 423.42346294542773, "cost1_min": 33.36999421988269, "cost2_max": -9.559506775909579, "outflow_rate_mean": 1164.750715791672, "system_level_velocity_min": 11.669154590836385, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.741810224952594}, "info": {"num_steps_trained": 5698585, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016623977571725845, "total_loss": 11.172407150268555, "vf_loss": 11.178814888000488, "policy_loss": -0.009213983081281185, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9637864828109741, "entropy": 1.1601983308792114}, "grad_time_ms": 9829.635, "load_time_ms": 14.072, "update_time_ms": 6.464, "num_steps_sampled": 5698585, "sample_time_ms": 12906.945}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6eb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ed30>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5698585, "hostname": "flow-main", "episodes_total": 2208, "timestamp": 1557233378, "episode_reward_max": 1360.7481437259667, "episode_len_mean": 671.23, "time_total_s": 3255.794276714325, "time_since_restore": 3255.794276714325}
{"timesteps_since_restore": 5739900, "training_iteration": 137, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-50-00", "episode_reward_min": 60.044898284826765, "timesteps_this_iter": 41315, "episode_reward_mean": 1156.0773452203723, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.860966682434082, "policy_reward_mean": {}, "iterations_since_restore": 137, "custom_metrics": {"outflow_rate_max": 1453.5874005994006, "cost2_mean": -19.19547469779115, "cost1_mean": 355.07521086509405, "system_level_velocity_mean": 14.447749846317127, "cost2_min": -32.01420803885784, "cost1_max": 433.5123731955446, "cost1_min": 33.36999421988269, "cost2_max": -9.559506775909579, "outflow_rate_mean": 1167.3227362830696, "system_level_velocity_min": 11.669154590836385, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.741810224952594}, "info": {"num_steps_trained": 5739900, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017348218709230423, "total_loss": 15.159829139709473, "vf_loss": 15.163167953491211, "policy_loss": -0.006265518721193075, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9553349614143372, "entropy": 1.1538981199264526}, "grad_time_ms": 9628.44, "load_time_ms": 13.871, "update_time_ms": 6.361, "num_steps_sampled": 5739900, "sample_time_ms": 12868.121}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ea20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69f28>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5739900, "hostname": "flow-main", "episodes_total": 2227, "timestamp": 1557233400, "episode_reward_max": 1360.7481437259667, "episode_len_mean": 672.82, "time_total_s": 3277.655243396759, "time_since_restore": 3277.655243396759}
{"timesteps_since_restore": 5781422, "training_iteration": 138, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-50-24", "episode_reward_min": 60.044898284826765, "timesteps_this_iter": 41522, "episode_reward_mean": 1145.1666190017336, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.551022052764893, "policy_reward_mean": {}, "iterations_since_restore": 138, "custom_metrics": {"outflow_rate_max": 1453.5874005994006, "cost2_mean": -19.119248382901723, "cost1_mean": 349.8867545360429, "system_level_velocity_mean": 14.401669017938678, "cost2_min": -32.01420803885784, "cost1_max": 433.5123731955446, "cost1_min": 33.36999421988269, "cost2_max": -9.559506775909579, "outflow_rate_mean": 1154.7892249122308, "system_level_velocity_min": 11.669154590836385, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.741810224952594}, "info": {"num_steps_trained": 5781422, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014682916924357414, "total_loss": 9.490511894226074, "vf_loss": 9.494096755981445, "policy_loss": -0.006062027998268604, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9726130962371826, "entropy": 1.166985273361206}, "grad_time_ms": 9581.418, "load_time_ms": 13.846, "update_time_ms": 6.295, "num_steps_sampled": 5781422, "sample_time_ms": 12953.899}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116ff28>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5781422, "hostname": "flow-main", "episodes_total": 2243, "timestamp": 1557233424, "episode_reward_max": 1360.7481437259667, "episode_len_mean": 667.16, "time_total_s": 3301.206265449524, "time_since_restore": 3301.206265449524}
{"timesteps_since_restore": 5822689, "training_iteration": 139, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-50-45", "episode_reward_min": 60.044898284826765, "timesteps_this_iter": 41267, "episode_reward_mean": 1159.3505034651714, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.19548511505127, "policy_reward_mean": {}, "iterations_since_restore": 139, "custom_metrics": {"outflow_rate_max": 1453.5874005994006, "cost2_mean": -19.01441928068287, "cost1_mean": 355.906180291282, "system_level_velocity_mean": 14.503300573557858, "cost2_min": -32.01420803885784, "cost1_max": 433.5123731955446, "cost1_min": 33.36999421988269, "cost2_max": -9.559506775909579, "outflow_rate_mean": 1170.6225719433849, "system_level_velocity_min": 11.718973883755334, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.741810224952594}, "info": {"num_steps_trained": 5822689, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01796819269657135, "total_loss": 11.61693000793457, "vf_loss": 11.620899200439453, "policy_loss": -0.007001733407378197, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.963849663734436, "entropy": 1.1687959432601929}, "grad_time_ms": 9580.546, "load_time_ms": 13.53, "update_time_ms": 6.319, "num_steps_sampled": 5822689, "sample_time_ms": 12901.492}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6eac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5822689, "hostname": "flow-main", "episodes_total": 2258, "timestamp": 1557233445, "episode_reward_max": 1364.2614377623486, "episode_len_mean": 672.75, "time_total_s": 3322.401750564575, "time_since_restore": 3322.401750564575}
{"timesteps_since_restore": 5864483, "training_iteration": 140, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-51-07", "episode_reward_min": 60.044898284826765, "timesteps_this_iter": 41794, "episode_reward_mean": 1155.2853387666728, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.910724401474, "policy_reward_mean": {}, "iterations_since_restore": 140, "custom_metrics": {"outflow_rate_max": 1455.218997802198, "cost2_mean": -18.919490002875488, "cost1_mean": 353.69406133145617, "system_level_velocity_mean": 14.411267197571483, "cost2_min": -32.01420803885784, "cost1_max": 433.5123731955446, "cost1_min": 33.36999421988269, "cost2_max": -9.559506775909579, "outflow_rate_mean": 1166.0566239993286, "system_level_velocity_min": 11.331019236628093, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.741810224952594}, "info": {"num_steps_trained": 5864483, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014586986973881721, "total_loss": 9.395174980163574, "vf_loss": 9.398665428161621, "policy_loss": -0.005952091887593269, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9755105972290039, "entropy": 1.1715151071548462}, "grad_time_ms": 9373.728, "load_time_ms": 14.13, "update_time_ms": 6.32, "num_steps_sampled": 5864483, "sample_time_ms": 12993.644}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb691d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5864483, "hostname": "flow-main", "episodes_total": 2275, "timestamp": 1557233467, "episode_reward_max": 1364.2614377623486, "episode_len_mean": 672.75, "time_total_s": 3344.312474966049, "time_since_restore": 3344.312474966049}
{"timesteps_since_restore": 5905559, "training_iteration": 141, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-51-31", "episode_reward_min": 60.044898284826765, "timesteps_this_iter": 41076, "episode_reward_mean": 1182.8231496582243, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.59130358695984, "policy_reward_mean": {}, "iterations_since_restore": 141, "custom_metrics": {"outflow_rate_max": 1455.218997802198, "cost2_mean": -18.996671197787037, "cost1_mean": 358.63388090208616, "system_level_velocity_mean": 14.27664932628207, "cost2_min": -27.675943909896528, "cost1_max": 433.5123731955446, "cost1_min": 33.36999421988269, "cost2_max": -9.559506775909579, "outflow_rate_mean": 1179.440254652517, "system_level_velocity_min": 11.331019236628093, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.59459599824153}, "info": {"num_steps_trained": 5905559, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01599055528640747, "total_loss": 9.567632675170898, "vf_loss": 9.57176399230957, "policy_loss": -0.006829882971942425, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9728975296020508, "entropy": 1.1603939533233643}, "grad_time_ms": 9369.87, "load_time_ms": 13.701, "update_time_ms": 6.316, "num_steps_sampled": 5905559, "sample_time_ms": 13076.994}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6eeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e240>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5905559, "hostname": "flow-main", "episodes_total": 2292, "timestamp": 1557233491, "episode_reward_max": 1393.912491532935, "episode_len_mean": 683.56, "time_total_s": 3367.903778553009, "time_since_restore": 3367.903778553009}
{"timesteps_since_restore": 5947218, "training_iteration": 142, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-51-55", "episode_reward_min": 51.201136374483795, "timesteps_this_iter": 41659, "episode_reward_mean": 1179.6159654076607, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.076101779937744, "policy_reward_mean": {}, "iterations_since_restore": 142, "custom_metrics": {"outflow_rate_max": 1455.218997802198, "cost2_mean": -18.972223941447467, "cost1_mean": 352.7802028607961, "system_level_velocity_mean": 14.15787951235942, "cost2_min": -27.675943909896528, "cost1_max": 433.5123731955446, "cost1_min": 28.43497135931245, "cost2_max": -7.450416903796261, "outflow_rate_mean": 1164.8142157917414, "system_level_velocity_min": 11.331019236628093, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.1025198809089}, "info": {"num_steps_trained": 5947218, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01600569300353527, "total_loss": 12.679708480834961, "vf_loss": 12.684350967407227, "policy_loss": -0.007344386540353298, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9639432430267334, "entropy": 1.1550257205963135}, "grad_time_ms": 9492.603, "load_time_ms": 13.582, "update_time_ms": 6.269, "num_steps_sampled": 5947218, "sample_time_ms": 13192.873}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69cf8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5947218, "hostname": "flow-main", "episodes_total": 2309, "timestamp": 1557233515, "episode_reward_max": 1393.912491532935, "episode_len_mean": 678.11, "time_total_s": 3391.979880332947, "time_since_restore": 3391.979880332947}
{"timesteps_since_restore": 5989975, "training_iteration": 143, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-52-17", "episode_reward_min": 51.201136374483795, "timesteps_this_iter": 42757, "episode_reward_mean": 1197.7299376933838, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.919438123703003, "policy_reward_mean": {}, "iterations_since_restore": 143, "custom_metrics": {"outflow_rate_max": 1455.218997802198, "cost2_mean": -19.581077030679666, "cost1_mean": 353.86571555413315, "system_level_velocity_mean": 14.055385825038716, "cost2_min": -29.249501064536005, "cost1_max": 428.84130469113165, "cost1_min": 28.43497135931245, "cost2_max": -7.450416903796261, "outflow_rate_mean": 1165.5881927508415, "system_level_velocity_min": 11.331019236628093, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.1025198809089}, "info": {"num_steps_trained": 5989975, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01656668819487095, "total_loss": 8.523473739624023, "vf_loss": 8.527728080749512, "policy_loss": -0.007049165200442076, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9727551937103271, "entropy": 1.1561663150787354}, "grad_time_ms": 9297.675, "load_time_ms": 13.411, "update_time_ms": 6.388, "num_steps_sampled": 5989975, "sample_time_ms": 13282.573}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb691d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69048>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 5989975, "hostname": "flow-main", "episodes_total": 2323, "timestamp": 1557233537, "episode_reward_max": 1393.912491532935, "episode_len_mean": 682.39, "time_total_s": 3413.89931845665, "time_since_restore": 3413.89931845665}
{"timesteps_since_restore": 6031829, "training_iteration": 144, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-52-38", "episode_reward_min": 51.02798840049719, "timesteps_this_iter": 41854, "episode_reward_mean": 1167.6874107638928, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.384806394577026, "policy_reward_mean": {}, "iterations_since_restore": 144, "custom_metrics": {"outflow_rate_max": 1455.218997802198, "cost2_mean": -19.791493746639855, "cost1_mean": 345.84385525165055, "system_level_velocity_mean": 14.162463903798741, "cost2_min": -29.249501064536005, "cost1_max": 428.84130469113165, "cost1_min": 28.43497135931245, "cost2_max": -7.450416903796261, "outflow_rate_mean": 1146.5343823984108, "system_level_velocity_min": 11.331019236628093, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.141674051637807}, "info": {"num_steps_trained": 6031829, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016182376071810722, "total_loss": 15.125635147094727, "vf_loss": 15.128363609313965, "policy_loss": -0.005461097229272127, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.955165445804596, "entropy": 1.1456236839294434}, "grad_time_ms": 9084.812, "load_time_ms": 13.373, "update_time_ms": 6.333, "num_steps_sampled": 6031829, "sample_time_ms": 13367.396}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116ff98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116feb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6031829, "hostname": "flow-main", "episodes_total": 2341, "timestamp": 1557233558, "episode_reward_max": 1393.912491532935, "episode_len_mean": 666.01, "time_total_s": 3435.284124851227, "time_since_restore": 3435.284124851227}
{"timesteps_since_restore": 6072544, "training_iteration": 145, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-53-00", "episode_reward_min": 51.02798840049719, "timesteps_this_iter": 40715, "episode_reward_mean": 1160.1223267713485, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.478527069091797, "policy_reward_mean": {}, "iterations_since_restore": 145, "custom_metrics": {"outflow_rate_max": 1455.218997802198, "cost2_mean": -19.965113595231596, "cost1_mean": 339.3469972982823, "system_level_velocity_mean": 13.995869993024401, "cost2_min": -29.249501064536005, "cost1_max": 428.84130469113165, "cost1_min": 28.43497135931245, "cost2_max": -7.450416903796261, "outflow_rate_mean": 1130.5538385003722, "system_level_velocity_min": 11.331019236628093, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.141674051637807}, "info": {"num_steps_trained": 6072544, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013956025242805481, "total_loss": 8.80787467956543, "vf_loss": 8.8119478225708, "policy_loss": -0.0064271013252437115, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.975582480430603, "entropy": 1.1382699012756348}, "grad_time_ms": 8904.02, "load_time_ms": 13.521, "update_time_ms": 6.338, "num_steps_sampled": 6072544, "sample_time_ms": 13392.928}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6072544, "hostname": "flow-main", "episodes_total": 2360, "timestamp": 1557233580, "episode_reward_max": 1393.912491532935, "episode_len_mean": 661.51, "time_total_s": 3456.7626519203186, "time_since_restore": 3456.7626519203186}
{"timesteps_since_restore": 6114257, "training_iteration": 146, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-53-22", "episode_reward_min": 51.02798840049719, "timesteps_this_iter": 41713, "episode_reward_mean": 1168.879299384052, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.63218665122986, "policy_reward_mean": {}, "iterations_since_restore": 146, "custom_metrics": {"outflow_rate_max": 1455.218997802198, "cost2_mean": -20.22219599087279, "cost1_mean": 340.8004681373443, "system_level_velocity_mean": 14.041092115113663, "cost2_min": -29.249501064536005, "cost1_max": 428.84130469113165, "cost1_min": 28.43497135931245, "cost2_max": -7.450416903796261, "outflow_rate_mean": 1134.946149069803, "system_level_velocity_min": 11.936386226552658, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.141674051637807}, "info": {"num_steps_trained": 6114257, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015688782557845116, "total_loss": 7.435413360595703, "vf_loss": 7.43822717666626, "policy_loss": -0.005462040193378925, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9752144813537598, "entropy": 1.1278905868530273}, "grad_time_ms": 8785.143, "load_time_ms": 13.833, "update_time_ms": 6.369, "num_steps_sampled": 6114257, "sample_time_ms": 13478.846}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69ef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6114257, "hostname": "flow-main", "episodes_total": 2374, "timestamp": 1557233602, "episode_reward_max": 1456.922698308359, "episode_len_mean": 661.51, "time_total_s": 3479.3948385715485, "time_since_restore": 3479.3948385715485}
{"timesteps_since_restore": 6156111, "training_iteration": 147, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-53-45", "episode_reward_min": 51.02798840049719, "timesteps_this_iter": 41854, "episode_reward_mean": 1169.0816419176767, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.259312391281128, "policy_reward_mean": {}, "iterations_since_restore": 147, "custom_metrics": {"outflow_rate_max": 1398.7355224775224, "cost2_mean": -20.205024741219965, "cost1_mean": 338.1774318179939, "system_level_velocity_mean": 14.043142994068546, "cost2_min": -29.249501064536005, "cost1_max": 428.84130469113165, "cost1_min": 28.43497135931245, "cost2_max": -7.450416903796261, "outflow_rate_mean": 1129.7915432092511, "system_level_velocity_min": 11.936386226552658, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.141674051637807}, "info": {"num_steps_trained": 6156111, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016251055523753166, "total_loss": 8.766959190368652, "vf_loss": 8.772047996520996, "policy_loss": -0.007830965332686901, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9701447486877441, "entropy": 1.1144367456436157}, "grad_time_ms": 9010.864, "load_time_ms": 13.707, "update_time_ms": 6.402, "num_steps_sampled": 6156111, "sample_time_ms": 13393.21}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fe10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6156111, "hostname": "flow-main", "episodes_total": 2388, "timestamp": 1557233625, "episode_reward_max": 1456.922698308359, "episode_len_mean": 657.18, "time_total_s": 3502.6541509628296, "time_since_restore": 3502.6541509628296}
{"timesteps_since_restore": 6197402, "training_iteration": 148, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-54-08", "episode_reward_min": 51.02798840049719, "timesteps_this_iter": 41291, "episode_reward_mean": 1158.2288209495919, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.01715064048767, "policy_reward_mean": {}, "iterations_since_restore": 148, "custom_metrics": {"outflow_rate_max": 1398.7355224775224, "cost2_mean": -20.195936623565355, "cost1_mean": 336.69950070248655, "system_level_velocity_mean": 14.147693995422555, "cost2_min": -29.249501064536005, "cost1_max": 428.84130469113165, "cost1_min": 28.43497135931245, "cost2_max": -7.450416903796261, "outflow_rate_mean": 1128.5686913331642, "system_level_velocity_min": 11.936386226552658, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.141674051637807}, "info": {"num_steps_trained": 6197402, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016206054016947746, "total_loss": 11.873940467834473, "vf_loss": 11.87942123413086, "policy_loss": -0.008215782232582569, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9673594832420349, "entropy": 1.1182717084884644}, "grad_time_ms": 8857.989, "load_time_ms": 13.83, "update_time_ms": 6.506, "num_steps_sampled": 6197402, "sample_time_ms": 13391.87}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69b00>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6197402, "hostname": "flow-main", "episodes_total": 2407, "timestamp": 1557233648, "episode_reward_max": 1456.922698308359, "episode_len_mean": 651.29, "time_total_s": 3524.6713016033173, "time_since_restore": 3524.6713016033173}
{"timesteps_since_restore": 6237701, "training_iteration": 149, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-54-31", "episode_reward_min": 51.02798840049719, "timesteps_this_iter": 40299, "episode_reward_mean": 1148.9818664587008, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.069793224334717, "policy_reward_mean": {}, "iterations_since_restore": 149, "custom_metrics": {"outflow_rate_max": 1353.183998001998, "cost2_mean": -19.938234037930453, "cost1_mean": 334.74769042912436, "system_level_velocity_mean": 14.164650029625436, "cost2_min": -28.132011579977668, "cost1_max": 406.88630835910857, "cost1_min": 28.479286518377105, "cost2_max": -7.886566135398778, "outflow_rate_mean": 1127.4564717442172, "system_level_velocity_min": 11.643530957593722, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.141674051637807}, "info": {"num_steps_trained": 6237701, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016889357939362526, "total_loss": 13.126590728759766, "vf_loss": 13.131585121154785, "policy_loss": -0.007845507934689522, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9663560390472412, "entropy": 1.110077142715454}, "grad_time_ms": 9022.802, "load_time_ms": 14.002, "update_time_ms": 6.476, "num_steps_sampled": 6237701, "sample_time_ms": 13413.124}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb698d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb699e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69080>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6237701, "hostname": "flow-main", "episodes_total": 2426, "timestamp": 1557233671, "episode_reward_max": 1456.922698308359, "episode_len_mean": 647.62, "time_total_s": 3547.741094827652, "time_since_restore": 3547.741094827652}
{"timesteps_since_restore": 6280031, "training_iteration": 150, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-54-54", "episode_reward_min": 177.16662032752552, "timesteps_this_iter": 42330, "episode_reward_mean": 1174.288906261176, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.48014259338379, "policy_reward_mean": {}, "iterations_since_restore": 150, "custom_metrics": {"outflow_rate_max": 1435.0937110889113, "cost2_mean": -20.130715079077742, "cost1_mean": 342.4175994679834, "system_level_velocity_mean": 14.164916097896867, "cost2_min": -30.204616641050784, "cost1_max": 418.0168481728167, "cost1_min": 77.5935680286535, "cost2_max": -8.379268269037244, "outflow_rate_mean": 1148.9893386601657, "system_level_velocity_min": 11.643530957593722, "outflow_rate_min": 430.7355832517697, "system_level_velocity_max": 18.271946901154866}, "info": {"num_steps_trained": 6280031, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018387075513601303, "total_loss": 15.560502052307129, "vf_loss": 15.564332962036133, "policy_loss": -0.006932817865163088, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.950178325176239, "entropy": 1.111764669418335}, "grad_time_ms": 9231.723, "load_time_ms": 14.121, "update_time_ms": 6.541, "num_steps_sampled": 6280031, "sample_time_ms": 13361.102}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ef60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ebe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e160>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6280031, "hostname": "flow-main", "episodes_total": 2443, "timestamp": 1557233694, "episode_reward_max": 1456.922698308359, "episode_len_mean": 658.42, "time_total_s": 3571.2212374210358, "time_since_restore": 3571.2212374210358}
{"timesteps_since_restore": 6322972, "training_iteration": 151, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-55-17", "episode_reward_min": 177.16662032752552, "timesteps_this_iter": 42941, "episode_reward_mean": 1175.9013789415314, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.362558603286743, "policy_reward_mean": {}, "iterations_since_restore": 151, "custom_metrics": {"outflow_rate_max": 1435.0937110889113, "cost2_mean": -20.234038553318868, "cost1_mean": 343.05723961790324, "system_level_velocity_mean": 14.226038360384596, "cost2_min": -30.204616641050784, "cost1_max": 434.07616234707524, "cost1_min": 75.47920671659121, "cost2_max": -8.379268269037244, "outflow_rate_mean": 1152.4640950353362, "system_level_velocity_min": 11.643530957593722, "outflow_rate_min": 430.7355832517697, "system_level_velocity_max": 18.271946901154866}, "info": {"num_steps_trained": 6322972, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018085308372974396, "total_loss": 11.155818939208984, "vf_loss": 11.161190032958984, "policy_loss": -0.008422397077083588, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9678224325180054, "entropy": 1.1163586378097534}, "grad_time_ms": 9086.389, "load_time_ms": 14.332, "update_time_ms": 6.493, "num_steps_sampled": 6322972, "sample_time_ms": 13383.279}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6322972, "hostname": "flow-main", "episodes_total": 2459, "timestamp": 1557233717, "episode_reward_max": 1456.922698308359, "episode_len_mean": 657.1, "time_total_s": 3593.5837960243225, "time_since_restore": 3593.5837960243225}
{"timesteps_since_restore": 6364659, "training_iteration": 152, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-55-41", "episode_reward_min": 54.72517951837103, "timesteps_this_iter": 41687, "episode_reward_mean": 1145.566409516446, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.977888107299805, "policy_reward_mean": {}, "iterations_since_restore": 152, "custom_metrics": {"outflow_rate_max": 1435.0937110889113, "cost2_mean": -20.435087867758046, "cost1_mean": 334.3888425701444, "system_level_velocity_mean": 14.378171043558716, "cost2_min": -34.63085608875889, "cost1_max": 434.07616234707524, "cost1_min": 28.241282047952115, "cost2_max": -6.599604175741276, "outflow_rate_mean": 1135.1682897409742, "system_level_velocity_min": 11.643530957593722, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.156183839690087}, "info": {"num_steps_trained": 6364659, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.019197287037968636, "total_loss": 18.38571548461914, "vf_loss": 18.389842987060547, "policy_loss": -0.0073678744956851006, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.946902334690094, "entropy": 1.1216118335723877}, "grad_time_ms": 9096.527, "load_time_ms": 14.677, "update_time_ms": 6.543, "num_steps_sampled": 6364659, "sample_time_ms": 13362.967}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb699b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69c18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6364659, "hostname": "flow-main", "episodes_total": 2477, "timestamp": 1557233741, "episode_reward_max": 1394.1457260910347, "episode_len_mean": 639.81, "time_total_s": 3617.5616841316223, "time_since_restore": 3617.5616841316223}
{"timesteps_since_restore": 6406046, "training_iteration": 153, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-56-02", "episode_reward_min": 54.72517951837103, "timesteps_this_iter": 41387, "episode_reward_mean": 1166.9778743150057, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.351449489593506, "policy_reward_mean": {}, "iterations_since_restore": 153, "custom_metrics": {"outflow_rate_max": 1435.0937110889113, "cost2_mean": -21.361421584193227, "cost1_mean": 338.8454421467367, "system_level_velocity_mean": 14.287391578635484, "cost2_min": -34.63085608875889, "cost1_max": 434.07616234707524, "cost1_min": 28.241282047952115, "cost2_max": -6.599604175741276, "outflow_rate_mean": 1149.0892195132637, "system_level_velocity_min": 11.643530957593722, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.156183839690087}, "info": {"num_steps_trained": 6406046, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016524940729141235, "total_loss": 9.830768585205078, "vf_loss": 9.834569931030273, "policy_loss": -0.006591004319489002, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9677417874336243, "entropy": 1.141926646232605}, "grad_time_ms": 9096.32, "load_time_ms": 14.74, "update_time_ms": 6.579, "num_steps_sampled": 6406046, "sample_time_ms": 13305.438}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ec88>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6406046, "hostname": "flow-main", "episodes_total": 2492, "timestamp": 1557233762, "episode_reward_max": 1394.1457260910347, "episode_len_mean": 650.0, "time_total_s": 3638.913133621216, "time_since_restore": 3638.913133621216}
{"timesteps_since_restore": 6447125, "training_iteration": 154, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-56-24", "episode_reward_min": 54.72517951837103, "timesteps_this_iter": 41079, "episode_reward_mean": 1179.7196146553913, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.367069244384766, "policy_reward_mean": {}, "iterations_since_restore": 154, "custom_metrics": {"outflow_rate_max": 1461.6767216783217, "cost2_mean": -22.295237076685098, "cost1_mean": 344.8817637712873, "system_level_velocity_mean": 14.385876055386147, "cost2_min": -34.63085608875889, "cost1_max": 457.0639482707557, "cost1_min": 28.241282047952115, "cost2_max": -6.599604175741276, "outflow_rate_mean": 1164.6919711336602, "system_level_velocity_min": 11.679989617467305, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.156183839690087}, "info": {"num_steps_trained": 6447125, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017310194671154022, "total_loss": 16.820018768310547, "vf_loss": 16.824565887451172, "policy_loss": -0.007469793315976858, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9506778717041016, "entropy": 1.1376657485961914}, "grad_time_ms": 9227.292, "load_time_ms": 14.685, "update_time_ms": 6.658, "num_steps_sampled": 6447125, "sample_time_ms": 13272.127}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb720f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb723c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72a20>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6447125, "hostname": "flow-main", "episodes_total": 2511, "timestamp": 1557233784, "episode_reward_max": 1545.9923217210787, "episode_len_mean": 655.47, "time_total_s": 3661.2802028656006, "time_since_restore": 3661.2802028656006}
{"timesteps_since_restore": 6488983, "training_iteration": 155, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-56-48", "episode_reward_min": 54.72517951837103, "timesteps_this_iter": 41858, "episode_reward_mean": 1180.7833684676489, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.250144004821777, "policy_reward_mean": {}, "iterations_since_restore": 155, "custom_metrics": {"outflow_rate_max": 1461.6767216783217, "cost2_mean": -22.8477571569713, "cost1_mean": 343.85188005698996, "system_level_velocity_mean": 14.349376615156608, "cost2_min": -34.63085608875889, "cost1_max": 457.0639482707557, "cost1_min": 28.241282047952115, "cost2_max": -6.599604175741276, "outflow_rate_mean": 1160.8468208010722, "system_level_velocity_min": 11.679989617467305, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.156183839690087}, "info": {"num_steps_trained": 6488983, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015431705862283707, "total_loss": 10.337111473083496, "vf_loss": 10.341498374938965, "policy_loss": -0.006990749388933182, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9656811356544495, "entropy": 1.1497851610183716}, "grad_time_ms": 9470.493, "load_time_ms": 14.559, "update_time_ms": 6.775, "num_steps_sampled": 6488983, "sample_time_ms": 13205.736}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6488983, "hostname": "flow-main", "episodes_total": 2528, "timestamp": 1557233808, "episode_reward_max": 1545.9923217210787, "episode_len_mean": 654.68, "time_total_s": 3684.5303468704224, "time_since_restore": 3684.5303468704224}
{"timesteps_since_restore": 6530602, "training_iteration": 156, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-57-11", "episode_reward_min": 54.72517951837103, "timesteps_this_iter": 41619, "episode_reward_mean": 1204.7337804295253, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.243576765060425, "policy_reward_mean": {}, "iterations_since_restore": 156, "custom_metrics": {"outflow_rate_max": 1461.6767216783217, "cost2_mean": -23.792831685603872, "cost1_mean": 349.1184144760843, "system_level_velocity_mean": 14.263908239157194, "cost2_min": -36.73343980734268, "cost1_max": 457.0639482707557, "cost1_min": 28.241282047952115, "cost2_max": -6.599604175741276, "outflow_rate_mean": 1173.385310827174, "system_level_velocity_min": 11.819096365685047, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.156183839690087}, "info": {"num_steps_trained": 6530602, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015347618609666824, "total_loss": 9.259706497192383, "vf_loss": 9.264781951904297, "policy_loss": -0.007665989920496941, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9744112491607666, "entropy": 1.1397132873535156}, "grad_time_ms": 9616.647, "load_time_ms": 14.221, "update_time_ms": 6.77, "num_steps_sampled": 6530602, "sample_time_ms": 13120.993}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e7b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6530602, "hostname": "flow-main", "episodes_total": 2543, "timestamp": 1557233831, "episode_reward_max": 1545.9923217210787, "episode_len_mean": 665.92, "time_total_s": 3707.773923635483, "time_since_restore": 3707.773923635483}
{"timesteps_since_restore": 6573032, "training_iteration": 157, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-57-34", "episode_reward_min": 54.72517951837103, "timesteps_this_iter": 42430, "episode_reward_mean": 1205.891512912352, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.34948182106018, "policy_reward_mean": {}, "iterations_since_restore": 157, "custom_metrics": {"outflow_rate_max": 1461.6767216783217, "cost2_mean": -24.756470043628916, "cost1_mean": 350.75105411366246, "system_level_velocity_mean": 14.337314889722052, "cost2_min": -36.73343980734268, "cost1_max": 457.0639482707557, "cost1_min": 28.241282047952115, "cost2_max": -6.599604175741276, "outflow_rate_mean": 1173.6729163825612, "system_level_velocity_min": 11.819096365685047, "outflow_rate_min": 335.6139678872712, "system_level_velocity_max": 19.156183839690087}, "info": {"num_steps_trained": 6573032, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01612386852502823, "total_loss": 9.581482887268066, "vf_loss": 9.586085319519043, "policy_loss": -0.007324898149818182, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9696338176727295, "entropy": 1.1265360116958618}, "grad_time_ms": 9445.411, "load_time_ms": 14.527, "update_time_ms": 6.733, "num_steps_sampled": 6573032, "sample_time_ms": 13299.576}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72128>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6573032, "hostname": "flow-main", "episodes_total": 2559, "timestamp": 1557233854, "episode_reward_max": 1545.9923217210787, "episode_len_mean": 665.21, "time_total_s": 3731.123405456543, "time_since_restore": 3731.123405456543}
{"timesteps_since_restore": 6616231, "training_iteration": 158, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-57-57", "episode_reward_min": 60.246793856679496, "timesteps_this_iter": 43199, "episode_reward_mean": 1225.0834924234923, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.564725160598755, "policy_reward_mean": {}, "iterations_since_restore": 158, "custom_metrics": {"outflow_rate_max": 1461.6767216783217, "cost2_mean": -25.67126831795427, "cost1_mean": 356.36458562538877, "system_level_velocity_mean": 14.207611744248188, "cost2_min": -36.73343980734268, "cost1_max": 457.0639482707557, "cost1_min": 31.04852044415248, "cost2_max": -6.9844873922917055, "outflow_rate_mean": 1182.6328898165718, "system_level_velocity_min": 11.813800980441094, "outflow_rate_min": 335.6139678872712, "system_level_velocity_max": 18.762123110628377}, "info": {"num_steps_trained": 6616231, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015884438529610634, "total_loss": 7.277656555175781, "vf_loss": 7.282224178314209, "policy_loss": -0.007247689180076122, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9779223203659058, "entropy": 1.1342391967773438}, "grad_time_ms": 9486.278, "load_time_ms": 14.348, "update_time_ms": 6.596, "num_steps_sampled": 6616231, "sample_time_ms": 13314.588}, "episodes_this_iter": 13, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb699e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69160>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6616231, "hostname": "flow-main", "episodes_total": 2572, "timestamp": 1557233877, "episode_reward_max": 1545.9923217210787, "episode_len_mean": 677.49, "time_total_s": 3753.6881306171417, "time_since_restore": 3753.6881306171417}
{"timesteps_since_restore": 6657439, "training_iteration": 159, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-58-19", "episode_reward_min": 57.97179697506592, "timesteps_this_iter": 41208, "episode_reward_mean": 1221.4899964031204, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.762134313583374, "policy_reward_mean": {}, "iterations_since_restore": 159, "custom_metrics": {"outflow_rate_max": 1461.6767216783217, "cost2_mean": -26.598849139056465, "cost1_mean": 355.57488639207884, "system_level_velocity_mean": 14.203293441445455, "cost2_min": -44.578429049630095, "cost1_max": 457.0639482707557, "cost1_min": 31.04852044415248, "cost2_max": -6.9844873922917055, "outflow_rate_mean": 1177.182136231807, "system_level_velocity_min": 11.611933707878254, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.97038029133214}, "info": {"num_steps_trained": 6657439, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017250891774892807, "total_loss": 10.003724098205566, "vf_loss": 10.00912094116211, "policy_loss": -0.008308165706694126, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9718353152275085, "entropy": 1.118417739868164}, "grad_time_ms": 9334.673, "load_time_ms": 14.271, "update_time_ms": 6.532, "num_steps_sampled": 6657439, "sample_time_ms": 13336.404}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf05f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf09b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d5c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6657439, "hostname": "flow-main", "episodes_total": 2589, "timestamp": 1557233899, "episode_reward_max": 1545.9923217210787, "episode_len_mean": 676.0, "time_total_s": 3775.450264930725, "time_since_restore": 3775.450264930725}
{"timesteps_since_restore": 6700411, "training_iteration": 160, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-58-43", "episode_reward_min": 57.97179697506592, "timesteps_this_iter": 42972, "episode_reward_mean": 1223.6962439090146, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.12802767753601, "policy_reward_mean": {}, "iterations_since_restore": 160, "custom_metrics": {"outflow_rate_max": 1414.0566025974024, "cost2_mean": -27.825655208839315, "cost1_mean": 356.3120737788572, "system_level_velocity_mean": 14.207239066930832, "cost2_min": -44.578429049630095, "cost1_max": 421.77722718902885, "cost1_min": 31.04852044415248, "cost2_max": -6.9844873922917055, "outflow_rate_mean": 1175.232951420618, "system_level_velocity_min": 11.611933707878254, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.97038029133214}, "info": {"num_steps_trained": 6700411, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018000049516558647, "total_loss": 7.443461894989014, "vf_loss": 7.4498395919799805, "policy_loss": -0.009415333159267902, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.978530764579773, "entropy": 1.1145141124725342}, "grad_time_ms": 9310.45, "load_time_ms": 14.342, "update_time_ms": 6.562, "num_steps_sampled": 6700411, "sample_time_ms": 13425.218}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ecf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e080>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6700411, "hostname": "flow-main", "episodes_total": 2607, "timestamp": 1557233923, "episode_reward_max": 1426.8913802974994, "episode_len_mean": 676.0, "time_total_s": 3799.578292608261, "time_since_restore": 3799.578292608261}
{"timesteps_since_restore": 6741733, "training_iteration": 161, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-59-07", "episode_reward_min": 56.356716372476605, "timesteps_this_iter": 41322, "episode_reward_mean": 1204.2830511580164, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.9501211643219, "policy_reward_mean": {}, "iterations_since_restore": 161, "custom_metrics": {"outflow_rate_max": 1414.0566025974024, "cost2_mean": -28.377639888446897, "cost1_mean": 349.10057563730385, "system_level_velocity_mean": 14.112395360660042, "cost2_min": -44.578429049630095, "cost1_max": 421.77722718902885, "cost1_min": 31.04852044415248, "cost2_max": -6.9844873922917055, "outflow_rate_mean": 1154.0206858058602, "system_level_velocity_min": 11.340004902847797, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.97038029133214}, "info": {"num_steps_trained": 6741733, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017430739477276802, "total_loss": 13.351492881774902, "vf_loss": 13.357247352600098, "policy_loss": -0.008697575889527798, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9617197513580322, "entropy": 1.1187865734100342}, "grad_time_ms": 9435.451, "load_time_ms": 14.588, "update_time_ms": 6.615, "num_steps_sampled": 6741733, "sample_time_ms": 13458.082}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb720b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6741733, "hostname": "flow-main", "episodes_total": 2624, "timestamp": 1557233947, "episode_reward_max": 1421.014139106352, "episode_len_mean": 669.21, "time_total_s": 3823.528413772583, "time_since_restore": 3823.528413772583}
{"timesteps_since_restore": 6784037, "training_iteration": 162, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-59-29", "episode_reward_min": 56.356716372476605, "timesteps_this_iter": 42304, "episode_reward_mean": 1217.9217239162479, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.891371250152588, "policy_reward_mean": {}, "iterations_since_restore": 162, "custom_metrics": {"outflow_rate_max": 1414.0566025974024, "cost2_mean": -28.726788036909273, "cost1_mean": 353.3151358025565, "system_level_velocity_mean": 14.11644835581761, "cost2_min": -44.578429049630095, "cost1_max": 431.28527560655914, "cost1_min": 31.04852044415248, "cost2_max": -6.9844873922917055, "outflow_rate_mean": 1171.484042193124, "system_level_velocity_min": 10.233697669101955, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.97038029133214}, "info": {"num_steps_trained": 6784037, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01616877317428589, "total_loss": 10.335322380065918, "vf_loss": 10.339142799377441, "policy_loss": -0.006548615638166666, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9647271633148193, "entropy": 1.0985231399536133}, "grad_time_ms": 9266.094, "load_time_ms": 14.282, "update_time_ms": 6.544, "num_steps_sampled": 6784037, "sample_time_ms": 13420.003}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ec50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e828>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6784037, "hostname": "flow-main", "episodes_total": 2638, "timestamp": 1557233969, "episode_reward_max": 1421.014139106352, "episode_len_mean": 674.78, "time_total_s": 3845.4197850227356, "time_since_restore": 3845.4197850227356}
{"timesteps_since_restore": 6828422, "training_iteration": 163, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_12-59-53", "episode_reward_min": 56.356716372476605, "timesteps_this_iter": 44385, "episode_reward_mean": 1212.8719614655733, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.65925145149231, "policy_reward_mean": {}, "iterations_since_restore": 163, "custom_metrics": {"outflow_rate_max": 1414.0566025974024, "cost2_mean": -29.298966476638146, "cost1_mean": 349.1100289260625, "system_level_velocity_mean": 13.928586181797964, "cost2_min": -44.578429049630095, "cost1_max": 431.28527560655914, "cost1_min": 31.37235908354852, "cost2_max": -8.985052621873177, "outflow_rate_mean": 1162.2736121263229, "system_level_velocity_min": 10.233697669101955, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.97038029133214}, "info": {"num_steps_trained": 6828422, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017473021522164345, "total_loss": 9.917445182800293, "vf_loss": 9.920658111572266, "policy_loss": -0.006161333993077278, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9653829336166382, "entropy": 1.1224514245986938}, "grad_time_ms": 9492.709, "load_time_ms": 14.475, "update_time_ms": 6.443, "num_steps_sampled": 6828422, "sample_time_ms": 13524.382}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e630>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6828422, "hostname": "flow-main", "episodes_total": 2653, "timestamp": 1557233993, "episode_reward_max": 1421.014139106352, "episode_len_mean": 675.83, "time_total_s": 3870.079036474228, "time_since_restore": 3870.079036474228}
{"timesteps_since_restore": 6870955, "training_iteration": 164, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-00-16", "episode_reward_min": 56.356716372476605, "timesteps_this_iter": 42533, "episode_reward_mean": 1213.01248541282, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.854647397994995, "policy_reward_mean": {}, "iterations_since_restore": 164, "custom_metrics": {"outflow_rate_max": 1414.0566025974024, "cost2_mean": -29.24699424415239, "cost1_mean": 347.30209313397665, "system_level_velocity_mean": 13.87444263152641, "cost2_min": -44.578429049630095, "cost1_max": 431.28527560655914, "cost1_min": 31.37235908354852, "cost2_max": -8.985052621873177, "outflow_rate_mean": 1159.292584270179, "system_level_velocity_min": 10.233697669101955, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.97038029133214}, "info": {"num_steps_trained": 6870955, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016030358150601387, "total_loss": 6.113492488861084, "vf_loss": 6.11833381652832, "policy_loss": -0.007547075394541025, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9805372357368469, "entropy": 1.1224809885025024}, "grad_time_ms": 9421.395, "load_time_ms": 14.549, "update_time_ms": 6.491, "num_steps_sampled": 6870955, "sample_time_ms": 13644.371}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69c88>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6870955, "hostname": "flow-main", "episodes_total": 2667, "timestamp": 1557234016, "episode_reward_max": 1421.014139106352, "episode_len_mean": 675.83, "time_total_s": 3892.933683872223, "time_since_restore": 3892.933683872223}
{"timesteps_since_restore": 6911817, "training_iteration": 165, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-00-40", "episode_reward_min": 56.356716372476605, "timesteps_this_iter": 40862, "episode_reward_mean": 1204.9806448122356, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.67886757850647, "policy_reward_mean": {}, "iterations_since_restore": 165, "custom_metrics": {"outflow_rate_max": 1414.0566025974024, "cost2_mean": -29.048863639197542, "cost1_mean": 343.6355885113102, "system_level_velocity_mean": 13.806817106630117, "cost2_min": -44.578429049630095, "cost1_max": 431.28527560655914, "cost1_min": 31.37235908354852, "cost2_max": -8.985052621873177, "outflow_rate_mean": 1153.3825062043209, "system_level_velocity_min": 10.233697669101955, "outflow_rate_min": 335.6139678872712, "system_level_velocity_max": 18.96922825834571}, "info": {"num_steps_trained": 6911817, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01723131723701954, "total_loss": 12.945289611816406, "vf_loss": 12.949654579162598, "policy_loss": -0.007273199502378702, "cur_kl_coeff": 0.16875000298023224, "vf_explained_var": 0.963493824005127, "entropy": 1.1171084642410278}, "grad_time_ms": 9322.288, "load_time_ms": 14.631, "update_time_ms": 6.559, "num_steps_sampled": 6911817, "sample_time_ms": 13786.861}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb693c8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6911817, "hostname": "flow-main", "episodes_total": 2687, "timestamp": 1557234040, "episode_reward_max": 1405.0384027563202, "episode_len_mean": 673.06, "time_total_s": 3916.6125514507294, "time_since_restore": 3916.6125514507294}
{"timesteps_since_restore": 6952903, "training_iteration": 166, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-01-01", "episode_reward_min": 56.356716372476605, "timesteps_this_iter": 41086, "episode_reward_mean": 1187.996140076026, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.422813177108765, "policy_reward_mean": {}, "iterations_since_restore": 166, "custom_metrics": {"outflow_rate_max": 1401.0147636363636, "cost2_mean": -28.421028619444797, "cost1_mean": 337.6931930050596, "system_level_velocity_mean": 13.736538454433244, "cost2_min": -44.45569047277867, "cost1_max": 431.28527560655914, "cost1_min": 31.37235908354852, "cost2_max": -8.985052621873177, "outflow_rate_mean": 1141.8266969740005, "system_level_velocity_min": 10.233697669101955, "outflow_rate_min": 335.6139678872712, "system_level_velocity_max": 18.96922825834571}, "info": {"num_steps_trained": 6952903, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016693435609340668, "total_loss": 10.235244750976562, "vf_loss": 10.240155220031738, "policy_loss": -0.007728601340204477, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.970367431640625, "entropy": 1.1202348470687866}, "grad_time_ms": 9042.75, "load_time_ms": 14.264, "update_time_ms": 6.551, "num_steps_sampled": 6952903, "sample_time_ms": 13885.025}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69a90>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6952903, "hostname": "flow-main", "episodes_total": 2705, "timestamp": 1557234061, "episode_reward_max": 1405.0384027563202, "episode_len_mean": 667.75, "time_total_s": 3938.035364627838, "time_since_restore": 3938.035364627838}
{"timesteps_since_restore": 6996364, "training_iteration": 167, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-01-24", "episode_reward_min": 277.899976007897, "timesteps_this_iter": 43461, "episode_reward_mean": 1195.3432200254192, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.220651388168335, "policy_reward_mean": {}, "iterations_since_restore": 167, "custom_metrics": {"outflow_rate_max": 1401.0147636363636, "cost2_mean": -28.85993244438595, "cost1_mean": 342.12451093920913, "system_level_velocity_mean": 13.73085779469792, "cost2_min": -44.45569047277867, "cost1_max": 431.28527560655914, "cost1_min": 99.81737847976187, "cost2_max": -11.33010232923688, "outflow_rate_mean": 1158.75586488758, "system_level_velocity_min": 10.233697669101955, "outflow_rate_min": 486.86542302190384, "system_level_velocity_max": 17.85972667426329}, "info": {"num_steps_trained": 6996364, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017683928832411766, "total_loss": 11.664658546447754, "vf_loss": 11.670055389404297, "policy_loss": -0.008381299674510956, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9572757482528687, "entropy": 1.1329854726791382}, "grad_time_ms": 9081.712, "load_time_ms": 14.174, "update_time_ms": 6.661, "num_steps_sampled": 6996364, "sample_time_ms": 13733.533}, "episodes_this_iter": 12, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb726d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 6996364, "hostname": "flow-main", "episodes_total": 2717, "timestamp": 1557234084, "episode_reward_max": 1391.205473201581, "episode_len_mean": 675.06, "time_total_s": 3960.2560160160065, "time_since_restore": 3960.2560160160065}
{"timesteps_since_restore": 7038666, "training_iteration": 168, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-01-46", "episode_reward_min": 277.899976007897, "timesteps_this_iter": 42302, "episode_reward_mean": 1184.9788186520793, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.16629123687744, "policy_reward_mean": {}, "iterations_since_restore": 168, "custom_metrics": {"outflow_rate_max": 1385.9235196803195, "cost2_mean": -29.071987414013552, "cost1_mean": 338.9712424221343, "system_level_velocity_mean": 13.634776983928992, "cost2_min": -44.45569047277867, "cost1_max": 431.28527560655914, "cost1_min": 99.81737847976187, "cost2_max": -11.33010232923688, "outflow_rate_mean": 1149.6930767637036, "system_level_velocity_min": 10.706195923748144, "outflow_rate_min": 486.86542302190384, "system_level_velocity_max": 17.85972667426329}, "info": {"num_steps_trained": 7038666, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017181335017085075, "total_loss": 6.726777076721191, "vf_loss": 6.733105659484863, "policy_loss": -0.009227019734680653, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9815648794174194, "entropy": 1.114808440208435}, "grad_time_ms": 9054.006, "load_time_ms": 14.031, "update_time_ms": 6.633, "num_steps_sampled": 7038666, "sample_time_ms": 13721.674}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb727b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb721d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7038666, "hostname": "flow-main", "episodes_total": 2733, "timestamp": 1557234106, "episode_reward_max": 1391.205473201581, "episode_len_mean": 675.06, "time_total_s": 3982.422307252884, "time_since_restore": 3982.422307252884}
{"timesteps_since_restore": 7079610, "training_iteration": 169, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-02-10", "episode_reward_min": 171.5929063853365, "timesteps_this_iter": 40944, "episode_reward_mean": 1176.6846885744253, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.02423095703125, "policy_reward_mean": {}, "iterations_since_restore": 169, "custom_metrics": {"outflow_rate_max": 1385.9235196803195, "cost2_mean": -28.344226978135456, "cost1_mean": 339.63720693334886, "system_level_velocity_mean": 13.716064346525425, "cost2_min": -40.47112010262768, "cost1_max": 408.7023945969495, "cost1_min": 70.43267383746266, "cost2_max": -10.074497134753777, "outflow_rate_mean": 1150.7292362624626, "system_level_velocity_min": 10.706195923748144, "outflow_rate_min": 439.5359604337186, "system_level_velocity_max": 18.30645081053707}, "info": {"num_steps_trained": 7079610, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017148783430457115, "total_loss": 11.87674617767334, "vf_loss": 11.88173770904541, "policy_loss": -0.00788642093539238, "cur_kl_coeff": 0.16875000298023224, "vf_explained_var": 0.9638826847076416, "entropy": 1.1161105632781982}, "grad_time_ms": 9238.748, "load_time_ms": 14.108, "update_time_ms": 6.668, "num_steps_sampled": 7079610, "sample_time_ms": 13763.45}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb5d400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7079610, "hostname": "flow-main", "episodes_total": 2751, "timestamp": 1557234130, "episode_reward_max": 1391.205473201581, "episode_len_mean": 674.59, "time_total_s": 4006.446538209915, "time_since_restore": 4006.446538209915}
{"timesteps_since_restore": 7120009, "training_iteration": 170, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-02-33", "episode_reward_min": 171.5929063853365, "timesteps_this_iter": 40399, "episode_reward_mean": 1180.8166887719103, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.54422879219055, "policy_reward_mean": {}, "iterations_since_restore": 170, "custom_metrics": {"outflow_rate_max": 1418.339830969031, "cost2_mean": -27.763087303309806, "cost1_mean": 343.22983258968713, "system_level_velocity_mean": 13.769725619250819, "cost2_min": -40.47112010262768, "cost1_max": 421.2893393801882, "cost1_min": 70.43267383746266, "cost2_max": -10.074497134753777, "outflow_rate_mean": 1161.6922284247487, "system_level_velocity_min": 10.706195923748144, "outflow_rate_min": 439.5359604337186, "system_level_velocity_max": 18.30645081053707}, "info": {"num_steps_trained": 7120009, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017295194789767265, "total_loss": 12.514616966247559, "vf_loss": 12.519678115844727, "policy_loss": -0.00798043329268694, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9652180075645447, "entropy": 1.1210519075393677}, "grad_time_ms": 9204.619, "load_time_ms": 13.848, "update_time_ms": 6.65, "num_steps_sampled": 7120009, "sample_time_ms": 13740.333}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72ba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7120009, "hostname": "flow-main", "episodes_total": 2770, "timestamp": 1557234153, "episode_reward_max": 1391.205473201581, "episode_len_mean": 678.51, "time_total_s": 4029.9907670021057, "time_since_restore": 4029.9907670021057}
{"timesteps_since_restore": 7162212, "training_iteration": 171, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-02-57", "episode_reward_min": 171.5929063853365, "timesteps_this_iter": 42203, "episode_reward_mean": 1184.212727968322, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.645447969436646, "policy_reward_mean": {}, "iterations_since_restore": 171, "custom_metrics": {"outflow_rate_max": 1418.339830969031, "cost2_mean": -27.51489861484171, "cost1_mean": 347.30537928364953, "system_level_velocity_mean": 13.81120987690942, "cost2_min": -40.47112010262768, "cost1_max": 421.2893393801882, "cost1_min": 70.43267383746266, "cost2_max": -10.074497134753777, "outflow_rate_mean": 1176.737010222988, "system_level_velocity_min": 10.706195923748144, "outflow_rate_min": 439.5359604337186, "system_level_velocity_max": 18.30645081053707}, "info": {"num_steps_trained": 7162212, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016242511570453644, "total_loss": 9.059162139892578, "vf_loss": 9.063316345214844, "policy_loss": -0.006894590798765421, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9742346405982971, "entropy": 1.1121008396148682}, "grad_time_ms": 9222.002, "load_time_ms": 13.494, "update_time_ms": 6.664, "num_steps_sampled": 7162212, "sample_time_ms": 13693.702}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb727f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb727b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7162212, "hostname": "flow-main", "episodes_total": 2787, "timestamp": 1557234177, "episode_reward_max": 1360.4690444192815, "episode_len_mean": 683.86, "time_total_s": 4053.6362149715424, "time_since_restore": 4053.6362149715424}
{"timesteps_since_restore": 7204177, "training_iteration": 172, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-03-20", "episode_reward_min": 171.5929063853365, "timesteps_this_iter": 41965, "episode_reward_mean": 1197.0986182109475, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.269381284713745, "policy_reward_mean": {}, "iterations_since_restore": 172, "custom_metrics": {"outflow_rate_max": 1418.339830969031, "cost2_mean": -27.227413036527356, "cost1_mean": 351.51980929385684, "system_level_velocity_mean": 13.859227414384975, "cost2_min": -40.47112010262768, "cost1_max": 421.2893393801882, "cost1_min": 70.43267383746266, "cost2_max": -10.074497134753777, "outflow_rate_mean": 1190.8568235971645, "system_level_velocity_min": 10.706195923748144, "outflow_rate_min": 439.5359604337186, "system_level_velocity_max": 18.30645081053707}, "info": {"num_steps_trained": 7204177, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014787305146455765, "total_loss": 8.619729042053223, "vf_loss": 8.623899459838867, "policy_loss": -0.0066657159477472305, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9709858298301697, "entropy": 1.1097148656845093}, "grad_time_ms": 9408.163, "load_time_ms": 13.606, "update_time_ms": 6.719, "num_steps_sampled": 7204177, "sample_time_ms": 13643.61}, "episodes_this_iter": 10, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6c88>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7204177, "hostname": "flow-main", "episodes_total": 2797, "timestamp": 1557234200, "episode_reward_max": 1360.4690444192815, "episode_len_mean": 689.17, "time_total_s": 4076.905596256256, "time_since_restore": 4076.905596256256}
{"timesteps_since_restore": 7246326, "training_iteration": 173, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-03-42", "episode_reward_min": 171.5929063853365, "timesteps_this_iter": 42149, "episode_reward_mean": 1208.7437225216656, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.11449146270752, "policy_reward_mean": {}, "iterations_since_restore": 173, "custom_metrics": {"outflow_rate_max": 1418.339830969031, "cost2_mean": -26.821303224274576, "cost1_mean": 352.5007143527309, "system_level_velocity_mean": 13.78505176433177, "cost2_min": -40.47112010262768, "cost1_max": 421.2893393801882, "cost1_min": 70.43267383746266, "cost2_max": -10.074497134753777, "outflow_rate_mean": 1192.9443269609806, "system_level_velocity_min": 10.706195923748144, "outflow_rate_min": 439.5359604337186, "system_level_velocity_max": 18.30645081053707}, "info": {"num_steps_trained": 7246326, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014419599436223507, "total_loss": 8.443126678466797, "vf_loss": 8.447993278503418, "policy_loss": -0.007300069555640221, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9759703278541565, "entropy": 1.103052020072937}, "grad_time_ms": 9223.815, "load_time_ms": 13.347, "update_time_ms": 6.887, "num_steps_sampled": 7246326, "sample_time_ms": 13573.604}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb726a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72b38>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7246326, "hostname": "flow-main", "episodes_total": 2813, "timestamp": 1557234222, "episode_reward_max": 1357.0184446849576, "episode_len_mean": 694.05, "time_total_s": 4099.020087718964, "time_since_restore": 4099.020087718964}
{"timesteps_since_restore": 7287989, "training_iteration": 174, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-04-06", "episode_reward_min": 171.5929063853365, "timesteps_this_iter": 41663, "episode_reward_mean": 1209.636731034755, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.165995121002197, "policy_reward_mean": {}, "iterations_since_restore": 174, "custom_metrics": {"outflow_rate_max": 1458.5876487512487, "cost2_mean": -25.611688198481303, "cost1_mean": 356.39611842207677, "system_level_velocity_mean": 13.959967759496125, "cost2_min": -40.47112010262768, "cost1_max": 426.9855256379233, "cost1_min": 70.43267383746266, "cost2_max": -10.074497134753777, "outflow_rate_mean": 1199.3863587052365, "system_level_velocity_min": 10.740961402440764, "outflow_rate_min": 439.5359604337186, "system_level_velocity_max": 18.30645081053707}, "info": {"num_steps_trained": 7287989, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016807112842798233, "total_loss": 13.180387496948242, "vf_loss": 13.184346199035645, "policy_loss": -0.0067949919030070305, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9633499979972839, "entropy": 1.107328176498413}, "grad_time_ms": 9388.67, "load_time_ms": 13.527, "update_time_ms": 6.849, "num_steps_sampled": 7287989, "sample_time_ms": 13439.357}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb723c8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7287989, "hostname": "flow-main", "episodes_total": 2829, "timestamp": 1557234246, "episode_reward_max": 1357.0184446849576, "episode_len_mean": 694.05, "time_total_s": 4122.186082839966, "time_since_restore": 4122.186082839966}
{"timesteps_since_restore": 7328591, "training_iteration": 175, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-04-29", "episode_reward_min": 171.5929063853365, "timesteps_this_iter": 40602, "episode_reward_mean": 1211.7568199909408, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.25519871711731, "policy_reward_mean": {}, "iterations_since_restore": 175, "custom_metrics": {"outflow_rate_max": 1458.5876487512487, "cost2_mean": -24.787213502440327, "cost1_mean": 356.19652845098864, "system_level_velocity_mean": 13.929883923254993, "cost2_min": -35.4330686624006, "cost1_max": 426.9855256379233, "cost1_min": 70.43267383746266, "cost2_max": -10.074497134753777, "outflow_rate_mean": 1200.704888223718, "system_level_velocity_min": 10.740961402440764, "outflow_rate_min": 439.5359604337186, "system_level_velocity_max": 18.30645081053707}, "info": {"num_steps_trained": 7328591, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018734252080321312, "total_loss": 11.376668930053711, "vf_loss": 11.381303787231445, "policy_loss": -0.007795512676239014, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9680081605911255, "entropy": 1.097648024559021}, "grad_time_ms": 9440.136, "load_time_ms": 13.219, "update_time_ms": 6.734, "num_steps_sampled": 7328591, "sample_time_ms": 13346.857}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ea20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e9b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7328591, "hostname": "flow-main", "episodes_total": 2848, "timestamp": 1557234269, "episode_reward_max": 1357.0184446849576, "episode_len_mean": 694.05, "time_total_s": 4145.441281557083, "time_since_restore": 4145.441281557083}
{"timesteps_since_restore": 7369355, "training_iteration": 176, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-04-53", "episode_reward_min": 50.14415481347918, "timesteps_this_iter": 40764, "episode_reward_mean": 1201.6169261325044, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.97864317893982, "policy_reward_mean": {}, "iterations_since_restore": 176, "custom_metrics": {"outflow_rate_max": 1458.5876487512487, "cost2_mean": -23.52404153078498, "cost1_mean": 352.6403746155813, "system_level_velocity_mean": 13.944185979459935, "cost2_min": -34.81427959437824, "cost1_max": 426.9855256379233, "cost1_min": 28.144866318435742, "cost2_max": -8.385592178407995, "outflow_rate_mean": 1189.3621210961473, "system_level_velocity_min": 10.740961402440764, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.95484143233487}, "info": {"num_steps_trained": 7369355, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01909657008945942, "total_loss": 16.670772552490234, "vf_loss": 16.675661087036133, "policy_loss": -0.008111774921417236, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9516271352767944, "entropy": 1.1079661846160889}, "grad_time_ms": 9678.503, "load_time_ms": 13.425, "update_time_ms": 6.676, "num_steps_sampled": 7369355, "sample_time_ms": 13363.533}, "episodes_this_iter": 21, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7369355, "hostname": "flow-main", "episodes_total": 2869, "timestamp": 1557234293, "episode_reward_max": 1382.484606297785, "episode_len_mean": 687.62, "time_total_s": 4169.419924736023, "time_since_restore": 4169.419924736023}
{"timesteps_since_restore": 7410446, "training_iteration": 177, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-05-15", "episode_reward_min": 50.14415481347918, "timesteps_this_iter": 41091, "episode_reward_mean": 1169.5224281334665, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.633107900619507, "policy_reward_mean": {}, "iterations_since_restore": 177, "custom_metrics": {"outflow_rate_max": 1458.5876487512487, "cost2_mean": -22.135286320050962, "cost1_mean": 344.53319789286166, "system_level_velocity_mean": 14.083330751862492, "cost2_min": -34.81427959437824, "cost1_max": 426.9855256379233, "cost1_min": 28.144866318435742, "cost2_max": -4.386461301933998, "outflow_rate_mean": 1169.5499637218456, "system_level_velocity_min": 10.740961402440764, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.95484143233487}, "info": {"num_steps_trained": 7410446, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01894514262676239, "total_loss": 23.24263572692871, "vf_loss": 23.246614456176758, "policy_loss": -0.007174577098339796, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9241296648979187, "entropy": 1.0891343355178833}, "grad_time_ms": 9595.28, "load_time_ms": 13.263, "update_time_ms": 6.603, "num_steps_sampled": 7410446, "sample_time_ms": 13389.145}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ebe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e198>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7410446, "hostname": "flow-main", "episodes_total": 2883, "timestamp": 1557234315, "episode_reward_max": 1382.484606297785, "episode_len_mean": 670.86, "time_total_s": 4191.0530326366425, "time_since_restore": 4191.0530326366425}
{"timesteps_since_restore": 7451323, "training_iteration": 178, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-05-37", "episode_reward_min": 50.14415481347918, "timesteps_this_iter": 40877, "episode_reward_mean": 1165.2079735358661, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.083040952682495, "policy_reward_mean": {}, "iterations_since_restore": 178, "custom_metrics": {"outflow_rate_max": 1458.5876487512487, "cost2_mean": -21.04592162692613, "cost1_mean": 343.7957925823037, "system_level_velocity_mean": 14.045647820527213, "cost2_min": -32.96754188618665, "cost1_max": 426.9855256379233, "cost1_min": 28.144866318435742, "cost2_max": -4.386461301933998, "outflow_rate_mean": 1166.0492328647028, "system_level_velocity_min": 10.718841777875761, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.95484143233487}, "info": {"num_steps_trained": 7451323, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01877719908952713, "total_loss": 12.224846839904785, "vf_loss": 12.230154991149902, "policy_loss": -0.008477363735437393, "cur_kl_coeff": 0.16875000298023224, "vf_explained_var": 0.9599130749702454, "entropy": 1.0902198553085327}, "grad_time_ms": 9552.13, "load_time_ms": 13.294, "update_time_ms": 6.605, "num_steps_sampled": 7451323, "sample_time_ms": 13424.637}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb722b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72eb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7451323, "hostname": "flow-main", "episodes_total": 2899, "timestamp": 1557234337, "episode_reward_max": 1382.484606297785, "episode_len_mean": 670.86, "time_total_s": 4213.136073589325, "time_since_restore": 4213.136073589325}
{"timesteps_since_restore": 7492518, "training_iteration": 179, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-05-58", "episode_reward_min": 50.14415481347918, "timesteps_this_iter": 41195, "episode_reward_mean": 1160.7413635104303, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.43625044822693, "policy_reward_mean": {}, "iterations_since_restore": 179, "custom_metrics": {"outflow_rate_max": 1458.5876487512487, "cost2_mean": -19.957760604440917, "cost1_mean": 343.70335231679775, "system_level_velocity_mean": 14.04636656889169, "cost2_min": -31.08189217524764, "cost1_max": 426.9855256379233, "cost1_min": 28.144866318435742, "cost2_max": -4.386461301933998, "outflow_rate_mean": 1167.660667985582, "system_level_velocity_min": 10.718841777875761, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.95484143233487}, "info": {"num_steps_trained": 7492518, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018607502803206444, "total_loss": 17.591049194335938, "vf_loss": 17.595706939697266, "policy_loss": -0.007799228187650442, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9318467378616333, "entropy": 1.104445457458496}, "grad_time_ms": 9352.329, "load_time_ms": 13.33, "update_time_ms": 6.592, "num_steps_sampled": 7492518, "sample_time_ms": 13365.495}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72dd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7492518, "hostname": "flow-main", "episodes_total": 2916, "timestamp": 1557234358, "episode_reward_max": 1382.484606297785, "episode_len_mean": 670.86, "time_total_s": 4234.572324037552, "time_since_restore": 4234.572324037552}
{"timesteps_since_restore": 7531605, "training_iteration": 180, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-06-22", "episode_reward_min": 50.14415481347918, "timesteps_this_iter": 39087, "episode_reward_mean": 1124.3866369449072, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.690120220184326, "policy_reward_mean": {}, "iterations_since_restore": 180, "custom_metrics": {"outflow_rate_max": 1404.4208999000998, "cost2_mean": -18.159666984681966, "cost1_mean": 332.1366713781588, "system_level_velocity_mean": 14.029014565497091, "cost2_min": -31.08189217524764, "cost1_max": 408.0719412313824, "cost1_min": 28.144866318435742, "cost2_max": -4.386461301933998, "outflow_rate_mean": 1143.0404557752167, "system_level_velocity_min": 10.66483153313053, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.95484143233487}, "info": {"num_steps_trained": 7531605, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01934860646724701, "total_loss": 19.52763557434082, "vf_loss": 19.532583236694336, "policy_loss": -0.008215177804231644, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.95662921667099, "entropy": 1.1004778146743774}, "grad_time_ms": 9326.412, "load_time_ms": 13.285, "update_time_ms": 6.572, "num_steps_sampled": 7531605, "sample_time_ms": 13407.029}, "episodes_this_iter": 21, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6860>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7531605, "hostname": "flow-main", "episodes_total": 2937, "timestamp": 1557234382, "episode_reward_max": 1382.484606297785, "episode_len_mean": 654.05, "time_total_s": 4258.262444257736, "time_since_restore": 4258.262444257736}
{"timesteps_since_restore": 7571549, "training_iteration": 181, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-06-47", "episode_reward_min": 52.54899121148671, "timesteps_this_iter": 39944, "episode_reward_mean": 1098.7538424158215, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.802799701690674, "policy_reward_mean": {}, "iterations_since_restore": 181, "custom_metrics": {"outflow_rate_max": 1404.4208999000998, "cost2_mean": -17.773039706931453, "cost1_mean": 333.2645538016331, "system_level_velocity_mean": 14.363048972327329, "cost2_min": -35.14559946655656, "cost1_max": 408.0719412313824, "cost1_min": 28.344119461223634, "cost2_max": -4.386461301933998, "outflow_rate_mean": 1150.3049288958878, "system_level_velocity_min": 10.66483153313053, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.329271329231226}, "info": {"num_steps_trained": 7571549, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017792273312807083, "total_loss": 21.45381736755371, "vf_loss": 21.459535598754883, "policy_loss": -0.008720559999346733, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9262763857841492, "entropy": 1.126301646232605}, "grad_time_ms": 9437.141, "load_time_ms": 13.182, "update_time_ms": 6.678, "num_steps_sampled": 7571549, "sample_time_ms": 13412.045}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ecc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb698d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ea90>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7571549, "hostname": "flow-main", "episodes_total": 2957, "timestamp": 1557234407, "episode_reward_max": 1382.484606297785, "episode_len_mean": 645.19, "time_total_s": 4283.065243959427, "time_since_restore": 4283.065243959427}
{"timesteps_since_restore": 7612990, "training_iteration": 182, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-07-10", "episode_reward_min": 52.54899121148671, "timesteps_this_iter": 41441, "episode_reward_mean": 1086.4472139819736, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.08864688873291, "policy_reward_mean": {}, "iterations_since_restore": 182, "custom_metrics": {"outflow_rate_max": 1404.4208999000998, "cost2_mean": -17.61717654909443, "cost1_mean": 330.04178441878355, "system_level_velocity_mean": 14.3347950980767, "cost2_min": -38.14622237307006, "cost1_max": 408.0719412313824, "cost1_min": 27.20576639895986, "cost2_max": -4.386461301933998, "outflow_rate_mean": 1141.5125996607424, "system_level_velocity_min": 10.66483153313053, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.36293495081895}, "info": {"num_steps_trained": 7612990, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01956120878458023, "total_loss": 16.56584930419922, "vf_loss": 16.57228660583496, "policy_loss": -0.00973755307495594, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9486020803451538, "entropy": 1.105368971824646}, "grad_time_ms": 9435.256, "load_time_ms": 13.116, "update_time_ms": 6.669, "num_steps_sampled": 7612990, "sample_time_ms": 13397.262}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72dd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7612990, "hostname": "flow-main", "episodes_total": 2973, "timestamp": 1557234430, "episode_reward_max": 1346.7293867483568, "episode_len_mean": 642.71, "time_total_s": 4306.15389084816, "time_since_restore": 4306.15389084816}
{"timesteps_since_restore": 7653460, "training_iteration": 183, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-07-32", "episode_reward_min": 51.728661626104724, "timesteps_this_iter": 40470, "episode_reward_mean": 1091.5046560608318, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.721404790878296, "policy_reward_mean": {}, "iterations_since_restore": 183, "custom_metrics": {"outflow_rate_max": 1404.4208999000998, "cost2_mean": -17.40298756554843, "cost1_mean": 328.27329645800563, "system_level_velocity_mean": 14.259934282631987, "cost2_min": -38.14622237307006, "cost1_max": 408.0719412313824, "cost1_min": 27.20576639895986, "cost2_max": -5.210209160956218, "outflow_rate_mean": 1138.5364618705635, "system_level_velocity_min": 10.66483153313053, "outflow_rate_min": 329.8655169108091, "system_level_velocity_max": 18.417769919472885}, "info": {"num_steps_trained": 7653460, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018811412155628204, "total_loss": 19.262502670288086, "vf_loss": 19.267757415771484, "policy_loss": -0.008430789224803448, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9340016841888428, "entropy": 1.12234628200531}, "grad_time_ms": 9375.824, "load_time_ms": 13.012, "update_time_ms": 6.456, "num_steps_sampled": 7653460, "sample_time_ms": 13418.516}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6eeb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7653460, "hostname": "flow-main", "episodes_total": 2991, "timestamp": 1557234452, "episode_reward_max": 1389.6391446355276, "episode_len_mean": 642.29, "time_total_s": 4327.875295639038, "time_since_restore": 4327.875295639038}
{"timesteps_since_restore": 7694399, "training_iteration": 184, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-07-55", "episode_reward_min": 51.728661626104724, "timesteps_this_iter": 40939, "episode_reward_mean": 1090.014424462692, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.234835863113403, "policy_reward_mean": {}, "iterations_since_restore": 184, "custom_metrics": {"outflow_rate_max": 1404.4208999000998, "cost2_mean": -17.34875562996777, "cost1_mean": 326.3805791914678, "system_level_velocity_mean": 14.184123045661975, "cost2_min": -38.14622237307006, "cost1_max": 413.3264029779118, "cost1_min": 27.20576639895986, "cost2_max": -5.210209160956218, "outflow_rate_mean": 1135.9043479005334, "system_level_velocity_min": 10.66483153313053, "outflow_rate_min": 329.8655169108091, "system_level_velocity_max": 18.417769919472885}, "info": {"num_steps_trained": 7694399, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.019151290878653526, "total_loss": 15.088196754455566, "vf_loss": 15.092700004577637, "policy_loss": -0.007735856808722019, "cur_kl_coeff": 0.16875000298023224, "vf_explained_var": 0.9504647254943848, "entropy": 1.1292494535446167}, "grad_time_ms": 9353.437, "load_time_ms": 12.855, "update_time_ms": 6.356, "num_steps_sampled": 7694399, "sample_time_ms": 13448.79}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb691d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7694399, "hostname": "flow-main", "episodes_total": 3007, "timestamp": 1557234475, "episode_reward_max": 1389.6391446355276, "episode_len_mean": 642.29, "time_total_s": 4351.1101315021515, "time_since_restore": 4351.1101315021515}
{"timesteps_since_restore": 7734881, "training_iteration": 185, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-08-17", "episode_reward_min": 51.728661626104724, "timesteps_this_iter": 40482, "episode_reward_mean": 1078.6077050222077, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.90340805053711, "policy_reward_mean": {}, "iterations_since_restore": 185, "custom_metrics": {"outflow_rate_max": 1386.0710073926073, "cost2_mean": -17.581754440274985, "cost1_mean": 323.11055783544396, "system_level_velocity_mean": 14.222492689063829, "cost2_min": -38.14622237307006, "cost1_max": 413.3264029779118, "cost1_min": 27.20576639895986, "cost2_max": -5.210209160956218, "outflow_rate_mean": 1124.6915298524495, "system_level_velocity_min": 10.66483153313053, "outflow_rate_min": 329.8655169108091, "system_level_velocity_max": 18.417769919472885}, "info": {"num_steps_trained": 7734881, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017723048105835915, "total_loss": 15.099170684814453, "vf_loss": 15.10619831085205, "policy_loss": -0.01001792773604393, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9521478414535522, "entropy": 1.119563102722168}, "grad_time_ms": 9174.026, "load_time_ms": 12.973, "update_time_ms": 6.33, "num_steps_sampled": 7734881, "sample_time_ms": 13492.389}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72cf8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7734881, "hostname": "flow-main", "episodes_total": 3026, "timestamp": 1557234497, "episode_reward_max": 1389.6391446355276, "episode_len_mean": 635.72, "time_total_s": 4373.013539552689, "time_since_restore": 4373.013539552689}
{"timesteps_since_restore": 7775338, "training_iteration": 186, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-08-40", "episode_reward_min": 51.728661626104724, "timesteps_this_iter": 40457, "episode_reward_mean": 1092.1271500797943, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.68260097503662, "policy_reward_mean": {}, "iterations_since_restore": 186, "custom_metrics": {"outflow_rate_max": 1444.4332903096904, "cost2_mean": -17.860015999867485, "cost1_mean": 329.5908000722462, "system_level_velocity_mean": 14.289240466629632, "cost2_min": -38.14622237307006, "cost1_max": 422.3853365486042, "cost1_min": 27.20576639895986, "cost2_max": -5.210209160956218, "outflow_rate_mean": 1140.308010954151, "system_level_velocity_min": 11.102006606440536, "outflow_rate_min": 329.8655169108091, "system_level_velocity_max": 18.417769919472885}, "info": {"num_steps_trained": 7775338, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018549632281064987, "total_loss": 20.611370086669922, "vf_loss": 20.616928100585938, "policy_loss": -0.008688999339938164, "cur_kl_coeff": 0.16875001788139343, "vf_explained_var": 0.9421883225440979, "entropy": 1.1288307905197144}, "grad_time_ms": 9186.21, "load_time_ms": 12.525, "update_time_ms": 6.306, "num_steps_sampled": 7775338, "sample_time_ms": 13451.548}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fe48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116feb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f9e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7775338, "hostname": "flow-main", "episodes_total": 3045, "timestamp": 1557234520, "episode_reward_max": 1389.6391446355276, "episode_len_mean": 643.73, "time_total_s": 4396.696140527725, "time_since_restore": 4396.696140527725}
{"timesteps_since_restore": 7815956, "training_iteration": 187, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-09-04", "episode_reward_min": 51.728661626104724, "timesteps_this_iter": 40618, "episode_reward_mean": 1116.2641787434907, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.12451958656311, "policy_reward_mean": {}, "iterations_since_restore": 187, "custom_metrics": {"outflow_rate_max": 1444.4332903096904, "cost2_mean": -18.73203422273924, "cost1_mean": 332.93970489859856, "system_level_velocity_mean": 14.126261894877116, "cost2_min": -38.14622237307006, "cost1_max": 422.3853365486042, "cost1_min": 27.20576639895986, "cost2_max": -5.210209160956218, "outflow_rate_mean": 1148.498705302348, "system_level_velocity_min": 11.102006606440536, "outflow_rate_min": 329.8655169108091, "system_level_velocity_max": 18.417769919472885}, "info": {"num_steps_trained": 7815956, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01797599159181118, "total_loss": 11.304228782653809, "vf_loss": 11.30849552154541, "policy_loss": -0.007301022298634052, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9635383486747742, "entropy": 1.1281155347824097}, "grad_time_ms": 9378.868, "load_time_ms": 12.695, "update_time_ms": 6.309, "num_steps_sampled": 7815956, "sample_time_ms": 13407.434}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72e80>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7815956, "hostname": "flow-main", "episodes_total": 3060, "timestamp": 1557234544, "episode_reward_max": 1389.6391446355276, "episode_len_mean": 654.29, "time_total_s": 4419.820660114288, "time_since_restore": 4419.820660114288}
{"timesteps_since_restore": 7856806, "training_iteration": 188, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-09-26", "episode_reward_min": 55.408501842929184, "timesteps_this_iter": 40850, "episode_reward_mean": 1133.109699063707, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.102120876312256, "policy_reward_mean": {}, "iterations_since_restore": 188, "custom_metrics": {"outflow_rate_max": 1444.4332903096904, "cost2_mean": -19.045696613530925, "cost1_mean": 339.2553284281396, "system_level_velocity_mean": 14.117410819990399, "cost2_min": -30.23909248852669, "cost1_max": 422.3853365486042, "cost1_min": 28.252406179703218, "cost2_max": -6.512419839614239, "outflow_rate_mean": 1166.0473413468583, "system_level_velocity_min": 11.219072972507162, "outflow_rate_min": 333.67054062656626, "system_level_velocity_max": 18.15057992522264}, "info": {"num_steps_trained": 7856806, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016616718843579292, "total_loss": 20.812246322631836, "vf_loss": 20.81593132019043, "policy_loss": -0.006488587241619825, "cur_kl_coeff": 0.16875000298023224, "vf_explained_var": 0.923256516456604, "entropy": 1.1159608364105225}, "grad_time_ms": 9559.983, "load_time_ms": 12.921, "update_time_ms": 6.35, "num_steps_sampled": 7856806, "sample_time_ms": 13227.02}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb724a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7856806, "hostname": "flow-main", "episodes_total": 3077, "timestamp": 1557234566, "episode_reward_max": 1389.6391446355276, "episode_len_mean": 664.77, "time_total_s": 4441.922780990601, "time_since_restore": 4441.922780990601}
{"timesteps_since_restore": 7897406, "training_iteration": 189, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-09-49", "episode_reward_min": 55.408501842929184, "timesteps_this_iter": 40600, "episode_reward_mean": 1122.6885433758118, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.076263189315796, "policy_reward_mean": {}, "iterations_since_restore": 189, "custom_metrics": {"outflow_rate_max": 1444.4332903096904, "cost2_mean": -19.21580616671973, "cost1_mean": 338.0862764126487, "system_level_velocity_mean": 14.201972574965772, "cost2_min": -30.23909248852669, "cost1_max": 422.3853365486042, "cost1_min": 28.252406179703218, "cost2_max": -6.512419839614239, "outflow_rate_mean": 1160.9877050755047, "system_level_velocity_min": 11.219072972507162, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.191506920809147}, "info": {"num_steps_trained": 7897406, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.020972928032279015, "total_loss": 12.386408805847168, "vf_loss": 12.393640518188477, "policy_loss": -0.010771061293780804, "cur_kl_coeff": 0.16875003278255463, "vf_explained_var": 0.9594271183013916, "entropy": 1.1115386486053467}, "grad_time_ms": 9751.912, "load_time_ms": 12.867, "update_time_ms": 6.606, "num_steps_sampled": 7897406, "sample_time_ms": 13198.692}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ebe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ed68>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7897406, "hostname": "flow-main", "episodes_total": 3095, "timestamp": 1557234589, "episode_reward_max": 1342.190963463659, "episode_len_mean": 660.23, "time_total_s": 4464.999044179916, "time_since_restore": 4464.999044179916}
{"timesteps_since_restore": 7938123, "training_iteration": 190, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-10-12", "episode_reward_min": 55.408501842929184, "timesteps_this_iter": 40717, "episode_reward_mean": 1129.9739575564556, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.488229513168335, "policy_reward_mean": {}, "iterations_since_restore": 190, "custom_metrics": {"outflow_rate_max": 1444.4332903096904, "cost2_mean": -19.45852209095109, "cost1_mean": 339.6154255626423, "system_level_velocity_mean": 14.25603726232731, "cost2_min": -30.23909248852669, "cost1_max": 422.3853365486042, "cost1_min": 28.252406179703218, "cost2_max": -6.512419839614239, "outflow_rate_mean": 1161.7063320731124, "system_level_velocity_min": 11.880659041290174, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.191506920809147}, "info": {"num_steps_trained": 7938123, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013071762397885323, "total_loss": 13.816192626953125, "vf_loss": 13.820337295532227, "policy_loss": -0.0074535240419209, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9529289603233337, "entropy": 1.1038206815719604}, "grad_time_ms": 9856.346, "load_time_ms": 13.003, "update_time_ms": 6.793, "num_steps_sampled": 7938123, "sample_time_ms": 13072.064}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72e80>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7938123, "hostname": "flow-main", "episodes_total": 3113, "timestamp": 1557234612, "episode_reward_max": 1353.6399213651327, "episode_len_mean": 660.24, "time_total_s": 4488.487273693085, "time_since_restore": 4488.487273693085}
{"timesteps_since_restore": 7978640, "training_iteration": 191, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-10-34", "episode_reward_min": 59.952348900320374, "timesteps_this_iter": 40517, "episode_reward_mean": 1134.889473075821, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.981795072555542, "policy_reward_mean": {}, "iterations_since_restore": 191, "custom_metrics": {"outflow_rate_max": 1444.4332903096904, "cost2_mean": -19.779787626586423, "cost1_mean": 341.6244573082293, "system_level_velocity_mean": 14.296041800010842, "cost2_min": -28.979334327951587, "cost1_max": 422.3853365486042, "cost1_min": 32.63111649066603, "cost2_max": -6.684584419017207, "outflow_rate_mean": 1167.3600426938242, "system_level_velocity_min": 11.899958059584748, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.191506920809147}, "info": {"num_steps_trained": 7978640, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01656341925263405, "total_loss": 14.19958782196045, "vf_loss": 14.20246410369873, "policy_loss": -0.0070682717487216, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9543370008468628, "entropy": 1.0934607982635498}, "grad_time_ms": 9752.607, "load_time_ms": 13.093, "update_time_ms": 6.672, "num_steps_sampled": 7978640, "sample_time_ms": 12892.605}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb724a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 7978640, "hostname": "flow-main", "episodes_total": 3129, "timestamp": 1557234634, "episode_reward_max": 1353.6399213651327, "episode_len_mean": 661.37, "time_total_s": 4510.46906876564, "time_since_restore": 4510.46906876564}
{"timesteps_since_restore": 8019369, "training_iteration": 192, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-10-57", "episode_reward_min": 59.952348900320374, "timesteps_this_iter": 40729, "episode_reward_mean": 1155.4666219313394, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.865880489349365, "policy_reward_mean": {}, "iterations_since_restore": 192, "custom_metrics": {"outflow_rate_max": 1416.760332067932, "cost2_mean": -20.460883171229817, "cost1_mean": 343.9569860773982, "system_level_velocity_mean": 14.172673536567586, "cost2_min": -30.51434397828983, "cost1_max": 421.7385819139655, "cost1_min": 32.63111649066603, "cost2_max": -6.684584419017207, "outflow_rate_mean": 1170.4445781135128, "system_level_velocity_min": 11.899958059584748, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.191506920809147}, "info": {"num_steps_trained": 8019369, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013497008010745049, "total_loss": 11.72667407989502, "vf_loss": 11.729780197143555, "policy_loss": -0.006523152347654104, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9635077118873596, "entropy": 1.0875394344329834}, "grad_time_ms": 9752.036, "load_time_ms": 13.136, "update_time_ms": 6.864, "num_steps_sampled": 8019369, "sample_time_ms": 12869.952}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9461150d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69ba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8019369, "hostname": "flow-main", "episodes_total": 3147, "timestamp": 1557234657, "episode_reward_max": 1353.6399213651327, "episode_len_mean": 668.54, "time_total_s": 4533.33494925499, "time_since_restore": 4533.33494925499}
{"timesteps_since_restore": 8060746, "training_iteration": 193, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-11-21", "episode_reward_min": 59.952348900320374, "timesteps_this_iter": 41377, "episode_reward_mean": 1153.8783617581817, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.323476791381836, "policy_reward_mean": {}, "iterations_since_restore": 193, "custom_metrics": {"outflow_rate_max": 1463.6342405594405, "cost2_mean": -20.83100375701638, "cost1_mean": 344.21670542693414, "system_level_velocity_mean": 14.190150398953024, "cost2_min": -33.11036100327179, "cost1_max": 421.7385819139655, "cost1_min": 32.63111649066603, "cost2_max": -6.684584419017207, "outflow_rate_mean": 1169.0627609187075, "system_level_velocity_min": 11.626997801787564, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.191506920809147}, "info": {"num_steps_trained": 8060746, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01259532105177641, "total_loss": 10.32661247253418, "vf_loss": 10.330790519714355, "policy_loss": -0.007366227451711893, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9679163098335266, "entropy": 1.0772373676300049}, "grad_time_ms": 9984.05, "load_time_ms": 13.368, "update_time_ms": 7.004, "num_steps_sampled": 8060746, "sample_time_ms": 12796.791}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69630>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8060746, "hostname": "flow-main", "episodes_total": 3162, "timestamp": 1557234681, "episode_reward_max": 1353.6399213651327, "episode_len_mean": 668.54, "time_total_s": 4556.6584260463715, "time_since_restore": 4556.6584260463715}
{"timesteps_since_restore": 8102290, "training_iteration": 194, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-11-44", "episode_reward_min": 59.952348900320374, "timesteps_this_iter": 41544, "episode_reward_mean": 1171.0584775361467, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.944288730621338, "policy_reward_mean": {}, "iterations_since_restore": 194, "custom_metrics": {"outflow_rate_max": 1463.6342405594405, "cost2_mean": -21.757089347680427, "cost1_mean": 347.01428250683244, "system_level_velocity_mean": 14.044896309174332, "cost2_min": -47.340283347839915, "cost1_max": 421.7385819139655, "cost1_min": 32.63111649066603, "cost2_max": -6.684584419017207, "outflow_rate_mean": 1174.2801068025917, "system_level_velocity_min": 11.626997801787564, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.191506920809147}, "info": {"num_steps_trained": 8102290, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014131812378764153, "total_loss": 9.182611465454102, "vf_loss": 9.18491268157959, "policy_loss": -0.005878058262169361, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9680109620094299, "entropy": 1.0918368101119995}, "grad_time_ms": 10045.38, "load_time_ms": 13.511, "update_time_ms": 7.143, "num_steps_sampled": 8102290, "sample_time_ms": 12705.426}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8102290, "hostname": "flow-main", "episodes_total": 3178, "timestamp": 1557234704, "episode_reward_max": 1353.6399213651327, "episode_len_mean": 677.69, "time_total_s": 4579.602714776993, "time_since_restore": 4579.602714776993}
{"timesteps_since_restore": 8142561, "training_iteration": 195, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-12-06", "episode_reward_min": 59.952348900320374, "timesteps_this_iter": 40271, "episode_reward_mean": 1181.450553260013, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.676481246948242, "policy_reward_mean": {}, "iterations_since_restore": 195, "custom_metrics": {"outflow_rate_max": 1463.6342405594405, "cost2_mean": -22.417981349363764, "cost1_mean": 351.07678435652434, "system_level_velocity_mean": 14.056416337503393, "cost2_min": -47.340283347839915, "cost1_max": 421.7385819139655, "cost1_min": 32.63111649066603, "cost2_max": -7.051769077164104, "outflow_rate_mean": 1186.5554048990584, "system_level_velocity_min": 11.20583175244545, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.133665505792965}, "info": {"num_steps_trained": 8142561, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014028096571564674, "total_loss": 12.824511528015137, "vf_loss": 12.829326629638672, "policy_loss": -0.008366219699382782, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9577399492263794, "entropy": 1.1175068616867065}, "grad_time_ms": 10236.279, "load_time_ms": 13.686, "update_time_ms": 7.243, "num_steps_sampled": 8142561, "sample_time_ms": 12591.082}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e4e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8142561, "hostname": "flow-main", "episodes_total": 3194, "timestamp": 1557234726, "episode_reward_max": 1353.6399213651327, "episode_len_mean": 683.06, "time_total_s": 4602.279196023941, "time_since_restore": 4602.279196023941}
{"timesteps_since_restore": 8182680, "training_iteration": 196, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-12-29", "episode_reward_min": 247.8015080455314, "timesteps_this_iter": 40119, "episode_reward_mean": 1182.8799904906202, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.236028909683228, "policy_reward_mean": {}, "iterations_since_restore": 196, "custom_metrics": {"outflow_rate_max": 1463.6342405594405, "cost2_mean": -22.79894414474095, "cost1_mean": 351.70215863849495, "system_level_velocity_mean": 14.008452360557236, "cost2_min": -47.340283347839915, "cost1_max": 421.7385819139655, "cost1_min": 101.63652529830955, "cost2_max": -8.927953876375206, "outflow_rate_mean": 1191.7971871061513, "system_level_velocity_min": 11.20583175244545, "outflow_rate_min": 557.8654512454806, "system_level_velocity_max": 17.808798418192577}, "info": {"num_steps_trained": 8182680, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012636806815862656, "total_loss": 13.239439010620117, "vf_loss": 13.242460250854492, "policy_loss": -0.00621926411986351, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9513506889343262, "entropy": 1.1078206300735474}, "grad_time_ms": 10249.415, "load_time_ms": 14.243, "update_time_ms": 7.503, "num_steps_sampled": 8182680, "sample_time_ms": 12432.042}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69630>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8182680, "hostname": "flow-main", "episodes_total": 3211, "timestamp": 1557234749, "episode_reward_max": 1353.7657395612382, "episode_len_mean": 685.4, "time_total_s": 4624.515224933624, "time_since_restore": 4624.515224933624}
{"timesteps_since_restore": 8223138, "training_iteration": 197, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-12-51", "episode_reward_min": 56.30902857084487, "timesteps_this_iter": 40458, "episode_reward_mean": 1185.0018814377986, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.879844427108765, "policy_reward_mean": {}, "iterations_since_restore": 197, "custom_metrics": {"outflow_rate_max": 1463.6342405594405, "cost2_mean": -22.2791235909159, "cost1_mean": 349.19480140478566, "system_level_velocity_mean": 13.94309267930319, "cost2_min": -47.340283347839915, "cost1_max": 421.7385819139655, "cost1_min": 32.165895916233424, "cost2_max": -7.8181691148463806, "outflow_rate_mean": 1187.4090218207464, "system_level_velocity_min": 11.20583175244545, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 17.63003078755836}, "info": {"num_steps_trained": 8223138, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016218502074480057, "total_loss": 18.403614044189453, "vf_loss": 18.408363342285156, "policy_loss": -0.008854160085320473, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9344057440757751, "entropy": 1.1068964004516602}, "grad_time_ms": 10292.022, "load_time_ms": 14.197, "update_time_ms": 7.594, "num_steps_sampled": 8223138, "sample_time_ms": 12364.423}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb790f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79d30>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8223138, "hostname": "flow-main", "episodes_total": 3231, "timestamp": 1557234771, "episode_reward_max": 1353.7657395612382, "episode_len_mean": 684.33, "time_total_s": 4647.395069360733, "time_since_restore": 4647.395069360733}
{"timesteps_since_restore": 8263982, "training_iteration": 198, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-13-16", "episode_reward_min": 56.30902857084487, "timesteps_this_iter": 40844, "episode_reward_mean": 1185.1487366565725, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.076330423355103, "policy_reward_mean": {}, "iterations_since_restore": 198, "custom_metrics": {"outflow_rate_max": 1463.6342405594405, "cost2_mean": -22.11361506267317, "cost1_mean": 346.6861765721114, "system_level_velocity_mean": 13.84542541774356, "cost2_min": -47.340283347839915, "cost1_max": 420.56456902184016, "cost1_min": 32.165895916233424, "cost2_max": -7.8181691148463806, "outflow_rate_mean": 1180.609356090477, "system_level_velocity_min": 11.20583175244545, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 17.63003078755836}, "info": {"num_steps_trained": 8263982, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014493915252387524, "total_loss": 7.620810508728027, "vf_loss": 7.624704360961914, "policy_loss": -0.007562767248600721, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9721983075141907, "entropy": 1.1004709005355835}, "grad_time_ms": 10329.405, "load_time_ms": 14.113, "update_time_ms": 7.629, "num_steps_sampled": 8263982, "sample_time_ms": 12524.19}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79128>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8263982, "hostname": "flow-main", "episodes_total": 3246, "timestamp": 1557234796, "episode_reward_max": 1356.8732728846032, "episode_len_mean": 684.33, "time_total_s": 4671.471399784088, "time_since_restore": 4671.471399784088}
{"timesteps_since_restore": 8306007, "training_iteration": 199, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-13-40", "episode_reward_min": 56.30902857084487, "timesteps_this_iter": 42025, "episode_reward_mean": 1180.2552191543862, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.025660276412964, "policy_reward_mean": {}, "iterations_since_restore": 199, "custom_metrics": {"outflow_rate_max": 1402.4344471528473, "cost2_mean": -21.757581820374856, "cost1_mean": 346.3572100560386, "system_level_velocity_mean": 13.83704311788061, "cost2_min": -47.340283347839915, "cost1_max": 408.9658355275188, "cost1_min": 32.165895916233424, "cost2_max": -7.8181691148463806, "outflow_rate_mean": 1181.283469588978, "system_level_velocity_min": 10.256644456776193, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 17.63003078755836}, "info": {"num_steps_trained": 8306007, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013903094455599785, "total_loss": 9.40869140625, "vf_loss": 9.413057327270508, "policy_loss": -0.007884453982114792, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9697507619857788, "entropy": 1.1072338819503784}, "grad_time_ms": 10346.009, "load_time_ms": 14.513, "update_time_ms": 7.515, "num_steps_sampled": 8306007, "sample_time_ms": 12601.262}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72550>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8306007, "hostname": "flow-main", "episodes_total": 3262, "timestamp": 1557234820, "episode_reward_max": 1356.8732728846032, "episode_len_mean": 684.33, "time_total_s": 4695.497060060501, "time_since_restore": 4695.497060060501}
{"timesteps_since_restore": 8347056, "training_iteration": 200, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-14-02", "episode_reward_min": 56.30902857084487, "timesteps_this_iter": 41049, "episode_reward_mean": 1172.581019741672, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.242330312728882, "policy_reward_mean": {}, "iterations_since_restore": 200, "custom_metrics": {"outflow_rate_max": 1402.4344471528473, "cost2_mean": -21.185974984680048, "cost1_mean": 345.0547478683317, "system_level_velocity_mean": 13.910517828121133, "cost2_min": -39.01351674454118, "cost1_max": 425.8614784130782, "cost1_min": 32.165895916233424, "cost2_max": -7.517880381937811, "outflow_rate_mean": 1177.873607692483, "system_level_velocity_min": 10.256644456776193, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 17.63003078755836}, "info": {"num_steps_trained": 8347056, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01444688718765974, "total_loss": 14.102457046508789, "vf_loss": 14.107081413269043, "policy_loss": -0.008282093331217766, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9486457705497742, "entropy": 1.1108020544052124}, "grad_time_ms": 10120.976, "load_time_ms": 14.475, "update_time_ms": 7.468, "num_steps_sampled": 8347056, "sample_time_ms": 12702.666}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb794a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79ef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8347056, "hostname": "flow-main", "episodes_total": 3276, "timestamp": 1557234842, "episode_reward_max": 1356.8732728846032, "episode_len_mean": 678.61, "time_total_s": 4717.73939037323, "time_since_restore": 4717.73939037323}
{"timesteps_since_restore": 8387933, "training_iteration": 201, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-14-24", "episode_reward_min": 54.331353118299816, "timesteps_this_iter": 40877, "episode_reward_mean": 1166.3929724505092, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.604307889938354, "policy_reward_mean": {}, "iterations_since_restore": 201, "custom_metrics": {"outflow_rate_max": 1402.4344471528473, "cost2_mean": -20.906855666808397, "cost1_mean": 344.0354423868619, "system_level_velocity_mean": 13.96550916459329, "cost2_min": -39.01351674454118, "cost1_max": 425.8614784130782, "cost1_min": 29.450188171622056, "cost2_max": -5.8606250607031, "outflow_rate_mean": 1170.669153305869, "system_level_velocity_min": 10.256644456776193, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 17.653196754477364}, "info": {"num_steps_trained": 8387933, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013742399401962757, "total_loss": 16.078893661499023, "vf_loss": 16.08331871032715, "policy_loss": -0.007903551682829857, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9458991289138794, "entropy": 1.1405926942825317}, "grad_time_ms": 9967.074, "load_time_ms": 14.363, "update_time_ms": 7.365, "num_steps_sampled": 8387933, "sample_time_ms": 12820.221}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb728d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8387933, "hostname": "flow-main", "episodes_total": 3296, "timestamp": 1557234864, "episode_reward_max": 1375.5390248634747, "episode_len_mean": 675.36, "time_total_s": 4739.343698263168, "time_since_restore": 4739.343698263168}
{"timesteps_since_restore": 8427921, "training_iteration": 202, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-14-46", "episode_reward_min": 54.331353118299816, "timesteps_this_iter": 39988, "episode_reward_mean": 1166.2551608929225, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.12349033355713, "policy_reward_mean": {}, "iterations_since_restore": 202, "custom_metrics": {"outflow_rate_max": 1397.758445954046, "cost2_mean": -21.14057451685538, "cost1_mean": 343.04682340958396, "system_level_velocity_mean": 13.911602991011403, "cost2_min": -39.01351674454118, "cost1_max": 425.8614784130782, "cost1_min": 29.450188171622056, "cost2_max": -5.8606250607031, "outflow_rate_mean": 1168.0889903408342, "system_level_velocity_min": 10.256644456776193, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 17.653196754477364}, "info": {"num_steps_trained": 8427921, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013661433942615986, "total_loss": 12.448951721191406, "vf_loss": 12.45362377166748, "policy_loss": -0.008129908703267574, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9614576697349548, "entropy": 1.1331239938735962}, "grad_time_ms": 9951.12, "load_time_ms": 14.122, "update_time_ms": 7.123, "num_steps_sampled": 8427921, "sample_time_ms": 12762.665}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8427921, "hostname": "flow-main", "episodes_total": 3314, "timestamp": 1557234886, "episode_reward_max": 1375.5390248634747, "episode_len_mean": 675.36, "time_total_s": 4761.4671885967255, "time_since_restore": 4761.4671885967255}
{"timesteps_since_restore": 8467420, "training_iteration": 203, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-15-08", "episode_reward_min": 54.331353118299816, "timesteps_this_iter": 39499, "episode_reward_mean": 1167.8764764949076, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.628785610198975, "policy_reward_mean": {}, "iterations_since_restore": 203, "custom_metrics": {"outflow_rate_max": 1397.758445954046, "cost2_mean": -21.450156216039254, "cost1_mean": 346.7040335848424, "system_level_velocity_mean": 13.960182621971189, "cost2_min": -39.01351674454118, "cost1_max": 425.8614784130782, "cost1_min": 29.450188171622056, "cost2_max": -5.8606250607031, "outflow_rate_mean": 1179.3099369828278, "system_level_velocity_min": 10.256644456776193, "outflow_rate_min": 335.6139678872712, "system_level_velocity_max": 17.653196754477364}, "info": {"num_steps_trained": 8467420, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015813859179615974, "total_loss": 18.07547378540039, "vf_loss": 18.07935333251953, "policy_loss": -0.007882639765739441, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9356790781021118, "entropy": 1.1469124555587769}, "grad_time_ms": 9915.968, "load_time_ms": 13.8, "update_time_ms": 7.096, "num_steps_sampled": 8467420, "sample_time_ms": 12728.276}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79fd0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8467420, "hostname": "flow-main", "episodes_total": 3330, "timestamp": 1557234908, "episode_reward_max": 1375.5390248634747, "episode_len_mean": 679.57, "time_total_s": 4784.095974206924, "time_since_restore": 4784.095974206924}
{"timesteps_since_restore": 8507386, "training_iteration": 204, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-15-31", "episode_reward_min": 54.331353118299816, "timesteps_this_iter": 39966, "episode_reward_mean": 1162.1416344614847, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.743286609649658, "policy_reward_mean": {}, "iterations_since_restore": 204, "custom_metrics": {"outflow_rate_max": 1453.0236007992007, "cost2_mean": -21.682417117544134, "cost1_mean": 348.48611396362213, "system_level_velocity_mean": 14.032293198609043, "cost2_min": -42.162358445646404, "cost1_max": 425.8614784130782, "cost1_min": 29.450188171622056, "cost2_max": -5.8606250607031, "outflow_rate_mean": 1187.7142692305802, "system_level_velocity_min": 10.256644456776193, "outflow_rate_min": 335.6139678872712, "system_level_velocity_max": 17.653196754477364}, "info": {"num_steps_trained": 8507386, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015029754489660263, "total_loss": 15.82407283782959, "vf_loss": 15.827924728393555, "policy_loss": -0.0076555670239031315, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9480752944946289, "entropy": 1.1451177597045898}, "grad_time_ms": 9871.236, "load_time_ms": 14.108, "update_time_ms": 7.13, "num_steps_sampled": 8507386, "sample_time_ms": 12753.118}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fa20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116feb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f2e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8507386, "hostname": "flow-main", "episodes_total": 3347, "timestamp": 1557234931, "episode_reward_max": 1375.5390248634747, "episode_len_mean": 679.57, "time_total_s": 4806.839260816574, "time_since_restore": 4806.839260816574}
{"timesteps_since_restore": 8547739, "training_iteration": 205, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-15-56", "episode_reward_min": 54.331353118299816, "timesteps_this_iter": 40353, "episode_reward_mean": 1139.9875567372371, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.728280067443848, "policy_reward_mean": {}, "iterations_since_restore": 205, "custom_metrics": {"outflow_rate_max": 1453.0236007992007, "cost2_mean": -21.476203776008806, "cost1_mean": 345.06363223365884, "system_level_velocity_mean": 14.235958907297727, "cost2_min": -42.162358445646404, "cost1_max": 425.8614784130782, "cost1_min": 29.450188171622056, "cost2_max": -5.8606250607031, "outflow_rate_mean": 1180.8158783723154, "system_level_velocity_min": 10.383220886641666, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.046569102862584}, "info": {"num_steps_trained": 8547739, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013500540517270565, "total_loss": 17.10091209411621, "vf_loss": 17.106149673461914, "policy_loss": -0.008655231446027756, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9415668845176697, "entropy": 1.1488876342773438}, "grad_time_ms": 9975.253, "load_time_ms": 13.986, "update_time_ms": 7.342, "num_steps_sampled": 8547739, "sample_time_ms": 12854.271}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8547739, "hostname": "flow-main", "episodes_total": 3367, "timestamp": 1557234956, "episode_reward_max": 1375.5390248634747, "episode_len_mean": 666.57, "time_total_s": 4831.567540884018, "time_since_restore": 4831.567540884018}
{"timesteps_since_restore": 8588270, "training_iteration": 206, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-16-20", "episode_reward_min": 54.331353118299816, "timesteps_this_iter": 40531, "episode_reward_mean": 1134.6845474135446, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.965219736099243, "policy_reward_mean": {}, "iterations_since_restore": 206, "custom_metrics": {"outflow_rate_max": 1453.0236007992007, "cost2_mean": -22.208004555519995, "cost1_mean": 341.93040863781624, "system_level_velocity_mean": 14.14433058902803, "cost2_min": -42.162358445646404, "cost1_max": 424.6651076801439, "cost1_min": 29.450188171622056, "cost2_max": -5.8606250607031, "outflow_rate_mean": 1173.766383268271, "system_level_velocity_min": 10.383220886641666, "outflow_rate_min": 331.0357017442644, "system_level_velocity_max": 18.046569102862584}, "info": {"num_steps_trained": 8588270, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013511314056813717, "total_loss": 11.648395538330078, "vf_loss": 11.652566909790039, "policy_loss": -0.007591280620545149, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9564909934997559, "entropy": 1.1419776678085327}, "grad_time_ms": 9965.789, "load_time_ms": 13.814, "update_time_ms": 7.233, "num_steps_sampled": 8588270, "sample_time_ms": 13037.104}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79e80>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8588270, "hostname": "flow-main", "episodes_total": 3381, "timestamp": 1557234980, "episode_reward_max": 1338.798606610851, "episode_len_mean": 665.81, "time_total_s": 4855.532760620117, "time_since_restore": 4855.532760620117}
{"timesteps_since_restore": 8629874, "training_iteration": 207, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-16-43", "episode_reward_min": 60.26469463603136, "timesteps_this_iter": 41604, "episode_reward_mean": 1140.939661689329, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.29712963104248, "policy_reward_mean": {}, "iterations_since_restore": 207, "custom_metrics": {"outflow_rate_max": 1453.0236007992007, "cost2_mean": -22.618479826369388, "cost1_mean": 344.3547968153114, "system_level_velocity_mean": 14.189027858984367, "cost2_min": -42.162358445646404, "cost1_max": 424.6651076801439, "cost1_min": 31.38798512376909, "cost2_max": -6.044522268744155, "outflow_rate_mean": 1185.344857982512, "system_level_velocity_min": 10.383220886641666, "outflow_rate_min": 331.0357017442644, "system_level_velocity_max": 18.046569102862584}, "info": {"num_steps_trained": 8629874, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014981206506490707, "total_loss": 19.298431396484375, "vf_loss": 19.30341148376465, "policy_loss": -0.00877078901976347, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9373266696929932, "entropy": 1.159442663192749}, "grad_time_ms": 9944.299, "load_time_ms": 14.367, "update_time_ms": 7.171, "num_steps_sampled": 8629874, "sample_time_ms": 13098.936}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69fd0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8629874, "hostname": "flow-main", "episodes_total": 3399, "timestamp": 1557235003, "episode_reward_max": 1338.798606610851, "episode_len_mean": 667.2, "time_total_s": 4878.82989025116, "time_since_restore": 4878.82989025116}
{"timesteps_since_restore": 8670028, "training_iteration": 208, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-17-05", "episode_reward_min": 60.26469463603136, "timesteps_this_iter": 40154, "episode_reward_mean": 1130.0926080980723, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.926260948181152, "policy_reward_mean": {}, "iterations_since_restore": 208, "custom_metrics": {"outflow_rate_max": 1453.0236007992007, "cost2_mean": -23.381091995858927, "cost1_mean": 341.40451267636723, "system_level_velocity_mean": 14.185765598003702, "cost2_min": -42.162358445646404, "cost1_max": 424.6651076801439, "cost1_min": 31.38798512376909, "cost2_max": -6.044522268744155, "outflow_rate_mean": 1178.0199491748035, "system_level_velocity_min": 9.276068109887825, "outflow_rate_min": 331.0357017442644, "system_level_velocity_max": 18.046569102862584}, "info": {"num_steps_trained": 8670028, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015216638334095478, "total_loss": 15.372406005859375, "vf_loss": 15.377259254455566, "policy_loss": -0.008704924024641514, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9469809532165527, "entropy": 1.1926017999649048}, "grad_time_ms": 9822.465, "load_time_ms": 14.534, "update_time_ms": 7.157, "num_steps_sampled": 8670028, "sample_time_ms": 13005.213}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb793c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb794e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79198>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8670028, "hostname": "flow-main", "episodes_total": 3417, "timestamp": 1557235025, "episode_reward_max": 1323.8958426942952, "episode_len_mean": 663.8, "time_total_s": 4900.756151199341, "time_since_restore": 4900.756151199341}
{"timesteps_since_restore": 8708821, "training_iteration": 209, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-17-28", "episode_reward_min": 60.26469463603136, "timesteps_this_iter": 38793, "episode_reward_mean": 1117.6624819673216, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.83165979385376, "policy_reward_mean": {}, "iterations_since_restore": 209, "custom_metrics": {"outflow_rate_max": 1453.0236007992007, "cost2_mean": -23.901952329319432, "cost1_mean": 339.1454430346463, "system_level_velocity_mean": 14.155498769819507, "cost2_min": -42.162358445646404, "cost1_max": 424.6651076801439, "cost1_min": 31.38798512376909, "cost2_max": -6.044522268744155, "outflow_rate_mean": 1166.3356708253707, "system_level_velocity_min": 9.276068109887825, "outflow_rate_min": 331.0357017442644, "system_level_velocity_max": 18.046569102862584}, "info": {"num_steps_trained": 8708821, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012248300947248936, "total_loss": 18.742185592651367, "vf_loss": 18.745359420776367, "policy_loss": -0.006275093648582697, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9429474472999573, "entropy": 1.1918307542800903}, "grad_time_ms": 9755.604, "load_time_ms": 14.345, "update_time_ms": 7.146, "num_steps_sampled": 8708821, "sample_time_ms": 12953.071}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb727f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8708821, "hostname": "flow-main", "episodes_total": 3436, "timestamp": 1557235048, "episode_reward_max": 1323.8958426942952, "episode_len_mean": 661.29, "time_total_s": 4923.587810993195, "time_since_restore": 4923.587810993195}
{"timesteps_since_restore": 8748441, "training_iteration": 210, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-17-51", "episode_reward_min": 60.26469463603136, "timesteps_this_iter": 39620, "episode_reward_mean": 1105.196617433484, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.52048897743225, "policy_reward_mean": {}, "iterations_since_restore": 210, "custom_metrics": {"outflow_rate_max": 1434.1781486513487, "cost2_mean": -23.438682047511303, "cost1_mean": 338.71984571640854, "system_level_velocity_mean": 14.285213712891705, "cost2_min": -41.054004820005545, "cost1_max": 415.23715035386823, "cost1_min": 31.38798512376909, "cost2_max": -6.044522268744155, "outflow_rate_mean": 1160.7949499954111, "system_level_velocity_min": 9.276068109887825, "outflow_rate_min": 331.0357017442644, "system_level_velocity_max": 18.046569102862584}, "info": {"num_steps_trained": 8748441, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014017398469150066, "total_loss": 16.656484603881836, "vf_loss": 16.659997940063477, "policy_loss": -0.007060516159981489, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9358798861503601, "entropy": 1.1720644235610962}, "grad_time_ms": 9931.095, "load_time_ms": 14.678, "update_time_ms": 7.164, "num_steps_sampled": 8748441, "sample_time_ms": 12804.514}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8748441, "hostname": "flow-main", "episodes_total": 3454, "timestamp": 1557235071, "episode_reward_max": 1323.8958426942952, "episode_len_mean": 656.42, "time_total_s": 4946.108299970627, "time_since_restore": 4946.108299970627}
{"timesteps_since_restore": 8787759, "training_iteration": 211, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-18-14", "episode_reward_min": 52.51615767605961, "timesteps_this_iter": 39318, "episode_reward_mean": 1084.6327706477239, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.55204749107361, "policy_reward_mean": {}, "iterations_since_restore": 211, "custom_metrics": {"outflow_rate_max": 1434.1781486513487, "cost2_mean": -23.380334086138575, "cost1_mean": 335.83109155872944, "system_level_velocity_mean": 14.496530433561924, "cost2_min": -43.49471584045601, "cost1_max": 415.23715035386823, "cost1_min": 27.3506481238152, "cost2_max": -5.166862594831337, "outflow_rate_mean": 1150.671131110874, "system_level_velocity_min": 9.276068109887825, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.11035822067753}, "info": {"num_steps_trained": 8787759, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014847597107291222, "total_loss": 25.765104293823242, "vf_loss": 25.768465042114258, "policy_loss": -0.00711766118183732, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9073264598846436, "entropy": 1.165220856666565}, "grad_time_ms": 10087.872, "load_time_ms": 14.866, "update_time_ms": 7.271, "num_steps_sampled": 8787759, "sample_time_ms": 12842.506}, "episodes_this_iter": 22, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb795c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb793c8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8787759, "hostname": "flow-main", "episodes_total": 3476, "timestamp": 1557235094, "episode_reward_max": 1323.8958426942952, "episode_len_mean": 644.32, "time_total_s": 4969.6603474617, "time_since_restore": 4969.6603474617}
{"timesteps_since_restore": 8827507, "training_iteration": 212, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-18-36", "episode_reward_min": 52.51615767605961, "timesteps_this_iter": 39748, "episode_reward_mean": 1094.1373138528863, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.272768259048462, "policy_reward_mean": {}, "iterations_since_restore": 212, "custom_metrics": {"outflow_rate_max": 1434.1781486513487, "cost2_mean": -22.837901440342463, "cost1_mean": 339.18911395049537, "system_level_velocity_mean": 14.508494916772555, "cost2_min": -43.49471584045601, "cost1_max": 415.23715035386823, "cost1_min": 27.3506481238152, "cost2_max": -5.166862594831337, "outflow_rate_mean": 1156.7366852498374, "system_level_velocity_min": 9.276068109887825, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.11035822067753}, "info": {"num_steps_trained": 8827507, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013725627213716507, "total_loss": 13.96063232421875, "vf_loss": 13.964447975158691, "policy_loss": -0.00729056540876627, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9408937692642212, "entropy": 1.186589002609253}, "grad_time_ms": 10096.486, "load_time_ms": 15.649, "update_time_ms": 7.359, "num_steps_sampled": 8827507, "sample_time_ms": 12847.293}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72c50>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8827507, "hostname": "flow-main", "episodes_total": 3492, "timestamp": 1557235116, "episode_reward_max": 1296.6369287778655, "episode_len_mean": 650.31, "time_total_s": 4991.933115720749, "time_since_restore": 4991.933115720749}
{"timesteps_since_restore": 8868458, "training_iteration": 213, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-19-00", "episode_reward_min": 52.51615767605961, "timesteps_this_iter": 40951, "episode_reward_mean": 1081.137472984559, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.481089115142822, "policy_reward_mean": {}, "iterations_since_restore": 213, "custom_metrics": {"outflow_rate_max": 1432.8608783216785, "cost2_mean": -21.710426651773478, "cost1_mean": 334.8994782450273, "system_level_velocity_mean": 14.503245041409512, "cost2_min": -43.49471584045601, "cost1_max": 415.23715035386823, "cost1_min": 27.3506481238152, "cost2_max": -5.166862594831337, "outflow_rate_mean": 1141.6002307977278, "system_level_velocity_min": 9.276068109887825, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.11035822067753}, "info": {"num_steps_trained": 8868458, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014382455497980118, "total_loss": 16.207918167114258, "vf_loss": 16.211824417114258, "policy_loss": -0.007547440007328987, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9369807243347168, "entropy": 1.2152023315429688}, "grad_time_ms": 10131.181, "load_time_ms": 16.209, "update_time_ms": 7.468, "num_steps_sampled": 8868458, "sample_time_ms": 12897.808}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79080>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8868458, "hostname": "flow-main", "episodes_total": 3509, "timestamp": 1557235140, "episode_reward_max": 1296.6369287778655, "episode_len_mean": 643.81, "time_total_s": 5015.414204835892, "time_since_restore": 5015.414204835892}
{"timesteps_since_restore": 8909528, "training_iteration": 214, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-19-23", "episode_reward_min": 52.51615767605961, "timesteps_this_iter": 41070, "episode_reward_mean": 1083.2592470010732, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.945150136947632, "policy_reward_mean": {}, "iterations_since_restore": 214, "custom_metrics": {"outflow_rate_max": 1432.8608783216785, "cost2_mean": -21.031706133852005, "cost1_mean": 338.0302737231551, "system_level_velocity_mean": 14.592889525364631, "cost2_min": -43.49471584045601, "cost1_max": 423.7191553053205, "cost1_min": 27.3506481238152, "cost2_max": -5.166862594831337, "outflow_rate_mean": 1144.2016739662222, "system_level_velocity_min": 10.78059141995325, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.11035822067753}, "info": {"num_steps_trained": 8909528, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013060227036476135, "total_loss": 16.127155303955078, "vf_loss": 16.130966186523438, "policy_loss": -0.0071180155500769615, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9302310943603516, "entropy": 1.2294602394104004}, "grad_time_ms": 10148.734, "load_time_ms": 16.322, "update_time_ms": 7.408, "num_steps_sampled": 8909528, "sample_time_ms": 12899.348}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb722b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8909528, "hostname": "flow-main", "episodes_total": 3524, "timestamp": 1557235163, "episode_reward_max": 1281.5039087206246, "episode_len_mean": 645.51, "time_total_s": 5038.359354972839, "time_since_restore": 5038.359354972839}
{"timesteps_since_restore": 8950161, "training_iteration": 215, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-19-45", "episode_reward_min": 52.51615767605961, "timesteps_this_iter": 40633, "episode_reward_mean": 1064.7036610778666, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.425796508789062, "policy_reward_mean": {}, "iterations_since_restore": 215, "custom_metrics": {"outflow_rate_max": 1409.2150641358644, "cost2_mean": -20.084328262229718, "cost1_mean": 326.20764727443094, "system_level_velocity_mean": 14.422244516441836, "cost2_min": -43.49471584045601, "cost1_max": 423.7191553053205, "cost1_min": 27.3506481238152, "cost2_max": -5.166862594831337, "outflow_rate_mean": 1110.6317862141932, "system_level_velocity_min": 10.172660721504187, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.11035822067753}, "info": {"num_steps_trained": 8950161, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013986455276608467, "total_loss": 20.860427856445312, "vf_loss": 20.86663246154785, "policy_loss": -0.009745551273226738, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9097821712493896, "entropy": 1.2286263704299927}, "grad_time_ms": 10066.077, "load_time_ms": 16.748, "update_time_ms": 7.223, "num_steps_sampled": 8950161, "sample_time_ms": 12751.346}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb729e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb726a0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8950161, "hostname": "flow-main", "episodes_total": 3543, "timestamp": 1557235185, "episode_reward_max": 1284.4494304112116, "episode_len_mean": 633.06, "time_total_s": 5060.785151481628, "time_since_restore": 5060.785151481628}
{"timesteps_since_restore": 8990059, "training_iteration": 216, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-20-08", "episode_reward_min": 54.62539130804945, "timesteps_this_iter": 39898, "episode_reward_mean": 1080.5005884371433, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.728632926940918, "policy_reward_mean": {}, "iterations_since_restore": 216, "custom_metrics": {"outflow_rate_max": 1409.2150641358644, "cost2_mean": -19.342887669150578, "cost1_mean": 327.8673896838013, "system_level_velocity_mean": 14.29989992847336, "cost2_min": -43.49471584045601, "cost1_max": 423.7191553053205, "cost1_min": 28.18252731031228, "cost2_max": -6.518390145573066, "outflow_rate_mean": 1113.7763466808337, "system_level_velocity_min": 10.172660721504187, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.11646132218997}, "info": {"num_steps_trained": 8990059, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01256128866225481, "total_loss": 23.658723831176758, "vf_loss": 23.662614822387695, "policy_loss": -0.007071103900671005, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.887170135974884, "entropy": 1.219780683517456}, "grad_time_ms": 10046.205, "load_time_ms": 16.957, "update_time_ms": 7.264, "num_steps_sampled": 8990059, "sample_time_ms": 12647.139}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 8990059, "hostname": "flow-main", "episodes_total": 3563, "timestamp": 1557235208, "episode_reward_max": 1284.4494304112116, "episode_len_mean": 640.82, "time_total_s": 5083.513784408569, "time_since_restore": 5083.513784408569}
{"timesteps_since_restore": 9029854, "training_iteration": 217, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-20-31", "episode_reward_min": 50.77162300515277, "timesteps_this_iter": 39795, "episode_reward_mean": 1082.6340271025374, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.26494526863098, "policy_reward_mean": {}, "iterations_since_restore": 217, "custom_metrics": {"outflow_rate_max": 1409.2150641358644, "cost2_mean": -18.746728479949127, "cost1_mean": 326.4501395572699, "system_level_velocity_mean": 14.230795099572592, "cost2_min": -40.238928726603724, "cost1_max": 423.7191553053205, "cost1_min": 27.9547166246791, "cost2_max": -6.518390145573066, "outflow_rate_mean": 1109.00762291554, "system_level_velocity_min": 10.172660721504187, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.11646132218997}, "info": {"num_steps_trained": 9029854, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015556004829704762, "total_loss": 24.86260414123535, "vf_loss": 24.867807388305664, "policy_loss": -0.009142376482486725, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.8955281972885132, "entropy": 1.2231481075286865}, "grad_time_ms": 10007.388, "load_time_ms": 16.481, "update_time_ms": 7.22, "num_steps_sampled": 9029854, "sample_time_ms": 12684.758}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb695c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb697b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69dd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9029854, "hostname": "flow-main", "episodes_total": 3582, "timestamp": 1557235231, "episode_reward_max": 1310.3465413919143, "episode_len_mean": 640.09, "time_total_s": 5106.7787296772, "time_since_restore": 5106.7787296772}
{"timesteps_since_restore": 9068722, "training_iteration": 218, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-20-53", "episode_reward_min": 50.77162300515277, "timesteps_this_iter": 38868, "episode_reward_mean": 1069.0025554250717, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.8321852684021, "policy_reward_mean": {}, "iterations_since_restore": 218, "custom_metrics": {"outflow_rate_max": 1409.2150641358644, "cost2_mean": -18.61201545143415, "cost1_mean": 324.6219545715344, "system_level_velocity_mean": 14.209978533147025, "cost2_min": -40.238928726603724, "cost1_max": 423.7191553053205, "cost1_min": 27.9547166246791, "cost2_max": -6.518390145573066, "outflow_rate_mean": 1101.4807768740552, "system_level_velocity_min": 9.761810017371383, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.11646132218997}, "info": {"num_steps_trained": 9068722, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014446310698986053, "total_loss": 19.30204963684082, "vf_loss": 19.307138442993164, "policy_loss": -0.008744834922254086, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9141305685043335, "entropy": 1.248467206954956}, "grad_time_ms": 10070.566, "load_time_ms": 16.453, "update_time_ms": 7.22, "num_steps_sampled": 9068722, "sample_time_ms": 12613.387}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79dd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9068722, "hostname": "flow-main", "episodes_total": 3601, "timestamp": 1557235253, "episode_reward_max": 1310.3465413919143, "episode_len_mean": 638.58, "time_total_s": 5128.610914945602, "time_since_restore": 5128.610914945602}
{"timesteps_since_restore": 9107911, "training_iteration": 219, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-21-16", "episode_reward_min": 50.77162300515277, "timesteps_this_iter": 39189, "episode_reward_mean": 1074.9660497804807, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.575334072113037, "policy_reward_mean": {}, "iterations_since_restore": 219, "custom_metrics": {"outflow_rate_max": 1369.5119844155845, "cost2_mean": -18.730829244369737, "cost1_mean": 328.1860816329295, "system_level_velocity_mean": 14.312597094509588, "cost2_min": -53.24300770360909, "cost1_max": 423.7191553053205, "cost1_min": 27.9547166246791, "cost2_max": -6.518390145573066, "outflow_rate_mean": 1108.453008998819, "system_level_velocity_min": 9.761810017371383, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 19.11646132218997}, "info": {"num_steps_trained": 9107911, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014105410315096378, "total_loss": 20.327836990356445, "vf_loss": 20.332195281982422, "policy_loss": -0.00792873278260231, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9234557151794434, "entropy": 1.2059887647628784}, "grad_time_ms": 10097.206, "load_time_ms": 16.317, "update_time_ms": 7.129, "num_steps_sampled": 9107911, "sample_time_ms": 12561.336}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb799b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79d68>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9107911, "hostname": "flow-main", "episodes_total": 3617, "timestamp": 1557235276, "episode_reward_max": 1310.3465413919143, "episode_len_mean": 640.28, "time_total_s": 5151.186249017715, "time_since_restore": 5151.186249017715}
{"timesteps_since_restore": 9147585, "training_iteration": 220, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-21-39", "episode_reward_min": 49.966308486765584, "timesteps_this_iter": 39674, "episode_reward_mean": 1078.9417346536216, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.87397003173828, "policy_reward_mean": {}, "iterations_since_restore": 220, "custom_metrics": {"outflow_rate_max": 1477.1792103896105, "cost2_mean": -19.886760809315852, "cost1_mean": 332.05260308932293, "system_level_velocity_mean": 14.322883984802996, "cost2_min": -53.24300770360909, "cost1_max": 422.7236052897284, "cost1_min": 27.9547166246791, "cost2_max": -6.518390145573066, "outflow_rate_mean": 1122.0897824494182, "system_level_velocity_min": 9.761810017371383, "outflow_rate_min": 334.2309683844586, "system_level_velocity_max": 19.12168822689318}, "info": {"num_steps_trained": 9147585, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015376156195998192, "total_loss": 22.949270248413086, "vf_loss": 22.95435905456543, "policy_loss": -0.008980908431112766, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9137914776802063, "entropy": 1.2019410133361816}, "grad_time_ms": 10073.673, "load_time_ms": 15.819, "update_time_ms": 6.985, "num_steps_sampled": 9147585, "sample_time_ms": 12621.629}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72400>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9147585, "hostname": "flow-main", "episodes_total": 3636, "timestamp": 1557235299, "episode_reward_max": 1310.3465413919143, "episode_len_mean": 646.71, "time_total_s": 5174.060219049454, "time_since_restore": 5174.060219049454}
{"timesteps_since_restore": 9187389, "training_iteration": 221, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-22-02", "episode_reward_min": 49.966308486765584, "timesteps_this_iter": 39804, "episode_reward_mean": 1075.3982014006228, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.26100254058838, "policy_reward_mean": {}, "iterations_since_restore": 221, "custom_metrics": {"outflow_rate_max": 1477.1792103896105, "cost2_mean": -21.085843692263964, "cost1_mean": 334.19432763303985, "system_level_velocity_mean": 14.384806551349794, "cost2_min": -62.95191185898269, "cost1_max": 433.99132040420096, "cost1_min": 27.9547166246791, "cost2_max": -6.518390145573066, "outflow_rate_mean": 1127.5630018679417, "system_level_velocity_min": 9.761810017371383, "outflow_rate_min": 334.2309683844586, "system_level_velocity_max": 19.260848081503553}, "info": {"num_steps_trained": 9187389, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013345985673367977, "total_loss": 17.796546936035156, "vf_loss": 17.80056381225586, "policy_loss": -0.007393983192741871, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9313459992408752, "entropy": 1.1637216806411743}, "grad_time_ms": 10056.446, "load_time_ms": 15.729, "update_time_ms": 7.018, "num_steps_sampled": 9187389, "sample_time_ms": 12609.707}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79320>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9187389, "hostname": "flow-main", "episodes_total": 3651, "timestamp": 1557235322, "episode_reward_max": 1310.3465413919143, "episode_len_mean": 647.77, "time_total_s": 5197.321221590042, "time_since_restore": 5197.321221590042}
{"timesteps_since_restore": 9226556, "training_iteration": 222, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-22-27", "episode_reward_min": 49.966308486765584, "timesteps_this_iter": 39167, "episode_reward_mean": 1069.5447680155648, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 25.341671466827393, "policy_reward_mean": {}, "iterations_since_restore": 222, "custom_metrics": {"outflow_rate_max": 1477.1792103896105, "cost2_mean": -21.091862647585817, "cost1_mean": 336.62824548349505, "system_level_velocity_mean": 14.493050122492185, "cost2_min": -62.95191185898269, "cost1_max": 433.99132040420096, "cost1_min": 27.9547166246791, "cost2_max": -6.545613027099829, "outflow_rate_mean": 1137.9726075462904, "system_level_velocity_min": 9.761810017371383, "outflow_rate_min": 337.7301442378166, "system_level_velocity_max": 19.260848081503553}, "info": {"num_steps_trained": 9226556, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015141109935939312, "total_loss": 24.261430740356445, "vf_loss": 24.26548957824707, "policy_loss": -0.007892000488936901, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9007971882820129, "entropy": 1.1887527704238892}, "grad_time_ms": 9998.22, "load_time_ms": 15.19, "update_time_ms": 6.948, "num_steps_sampled": 9226556, "sample_time_ms": 12977.007}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb695f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9226556, "hostname": "flow-main", "episodes_total": 3671, "timestamp": 1557235347, "episode_reward_max": 1302.114352891696, "episode_len_mean": 649.42, "time_total_s": 5222.6628930568695, "time_since_restore": 5222.6628930568695}
{"timesteps_since_restore": 9265850, "training_iteration": 223, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-22-48", "episode_reward_min": 49.966308486765584, "timesteps_this_iter": 39294, "episode_reward_mean": 1087.9883591378975, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 20.96753454208374, "policy_reward_mean": {}, "iterations_since_restore": 223, "custom_metrics": {"outflow_rate_max": 1477.1792103896105, "cost2_mean": -21.522107954421845, "cost1_mean": 343.8516627890856, "system_level_velocity_mean": 14.514934751501997, "cost2_min": -62.95191185898269, "cost1_max": 433.99132040420096, "cost1_min": 27.976606724582954, "cost2_max": -6.922432555828791, "outflow_rate_mean": 1152.7265040230209, "system_level_velocity_min": 9.761810017371383, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.260848081503553}, "info": {"num_steps_trained": 9265850, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01309570949524641, "total_loss": 19.689804077148438, "vf_loss": 19.693422317504883, "policy_loss": -0.006934226956218481, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9240224957466125, "entropy": 1.160981297492981}, "grad_time_ms": 9753.632, "load_time_ms": 14.792, "update_time_ms": 6.784, "num_steps_sampled": 9265850, "sample_time_ms": 12971.233}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9265850, "hostname": "flow-main", "episodes_total": 3690, "timestamp": 1557235368, "episode_reward_max": 1302.114352891696, "episode_len_mean": 660.77, "time_total_s": 5243.630427598953, "time_since_restore": 5243.630427598953}
{"timesteps_since_restore": 9304906, "training_iteration": 224, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-23-10", "episode_reward_min": 49.966308486765584, "timesteps_this_iter": 39056, "episode_reward_mean": 1093.2188441889948, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.8917977809906, "policy_reward_mean": {}, "iterations_since_restore": 224, "custom_metrics": {"outflow_rate_max": 1477.1792103896105, "cost2_mean": -21.76457859943192, "cost1_mean": 346.94142946093655, "system_level_velocity_mean": 14.66515444359794, "cost2_min": -62.95191185898269, "cost1_max": 433.99132040420096, "cost1_min": 27.976606724582954, "cost2_max": -6.922432555828791, "outflow_rate_mean": 1162.9136280549892, "system_level_velocity_min": 11.8763677995374, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.260848081503553}, "info": {"num_steps_trained": 9304906, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014222576282918453, "total_loss": 18.04119873046875, "vf_loss": 18.045385360717773, "policy_loss": -0.0077863167971372604, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9227893352508545, "entropy": 1.1657679080963135}, "grad_time_ms": 9712.626, "load_time_ms": 14.332, "update_time_ms": 6.774, "num_steps_sampled": 9304906, "sample_time_ms": 12908.625}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb696a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79f98>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9304906, "hostname": "flow-main", "episodes_total": 3706, "timestamp": 1557235390, "episode_reward_max": 1351.1647400854083, "episode_len_mean": 660.77, "time_total_s": 5265.522225379944, "time_since_restore": 5265.522225379944}
{"timesteps_since_restore": 9344745, "training_iteration": 225, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-23-33", "episode_reward_min": 49.966308486765584, "timesteps_this_iter": 39839, "episode_reward_mean": 1099.1642420799672, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.797913551330566, "policy_reward_mean": {}, "iterations_since_restore": 225, "custom_metrics": {"outflow_rate_max": 1477.1792103896105, "cost2_mean": -21.120859905960618, "cost1_mean": 349.6255148051465, "system_level_velocity_mean": 14.654293786354623, "cost2_min": -62.95191185898269, "cost1_max": 433.99132040420096, "cost1_min": 27.976606724582954, "cost2_max": -6.922432555828791, "outflow_rate_mean": 1171.904445571146, "system_level_velocity_min": 11.8763677995374, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.260848081503553}, "info": {"num_steps_trained": 9344745, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014112978242337704, "total_loss": 19.891019821166992, "vf_loss": 19.894020080566406, "policy_loss": -0.006569521967321634, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9254917502403259, "entropy": 1.1757521629333496}, "grad_time_ms": 9681.158, "load_time_ms": 13.979, "update_time_ms": 6.725, "num_steps_sampled": 9344745, "sample_time_ms": 12977.252}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb799b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb795f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb790b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9344745, "hostname": "flow-main", "episodes_total": 3724, "timestamp": 1557235413, "episode_reward_max": 1351.1647400854083, "episode_len_mean": 665.57, "time_total_s": 5288.320138931274, "time_since_restore": 5288.320138931274}
{"timesteps_since_restore": 9383248, "training_iteration": 226, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-23-55", "episode_reward_min": 55.14950917898117, "timesteps_this_iter": 38503, "episode_reward_mean": 1104.5457983315318, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.38780665397644, "policy_reward_mean": {}, "iterations_since_restore": 226, "custom_metrics": {"outflow_rate_max": 1423.395641958042, "cost2_mean": -20.843116200066493, "cost1_mean": 350.2200723003218, "system_level_velocity_mean": 14.657826279075312, "cost2_min": -62.95191185898269, "cost1_max": 421.3308298621474, "cost1_min": 28.5490600823763, "cost2_max": -6.922432555828791, "outflow_rate_mean": 1172.2345325787103, "system_level_velocity_min": 11.819805867886855, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.260848081503553}, "info": {"num_steps_trained": 9383248, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0145034184679389, "total_loss": 18.424530029296875, "vf_loss": 18.430667877197266, "policy_loss": -0.009807808324694633, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9284976124763489, "entropy": 1.1857441663742065}, "grad_time_ms": 9662.721, "load_time_ms": 13.876, "update_time_ms": 6.627, "num_steps_sampled": 9383248, "sample_time_ms": 12962.164}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fa20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fa58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fc18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9383248, "hostname": "flow-main", "episodes_total": 3741, "timestamp": 1557235435, "episode_reward_max": 1351.1647400854083, "episode_len_mean": 666.56, "time_total_s": 5310.707945585251, "time_since_restore": 5310.707945585251}
{"timesteps_since_restore": 9423077, "training_iteration": 227, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-24-18", "episode_reward_min": 55.14950917898117, "timesteps_this_iter": 39829, "episode_reward_mean": 1130.5394454271645, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.077524423599243, "policy_reward_mean": {}, "iterations_since_restore": 227, "custom_metrics": {"outflow_rate_max": 1423.395641958042, "cost2_mean": -20.247499854196228, "cost1_mean": 357.5907906240401, "system_level_velocity_mean": 14.54688894422131, "cost2_min": -50.08032266477622, "cost1_max": 421.3308298621474, "cost1_min": 28.5490600823763, "cost2_max": -6.922432555828791, "outflow_rate_mean": 1189.1631988551046, "system_level_velocity_min": 11.819805867886855, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.23870420558396}, "info": {"num_steps_trained": 9423077, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014359762892127037, "total_loss": 19.489519119262695, "vf_loss": 19.49427604675293, "policy_loss": -0.008390231989324093, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9130975008010864, "entropy": 1.1999939680099487}, "grad_time_ms": 9668.367, "load_time_ms": 13.68, "update_time_ms": 6.714, "num_steps_sampled": 9423077, "sample_time_ms": 12837.377}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb794a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79e80>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9423077, "hostname": "flow-main", "episodes_total": 3758, "timestamp": 1557235458, "episode_reward_max": 1351.1647400854083, "episode_len_mean": 681.97, "time_total_s": 5332.78547000885, "time_since_restore": 5332.78547000885}
{"timesteps_since_restore": 9462314, "training_iteration": 228, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-24-41", "episode_reward_min": 55.14950917898117, "timesteps_this_iter": 39237, "episode_reward_mean": 1130.3349457431284, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.389256954193115, "policy_reward_mean": {}, "iterations_since_restore": 228, "custom_metrics": {"outflow_rate_max": 1446.3669590409588, "cost2_mean": -20.819528473803953, "cost1_mean": 357.62639627540716, "system_level_velocity_mean": 14.538309353991396, "cost2_min": -50.08032266477622, "cost1_max": 442.8602578691604, "cost1_min": 28.5490600823763, "cost2_max": -6.869576785613391, "outflow_rate_mean": 1191.0388718115228, "system_level_velocity_min": 11.819805867886855, "outflow_rate_min": 331.00586905405225, "system_level_velocity_max": 19.23870420558396}, "info": {"num_steps_trained": 9462314, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014020265080034733, "total_loss": 19.237754821777344, "vf_loss": 19.24448585510254, "policy_loss": -0.0102787921205163, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9245681166648865, "entropy": 1.2009671926498413}, "grad_time_ms": 9689.027, "load_time_ms": 13.364, "update_time_ms": 6.808, "num_steps_sampled": 9462314, "sample_time_ms": 12972.235}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6edd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9462314, "hostname": "flow-main", "episodes_total": 3774, "timestamp": 1557235481, "episode_reward_max": 1351.1647400854083, "episode_len_mean": 681.32, "time_total_s": 5356.174726963043, "time_since_restore": 5356.174726963043}
{"timesteps_since_restore": 9501117, "training_iteration": 229, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-25-04", "episode_reward_min": 62.55862305686562, "timesteps_this_iter": 38803, "episode_reward_mean": 1129.4517199439533, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.008846759796143, "policy_reward_mean": {}, "iterations_since_restore": 229, "custom_metrics": {"outflow_rate_max": 1446.3669590409588, "cost2_mean": -21.301554980077206, "cost1_mean": 358.61704313814624, "system_level_velocity_mean": 14.5637995686453, "cost2_min": -50.08032266477622, "cost1_max": 442.8602578691604, "cost1_min": 30.922661597612947, "cost2_max": -6.869576785613391, "outflow_rate_mean": 1197.6140162013664, "system_level_velocity_min": 11.819805867886855, "outflow_rate_min": 331.00586905405225, "system_level_velocity_max": 18.519010403477225}, "info": {"num_steps_trained": 9501117, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01514182984828949, "total_loss": 22.147777557373047, "vf_loss": 22.15170669555664, "policy_loss": -0.007763970177620649, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9048693776130676, "entropy": 1.2050085067749023}, "grad_time_ms": 9671.489, "load_time_ms": 13.349, "update_time_ms": 6.869, "num_steps_sampled": 9501117, "sample_time_ms": 13032.544}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fa58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79be0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9501117, "hostname": "flow-main", "episodes_total": 3794, "timestamp": 1557235504, "episode_reward_max": 1351.1647400854083, "episode_len_mean": 682.31, "time_total_s": 5379.183573722839, "time_since_restore": 5379.183573722839}
{"timesteps_since_restore": 9540238, "training_iteration": 230, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-25-26", "episode_reward_min": 62.55862305686562, "timesteps_this_iter": 39121, "episode_reward_mean": 1109.414109268674, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.94376826286316, "policy_reward_mean": {}, "iterations_since_restore": 230, "custom_metrics": {"outflow_rate_max": 1446.3669590409588, "cost2_mean": -21.483970586607214, "cost1_mean": 351.9012039065591, "system_level_velocity_mean": 14.513546187527272, "cost2_min": -40.80427286523041, "cost1_max": 442.8602578691604, "cost1_min": 30.922661597612947, "cost2_max": -6.869576785613391, "outflow_rate_mean": 1183.7585507278995, "system_level_velocity_min": 11.819805867886855, "outflow_rate_min": 331.00586905405225, "system_level_velocity_max": 18.519010403477225}, "info": {"num_steps_trained": 9540238, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013902170583605766, "total_loss": 26.734107971191406, "vf_loss": 26.73931884765625, "policy_loss": -0.008732125163078308, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.8913719058036804, "entropy": 1.2316570281982422}, "grad_time_ms": 9662.793, "load_time_ms": 13.222, "update_time_ms": 6.889, "num_steps_sampled": 9540238, "sample_time_ms": 12948.132}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb794a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9540238, "hostname": "flow-main", "episodes_total": 3813, "timestamp": 1557235526, "episode_reward_max": 1287.677169531219, "episode_len_mean": 673.42, "time_total_s": 5401.1273419857025, "time_since_restore": 5401.1273419857025}
{"timesteps_since_restore": 9579311, "training_iteration": 231, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-25-48", "episode_reward_min": 62.55862305686562, "timesteps_this_iter": 39073, "episode_reward_mean": 1104.0708509472252, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.424684286117554, "policy_reward_mean": {}, "iterations_since_restore": 231, "custom_metrics": {"outflow_rate_max": 1446.3669590409588, "cost2_mean": -21.94840068679407, "cost1_mean": 350.85386778712405, "system_level_velocity_mean": 14.48609200223795, "cost2_min": -40.80427286523041, "cost1_max": 442.8602578691604, "cost1_min": 30.922661597612947, "cost2_max": -6.869576785613391, "outflow_rate_mean": 1181.985797325302, "system_level_velocity_min": 11.757574646350918, "outflow_rate_min": 331.00586905405225, "system_level_velocity_max": 18.519010403477225}, "info": {"num_steps_trained": 9579311, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012642349116504192, "total_loss": 15.526095390319824, "vf_loss": 15.531325340270996, "policy_loss": -0.008430179208517075, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9460445046424866, "entropy": 1.2144378423690796}, "grad_time_ms": 9664.271, "load_time_ms": 12.839, "update_time_ms": 6.825, "num_steps_sampled": 9579311, "sample_time_ms": 12862.471}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69198>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9579311, "hostname": "flow-main", "episodes_total": 3828, "timestamp": 1557235548, "episode_reward_max": 1287.677169531219, "episode_len_mean": 673.42, "time_total_s": 5423.55202627182, "time_since_restore": 5423.55202627182}
{"timesteps_since_restore": 9618371, "training_iteration": 232, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-26-11", "episode_reward_min": 48.19499897237209, "timesteps_this_iter": 39060, "episode_reward_mean": 1097.155250656785, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.849178075790405, "policy_reward_mean": {}, "iterations_since_restore": 232, "custom_metrics": {"outflow_rate_max": 1446.3669590409588, "cost2_mean": -22.54856637572276, "cost1_mean": 350.56494346978934, "system_level_velocity_mean": 14.527827716554457, "cost2_min": -40.80427286523041, "cost1_max": 442.8602578691604, "cost1_min": 28.048750293158516, "cost2_max": -6.869576785613391, "outflow_rate_mean": 1183.5440082238317, "system_level_velocity_min": 11.757574646350918, "outflow_rate_min": 331.00586905405225, "system_level_velocity_max": 19.077767224976242}, "info": {"num_steps_trained": 9618371, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0133183803409338, "total_loss": 20.2777156829834, "vf_loss": 20.282093048095703, "policy_loss": -0.007751095108687878, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9174378514289856, "entropy": 1.2245361804962158}, "grad_time_ms": 9715.842, "load_time_ms": 12.316, "update_time_ms": 7.112, "num_steps_sampled": 9618371, "sample_time_ms": 12559.922}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9618371, "hostname": "flow-main", "episodes_total": 3846, "timestamp": 1557235571, "episode_reward_max": 1287.677169531219, "episode_len_mean": 672.43, "time_total_s": 5446.4012043476105, "time_since_restore": 5446.4012043476105}
{"timesteps_since_restore": 9657609, "training_iteration": 233, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-26-34", "episode_reward_min": 48.19499897237209, "timesteps_this_iter": 39238, "episode_reward_mean": 1076.2229268291328, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.54266119003296, "policy_reward_mean": {}, "iterations_since_restore": 233, "custom_metrics": {"outflow_rate_max": 1426.9441922077924, "cost2_mean": -23.090268298517373, "cost1_mean": 345.0658197532408, "system_level_velocity_mean": 14.490524250855696, "cost2_min": -44.93531043837757, "cost1_max": 410.59245471965113, "cost1_min": 28.048750293158516, "cost2_max": -6.869576785613391, "outflow_rate_mean": 1169.0185268631344, "system_level_velocity_min": 11.757574646350918, "outflow_rate_min": 331.00586905405225, "system_level_velocity_max": 19.077767224976242}, "info": {"num_steps_trained": 9657609, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014340539462864399, "total_loss": 20.456462860107422, "vf_loss": 20.46163558959961, "policy_loss": -0.008801502175629139, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9172433018684387, "entropy": 1.2049429416656494}, "grad_time_ms": 9909.176, "load_time_ms": 12.335, "update_time_ms": 7.371, "num_steps_sampled": 9657609, "sample_time_ms": 12523.594}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb794a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9657609, "hostname": "flow-main", "episodes_total": 3865, "timestamp": 1557235594, "episode_reward_max": 1287.677169531219, "episode_len_mean": 666.49, "time_total_s": 5468.943865537643, "time_since_restore": 5468.943865537643}
{"timesteps_since_restore": 9696996, "training_iteration": 234, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-26-56", "episode_reward_min": 48.19499897237209, "timesteps_this_iter": 39387, "episode_reward_mean": 1080.6855963545247, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.541367053985596, "policy_reward_mean": {}, "iterations_since_restore": 234, "custom_metrics": {"outflow_rate_max": 1411.1801622377625, "cost2_mean": -24.269111392992905, "cost1_mean": 345.17810027741405, "system_level_velocity_mean": 14.335772774213822, "cost2_min": -44.93531043837757, "cost1_max": 410.59245471965113, "cost1_min": 28.048750293158516, "cost2_max": -7.181744591946453, "outflow_rate_mean": 1170.775347481285, "system_level_velocity_min": 11.403515632255202, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.077767224976242}, "info": {"num_steps_trained": 9696996, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013770016841590405, "total_loss": 15.246809005737305, "vf_loss": 15.250359535217285, "policy_loss": -0.007035869173705578, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9544146656990051, "entropy": 1.1885393857955933}, "grad_time_ms": 9921.848, "load_time_ms": 12.288, "update_time_ms": 7.313, "num_steps_sampled": 9696996, "sample_time_ms": 12575.35}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72780>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9696996, "hostname": "flow-main", "episodes_total": 3882, "timestamp": 1557235616, "episode_reward_max": 1287.677169531219, "episode_len_mean": 672.02, "time_total_s": 5491.485232591629, "time_since_restore": 5491.485232591629}
{"timesteps_since_restore": 9737052, "training_iteration": 235, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-27-19", "episode_reward_min": 48.19499897237209, "timesteps_this_iter": 40056, "episode_reward_mean": 1091.635404798677, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.73266339302063, "policy_reward_mean": {}, "iterations_since_restore": 235, "custom_metrics": {"outflow_rate_max": 1411.1801622377625, "cost2_mean": -25.446273350495563, "cost1_mean": 346.7653973957693, "system_level_velocity_mean": 14.20980640845881, "cost2_min": -44.93531043837757, "cost1_max": 410.59245471965113, "cost1_min": 28.048750293158516, "cost2_max": -7.181744591946453, "outflow_rate_mean": 1174.114194777989, "system_level_velocity_min": 11.403515632255202, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.077767224976242}, "info": {"num_steps_trained": 9737052, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013322134502232075, "total_loss": 12.515039443969727, "vf_loss": 12.519618034362793, "policy_loss": -0.0079488605260849, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9572706818580627, "entropy": 1.2047144174575806}, "grad_time_ms": 9952.753, "load_time_ms": 12.244, "update_time_ms": 7.273, "num_steps_sampled": 9737052, "sample_time_ms": 12538.072}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f0f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9737052, "hostname": "flow-main", "episodes_total": 3897, "timestamp": 1557235639, "episode_reward_max": 1286.9333126077725, "episode_len_mean": 677.6, "time_total_s": 5514.21789598465, "time_since_restore": 5514.21789598465}
{"timesteps_since_restore": 9776973, "training_iteration": 236, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-27-43", "episode_reward_min": 48.19499897237209, "timesteps_this_iter": 39921, "episode_reward_mean": 1108.9757495578774, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.760108947753906, "policy_reward_mean": {}, "iterations_since_restore": 236, "custom_metrics": {"outflow_rate_max": 1441.7559500499501, "cost2_mean": -25.863626758983795, "cost1_mean": 352.5851877349843, "system_level_velocity_mean": 14.223167095384861, "cost2_min": -44.93531043837757, "cost1_max": 417.4910675161536, "cost1_min": 28.048750293158516, "cost2_max": -7.181744591946453, "outflow_rate_mean": 1188.478313993714, "system_level_velocity_min": 11.403515632255202, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.077767224976242}, "info": {"num_steps_trained": 9776973, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01501017902046442, "total_loss": 16.678857803344727, "vf_loss": 16.685453414916992, "policy_loss": -0.010394916869699955, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9434598684310913, "entropy": 1.1953543424606323}, "grad_time_ms": 10020.469, "load_time_ms": 12.347, "update_time_ms": 7.337, "num_steps_sampled": 9776973, "sample_time_ms": 12607.973}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb696a0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9776973, "hostname": "flow-main", "episodes_total": 3914, "timestamp": 1557235663, "episode_reward_max": 1286.9333126077725, "episode_len_mean": 686.49, "time_total_s": 5537.978004932404, "time_since_restore": 5537.978004932404}
{"timesteps_since_restore": 9816800, "training_iteration": 237, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-28-05", "episode_reward_min": 48.19499897237209, "timesteps_this_iter": 39827, "episode_reward_mean": 1116.8250258290375, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.152660846710205, "policy_reward_mean": {}, "iterations_since_restore": 237, "custom_metrics": {"outflow_rate_max": 1441.7559500499501, "cost2_mean": -26.599894572324175, "cost1_mean": 353.9428934024115, "system_level_velocity_mean": 14.248118165778438, "cost2_min": -44.93531043837757, "cost1_max": 419.42118642331076, "cost1_min": 28.048750293158516, "cost2_max": -7.181744591946453, "outflow_rate_mean": 1191.9835653223854, "system_level_velocity_min": 11.403515632255202, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.077767224976242}, "info": {"num_steps_trained": 9816800, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014452594332396984, "total_loss": 10.744640350341797, "vf_loss": 10.74864673614502, "policy_loss": -0.007663806434720755, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9666582942008972, "entropy": 1.1929823160171509}, "grad_time_ms": 10051.667, "load_time_ms": 11.943, "update_time_ms": 7.205, "num_steps_sampled": 9816800, "sample_time_ms": 12584.56}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb796a0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9816800, "hostname": "flow-main", "episodes_total": 3932, "timestamp": 1557235685, "episode_reward_max": 1286.9333126077725, "episode_len_mean": 686.49, "time_total_s": 5560.130665779114, "time_since_restore": 5560.130665779114}
{"timesteps_since_restore": 9856888, "training_iteration": 238, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-28-28", "episode_reward_min": 169.88020864432056, "timesteps_this_iter": 40088, "episode_reward_mean": 1141.9244080822618, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.00320291519165, "policy_reward_mean": {}, "iterations_since_restore": 238, "custom_metrics": {"outflow_rate_max": 1441.7559500499501, "cost2_mean": -26.903098288511828, "cost1_mean": 358.257706489453, "system_level_velocity_mean": 14.199933630379768, "cost2_min": -44.93531043837757, "cost1_max": 419.42118642331076, "cost1_min": 70.80903913917913, "cost2_max": -8.550272503571627, "outflow_rate_mean": 1204.072390779163, "system_level_velocity_min": 11.403515632255202, "outflow_rate_min": 455.31392307113634, "system_level_velocity_max": 18.769678568829853}, "info": {"num_steps_trained": 9856888, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011546052992343903, "total_loss": 17.675090789794922, "vf_loss": 17.678504943847656, "policy_loss": -0.006336068268865347, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9421679377555847, "entropy": 1.1939153671264648}, "grad_time_ms": 10068.797, "load_time_ms": 11.934, "update_time_ms": 7.175, "num_steps_sampled": 9856888, "sample_time_ms": 12529.326}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb725f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9856888, "hostname": "flow-main", "episodes_total": 3948, "timestamp": 1557235708, "episode_reward_max": 1302.1359619438563, "episode_len_mean": 693.06, "time_total_s": 5583.133868694305, "time_since_restore": 5583.133868694305}
{"timesteps_since_restore": 9897360, "training_iteration": 239, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-28-51", "episode_reward_min": 171.4470844009216, "timesteps_this_iter": 40472, "episode_reward_mean": 1148.1687315955005, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.561206102371216, "policy_reward_mean": {}, "iterations_since_restore": 239, "custom_metrics": {"outflow_rate_max": 1441.7559500499501, "cost2_mean": -26.738141890148924, "cost1_mean": 359.658652590227, "system_level_velocity_mean": 14.361845087529145, "cost2_min": -57.01057047917087, "cost1_max": 419.42118642331076, "cost1_min": 68.01899856419494, "cost2_max": -8.951058817656593, "outflow_rate_mean": 1207.7108733670132, "system_level_velocity_min": 11.403515632255202, "outflow_rate_min": 448.49867121020134, "system_level_velocity_max": 17.54526291497303}, "info": {"num_steps_trained": 9897360, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01413932628929615, "total_loss": 20.459367752075195, "vf_loss": 20.464122772216797, "policy_loss": -0.008333871141076088, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9341569542884827, "entropy": 1.1738998889923096}, "grad_time_ms": 10104.021, "load_time_ms": 11.82, "update_time_ms": 7.232, "num_steps_sampled": 9897360, "sample_time_ms": 12450.509}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fa58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9897360, "hostname": "flow-main", "episodes_total": 3967, "timestamp": 1557235731, "episode_reward_max": 1339.5031603309644, "episode_len_mean": 687.65, "time_total_s": 5605.695074796677, "time_since_restore": 5605.695074796677}
{"timesteps_since_restore": 9937005, "training_iteration": 240, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-29-14", "episode_reward_min": 171.4470844009216, "timesteps_this_iter": 39645, "episode_reward_mean": 1152.8605458460258, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.743707418441772, "policy_reward_mean": {}, "iterations_since_restore": 240, "custom_metrics": {"outflow_rate_max": 1441.7559500499501, "cost2_mean": -26.402535146334934, "cost1_mean": 358.6351285216093, "system_level_velocity_mean": 14.422377615995156, "cost2_min": -57.01057047917087, "cost1_max": 419.42118642331076, "cost1_min": 68.01899856419494, "cost2_max": -8.951058817656593, "outflow_rate_mean": 1204.587452781212, "system_level_velocity_min": 12.018992646154347, "outflow_rate_min": 420.3671621991381, "system_level_velocity_max": 17.54526291497303}, "info": {"num_steps_trained": 9937005, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015103830955922604, "total_loss": 15.36684799194336, "vf_loss": 15.369848251342773, "policy_loss": -0.006825434509664774, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9556702971458435, "entropy": 1.1951067447662354}, "grad_time_ms": 10102.992, "load_time_ms": 11.902, "update_time_ms": 7.171, "num_steps_sampled": 9937005, "sample_time_ms": 12530.588}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72828>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9937005, "hostname": "flow-main", "episodes_total": 3986, "timestamp": 1557235754, "episode_reward_max": 1360.8876419912795, "episode_len_mean": 682.79, "time_total_s": 5628.438782215118, "time_since_restore": 5628.438782215118}
{"timesteps_since_restore": 9976925, "training_iteration": 241, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-29-36", "episode_reward_min": 171.4470844009216, "timesteps_this_iter": 39920, "episode_reward_mean": 1141.4392153000815, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.699788331985474, "policy_reward_mean": {}, "iterations_since_restore": 241, "custom_metrics": {"outflow_rate_max": 1441.7559500499501, "cost2_mean": -26.345407843890076, "cost1_mean": 355.7261702738615, "system_level_velocity_mean": 14.447359398860327, "cost2_min": -57.01057047917087, "cost1_max": 428.40040945069444, "cost1_min": 68.01899856419494, "cost2_max": -8.951058817656593, "outflow_rate_mean": 1197.9578716749747, "system_level_velocity_min": 11.805090270734143, "outflow_rate_min": 420.3671621991381, "system_level_velocity_max": 18.535832611089546}, "info": {"num_steps_trained": 9976925, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01410116907209158, "total_loss": 15.655386924743652, "vf_loss": 15.66168212890625, "policy_loss": -0.009866283275187016, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9452098608016968, "entropy": 1.2089587450027466}, "grad_time_ms": 10097.962, "load_time_ms": 12.286, "update_time_ms": 7.282, "num_steps_sampled": 9976925, "sample_time_ms": 12563.4}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fbe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb790f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 9976925, "hostname": "flow-main", "episodes_total": 4004, "timestamp": 1557235776, "episode_reward_max": 1360.8876419912795, "episode_len_mean": 677.13, "time_total_s": 5651.138570547104, "time_since_restore": 5651.138570547104}
{"timesteps_since_restore": 10017458, "training_iteration": 242, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-29-59", "episode_reward_min": 171.4470844009216, "timesteps_this_iter": 40533, "episode_reward_mean": 1138.8299411222179, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.083537817001343, "policy_reward_mean": {}, "iterations_since_restore": 242, "custom_metrics": {"outflow_rate_max": 1410.331757842158, "cost2_mean": -27.325757406671137, "cost1_mean": 353.72217548183085, "system_level_velocity_mean": 14.359947294737616, "cost2_min": -57.01057047917087, "cost1_max": 428.40040945069444, "cost1_min": 68.01899856419494, "cost2_max": -8.951058817656593, "outflow_rate_mean": 1191.4645705560936, "system_level_velocity_min": 11.805090270734143, "outflow_rate_min": 420.3671621991381, "system_level_velocity_max": 18.535832611089546}, "info": {"num_steps_trained": 10017458, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013831508345901966, "total_loss": 10.903886795043945, "vf_loss": 10.908185958862305, "policy_loss": -0.00780126778408885, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9659106135368347, "entropy": 1.1930208206176758}, "grad_time_ms": 10113.251, "load_time_ms": 12.825, "update_time_ms": 7.055, "num_steps_sampled": 10017458, "sample_time_ms": 12571.918}, "episodes_this_iter": 13, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fa90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f400>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10017458, "hostname": "flow-main", "episodes_total": 4017, "timestamp": 1557235799, "episode_reward_max": 1360.8876419912795, "episode_len_mean": 677.13, "time_total_s": 5674.222108364105, "time_since_restore": 5674.222108364105}
{"timesteps_since_restore": 10058042, "training_iteration": 243, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-30-22", "episode_reward_min": 171.4470844009216, "timesteps_this_iter": 40584, "episode_reward_mean": 1129.8453147320406, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.658921718597412, "policy_reward_mean": {}, "iterations_since_restore": 243, "custom_metrics": {"outflow_rate_max": 1428.7089158841156, "cost2_mean": -27.07325292377297, "cost1_mean": 351.46017598397026, "system_level_velocity_mean": 14.418702785463383, "cost2_min": -57.01057047917087, "cost1_max": 428.40040945069444, "cost1_min": 68.01899856419494, "cost2_max": -8.951058817656593, "outflow_rate_mean": 1185.5340728192214, "system_level_velocity_min": 11.805090270734143, "outflow_rate_min": 420.3671621991381, "system_level_velocity_max": 18.535832611089546}, "info": {"num_steps_trained": 10058042, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013523380272090435, "total_loss": 15.293322563171387, "vf_loss": 15.298514366149902, "policy_loss": -0.008613320998847485, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9420425891876221, "entropy": 1.1862224340438843}, "grad_time_ms": 10201.127, "load_time_ms": 12.874, "update_time_ms": 6.802, "num_steps_sampled": 10058042, "sample_time_ms": 12495.229}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f9b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10058042, "hostname": "flow-main", "episodes_total": 4033, "timestamp": 1557235822, "episode_reward_max": 1360.8876419912795, "episode_len_mean": 671.61, "time_total_s": 5696.881030082703, "time_since_restore": 5696.881030082703}
{"timesteps_since_restore": 10097097, "training_iteration": 244, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-30-45", "episode_reward_min": 171.4470844009216, "timesteps_this_iter": 39055, "episode_reward_mean": 1131.8735865302497, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.98086905479431, "policy_reward_mean": {}, "iterations_since_restore": 244, "custom_metrics": {"outflow_rate_max": 1428.7089158841156, "cost2_mean": -27.803624181613813, "cost1_mean": 351.1450813243614, "system_level_velocity_mean": 14.39983676538775, "cost2_min": -57.01057047917087, "cost1_max": 462.3253228803143, "cost1_min": 68.01899856419494, "cost2_max": -8.951058817656593, "outflow_rate_mean": 1181.4058900739665, "system_level_velocity_min": 11.805090270734143, "outflow_rate_min": 420.3671621991381, "system_level_velocity_max": 18.535832611089546}, "info": {"num_steps_trained": 10097097, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013576485216617584, "total_loss": 17.892263412475586, "vf_loss": 17.896398544311523, "policy_loss": -0.007569108158349991, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9447931051254272, "entropy": 1.2110244035720825}, "grad_time_ms": 10185.402, "load_time_ms": 12.6, "update_time_ms": 7.005, "num_steps_sampled": 10097097, "sample_time_ms": 12555.808}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116feb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fe10>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10097097, "hostname": "flow-main", "episodes_total": 4051, "timestamp": 1557235845, "episode_reward_max": 1457.8050052278409, "episode_len_mean": 671.61, "time_total_s": 5719.861899137497, "time_since_restore": 5719.861899137497}
{"timesteps_since_restore": 10136326, "training_iteration": 245, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-31-08", "episode_reward_min": 193.21430776430762, "timesteps_this_iter": 39229, "episode_reward_mean": 1122.7462721124953, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.155651330947876, "policy_reward_mean": {}, "iterations_since_restore": 245, "custom_metrics": {"outflow_rate_max": 1428.7089158841156, "cost2_mean": -27.15501756193422, "cost1_mean": 354.05121529270474, "system_level_velocity_mean": 14.53057784752974, "cost2_min": -47.587878847314116, "cost1_max": 462.3253228803143, "cost1_min": 73.31961426591133, "cost2_max": -9.713203911507664, "outflow_rate_mean": 1192.7177087095658, "system_level_velocity_min": 11.805090270734143, "outflow_rate_min": 420.3671621991381, "system_level_velocity_max": 18.535832611089546}, "info": {"num_steps_trained": 10136326, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014469427056610584, "total_loss": 20.9824161529541, "vf_loss": 20.986021041870117, "policy_loss": -0.007270636968314648, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9310409426689148, "entropy": 1.225795030593872}, "grad_time_ms": 10211.296, "load_time_ms": 12.441, "update_time_ms": 7.078, "num_steps_sampled": 10136326, "sample_time_ms": 12570.912}, "episodes_this_iter": 21, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fa58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f470>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10136326, "hostname": "flow-main", "episodes_total": 4072, "timestamp": 1557235868, "episode_reward_max": 1457.8050052278409, "episode_len_mean": 672.44, "time_total_s": 5743.017550468445, "time_since_restore": 5743.017550468445}
{"timesteps_since_restore": 10175113, "training_iteration": 246, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-31-31", "episode_reward_min": 205.49699803736777, "timesteps_this_iter": 38787, "episode_reward_mean": 1114.6580105754513, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.864089488983154, "policy_reward_mean": {}, "iterations_since_restore": 246, "custom_metrics": {"outflow_rate_max": 1428.7089158841156, "cost2_mean": -27.773225701483966, "cost1_mean": 352.4792581146163, "system_level_velocity_mean": 14.490978653608906, "cost2_min": -47.587878847314116, "cost1_max": 462.3253228803143, "cost1_min": 90.43714664119435, "cost2_max": -10.964772725547318, "outflow_rate_mean": 1186.1873788611795, "system_level_velocity_min": 11.805090270734143, "outflow_rate_min": 498.1159452720836, "system_level_velocity_max": 18.535832611089546}, "info": {"num_steps_trained": 10175113, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013785692863166332, "total_loss": 17.413530349731445, "vf_loss": 17.417890548706055, "policy_loss": -0.00785037036985159, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9453885555267334, "entropy": 1.1980931758880615}, "grad_time_ms": 10167.284, "load_time_ms": 12.143, "update_time_ms": 7.347, "num_steps_sampled": 10175113, "sample_time_ms": 12524.315}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fe10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f6d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10175113, "hostname": "flow-main", "episodes_total": 4092, "timestamp": 1557235891, "episode_reward_max": 1457.8050052278409, "episode_len_mean": 672.91, "time_total_s": 5765.881639957428, "time_since_restore": 5765.881639957428}
{"timesteps_since_restore": 10214024, "training_iteration": 247, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-31-54", "episode_reward_min": 51.83871860842777, "timesteps_this_iter": 38911, "episode_reward_mean": 1108.9052020406377, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.389105081558228, "policy_reward_mean": {}, "iterations_since_restore": 247, "custom_metrics": {"outflow_rate_max": 1497.20872967033, "cost2_mean": -27.54653267903019, "cost1_mean": 352.016837954626, "system_level_velocity_mean": 14.614356924766996, "cost2_min": -50.027903093434915, "cost1_max": 462.3253228803143, "cost1_min": 28.533677930889624, "cost2_max": -6.650484913125662, "outflow_rate_mean": 1190.3579810070844, "system_level_velocity_min": 11.993102014924675, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.346178280120743}, "info": {"num_steps_trained": 10214024, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013768193311989307, "total_loss": 21.503873825073242, "vf_loss": 21.50897979736328, "policy_loss": -0.00859083328396082, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.925846517086029, "entropy": 1.1956061124801636}, "grad_time_ms": 10142.747, "load_time_ms": 12.157, "update_time_ms": 7.518, "num_steps_sampled": 10214024, "sample_time_ms": 12571.813}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79c18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10214024, "hostname": "flow-main", "episodes_total": 4110, "timestamp": 1557235914, "episode_reward_max": 1457.8050052278409, "episode_len_mean": 668.59, "time_total_s": 5788.270745038986, "time_since_restore": 5788.270745038986}
{"timesteps_since_restore": 10255172, "training_iteration": 248, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-32-16", "episode_reward_min": 51.83871860842777, "timesteps_this_iter": 41148, "episode_reward_mean": 1110.1719865026994, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.444911003112793, "policy_reward_mean": {}, "iterations_since_restore": 248, "custom_metrics": {"outflow_rate_max": 1497.20872967033, "cost2_mean": -27.47677187517662, "cost1_mean": 353.3524085225578, "system_level_velocity_mean": 14.685456596569127, "cost2_min": -50.027903093434915, "cost1_max": 462.3253228803143, "cost1_min": 28.533677930889624, "cost2_max": -6.650484913125662, "outflow_rate_mean": 1193.6870389651262, "system_level_velocity_min": 11.993102014924675, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.346178280120743}, "info": {"num_steps_trained": 10255172, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015213562175631523, "total_loss": 11.521294593811035, "vf_loss": 11.526061058044434, "policy_loss": -0.008617766201496124, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.962958037853241, "entropy": 1.1924163103103638}, "grad_time_ms": 10162.47, "load_time_ms": 12.308, "update_time_ms": 7.492, "num_steps_sampled": 10255172, "sample_time_ms": 12496.001}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79d68>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10255172, "hostname": "flow-main", "episodes_total": 4124, "timestamp": 1557235936, "episode_reward_max": 1457.8050052278409, "episode_len_mean": 668.59, "time_total_s": 5810.715656042099, "time_since_restore": 5810.715656042099}
{"timesteps_since_restore": 10295221, "training_iteration": 249, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-32-41", "episode_reward_min": 51.83871860842777, "timesteps_this_iter": 40049, "episode_reward_mean": 1084.042416308434, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.573894500732422, "policy_reward_mean": {}, "iterations_since_restore": 249, "custom_metrics": {"outflow_rate_max": 1497.20872967033, "cost2_mean": -27.925861723790202, "cost1_mean": 345.9675036465833, "system_level_velocity_mean": 14.72088555975853, "cost2_min": -57.19728297036913, "cost1_max": 427.30611923063344, "cost1_min": 28.533677930889624, "cost2_max": -6.650484913125662, "outflow_rate_mean": 1174.7662588745156, "system_level_velocity_min": 12.070191232660587, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.346178280120743}, "info": {"num_steps_trained": 10295221, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014066006988286972, "total_loss": 19.550273895263672, "vf_loss": 19.555219650268555, "policy_loss": -0.008507807739078999, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9400761127471924, "entropy": 1.2091633081436157}, "grad_time_ms": 10258.287, "load_time_ms": 12.338, "update_time_ms": 7.574, "num_steps_sampled": 10295221, "sample_time_ms": 12601.084}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6eb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f780>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10295221, "hostname": "flow-main", "episodes_total": 4142, "timestamp": 1557235961, "episode_reward_max": 1409.8072813751, "episode_len_mean": 656.77, "time_total_s": 5835.289550542831, "time_since_restore": 5835.289550542831}
{"timesteps_since_restore": 10334444, "training_iteration": 250, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-33-04", "episode_reward_min": 51.83871860842777, "timesteps_this_iter": 39223, "episode_reward_mean": 1041.7907475637423, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.307766675949097, "policy_reward_mean": {}, "iterations_since_restore": 250, "custom_metrics": {"outflow_rate_max": 1497.20872967033, "cost2_mean": -27.674178704764245, "cost1_mean": 335.2562687374669, "system_level_velocity_mean": 14.795286412357035, "cost2_min": -57.19728297036913, "cost1_max": 427.30611923063344, "cost1_min": 28.533677930889624, "cost2_max": -6.650484913125662, "outflow_rate_mean": 1150.8679025950419, "system_level_velocity_min": 11.68623730173888, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.346178280120743}, "info": {"num_steps_trained": 10334444, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013601724058389664, "total_loss": 20.268756866455078, "vf_loss": 20.273380279541016, "policy_loss": -0.008064587600529194, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9375588297843933, "entropy": 1.2195512056350708}, "grad_time_ms": 10287.227, "load_time_ms": 12.16, "update_time_ms": 7.576, "num_steps_sampled": 10334444, "sample_time_ms": 12629.786}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fa58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f8d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10334444, "hostname": "flow-main", "episodes_total": 4162, "timestamp": 1557235984, "episode_reward_max": 1409.8072813751, "episode_len_mean": 636.79, "time_total_s": 5858.5973172187805, "time_since_restore": 5858.5973172187805}
{"timesteps_since_restore": 10373676, "training_iteration": 251, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-33-27", "episode_reward_min": 51.83871860842777, "timesteps_this_iter": 39232, "episode_reward_mean": 1060.3246995772297, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.517715454101562, "policy_reward_mean": {}, "iterations_since_restore": 251, "custom_metrics": {"outflow_rate_max": 1497.20872967033, "cost2_mean": -28.081481842866943, "cost1_mean": 341.1949291535953, "system_level_velocity_mean": 14.764950666460779, "cost2_min": -57.19728297036913, "cost1_max": 427.30611923063344, "cost1_min": 28.533677930889624, "cost2_max": -6.650484913125662, "outflow_rate_mean": 1164.692144290731, "system_level_velocity_min": 11.68623730173888, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.346178280120743}, "info": {"num_steps_trained": 10373676, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013566863723099232, "total_loss": 19.897729873657227, "vf_loss": 19.902446746826172, "policy_loss": -0.00814820546656847, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.922014594078064, "entropy": 1.2368788719177246}, "grad_time_ms": 10289.472, "load_time_ms": 11.598, "update_time_ms": 7.513, "num_steps_sampled": 10373676, "sample_time_ms": 12609.923}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f630>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10373676, "hostname": "flow-main", "episodes_total": 4181, "timestamp": 1557236007, "episode_reward_max": 1409.8072813751, "episode_len_mean": 647.31, "time_total_s": 5881.115032672882, "time_since_restore": 5881.115032672882}
{"timesteps_since_restore": 10413618, "training_iteration": 252, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-33-49", "episode_reward_min": 159.39801435708264, "timesteps_this_iter": 39942, "episode_reward_mean": 1067.874693281822, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.66127300262451, "policy_reward_mean": {}, "iterations_since_restore": 252, "custom_metrics": {"outflow_rate_max": 1497.20872967033, "cost2_mean": -28.03579617762968, "cost1_mean": 343.1436239963431, "system_level_velocity_mean": 14.687766467768695, "cost2_min": -57.19728297036913, "cost1_max": 427.30611923063344, "cost1_min": 67.91218819462917, "cost2_max": -7.802303204199604, "outflow_rate_mean": 1163.6865945612608, "system_level_velocity_min": 11.68623730173888, "outflow_rate_min": 439.6843258685496, "system_level_velocity_max": 18.45534102978297}, "info": {"num_steps_trained": 10413618, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015227696858346462, "total_loss": 15.513900756835938, "vf_loss": 15.517903327941895, "policy_loss": -0.007859128527343273, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9495053291320801, "entropy": 1.220517635345459}, "grad_time_ms": 10261.181, "load_time_ms": 11.441, "update_time_ms": 7.563, "num_steps_sampled": 10413618, "sample_time_ms": 12595.782}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fe48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10413618, "hostname": "flow-main", "episodes_total": 4201, "timestamp": 1557236029, "episode_reward_max": 1409.8072813751, "episode_len_mean": 653.37, "time_total_s": 5903.776305675507, "time_since_restore": 5903.776305675507}
{"timesteps_since_restore": 10453655, "training_iteration": 253, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-34-13", "episode_reward_min": 159.39801435708264, "timesteps_this_iter": 40037, "episode_reward_mean": 1072.3708031852493, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.569713830947876, "policy_reward_mean": {}, "iterations_since_restore": 253, "custom_metrics": {"outflow_rate_max": 1434.1968915084917, "cost2_mean": -28.03840954972211, "cost1_mean": 343.46725205782974, "system_level_velocity_mean": 14.623360449394877, "cost2_min": -69.41801974139722, "cost1_max": 427.30611923063344, "cost1_min": 67.91218819462917, "cost2_max": -7.802303204199604, "outflow_rate_mean": 1163.3795817511295, "system_level_velocity_min": 11.167786384943362, "outflow_rate_min": 439.6843258685496, "system_level_velocity_max": 18.45534102978297}, "info": {"num_steps_trained": 10453655, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014346173033118248, "total_loss": 14.658300399780273, "vf_loss": 14.665827751159668, "policy_loss": -0.011159348301589489, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9477577209472656, "entropy": 1.2275285720825195}, "grad_time_ms": 10185.898, "load_time_ms": 10.936, "update_time_ms": 7.703, "num_steps_sampled": 10453655, "sample_time_ms": 12763.144}, "episodes_this_iter": 13, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79ba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10453655, "hostname": "flow-main", "episodes_total": 4214, "timestamp": 1557236053, "episode_reward_max": 1409.8072813751, "episode_len_mean": 656.78, "time_total_s": 5927.3460195064545, "time_since_restore": 5927.3460195064545}
{"timesteps_since_restore": 10493466, "training_iteration": 254, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-34-36", "episode_reward_min": 159.39801435708264, "timesteps_this_iter": 39811, "episode_reward_mean": 1079.7587712403715, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.930073499679565, "policy_reward_mean": {}, "iterations_since_restore": 254, "custom_metrics": {"outflow_rate_max": 1434.1968915084917, "cost2_mean": -27.537940768032897, "cost1_mean": 344.91802932511274, "system_level_velocity_mean": 14.523979140514003, "cost2_min": -69.41801974139722, "cost1_max": 427.30611923063344, "cost1_min": 67.91218819462917, "cost2_max": -7.802303204199604, "outflow_rate_mean": 1166.052644007429, "system_level_velocity_min": 11.167786384943362, "outflow_rate_min": 439.6843258685496, "system_level_velocity_max": 18.415153334472297}, "info": {"num_steps_trained": 10493466, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012628952041268349, "total_loss": 11.134984970092773, "vf_loss": 11.139369010925293, "policy_loss": -0.007579762022942305, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9622220993041992, "entropy": 1.214465618133545}, "grad_time_ms": 10197.23, "load_time_ms": 10.975, "update_time_ms": 7.534, "num_steps_sampled": 10493466, "sample_time_ms": 12745.784}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb790b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10493466, "hostname": "flow-main", "episodes_total": 4231, "timestamp": 1557236076, "episode_reward_max": 1409.8072813751, "episode_len_mean": 662.34, "time_total_s": 5950.276093006134, "time_since_restore": 5950.276093006134}
{"timesteps_since_restore": 10533849, "training_iteration": 255, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-34-59", "episode_reward_min": 159.39801435708264, "timesteps_this_iter": 40383, "episode_reward_mean": 1095.5877512116515, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.38212299346924, "policy_reward_mean": {}, "iterations_since_restore": 255, "custom_metrics": {"outflow_rate_max": 1434.1968915084917, "cost2_mean": -27.336398942646138, "cost1_mean": 349.4436857746784, "system_level_velocity_mean": 14.392897577578657, "cost2_min": -69.41801974139722, "cost1_max": 410.6548331420993, "cost1_min": 69.97348397493634, "cost2_max": -8.178226268625577, "outflow_rate_mean": 1175.114189268922, "system_level_velocity_min": 11.167786384943362, "outflow_rate_min": 439.6843258685496, "system_level_velocity_max": 18.08545281376178}, "info": {"num_steps_trained": 10533849, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013451545499265194, "total_loss": 12.504761695861816, "vf_loss": 12.509011268615723, "policy_loss": -0.0076543837785720825, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9597310423851013, "entropy": 1.2177234888076782}, "grad_time_ms": 10147.878, "load_time_ms": 11.073, "update_time_ms": 7.536, "num_steps_sampled": 10533849, "sample_time_ms": 12820.515}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f940>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10533849, "hostname": "flow-main", "episodes_total": 4246, "timestamp": 1557236099, "episode_reward_max": 1256.0489975877397, "episode_len_mean": 674.12, "time_total_s": 5973.658215999603, "time_since_restore": 5973.658215999603}
{"timesteps_since_restore": 10574594, "training_iteration": 256, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-35-22", "episode_reward_min": 161.9397922974273, "timesteps_this_iter": 40745, "episode_reward_mean": 1131.4207861298687, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.43540358543396, "policy_reward_mean": {}, "iterations_since_restore": 256, "custom_metrics": {"outflow_rate_max": 1434.1968915084917, "cost2_mean": -26.103496773169464, "cost1_mean": 358.2532566054927, "system_level_velocity_mean": 14.294071639402771, "cost2_min": -69.41801974139722, "cost1_max": 407.36271962877606, "cost1_min": 71.30280815404792, "cost2_max": -9.993715931616427, "outflow_rate_mean": 1192.3931645636485, "system_level_velocity_min": 11.167786384943362, "outflow_rate_min": 439.6843258685496, "system_level_velocity_max": 17.889745189160287}, "info": {"num_steps_trained": 10574594, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013853982090950012, "total_loss": 15.624710083007812, "vf_loss": 15.62850570678711, "policy_loss": -0.007302011363208294, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9447524547576904, "entropy": 1.2178847789764404}, "grad_time_ms": 10200.301, "load_time_ms": 11.244, "update_time_ms": 7.153, "num_steps_sampled": 10574594, "sample_time_ms": 12724.728}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb795f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79ba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10574594, "hostname": "flow-main", "episodes_total": 4263, "timestamp": 1557236122, "episode_reward_max": 1294.1313240030042, "episode_len_mean": 691.87, "time_total_s": 5996.093619585037, "time_since_restore": 5996.093619585037}
{"timesteps_since_restore": 10613084, "training_iteration": 257, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-35-43", "episode_reward_min": 161.9397922974273, "timesteps_this_iter": 38490, "episode_reward_mean": 1133.752233263963, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.564782857894897, "policy_reward_mean": {}, "iterations_since_restore": 257, "custom_metrics": {"outflow_rate_max": 1396.940240959041, "cost2_mean": -24.889434018871953, "cost1_mean": 353.0108705895147, "system_level_velocity_mean": 14.182810024387969, "cost2_min": -69.41801974139722, "cost1_max": 405.63087910841335, "cost1_min": 71.30280815404792, "cost2_max": -9.993715931616427, "outflow_rate_mean": 1182.2079233785591, "system_level_velocity_min": 11.167786384943362, "outflow_rate_min": 439.6843258685496, "system_level_velocity_max": 17.889745189160287}, "info": {"num_steps_trained": 10613084, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014658050611615181, "total_loss": 19.5052547454834, "vf_loss": 19.508934020996094, "policy_loss": -0.007391214370727539, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9322420358657837, "entropy": 1.2267087697982788}, "grad_time_ms": 10178.306, "load_time_ms": 11.665, "update_time_ms": 7.157, "num_steps_sampled": 10613084, "sample_time_ms": 12664.924}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fdd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fa90>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10613084, "hostname": "flow-main", "episodes_total": 4283, "timestamp": 1557236143, "episode_reward_max": 1310.2448489665294, "episode_len_mean": 687.06, "time_total_s": 6017.658402442932, "time_since_restore": 6017.658402442932}
{"timesteps_since_restore": 10651958, "training_iteration": 258, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-36-06", "episode_reward_min": 394.72209095193773, "timesteps_this_iter": 38874, "episode_reward_mean": 1150.2853012665596, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.573243618011475, "policy_reward_mean": {}, "iterations_since_restore": 258, "custom_metrics": {"outflow_rate_max": 1396.940240959041, "cost2_mean": -23.731787751013563, "cost1_mean": 357.1884970502304, "system_level_velocity_mean": 14.161219174728645, "cost2_min": -69.41801974139722, "cost1_max": 416.31245727345515, "cost1_min": 139.15367233913992, "cost2_max": -11.800162082056557, "outflow_rate_mean": 1192.9373414265667, "system_level_velocity_min": 11.167786384943362, "outflow_rate_min": 742.8350495230158, "system_level_velocity_max": 17.24843771515533}, "info": {"num_steps_trained": 10651958, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013650424778461456, "total_loss": 12.284749984741211, "vf_loss": 12.289183616638184, "policy_loss": -0.0078881299123168, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9585015177726746, "entropy": 1.220600962638855}, "grad_time_ms": 10126.225, "load_time_ms": 11.488, "update_time_ms": 7.151, "num_steps_sampled": 10651958, "sample_time_ms": 12729.77}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fcc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f0f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10651958, "hostname": "flow-main", "episodes_total": 4301, "timestamp": 1557236166, "episode_reward_max": 1310.2448489665294, "episode_len_mean": 692.96, "time_total_s": 6040.231646060944, "time_since_restore": 6040.231646060944}
{"timesteps_since_restore": 10691853, "training_iteration": 259, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-36-29", "episode_reward_min": 375.4973152674641, "timesteps_this_iter": 39895, "episode_reward_mean": 1143.5009118466803, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.47362232208252, "policy_reward_mean": {}, "iterations_since_restore": 259, "custom_metrics": {"outflow_rate_max": 1396.940240959041, "cost2_mean": -22.55792683776359, "cost1_mean": 355.3699743952865, "system_level_velocity_mean": 14.180138031942503, "cost2_min": -51.172872670692215, "cost1_max": 416.31245727345515, "cost1_min": 139.15367233913992, "cost2_max": -6.7620723887267316, "outflow_rate_mean": 1189.278044449715, "system_level_velocity_min": 11.342433275788323, "outflow_rate_min": 742.8350495230158, "system_level_velocity_max": 17.24843771515533}, "info": {"num_steps_trained": 10691853, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013727029785513878, "total_loss": 22.19904327392578, "vf_loss": 22.204755783081055, "policy_loss": -0.009187892079353333, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9241273999214172, "entropy": 1.2284321784973145}, "grad_time_ms": 10002.532, "load_time_ms": 11.501, "update_time_ms": 7.105, "num_steps_sampled": 10691853, "sample_time_ms": 12743.115}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79748>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10691853, "hostname": "flow-main", "episodes_total": 4317, "timestamp": 1557236189, "episode_reward_max": 1312.5674103926294, "episode_len_mean": 688.29, "time_total_s": 6063.705268383026, "time_since_restore": 6063.705268383026}
{"timesteps_since_restore": 10730641, "training_iteration": 260, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-36-52", "episode_reward_min": 375.4973152674641, "timesteps_this_iter": 38788, "episode_reward_mean": 1150.486949862513, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.24437165260315, "policy_reward_mean": {}, "iterations_since_restore": 260, "custom_metrics": {"outflow_rate_max": 1396.940240959041, "cost2_mean": -21.147072169982252, "cost1_mean": 356.2770798014376, "system_level_velocity_mean": 14.214297183710325, "cost2_min": -40.692330890959234, "cost1_max": 416.31245727345515, "cost1_min": 139.15367233913992, "cost2_max": -6.7620723887267316, "outflow_rate_mean": 1192.302841728436, "system_level_velocity_min": 11.342433275788323, "outflow_rate_min": 742.8350495230158, "system_level_velocity_max": 17.24843771515533}, "info": {"num_steps_trained": 10730641, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014986581169068813, "total_loss": 15.286665916442871, "vf_loss": 15.291766166687012, "policy_loss": -0.008893507532775402, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9358288049697876, "entropy": 1.2474889755249023}, "grad_time_ms": 9942.847, "load_time_ms": 11.711, "update_time_ms": 7.174, "num_steps_sampled": 10730641, "sample_time_ms": 12695.807}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb789b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78dd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10730641, "hostname": "flow-main", "episodes_total": 4333, "timestamp": 1557236212, "episode_reward_max": 1312.5674103926294, "episode_len_mean": 688.29, "time_total_s": 6085.949640035629, "time_since_restore": 6085.949640035629}
{"timesteps_since_restore": 10769683, "training_iteration": 261, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-37-14", "episode_reward_min": 375.4973152674641, "timesteps_this_iter": 39042, "episode_reward_mean": 1147.4502200525046, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.801385164260864, "policy_reward_mean": {}, "iterations_since_restore": 261, "custom_metrics": {"outflow_rate_max": 1405.1345666333666, "cost2_mean": -20.67453433031291, "cost1_mean": 355.04936429559245, "system_level_velocity_mean": 14.175235383794575, "cost2_min": -38.762315712052505, "cost1_max": 416.31245727345515, "cost1_min": 139.15367233913992, "cost2_max": -6.7620723887267316, "outflow_rate_mean": 1192.2579959101574, "system_level_velocity_min": 11.342433275788323, "outflow_rate_min": 742.8350495230158, "system_level_velocity_max": 17.24843771515533}, "info": {"num_steps_trained": 10769683, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014643669128417969, "total_loss": 17.619571685791016, "vf_loss": 17.6236629486084, "policy_loss": -0.007798430975526571, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9423183798789978, "entropy": 1.2509227991104126}, "grad_time_ms": 9926.391, "load_time_ms": 12.348, "update_time_ms": 7.13, "num_steps_sampled": 10769683, "sample_time_ms": 12740.427}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78b70>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10769683, "hostname": "flow-main", "episodes_total": 4352, "timestamp": 1557236234, "episode_reward_max": 1312.5674103926294, "episode_len_mean": 687.72, "time_total_s": 6108.75102519989, "time_since_restore": 6108.75102519989}
{"timesteps_since_restore": 10809530, "training_iteration": 262, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-37-37", "episode_reward_min": 375.4973152674641, "timesteps_this_iter": 39847, "episode_reward_mean": 1143.8831421497064, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.6999294757843, "policy_reward_mean": {}, "iterations_since_restore": 262, "custom_metrics": {"outflow_rate_max": 1405.1345666333666, "cost2_mean": -20.513587758718053, "cost1_mean": 356.02398893792343, "system_level_velocity_mean": 14.22236383373234, "cost2_min": -38.762315712052505, "cost1_max": 416.31245727345515, "cost1_min": 139.15367233913992, "cost2_max": -6.7620723887267316, "outflow_rate_mean": 1193.4554090809868, "system_level_velocity_min": 11.342433275788323, "outflow_rate_min": 742.8350495230158, "system_level_velocity_max": 17.24843771515533}, "info": {"num_steps_trained": 10809530, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013191442005336285, "total_loss": 13.134007453918457, "vf_loss": 13.138566970825195, "policy_loss": -0.007897289469838142, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9531957507133484, "entropy": 1.2301833629608154}, "grad_time_ms": 9917.7, "load_time_ms": 12.536, "update_time_ms": 7.059, "num_steps_sampled": 10809530, "sample_time_ms": 12752.916}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb794e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10809530, "hostname": "flow-main", "episodes_total": 4368, "timestamp": 1557236257, "episode_reward_max": 1312.5674103926294, "episode_len_mean": 687.72, "time_total_s": 6131.450954675674, "time_since_restore": 6131.450954675674}
{"timesteps_since_restore": 10849270, "training_iteration": 263, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-38-00", "episode_reward_min": 375.4973152674641, "timesteps_this_iter": 39740, "episode_reward_mean": 1145.9439036514973, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.817792892456055, "policy_reward_mean": {}, "iterations_since_restore": 263, "custom_metrics": {"outflow_rate_max": 1405.1345666333666, "cost2_mean": -20.75904831662625, "cost1_mean": 357.82368290458544, "system_level_velocity_mean": 14.17834718025277, "cost2_min": -38.762315712052505, "cost1_max": 416.31245727345515, "cost1_min": 139.88770953217076, "cost2_max": -6.7620723887267316, "outflow_rate_mean": 1195.509703976366, "system_level_velocity_min": 11.342433275788323, "outflow_rate_min": 762.687020796311, "system_level_velocity_max": 16.558438935120606}, "info": {"num_steps_trained": 10849270, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012537463568150997, "total_loss": 10.369974136352539, "vf_loss": 10.372709274291992, "policy_loss": -0.00590816093608737, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9605669379234314, "entropy": 1.2544511556625366}, "grad_time_ms": 9916.44, "load_time_ms": 13.023, "update_time_ms": 6.984, "num_steps_sampled": 10849270, "sample_time_ms": 12678.436}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb799b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb792e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10849270, "hostname": "flow-main", "episodes_total": 4385, "timestamp": 1557236280, "episode_reward_max": 1312.5674103926294, "episode_len_mean": 692.53, "time_total_s": 6154.2687475681305, "time_since_restore": 6154.2687475681305}
{"timesteps_since_restore": 10888356, "training_iteration": 264, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-38-23", "episode_reward_min": 683.0962974981356, "timesteps_this_iter": 39086, "episode_reward_mean": 1149.2545058846308, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.68159008026123, "policy_reward_mean": {}, "iterations_since_restore": 264, "custom_metrics": {"outflow_rate_max": 1405.1345666333666, "cost2_mean": -21.21750380945653, "cost1_mean": 359.11905354009764, "system_level_velocity_mean": 14.131590918299372, "cost2_min": -38.762315712052505, "cost1_max": 410.8089971848135, "cost1_min": 240.84308225764636, "cost2_max": -10.555910709962241, "outflow_rate_mean": 1201.624247886285, "system_level_velocity_min": 11.342433275788323, "outflow_rate_min": 1004.0088867132868, "system_level_velocity_max": 16.429128155736326}, "info": {"num_steps_trained": 10888356, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013733847998082638, "total_loss": 14.26424503326416, "vf_loss": 14.270550727844238, "policy_loss": -0.009780877269804478, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.955845057964325, "entropy": 1.263130784034729}, "grad_time_ms": 9924.59, "load_time_ms": 13.137, "update_time_ms": 7.057, "num_steps_sampled": 10888356, "sample_time_ms": 12646.269}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb794e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10888356, "hostname": "flow-main", "episodes_total": 4403, "timestamp": 1557236303, "episode_reward_max": 1312.5674103926294, "episode_len_mean": 697.2, "time_total_s": 6176.950337648392, "time_since_restore": 6176.950337648392}
{"timesteps_since_restore": 10927897, "training_iteration": 265, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-38-46", "episode_reward_min": 50.001447934183595, "timesteps_this_iter": 39541, "episode_reward_mean": 1138.3639028743185, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.958357334136963, "policy_reward_mean": {}, "iterations_since_restore": 265, "custom_metrics": {"outflow_rate_max": 1405.1345666333666, "cost2_mean": -22.029391470139245, "cost1_mean": 357.26131303857625, "system_level_velocity_mean": 14.2436690783299, "cost2_min": -55.86815415038393, "cost1_max": 410.8089971848135, "cost1_min": 28.033750615476222, "cost2_max": -8.230416187141607, "outflow_rate_mean": 1198.1916995933188, "system_level_velocity_min": 11.44186036289352, "outflow_rate_min": 338.35525222187107, "system_level_velocity_max": 18.90995536649558}, "info": {"num_steps_trained": 10927897, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014248272404074669, "total_loss": 16.554607391357422, "vf_loss": 16.558303833007812, "policy_loss": -0.007304308470338583, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9391852021217346, "entropy": 1.2710274457931519}, "grad_time_ms": 9896.138, "load_time_ms": 13.065, "update_time_ms": 6.955, "num_steps_sampled": 10927897, "sample_time_ms": 12631.983}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f048>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10927897, "hostname": "flow-main", "episodes_total": 4420, "timestamp": 1557236326, "episode_reward_max": 1301.7483071298077, "episode_len_mean": 690.63, "time_total_s": 6199.908694982529, "time_since_restore": 6199.908694982529}
{"timesteps_since_restore": 10966413, "training_iteration": 266, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-39-08", "episode_reward_min": 50.001447934183595, "timesteps_this_iter": 38516, "episode_reward_mean": 1109.9247660515312, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.64332389831543, "policy_reward_mean": {}, "iterations_since_restore": 266, "custom_metrics": {"outflow_rate_max": 1405.1345666333666, "cost2_mean": -22.113487475043335, "cost1_mean": 350.3055257494668, "system_level_velocity_mean": 14.324832774657459, "cost2_min": -55.86815415038393, "cost1_max": 410.8089971848135, "cost1_min": 28.033750615476222, "cost2_max": -8.230416187141607, "outflow_rate_mean": 1183.8682341306055, "system_level_velocity_min": 11.44186036289352, "outflow_rate_min": 338.35525222187107, "system_level_velocity_max": 18.90995536649558}, "info": {"num_steps_trained": 10966413, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013892765156924725, "total_loss": 20.539125442504883, "vf_loss": 20.543397903442383, "policy_loss": -0.00778996292501688, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9311618804931641, "entropy": 1.2793561220169067}, "grad_time_ms": 9819.771, "load_time_ms": 12.96, "update_time_ms": 7.003, "num_steps_sampled": 10966413, "sample_time_ms": 12730.117}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79eb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 10966413, "hostname": "flow-main", "episodes_total": 4439, "timestamp": 1557236348, "episode_reward_max": 1301.7483071298077, "episode_len_mean": 676.59, "time_total_s": 6222.552018880844, "time_since_restore": 6222.552018880844}
{"timesteps_since_restore": 11005662, "training_iteration": 267, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-39-31", "episode_reward_min": 50.001447934183595, "timesteps_this_iter": 39249, "episode_reward_mean": 1099.7530607394453, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.3179132938385, "policy_reward_mean": {}, "iterations_since_restore": 267, "custom_metrics": {"outflow_rate_max": 1401.394870729271, "cost2_mean": -21.676236865156362, "cost1_mean": 348.22250520094747, "system_level_velocity_mean": 14.398865316247038, "cost2_min": -55.86815415038393, "cost1_max": 411.06711628215135, "cost1_min": 28.033750615476222, "cost2_max": -8.230416187141607, "outflow_rate_mean": 1182.609942173449, "system_level_velocity_min": 12.3576721548149, "outflow_rate_min": 338.35525222187107, "system_level_velocity_max": 18.90995536649558}, "info": {"num_steps_trained": 11005662, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014308078214526176, "total_loss": 19.92625617980957, "vf_loss": 19.930713653564453, "policy_loss": -0.008078482002019882, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9228207468986511, "entropy": 1.2478480339050293}, "grad_time_ms": 9820.913, "load_time_ms": 13.111, "update_time_ms": 6.922, "num_steps_sampled": 11005662, "sample_time_ms": 12801.95}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78b38>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11005662, "hostname": "flow-main", "episodes_total": 4457, "timestamp": 1557236371, "episode_reward_max": 1301.7483071298077, "episode_len_mean": 670.24, "time_total_s": 6244.869932174683, "time_since_restore": 6244.869932174683}
{"timesteps_since_restore": 11045301, "training_iteration": 268, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-39-53", "episode_reward_min": 50.001447934183595, "timesteps_this_iter": 39639, "episode_reward_mean": 1105.5884841739885, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.671262741088867, "policy_reward_mean": {}, "iterations_since_restore": 268, "custom_metrics": {"outflow_rate_max": 1401.394870729271, "cost2_mean": -21.95481965279021, "cost1_mean": 346.99153508007396, "system_level_velocity_mean": 14.346998691982032, "cost2_min": -55.86815415038393, "cost1_max": 411.06711628215135, "cost1_min": 28.033750615476222, "cost2_max": -8.230416187141607, "outflow_rate_mean": 1177.3512285910315, "system_level_velocity_min": 12.231553831525458, "outflow_rate_min": 338.35525222187107, "system_level_velocity_max": 18.90995536649558}, "info": {"num_steps_trained": 11045301, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01257597841322422, "total_loss": 14.550430297851562, "vf_loss": 14.553338050842285, "policy_loss": -0.006089725997298956, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9490741491317749, "entropy": 1.2427371740341187}, "grad_time_ms": 9844.848, "load_time_ms": 13.166, "update_time_ms": 7.065, "num_steps_sampled": 11045301, "sample_time_ms": 12787.384}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78550>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11045301, "hostname": "flow-main", "episodes_total": 4474, "timestamp": 1557236393, "episode_reward_max": 1301.7483071298077, "episode_len_mean": 670.24, "time_total_s": 6267.5411949157715, "time_since_restore": 6267.5411949157715}
{"timesteps_since_restore": 11085044, "training_iteration": 269, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-40-16", "episode_reward_min": 50.001447934183595, "timesteps_this_iter": 39743, "episode_reward_mean": 1106.5450158764156, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.875819206237793, "policy_reward_mean": {}, "iterations_since_restore": 269, "custom_metrics": {"outflow_rate_max": 1391.1021870129873, "cost2_mean": -21.215498398116214, "cost1_mean": 348.8011660236251, "system_level_velocity_mean": 14.42776350956825, "cost2_min": -55.86815415038393, "cost1_max": 411.06711628215135, "cost1_min": 28.033750615476222, "cost2_max": -8.230416187141607, "outflow_rate_mean": 1183.0595827488737, "system_level_velocity_min": 12.231553831525458, "outflow_rate_min": 338.35525222187107, "system_level_velocity_max": 18.90995536649558}, "info": {"num_steps_trained": 11085044, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01461559534072876, "total_loss": 16.51416015625, "vf_loss": 16.51840591430664, "policy_loss": -0.007947031408548355, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9390526413917542, "entropy": 1.26007080078125}, "grad_time_ms": 9847.464, "load_time_ms": 13.18, "update_time_ms": 6.979, "num_steps_sampled": 11085044, "sample_time_ms": 12725.237}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb797b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79c88>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11085044, "hostname": "flow-main", "episodes_total": 4492, "timestamp": 1557236416, "episode_reward_max": 1301.7483071298077, "episode_len_mean": 670.24, "time_total_s": 6290.417014122009, "time_since_restore": 6290.417014122009}
{"timesteps_since_restore": 11125426, "training_iteration": 270, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-40-39", "episode_reward_min": 50.001447934183595, "timesteps_this_iter": 40382, "episode_reward_mean": 1102.9518095868316, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.69002866744995, "policy_reward_mean": {}, "iterations_since_restore": 270, "custom_metrics": {"outflow_rate_max": 1391.1021870129873, "cost2_mean": -20.45451449354411, "cost1_mean": 346.0136642965075, "system_level_velocity_mean": 14.440569433686521, "cost2_min": -55.86815415038393, "cost1_max": 411.06711628215135, "cost1_min": 28.033750615476222, "cost2_max": -8.230416187141607, "outflow_rate_mean": 1173.5795181973879, "system_level_velocity_min": 12.231553831525458, "outflow_rate_min": 338.35525222187107, "system_level_velocity_max": 18.90995536649558}, "info": {"num_steps_trained": 11125426, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013142505660653114, "total_loss": 11.354214668273926, "vf_loss": 11.357304573059082, "policy_loss": -0.006416030693799257, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9572741389274597, "entropy": 1.2444120645523071}, "grad_time_ms": 9918.607, "load_time_ms": 13.371, "update_time_ms": 6.969, "num_steps_sampled": 11125426, "sample_time_ms": 12699.022}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78358>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11125426, "hostname": "flow-main", "episodes_total": 4507, "timestamp": 1557236439, "episode_reward_max": 1282.8572305685223, "episode_len_mean": 664.89, "time_total_s": 6313.107042789459, "time_since_restore": 6313.107042789459}
{"timesteps_since_restore": 11165724, "training_iteration": 271, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-41-02", "episode_reward_min": 248.1078155514602, "timesteps_this_iter": 40298, "episode_reward_mean": 1126.4642344722283, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.510764360427856, "policy_reward_mean": {}, "iterations_since_restore": 271, "custom_metrics": {"outflow_rate_max": 1386.019070929071, "cost2_mean": -19.759848741805907, "cost1_mean": 348.3583588398615, "system_level_velocity_mean": 14.32746605620914, "cost2_min": -38.98547365621652, "cost1_max": 411.06711628215135, "cost1_min": 97.41974144283493, "cost2_max": -8.730453836288126, "outflow_rate_mean": 1177.4368249598847, "system_level_velocity_min": 12.231553831525458, "outflow_rate_min": 556.1619617735432, "system_level_velocity_max": 17.357947680400223}, "info": {"num_steps_trained": 11165724, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013308171182870865, "total_loss": 15.154328346252441, "vf_loss": 15.156294822692871, "policy_loss": -0.005333693698048592, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9494078755378723, "entropy": 1.2409017086029053}, "grad_time_ms": 9943.62, "load_time_ms": 13.089, "update_time_ms": 6.998, "num_steps_sampled": 11165724, "sample_time_ms": 12645.066}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb785f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78f98>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11165724, "hostname": "flow-main", "episodes_total": 4524, "timestamp": 1557236462, "episode_reward_max": 1325.2942201234926, "episode_len_mean": 671.46, "time_total_s": 6335.617807149887, "time_since_restore": 6335.617807149887}
{"timesteps_since_restore": 11205903, "training_iteration": 272, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-41-24", "episode_reward_min": 266.7144366247585, "timesteps_this_iter": 40179, "episode_reward_mean": 1153.375156514968, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.71232843399048, "policy_reward_mean": {}, "iterations_since_restore": 272, "custom_metrics": {"outflow_rate_max": 1386.019070929071, "cost2_mean": -20.200605958813316, "cost1_mean": 352.68224005957455, "system_level_velocity_mean": 14.2478077684268, "cost2_min": -44.75525401017644, "cost1_max": 411.06711628215135, "cost1_min": 104.442287649861, "cost2_max": -9.746392217816378, "outflow_rate_mean": 1187.9252121936347, "system_level_velocity_min": 11.954967947802823, "outflow_rate_min": 563.95924754873, "system_level_velocity_max": 17.357947680400223}, "info": {"num_steps_trained": 11205903, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014862393960356712, "total_loss": 14.276276588439941, "vf_loss": 14.280806541442871, "policy_loss": -0.008292530663311481, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9601990580558777, "entropy": 1.2263236045837402}, "grad_time_ms": 9959.414, "load_time_ms": 13.025, "update_time_ms": 7.022, "num_steps_sampled": 11205903, "sample_time_ms": 12630.974}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb797b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb721d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79550>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11205903, "hostname": "flow-main", "episodes_total": 4541, "timestamp": 1557236484, "episode_reward_max": 1325.2942201234926, "episode_len_mean": 680.48, "time_total_s": 6358.330135583878, "time_since_restore": 6358.330135583878}
{"timesteps_since_restore": 11245172, "training_iteration": 273, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-41-47", "episode_reward_min": 188.6809240720973, "timesteps_this_iter": 39269, "episode_reward_mean": 1159.3533711891987, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.30912494659424, "policy_reward_mean": {}, "iterations_since_restore": 273, "custom_metrics": {"outflow_rate_max": 1370.8383072927072, "cost2_mean": -20.782090363250873, "cost1_mean": 353.3147122884334, "system_level_velocity_mean": 14.26376495583339, "cost2_min": -45.69051064379556, "cost1_max": 406.01746081260467, "cost1_min": 81.52597429043796, "cost2_max": -9.613213694275053, "outflow_rate_mean": 1183.8742245654946, "system_level_velocity_min": 11.950153993944129, "outflow_rate_min": 486.5185550448956, "system_level_velocity_max": 17.953383579461782}, "info": {"num_steps_trained": 11245172, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014302008785307407, "total_loss": 16.143817901611328, "vf_loss": 16.14869499206543, "policy_loss": -0.008498064242303371, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9528118371963501, "entropy": 1.2627068758010864}, "grad_time_ms": 9943.141, "load_time_ms": 13.003, "update_time_ms": 6.919, "num_steps_sampled": 11245172, "sample_time_ms": 12596.099}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb789b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb780f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11245172, "hostname": "flow-main", "episodes_total": 4560, "timestamp": 1557236507, "episode_reward_max": 1325.2942201234926, "episode_len_mean": 680.48, "time_total_s": 6380.639260530472, "time_since_restore": 6380.639260530472}
{"timesteps_since_restore": 11285211, "training_iteration": 274, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-42-09", "episode_reward_min": 188.6809240720973, "timesteps_this_iter": 40039, "episode_reward_mean": 1138.7648927849762, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.754822254180908, "policy_reward_mean": {}, "iterations_since_restore": 274, "custom_metrics": {"outflow_rate_max": 1370.8383072927072, "cost2_mean": -20.918925618207926, "cost1_mean": 347.40388560689627, "system_level_velocity_mean": 14.27684265004762, "cost2_min": -50.27187356526584, "cost1_max": 406.01746081260467, "cost1_min": 81.52597429043796, "cost2_max": -9.613213694275053, "outflow_rate_mean": 1170.7528749287455, "system_level_velocity_min": 11.950153993944129, "outflow_rate_min": 486.5185550448956, "system_level_velocity_max": 17.953383579461782}, "info": {"num_steps_trained": 11285211, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012611789628863335, "total_loss": 14.474053382873535, "vf_loss": 14.47741413116455, "policy_loss": -0.006553448271006346, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9512962102890015, "entropy": 1.2406291961669922}, "grad_time_ms": 9960.917, "load_time_ms": 13.055, "update_time_ms": 6.897, "num_steps_sampled": 11285211, "sample_time_ms": 12585.22}, "episodes_this_iter": 21, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11285211, "hostname": "flow-main", "episodes_total": 4581, "timestamp": 1557236529, "episode_reward_max": 1325.2942201234926, "episode_len_mean": 670.07, "time_total_s": 6403.394082784653, "time_since_restore": 6403.394082784653}
{"timesteps_since_restore": 11324972, "training_iteration": 275, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-42-32", "episode_reward_min": 188.6809240720973, "timesteps_this_iter": 39761, "episode_reward_mean": 1143.9661933368006, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.487804651260376, "policy_reward_mean": {}, "iterations_since_restore": 275, "custom_metrics": {"outflow_rate_max": 1370.8383072927072, "cost2_mean": -21.64422055307493, "cost1_mean": 347.6837742856551, "system_level_velocity_mean": 14.273869634225212, "cost2_min": -50.27187356526584, "cost1_max": 406.01746081260467, "cost1_min": 81.52597429043796, "cost2_max": -9.613213694275053, "outflow_rate_mean": 1172.0068866450292, "system_level_velocity_min": 11.950153993944129, "outflow_rate_min": 486.5185550448956, "system_level_velocity_max": 17.953383579461782}, "info": {"num_steps_trained": 11324972, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01369364932179451, "total_loss": 14.049468040466309, "vf_loss": 14.05424976348877, "policy_loss": -0.008248018100857735, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9380263090133667, "entropy": 1.2732129096984863}, "grad_time_ms": 9985.915, "load_time_ms": 13.107, "update_time_ms": 6.923, "num_steps_sampled": 11324972, "sample_time_ms": 12512.795}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78978>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11324972, "hostname": "flow-main", "episodes_total": 4596, "timestamp": 1557236552, "episode_reward_max": 1350.3271179005783, "episode_len_mean": 670.07, "time_total_s": 6425.881887435913, "time_since_restore": 6425.881887435913}
{"timesteps_since_restore": 11366870, "training_iteration": 276, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-42-56", "episode_reward_min": 188.6809240720973, "timesteps_this_iter": 41898, "episode_reward_mean": 1153.6132505625683, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.56373143196106, "policy_reward_mean": {}, "iterations_since_restore": 276, "custom_metrics": {"outflow_rate_max": 1392.6200807192808, "cost2_mean": -22.282402637669023, "cost1_mean": 350.98126581494796, "system_level_velocity_mean": 14.290872645004391, "cost2_min": -50.27187356526584, "cost1_max": 406.01746081260467, "cost1_min": 81.52597429043796, "cost2_max": -9.613213694275053, "outflow_rate_mean": 1181.8516137579538, "system_level_velocity_min": 11.950153993944129, "outflow_rate_min": 486.5185550448956, "system_level_velocity_max": 17.953383579461782}, "info": {"num_steps_trained": 11366870, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01452711969614029, "total_loss": 13.295880317687988, "vf_loss": 13.299649238586426, "policy_loss": -0.007446041330695152, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9546485543251038, "entropy": 1.2553085088729858}, "grad_time_ms": 10146.973, "load_time_ms": 13.188, "update_time_ms": 6.875, "num_steps_sampled": 11366870, "sample_time_ms": 12443.591}, "episodes_this_iter": 14, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb789b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11366870, "hostname": "flow-main", "episodes_total": 4610, "timestamp": 1557236576, "episode_reward_max": 1350.3271179005783, "episode_len_mean": 675.42, "time_total_s": 6449.445618867874, "time_since_restore": 6449.445618867874}
{"timesteps_since_restore": 11406946, "training_iteration": 277, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-43-19", "episode_reward_min": 188.6809240720973, "timesteps_this_iter": 40076, "episode_reward_mean": 1143.0132400389323, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.352863311767578, "policy_reward_mean": {}, "iterations_since_restore": 277, "custom_metrics": {"outflow_rate_max": 1392.6200807192808, "cost2_mean": -23.333198879931842, "cost1_mean": 347.0616875735869, "system_level_velocity_mean": 14.250771539245129, "cost2_min": -50.27187356526584, "cost1_max": 406.01746081260467, "cost1_min": 81.52597429043796, "cost2_max": -9.613213694275053, "outflow_rate_mean": 1174.0536715926623, "system_level_velocity_min": 11.637705965633446, "outflow_rate_min": 486.5185550448956, "system_level_velocity_max": 17.953383579461782}, "info": {"num_steps_trained": 11406946, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014371112920343876, "total_loss": 11.898741722106934, "vf_loss": 11.902017593383789, "policy_loss": -0.006914155557751656, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9634237289428711, "entropy": 1.2676185369491577}, "grad_time_ms": 10212.358, "load_time_ms": 13.12, "update_time_ms": 6.878, "num_steps_sampled": 11406946, "sample_time_ms": 12483.783}, "episodes_this_iter": 16, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fa20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fe10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72b38>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11406946, "hostname": "flow-main", "episodes_total": 4626, "timestamp": 1557236599, "episode_reward_max": 1350.3271179005783, "episode_len_mean": 670.48, "time_total_s": 6472.798482179642, "time_since_restore": 6472.798482179642}
{"timesteps_since_restore": 11446830, "training_iteration": 278, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-43-42", "episode_reward_min": 188.6809240720973, "timesteps_this_iter": 39884, "episode_reward_mean": 1143.9370506631265, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.587307691574097, "policy_reward_mean": {}, "iterations_since_restore": 278, "custom_metrics": {"outflow_rate_max": 1392.6200807192808, "cost2_mean": -23.723045832610545, "cost1_mean": 349.39170045037673, "system_level_velocity_mean": 14.25645241212549, "cost2_min": -52.42349098392462, "cost1_max": 406.01746081260467, "cost1_min": 81.52597429043796, "cost2_max": -9.613213694275053, "outflow_rate_mean": 1178.8633081829985, "system_level_velocity_min": 11.637705965633446, "outflow_rate_min": 486.5185550448956, "system_level_velocity_max": 17.953383579461782}, "info": {"num_steps_trained": 11446830, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014265366829931736, "total_loss": 13.636835098266602, "vf_loss": 13.641438484191895, "policy_loss": -0.008214783854782581, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9577163457870483, "entropy": 1.2624266147613525}, "grad_time_ms": 10215.117, "load_time_ms": 13.243, "update_time_ms": 6.703, "num_steps_sampled": 11446830, "sample_time_ms": 12473.443}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fa58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f1d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11446830, "hostname": "flow-main", "episodes_total": 4646, "timestamp": 1557236622, "episode_reward_max": 1350.3271179005783, "episode_len_mean": 674.34, "time_total_s": 6495.385789871216, "time_since_restore": 6495.385789871216}
{"timesteps_since_restore": 11486977, "training_iteration": 279, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-44-04", "episode_reward_min": 49.304397728812084, "timesteps_this_iter": 40147, "episode_reward_mean": 1146.7230646054888, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.14054298400879, "policy_reward_mean": {}, "iterations_since_restore": 279, "custom_metrics": {"outflow_rate_max": 1392.6200807192808, "cost2_mean": -23.606198159260526, "cost1_mean": 349.88717753524986, "system_level_velocity_mean": 14.304875153532594, "cost2_min": -52.42349098392462, "cost1_max": 406.5232495028477, "cost1_min": 28.003442827635283, "cost2_max": -9.375705642887747, "outflow_rate_mean": 1181.701431877071, "system_level_velocity_min": 11.637705965633446, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.879840749713477}, "info": {"num_steps_trained": 11486977, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01402874756604433, "total_loss": 15.3475341796875, "vf_loss": 15.353543281555176, "policy_loss": -0.009560682810842991, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.952498197555542, "entropy": 1.269210696220398}, "grad_time_ms": 10253.054, "load_time_ms": 13.071, "update_time_ms": 6.699, "num_steps_sampled": 11486977, "sample_time_ms": 12362.197}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fcf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6ef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11486977, "hostname": "flow-main", "episodes_total": 4663, "timestamp": 1557236644, "episode_reward_max": 1350.3271179005783, "episode_len_mean": 673.5, "time_total_s": 6517.526332855225, "time_since_restore": 6517.526332855225}
{"timesteps_since_restore": 11527421, "training_iteration": 280, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-44-27", "episode_reward_min": 49.304397728812084, "timesteps_this_iter": 40444, "episode_reward_mean": 1166.3601258483543, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.46580410003662, "policy_reward_mean": {}, "iterations_since_restore": 280, "custom_metrics": {"outflow_rate_max": 1417.6438249750252, "cost2_mean": -24.218020258267856, "cost1_mean": 354.87341582356663, "system_level_velocity_mean": 14.232334332761166, "cost2_min": -52.42349098392462, "cost1_max": 406.5232495028477, "cost1_min": 28.003442827635283, "cost2_max": -9.375705642887747, "outflow_rate_mean": 1192.422487995338, "system_level_velocity_min": 11.637705965633446, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.879840749713477}, "info": {"num_steps_trained": 11527421, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014963002875447273, "total_loss": 10.85737419128418, "vf_loss": 10.862412452697754, "policy_loss": -0.008824561722576618, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9669629335403442, "entropy": 1.2572505474090576}, "grad_time_ms": 10248.978, "load_time_ms": 12.998, "update_time_ms": 6.742, "num_steps_sampled": 11527421, "sample_time_ms": 12442.612}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f128>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11527421, "hostname": "flow-main", "episodes_total": 4681, "timestamp": 1557236667, "episode_reward_max": 1350.3271179005783, "episode_len_mean": 683.91, "time_total_s": 6540.992136955261, "time_since_restore": 6540.992136955261}
{"timesteps_since_restore": 11568593, "training_iteration": 281, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-44-51", "episode_reward_min": 49.304397728812084, "timesteps_this_iter": 41172, "episode_reward_mean": 1164.7359868042427, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.40785813331604, "policy_reward_mean": {}, "iterations_since_restore": 281, "custom_metrics": {"outflow_rate_max": 1417.6438249750252, "cost2_mean": -24.528020768725533, "cost1_mean": 355.88285009843094, "system_level_velocity_mean": 14.264368019254734, "cost2_min": -56.58547957078581, "cost1_max": 407.9681285048637, "cost1_min": 28.003442827635283, "cost2_max": -9.375705642887747, "outflow_rate_mean": 1191.6229603909426, "system_level_velocity_min": 11.637705965633446, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.879840749713477}, "info": {"num_steps_trained": 11568593, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01489329431205988, "total_loss": 11.59951400756836, "vf_loss": 11.604031562805176, "policy_loss": -0.00828753411769867, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9649868011474609, "entropy": 1.2435184717178345}, "grad_time_ms": 10282.059, "load_time_ms": 13.296, "update_time_ms": 7.043, "num_steps_sampled": 11568593, "sample_time_ms": 12498.07}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f400>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11568593, "hostname": "flow-main", "episodes_total": 4698, "timestamp": 1557236691, "episode_reward_max": 1342.214437159819, "episode_len_mean": 683.91, "time_total_s": 6564.399995088577, "time_since_restore": 6564.399995088577}
{"timesteps_since_restore": 11609381, "training_iteration": 282, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-45-13", "episode_reward_min": 49.304397728812084, "timesteps_this_iter": 40788, "episode_reward_mean": 1166.919593879005, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.59024691581726, "policy_reward_mean": {}, "iterations_since_restore": 282, "custom_metrics": {"outflow_rate_max": 1417.6438249750252, "cost2_mean": -25.080106052896006, "cost1_mean": 355.83697391984845, "system_level_velocity_mean": 14.232479510401184, "cost2_min": -59.9340577567512, "cost1_max": 407.9681285048637, "cost1_min": 28.003442827635283, "cost2_max": -9.375705642887747, "outflow_rate_mean": 1186.7463732820513, "system_level_velocity_min": 11.637705965633446, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.879840749713477}, "info": {"num_steps_trained": 11609381, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01350568700581789, "total_loss": 8.24366283416748, "vf_loss": 8.247481346130371, "policy_loss": -0.007236648816615343, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9733681082725525, "entropy": 1.2438416481018066}, "grad_time_ms": 10308.789, "load_time_ms": 13.204, "update_time_ms": 7.225, "num_steps_sampled": 11609381, "sample_time_ms": 12458.898}, "episodes_this_iter": 13, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f946116f940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb69278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fa20>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11609381, "hostname": "flow-main", "episodes_total": 4711, "timestamp": 1557236713, "episode_reward_max": 1342.214437159819, "episode_len_mean": 683.91, "time_total_s": 6586.9902420043945, "time_since_restore": 6586.9902420043945}
{"timesteps_since_restore": 11650428, "training_iteration": 283, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-45-37", "episode_reward_min": 49.304397728812084, "timesteps_this_iter": 41047, "episode_reward_mean": 1161.426704205408, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.581231355667114, "policy_reward_mean": {}, "iterations_since_restore": 283, "custom_metrics": {"outflow_rate_max": 1417.6438249750252, "cost2_mean": -25.27558765463169, "cost1_mean": 356.82936638293336, "system_level_velocity_mean": 14.288476545706517, "cost2_min": -59.9340577567512, "cost1_max": 407.9681285048637, "cost1_min": 28.003442827635283, "cost2_max": -9.375705642887747, "outflow_rate_mean": 1187.7294735187202, "system_level_velocity_min": 11.698873436306169, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.879840749713477}, "info": {"num_steps_trained": 11650428, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01826944388449192, "total_loss": 14.343246459960938, "vf_loss": 14.34466552734375, "policy_loss": -0.0060434481129050255, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9542333483695984, "entropy": 1.2584997415542603}, "grad_time_ms": 10346.509, "load_time_ms": 13.22, "update_time_ms": 7.328, "num_steps_sampled": 11650428, "sample_time_ms": 12548.467}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb796a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79048>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11650428, "hostname": "flow-main", "episodes_total": 4729, "timestamp": 1557236737, "episode_reward_max": 1315.7314404306153, "episode_len_mean": 683.05, "time_total_s": 6610.571473360062, "time_since_restore": 6610.571473360062}
{"timesteps_since_restore": 11691151, "training_iteration": 284, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-45-59", "episode_reward_min": 49.304397728812084, "timesteps_this_iter": 40723, "episode_reward_mean": 1165.4605643599984, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.408564567565918, "policy_reward_mean": {}, "iterations_since_restore": 284, "custom_metrics": {"outflow_rate_max": 1417.6438249750252, "cost2_mean": -25.677396576888658, "cost1_mean": 355.5917265623044, "system_level_velocity_mean": 14.300342096603345, "cost2_min": -59.9340577567512, "cost1_max": 412.774628433819, "cost1_min": 27.95231397134548, "cost2_max": -6.852749981390269, "outflow_rate_mean": 1181.8945014515286, "system_level_velocity_min": 11.534961508819219, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.945698599835247}, "info": {"num_steps_trained": 11691151, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01409386657178402, "total_loss": 11.734621047973633, "vf_loss": 11.738771438598633, "policy_loss": -0.007717958651483059, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9661100506782532, "entropy": 1.2318114042282104}, "grad_time_ms": 10349.911, "load_time_ms": 13.09, "update_time_ms": 7.296, "num_steps_sampled": 11691151, "sample_time_ms": 12510.421}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb786d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb785f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78240>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11691151, "hostname": "flow-main", "episodes_total": 4747, "timestamp": 1557236759, "episode_reward_max": 1315.7314404306153, "episode_len_mean": 681.06, "time_total_s": 6632.980037927628, "time_since_restore": 6632.980037927628}
{"timesteps_since_restore": 11731501, "training_iteration": 285, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-46-23", "episode_reward_min": 50.607632229134275, "timesteps_this_iter": 40350, "episode_reward_mean": 1173.5274034125102, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 24.160722970962524, "policy_reward_mean": {}, "iterations_since_restore": 285, "custom_metrics": {"outflow_rate_max": 1417.6438249750252, "cost2_mean": -26.611417331473266, "cost1_mean": 355.6638390377546, "system_level_velocity_mean": 14.27611347254371, "cost2_min": -65.92868433932357, "cost1_max": 421.3556810966995, "cost1_min": 27.95231397134548, "cost2_max": -6.852749981390269, "outflow_rate_mean": 1181.4083322821061, "system_level_velocity_min": 11.534961508819219, "outflow_rate_min": 330.4563891282442, "system_level_velocity_max": 18.945698599835247}, "info": {"num_steps_trained": 11731501, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013983029872179031, "total_loss": 13.710567474365234, "vf_loss": 13.714905738830566, "policy_loss": -0.007877339608967304, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9590364694595337, "entropy": 1.2368621826171875}, "grad_time_ms": 10498.591, "load_time_ms": 13.145, "update_time_ms": 7.287, "num_steps_sampled": 11731501, "sample_time_ms": 12528.717}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f1d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11731501, "hostname": "flow-main", "episodes_total": 4766, "timestamp": 1557236783, "episode_reward_max": 1359.6124549401645, "episode_len_mean": 681.14, "time_total_s": 6657.14076089859, "time_since_restore": 6657.14076089859}
{"timesteps_since_restore": 11773092, "training_iteration": 286, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-46-46", "episode_reward_min": 31.89255147632863, "timesteps_this_iter": 41591, "episode_reward_mean": 1171.4372854017538, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.986438989639282, "policy_reward_mean": {}, "iterations_since_restore": 286, "custom_metrics": {"outflow_rate_max": 1411.6859736263734, "cost2_mean": -26.259810412158963, "cost1_mean": 353.5163333218035, "system_level_velocity_mean": 14.370323205912824, "cost2_min": -65.92868433932357, "cost1_max": 421.3556810966995, "cost1_min": 18.329398850624912, "cost2_max": -3.911439548466948, "outflow_rate_mean": 1176.7736006445243, "system_level_velocity_min": 11.534961508819219, "outflow_rate_min": 316.4741373407306, "system_level_velocity_max": 18.945698599835247}, "info": {"num_steps_trained": 11773092, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014632917940616608, "total_loss": 14.571060180664062, "vf_loss": 14.574773788452148, "policy_loss": -0.0074164243414998055, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9446598291397095, "entropy": 1.2151683568954468}, "grad_time_ms": 10413.0, "load_time_ms": 13.167, "update_time_ms": 7.474, "num_steps_sampled": 11773092, "sample_time_ms": 12555.962}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb785c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb78550>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11773092, "hostname": "flow-main", "episodes_total": 4781, "timestamp": 1557236806, "episode_reward_max": 1359.6124549401645, "episode_len_mean": 674.42, "time_total_s": 6680.127199888229, "time_since_restore": 6680.127199888229}
{"timesteps_since_restore": 11814231, "training_iteration": 287, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-47-10", "episode_reward_min": 31.89255147632863, "timesteps_this_iter": 41139, "episode_reward_mean": 1158.9474597516376, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.275776147842407, "policy_reward_mean": {}, "iterations_since_restore": 287, "custom_metrics": {"outflow_rate_max": 1411.6859736263734, "cost2_mean": -26.15691984263117, "cost1_mean": 348.594922217931, "system_level_velocity_mean": 14.33477083335892, "cost2_min": -65.92868433932357, "cost1_max": 421.3556810966995, "cost1_min": 18.329398850624912, "cost2_max": -3.911439548466948, "outflow_rate_mean": 1161.1200734153226, "system_level_velocity_min": 11.534961508819219, "outflow_rate_min": 316.4741373407306, "system_level_velocity_max": 18.945698599835247}, "info": {"num_steps_trained": 11814231, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014519876800477505, "total_loss": 8.969090461730957, "vf_loss": 8.972116470336914, "policy_loss": -0.006700190249830484, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.971837043762207, "entropy": 1.2068939208984375}, "grad_time_ms": 10383.501, "load_time_ms": 13.196, "update_time_ms": 7.468, "num_steps_sampled": 11814231, "sample_time_ms": 12577.939}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fc18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fda0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11814231, "hostname": "flow-main", "episodes_total": 4796, "timestamp": 1557236830, "episode_reward_max": 1359.6124549401645, "episode_len_mean": 668.49, "time_total_s": 6703.402976036072, "time_since_restore": 6703.402976036072}
{"timesteps_since_restore": 11854836, "training_iteration": 288, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-47-33", "episode_reward_min": 31.89255147632863, "timesteps_this_iter": 40605, "episode_reward_mean": 1152.1918613833761, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.212686777114868, "policy_reward_mean": {}, "iterations_since_restore": 288, "custom_metrics": {"outflow_rate_max": 1411.6859736263734, "cost2_mean": -25.058749969653036, "cost1_mean": 345.3924465978863, "system_level_velocity_mean": 14.348003199745431, "cost2_min": -65.92868433932357, "cost1_max": 421.3556810966995, "cost1_min": 18.329398850624912, "cost2_max": -3.911439548466948, "outflow_rate_mean": 1155.342030835862, "system_level_velocity_min": 11.534961508819219, "outflow_rate_min": 316.4741373407306, "system_level_velocity_max": 18.945698599835247}, "info": {"num_steps_trained": 11854836, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0149309653788805, "total_loss": 14.04638957977295, "vf_loss": 14.051347732543945, "policy_loss": -0.008736232295632362, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9539369344711304, "entropy": 1.2472223043441772}, "grad_time_ms": 10383.007, "load_time_ms": 13.268, "update_time_ms": 7.706, "num_steps_sampled": 11854836, "sample_time_ms": 12639.796}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb792b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79ef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11854836, "hostname": "flow-main", "episodes_total": 4814, "timestamp": 1557236853, "episode_reward_max": 1359.6124549401645, "episode_len_mean": 663.03, "time_total_s": 6726.615662813187, "time_since_restore": 6726.615662813187}
{"timesteps_since_restore": 11894649, "training_iteration": 289, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-47-55", "episode_reward_min": 31.89255147632863, "timesteps_this_iter": 39813, "episode_reward_mean": 1162.1922854842499, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.431692600250244, "policy_reward_mean": {}, "iterations_since_restore": 289, "custom_metrics": {"outflow_rate_max": 1411.6859736263734, "cost2_mean": -24.089259131328777, "cost1_mean": 347.3474375390682, "system_level_velocity_mean": 14.285995920712853, "cost2_min": -65.92868433932357, "cost1_max": 421.3556810966995, "cost1_min": 18.329398850624912, "cost2_max": -3.911439548466948, "outflow_rate_mean": 1157.5967594937551, "system_level_velocity_min": 11.534961508819219, "outflow_rate_min": 316.4741373407306, "system_level_velocity_max": 18.945698599835247}, "info": {"num_steps_trained": 11894649, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015008782036602497, "total_loss": 13.703969955444336, "vf_loss": 13.708121299743652, "policy_loss": -0.007949705235660076, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9536619782447815, "entropy": 1.2272579669952393}, "grad_time_ms": 10350.357, "load_time_ms": 13.478, "update_time_ms": 7.666, "num_steps_sampled": 11894649, "sample_time_ms": 12701.94}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72400>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11894649, "hostname": "flow-main", "episodes_total": 4832, "timestamp": 1557236875, "episode_reward_max": 1359.6124549401645, "episode_len_mean": 668.83, "time_total_s": 6749.047355413437, "time_since_restore": 6749.047355413437}
{"timesteps_since_restore": 11934605, "training_iteration": 290, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-48-19", "episode_reward_min": 31.89255147632863, "timesteps_this_iter": 39956, "episode_reward_mean": 1187.9691042214777, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.575634956359863, "policy_reward_mean": {}, "iterations_since_restore": 290, "custom_metrics": {"outflow_rate_max": 1411.6859736263734, "cost2_mean": -23.143713657604913, "cost1_mean": 354.1438955415275, "system_level_velocity_mean": 14.19772533399952, "cost2_min": -65.92868433932357, "cost1_max": 414.30864634200316, "cost1_min": 18.329398850624912, "cost2_max": -3.911439548466948, "outflow_rate_mean": 1178.5495520682414, "system_level_velocity_min": 11.597442502809727, "outflow_rate_min": 316.4741373407306, "system_level_velocity_max": 18.780966873845482}, "info": {"num_steps_trained": 11934605, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013724925927817822, "total_loss": 14.61847972869873, "vf_loss": 14.623456954956055, "policy_loss": -0.00844972301274538, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9487156867980957, "entropy": 1.2292810678482056}, "grad_time_ms": 10332.852, "load_time_ms": 13.534, "update_time_ms": 7.603, "num_steps_sampled": 11934605, "sample_time_ms": 12730.679}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb790b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79b70>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11934605, "hostname": "flow-main", "episodes_total": 4850, "timestamp": 1557236899, "episode_reward_max": 1365.0458206875467, "episode_len_mean": 681.89, "time_total_s": 6772.622990369797, "time_since_restore": 6772.622990369797}
{"timesteps_since_restore": 11975752, "training_iteration": 291, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-48-40", "episode_reward_min": 31.89255147632863, "timesteps_this_iter": 41147, "episode_reward_mean": 1168.8820602207009, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 21.274736166000366, "policy_reward_mean": {}, "iterations_since_restore": 291, "custom_metrics": {"outflow_rate_max": 1422.7965834165834, "cost2_mean": -21.50079813888551, "cost1_mean": 349.96759514022574, "system_level_velocity_mean": 14.30032419743472, "cost2_min": -44.049627586615124, "cost1_max": 414.30864634200316, "cost1_min": 18.329398850624912, "cost2_max": -3.911439548466948, "outflow_rate_mean": 1172.5253942203901, "system_level_velocity_min": 11.597442502809727, "outflow_rate_min": 316.4741373407306, "system_level_velocity_max": 18.780966873845482}, "info": {"num_steps_trained": 11975752, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015240354463458061, "total_loss": 15.874902725219727, "vf_loss": 15.87745189666748, "policy_loss": -0.006407123524695635, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.944405734539032, "entropy": 1.211542010307312}, "grad_time_ms": 10138.017, "load_time_ms": 13.431, "update_time_ms": 7.313, "num_steps_sampled": 11975752, "sample_time_ms": 12712.188}, "episodes_this_iter": 13, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79400>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 11975752, "hostname": "flow-main", "episodes_total": 4863, "timestamp": 1557236920, "episode_reward_max": 1365.0458206875467, "episode_len_mean": 672.16, "time_total_s": 6793.897726535797, "time_since_restore": 6793.897726535797}
{"timesteps_since_restore": 12015369, "training_iteration": 292, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-49-04", "episode_reward_min": 157.33263615171347, "timesteps_this_iter": 39617, "episode_reward_mean": 1179.1111029237225, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.366819143295288, "policy_reward_mean": {}, "iterations_since_restore": 292, "custom_metrics": {"outflow_rate_max": 1422.7965834165834, "cost2_mean": -21.744322204493173, "cost1_mean": 352.5504974580586, "system_level_velocity_mean": 14.21053040538694, "cost2_min": -57.27659852423767, "cost1_max": 412.26100760952795, "cost1_min": 71.31442889616393, "cost2_max": -7.663516108581219, "outflow_rate_mean": 1175.155948982847, "system_level_velocity_min": 11.217852775568065, "outflow_rate_min": 420.1614565003781, "system_level_velocity_max": 18.022584804393787}, "info": {"num_steps_trained": 12015369, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017377648502588272, "total_loss": 13.056310653686523, "vf_loss": 13.061848640441895, "policy_loss": -0.009936895221471786, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9537718892097473, "entropy": 1.243414282798767}, "grad_time_ms": 10086.889, "load_time_ms": 13.495, "update_time_ms": 7.074, "num_steps_sampled": 12015369, "sample_time_ms": 12841.785}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb796a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72e80>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 12015369, "hostname": "flow-main", "episodes_total": 4882, "timestamp": 1557236944, "episode_reward_max": 1365.0458206875467, "episode_len_mean": 678.88, "time_total_s": 6817.264545679092, "time_since_restore": 6817.264545679092}
{"timesteps_since_restore": 12054589, "training_iteration": 293, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-49-24", "episode_reward_min": 61.23372993422856, "timesteps_this_iter": 39220, "episode_reward_mean": 1177.1744796436205, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 20.703861951828003, "policy_reward_mean": {}, "iterations_since_restore": 293, "custom_metrics": {"outflow_rate_max": 1453.9982417582416, "cost2_mean": -21.340464392915255, "cost1_mean": 353.84962223668913, "system_level_velocity_mean": 14.30929760466421, "cost2_min": -57.27659852423767, "cost1_max": 433.7200144136112, "cost1_min": 32.984385095093785, "cost2_max": -6.1317379760186945, "outflow_rate_mean": 1182.2190147392455, "system_level_velocity_min": 11.217852775568065, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 17.90207790906767}, "info": {"num_steps_trained": 12054589, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014474528841674328, "total_loss": 22.22801399230957, "vf_loss": 22.23139762878418, "policy_loss": -0.007047335151582956, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9162136912345886, "entropy": 1.2574000358581543}, "grad_time_ms": 9870.621, "load_time_ms": 13.369, "update_time_ms": 7.031, "num_steps_sampled": 12054589, "sample_time_ms": 12770.052}, "episodes_this_iter": 19, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb79048>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 12054589, "hostname": "flow-main", "episodes_total": 4901, "timestamp": 1557236964, "episode_reward_max": 1365.0458206875467, "episode_len_mean": 677.5, "time_total_s": 6837.96840763092, "time_since_restore": 6837.96840763092}
{"timesteps_since_restore": 12094802, "training_iteration": 294, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-49-48", "episode_reward_min": 61.23372993422856, "timesteps_this_iter": 40213, "episode_reward_mean": 1182.3020111571773, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.054438829421997, "policy_reward_mean": {}, "iterations_since_restore": 294, "custom_metrics": {"outflow_rate_max": 1453.9982417582416, "cost2_mean": -21.347167545491974, "cost1_mean": 356.2125228424809, "system_level_velocity_mean": 14.304603027262521, "cost2_min": -59.12283174001526, "cost1_max": 433.7200144136112, "cost1_min": 32.984385095093785, "cost2_max": -6.1317379760186945, "outflow_rate_mean": 1187.7419070769479, "system_level_velocity_min": 11.217852775568065, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 17.90207790906767}, "info": {"num_steps_trained": 12094802, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016792254522442818, "total_loss": 12.242480278015137, "vf_loss": 12.2459135055542, "policy_loss": -0.007684903685003519, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9561744332313538, "entropy": 1.2271069288253784}, "grad_time_ms": 9866.203, "load_time_ms": 13.536, "update_time_ms": 6.978, "num_steps_sampled": 12094802, "sample_time_ms": 12839.3}, "episodes_this_iter": 15, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7feb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f5c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 12094802, "hostname": "flow-main", "episodes_total": 4916, "timestamp": 1557236988, "episode_reward_max": 1365.0458206875467, "episode_len_mean": 682.96, "time_total_s": 6861.022846460342, "time_since_restore": 6861.022846460342}
{"timesteps_since_restore": 12135734, "training_iteration": 295, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-50-11", "episode_reward_min": 50.56461676057788, "timesteps_this_iter": 40932, "episode_reward_mean": 1152.831717581215, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.463438749313354, "policy_reward_mean": {}, "iterations_since_restore": 295, "custom_metrics": {"outflow_rate_max": 1453.9982417582416, "cost2_mean": -21.741452917767084, "cost1_mean": 350.0750772495404, "system_level_velocity_mean": 14.409577619374732, "cost2_min": -59.12283174001526, "cost1_max": 433.7200144136112, "cost1_min": 28.972713357235584, "cost2_max": -6.1317379760186945, "outflow_rate_mean": 1169.3703232803123, "system_level_velocity_min": 11.217852775568065, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 19.693598836288075}, "info": {"num_steps_trained": 12135734, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014462769962847233, "total_loss": 16.904462814331055, "vf_loss": 16.90977668762207, "policy_loss": -0.008975882083177567, "cur_kl_coeff": 0.2531249523162842, "vf_explained_var": 0.9447683691978455, "entropy": 1.2317394018173218}, "grad_time_ms": 9726.151, "load_time_ms": 13.506, "update_time_ms": 6.933, "num_steps_sampled": 12135734, "sample_time_ms": 12909.59}, "episodes_this_iter": 20, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb721d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 12135734, "hostname": "flow-main", "episodes_total": 4936, "timestamp": 1557237011, "episode_reward_max": 1365.0458206875467, "episode_len_mean": 670.55, "time_total_s": 6884.486285209656, "time_since_restore": 6884.486285209656}
{"timesteps_since_restore": 12176139, "training_iteration": 296, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-50-34", "episode_reward_min": 50.56461676057788, "timesteps_this_iter": 40405, "episode_reward_mean": 1152.248724923974, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 23.29725980758667, "policy_reward_mean": {}, "iterations_since_restore": 296, "custom_metrics": {"outflow_rate_max": 1453.9982417582416, "cost2_mean": -21.402695155145494, "cost1_mean": 350.30034498768214, "system_level_velocity_mean": 14.442381799954747, "cost2_min": -59.12283174001526, "cost1_max": 433.7200144136112, "cost1_min": 28.972713357235584, "cost2_max": -6.1317379760186945, "outflow_rate_mean": 1171.0339836359565, "system_level_velocity_min": 11.217852775568065, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 19.693598836288075}, "info": {"num_steps_trained": 12176139, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015810463577508926, "total_loss": 13.870702743530273, "vf_loss": 13.873007774353027, "policy_loss": -0.006307948846369982, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.940191388130188, "entropy": 1.260625958442688}, "grad_time_ms": 9714.541, "load_time_ms": 13.306, "update_time_ms": 6.836, "num_steps_sampled": 12176139, "sample_time_ms": 12953.312}, "episodes_this_iter": 13, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f8d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 12176139, "hostname": "flow-main", "episodes_total": 4949, "timestamp": 1557237034, "episode_reward_max": 1325.1084982283435, "episode_len_mean": 670.55, "time_total_s": 6907.783545017242, "time_since_restore": 6907.783545017242}
{"timesteps_since_restore": 12216781, "training_iteration": 297, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-50-57", "episode_reward_min": 50.56461676057788, "timesteps_this_iter": 40642, "episode_reward_mean": 1158.8296998512733, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.964664936065674, "policy_reward_mean": {}, "iterations_since_restore": 297, "custom_metrics": {"outflow_rate_max": 1453.9982417582416, "cost2_mean": -21.190020877920553, "cost1_mean": 352.46671980485075, "system_level_velocity_mean": 14.378318621119174, "cost2_min": -59.12283174001526, "cost1_max": 433.7200144136112, "cost1_min": 28.972713357235584, "cost2_max": -6.1317379760186945, "outflow_rate_mean": 1174.7424578850105, "system_level_velocity_min": 11.728119195254918, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 19.693598836288075}, "info": {"num_steps_trained": 12216781, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015590093098580837, "total_loss": 14.936989784240723, "vf_loss": 14.941486358642578, "policy_loss": -0.008442873135209084, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9503474235534668, "entropy": 1.249782919883728}, "grad_time_ms": 9708.413, "load_time_ms": 13.324, "update_time_ms": 6.873, "num_steps_sampled": 12216781, "sample_time_ms": 12928.014}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7feb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6ed68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f630>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 12216781, "hostname": "flow-main", "episodes_total": 4967, "timestamp": 1557237057, "episode_reward_max": 1325.1084982283435, "episode_len_mean": 676.16, "time_total_s": 6930.748209953308, "time_since_restore": 6930.748209953308}
{"timesteps_since_restore": 12256468, "training_iteration": 298, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-51-19", "episode_reward_min": 50.56461676057788, "timesteps_this_iter": 39687, "episode_reward_mean": 1153.6488406098395, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.010319471359253, "policy_reward_mean": {}, "iterations_since_restore": 298, "custom_metrics": {"outflow_rate_max": 1453.9982417582416, "cost2_mean": -20.948346686017967, "cost1_mean": 351.4496873633627, "system_level_velocity_mean": 14.347469274464288, "cost2_min": -59.12283174001526, "cost1_max": 433.7200144136112, "cost1_min": 28.972713357235584, "cost2_max": -6.1317379760186945, "outflow_rate_mean": 1174.616951719176, "system_level_velocity_min": 11.604492238392977, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 19.693598836288075}, "info": {"num_steps_trained": 12256468, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014935536310076714, "total_loss": 13.31462287902832, "vf_loss": 13.317890167236328, "policy_loss": -0.007045588921755552, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9554523229598999, "entropy": 1.206923007965088}, "grad_time_ms": 9704.605, "load_time_ms": 13.185, "update_time_ms": 6.617, "num_steps_sampled": 12256468, "sample_time_ms": 12812.937}, "episodes_this_iter": 17, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7f5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb7fda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb72390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 12256468, "hostname": "flow-main", "episodes_total": 4984, "timestamp": 1557237079, "episode_reward_max": 1319.5121006172408, "episode_len_mean": 676.16, "time_total_s": 6952.758529424667, "time_since_restore": 6952.758529424667}
{"timesteps_since_restore": 12296504, "training_iteration": 299, "done": false, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-51-42", "episode_reward_min": 50.56461676057788, "timesteps_this_iter": 40036, "episode_reward_mean": 1166.9449418428537, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.253720998764038, "policy_reward_mean": {}, "iterations_since_restore": 299, "custom_metrics": {"outflow_rate_max": 1395.7708907092908, "cost2_mean": -21.29253853146068, "cost1_mean": 353.6200230269628, "system_level_velocity_mean": 14.217443976825928, "cost2_min": -59.12283174001526, "cost1_max": 409.65441574467224, "cost1_min": 28.972713357235584, "cost2_max": -10.169731403352296, "outflow_rate_mean": 1180.9984078013701, "system_level_velocity_min": 11.604492238392977, "outflow_rate_min": 338.35525222187107, "system_level_velocity_max": 19.693598836288075}, "info": {"num_steps_trained": 12296504, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01527484692633152, "total_loss": 19.431787490844727, "vf_loss": 19.43634796142578, "policy_loss": -0.00842788815498352, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9204721450805664, "entropy": 1.255140781402588}, "grad_time_ms": 9736.264, "load_time_ms": 12.902, "update_time_ms": 6.625, "num_steps_sampled": 12296504, "sample_time_ms": 12763.499}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb6e9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f94517f8c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f946116fac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 12296504, "hostname": "flow-main", "episodes_total": 5002, "timestamp": 1557237102, "episode_reward_max": 1336.3376150234135, "episode_len_mean": 683.47, "time_total_s": 6975.012250423431, "time_since_restore": 6975.012250423431}
{"timesteps_since_restore": 12337311, "training_iteration": 300, "done": true, "node_ip": "10.138.0.2", "pid": 10860, "date": "2019-05-07_13-52-04", "episode_reward_min": 50.56461676057788, "timesteps_this_iter": 40807, "episode_reward_mean": 1169.366489053912, "experiment_id": "fcebd832d58945aab120c73c2510a73c", "time_this_iter_s": 22.615227699279785, "policy_reward_mean": {}, "iterations_since_restore": 300, "custom_metrics": {"outflow_rate_max": 1395.7708907092908, "cost2_mean": -20.3122365632787, "cost1_mean": 351.28473056678916, "system_level_velocity_mean": 14.109136830508087, "cost2_min": -49.39271690262619, "cost1_max": 409.65441574467224, "cost1_min": 28.972713357235584, "cost2_max": -10.169731403352296, "outflow_rate_mean": 1179.338312416755, "system_level_velocity_min": 11.604492238392977, "outflow_rate_min": 338.35525222187107, "system_level_velocity_max": 19.693598836288075}, "info": {"num_steps_trained": 12337311, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016746005043387413, "total_loss": 13.335046768188477, "vf_loss": 13.339466094970703, "policy_loss": -0.008659258484840393, "cur_kl_coeff": 0.25312498211860657, "vf_explained_var": 0.9576535224914551, "entropy": 1.1911988258361816}, "grad_time_ms": 9753.701, "load_time_ms": 12.701, "update_time_ms": 6.564, "num_steps_sampled": 12337311, "sample_time_ms": 12649.931}, "episodes_this_iter": 18, "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "compress_observations": false, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "optimizer": {}, "model": {"fcnet_hiddens": [100, 50, 25], "framestack": true, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "custom_model": null, "channel_major": false, "conv_filters": null, "lstm_cell_size": 256, "squash_to_range": false, "conv_activation": "relu", "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "vf_share_layers": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_for_driver": 1, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f94517f8898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f94517f8470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fb70>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "num_metric_batches_dropped": 0, "timesteps_total": 12337311, "hostname": "flow-main", "episodes_total": 5020, "timestamp": 1557237124, "episode_reward_max": 1336.3376150234135, "episode_len_mean": 683.47, "time_total_s": 6997.627478122711, "time_since_restore": 6997.627478122711}

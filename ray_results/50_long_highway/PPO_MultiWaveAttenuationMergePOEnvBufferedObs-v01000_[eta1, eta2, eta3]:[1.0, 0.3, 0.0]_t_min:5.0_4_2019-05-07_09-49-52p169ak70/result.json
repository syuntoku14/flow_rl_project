{"timesteps_since_restore": 51466, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 51466, "date": "2019-05-07_09-50-32", "episode_reward_min": NaN, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbe10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f94611bacc0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 1, "episode_reward_mean": NaN, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 1, "custom_metrics": {}, "info": {"num_steps_trained": 51466, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0008710799156688154, "total_loss": 1.579055666923523, "vf_loss": 1.5792523622512817, "policy_loss": -0.0003707539290189743, "cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.9184611439704895, "entropy": 1.423198938369751}, "load_time_ms": 66.343, "grad_time_ms": 12430.263, "update_time_ms": 1055.188, "num_steps_sampled": 51466, "sample_time_ms": 16047.961}, "episode_len_mean": NaN, "time_this_iter_s": 29.72873067855835, "num_metric_batches_dropped": 0, "timesteps_total": 51466, "hostname": "flow-main", "episodes_total": 0, "timestamp": 1557222632, "episode_reward_max": NaN, "episodes_this_iter": 0, "time_total_s": 29.72873067855835, "time_since_restore": 29.72873067855835}
{"timesteps_since_restore": 97228, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 45762, "date": "2019-05-07_09-51-00", "episode_reward_min": 443.85244665366696, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 2, "episode_reward_mean": 552.0602347348689, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 2, "custom_metrics": {"outflow_rate_max": 826.884871128871, "cost2_mean": -73.53887087472634, "cost1_mean": 228.98585305913056, "system_level_velocity_mean": 8.67426433175614, "cost2_min": -95.49915591022936, "cost1_max": 306.7088703143313, "cost1_min": 187.41863879905836, "cost2_max": -57.37485633173924, "outflow_rate_mean": 468.36784199800206, "system_level_velocity_min": 7.26240456222289, "outflow_rate_min": 162.3426857142857, "system_level_velocity_max": 11.375517522278438}, "info": {"num_steps_trained": 97228, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009003642946481705, "total_loss": 1.1164371967315674, "vf_loss": 1.1178686618804932, "policy_loss": -0.0023318675812333822, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.9764178395271301, "entropy": 1.4236243963241577}, "load_time_ms": 37.768, "grad_time_ms": 11753.267, "update_time_ms": 531.527, "num_steps_sampled": 97228, "sample_time_ms": 16375.271}, "episode_len_mean": 700.0, "time_this_iter_s": 27.88272190093994, "num_metric_batches_dropped": 0, "timesteps_total": 97228, "hostname": "flow-main", "episodes_total": 20, "timestamp": 1557222660, "episode_reward_max": 792.1067709515632, "episodes_this_iter": 20, "time_total_s": 57.61145257949829, "time_since_restore": 57.61145257949829}
{"timesteps_since_restore": 147323, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 50095, "date": "2019-05-07_09-51-30", "episode_reward_min": 342.68503723520416, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34b00>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 3, "episode_reward_mean": 547.9839841674093, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 3, "custom_metrics": {"outflow_rate_max": 888.4860103896102, "cost2_mean": -69.54988332942222, "cost1_mean": 223.238309499898, "system_level_velocity_mean": 8.46782897088234, "cost2_min": -95.49915591022936, "cost1_max": 306.7088703143313, "cost1_min": 165.29484659300303, "cost2_max": -43.05498327245569, "outflow_rate_mean": 464.07363519723515, "system_level_velocity_min": 6.224047102285359, "outflow_rate_min": 162.3426857142857, "system_level_velocity_max": 11.375517522278438}, "info": {"num_steps_trained": 147323, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007663421798497438, "total_loss": 0.5943194031715393, "vf_loss": 0.5979138016700745, "policy_loss": -0.004360748454928398, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.9699262380599976, "entropy": 1.4189481735229492}, "load_time_ms": 27.872, "grad_time_ms": 11904.19, "update_time_ms": 357.356, "num_steps_sampled": 147323, "sample_time_ms": 16689.633}, "episode_len_mean": 700.0, "time_this_iter_s": 29.63037109375, "num_metric_batches_dropped": 0, "timesteps_total": 147323, "hostname": "flow-main", "episodes_total": 37, "timestamp": 1557222690, "episode_reward_max": 792.1067709515632, "episodes_this_iter": 17, "time_total_s": 87.24182367324829, "time_since_restore": 87.24182367324829}
{"timesteps_since_restore": 190446, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 43123, "date": "2019-05-07_09-51-53", "episode_reward_min": 342.68503723520416, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f94611ba9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd349b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 4, "episode_reward_mean": 545.0768996473445, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 4, "custom_metrics": {"outflow_rate_max": 888.4860103896102, "cost2_mean": -68.25237215093799, "cost1_mean": 221.13719533245913, "system_level_velocity_mean": 8.384927440503116, "cost2_min": -95.49915591022936, "cost1_max": 306.7088703143313, "cost1_min": 165.29484659300303, "cost2_max": -43.05498327245569, "outflow_rate_mean": 458.6690454145854, "system_level_velocity_min": 6.224047102285359, "outflow_rate_min": 162.3426857142857, "system_level_velocity_max": 11.375517522278438}, "info": {"num_steps_trained": 190446, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010965953581035137, "total_loss": 0.9331926703453064, "vf_loss": 0.9386934638023376, "policy_loss": -0.006597402039915323, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.9810436964035034, "entropy": 1.395477294921875}, "load_time_ms": 22.982, "grad_time_ms": 11438.672, "update_time_ms": 269.953, "num_steps_sampled": 190446, "sample_time_ms": 15789.621}, "episode_len_mean": 700.0, "time_this_iter_s": 23.2378671169281, "num_metric_batches_dropped": 0, "timesteps_total": 190446, "hostname": "flow-main", "episodes_total": 40, "timestamp": 1557222713, "episode_reward_max": 792.1067709515632, "episodes_this_iter": 3, "time_total_s": 110.47969079017639, "time_since_restore": 110.47969079017639}
{"timesteps_since_restore": 232596, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42150, "date": "2019-05-07_09-52-18", "episode_reward_min": 342.68503723520416, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34ac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 5, "episode_reward_mean": 524.8631455170118, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 5, "custom_metrics": {"outflow_rate_max": 888.4860103896102, "cost2_mean": -57.63246844425464, "cost1_mean": 205.767274999983, "system_level_velocity_mean": 7.806587825657342, "cost2_min": -95.49915591022936, "cost1_max": 306.7088703143313, "cost1_min": 142.43990807900437, "cost2_max": -22.020115914344363, "outflow_rate_mean": 449.6520988478188, "system_level_velocity_min": 5.441121040537914, "outflow_rate_min": 162.3426857142857, "system_level_velocity_max": 11.375517522278438}, "info": {"num_steps_trained": 232596, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007433238904923201, "total_loss": 3.2268800735473633, "vf_loss": 3.22902512550354, "policy_loss": -0.002887911396101117, "cur_kl_coeff": 0.10000000149011612, "vf_explained_var": 0.9324379563331604, "entropy": 1.3721067905426025}, "load_time_ms": 19.788, "grad_time_ms": 11140.547, "update_time_ms": 217.948, "num_steps_sampled": 232596, "sample_time_ms": 15585.807}, "episode_len_mean": 700.0, "time_this_iter_s": 24.816166877746582, "num_metric_batches_dropped": 0, "timesteps_total": 232596, "hostname": "flow-main", "episodes_total": 60, "timestamp": 1557222738, "episode_reward_max": 792.1067709515632, "episodes_this_iter": 20, "time_total_s": 135.29585766792297, "time_since_restore": 135.29585766792297}
{"timesteps_since_restore": 274528, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41932, "date": "2019-05-07_09-52-44", "episode_reward_min": 342.68503723520416, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd0f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 6, "episode_reward_mean": 550.9298904937459, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 6, "custom_metrics": {"outflow_rate_max": 888.4860103896102, "cost2_mean": -50.50698965129577, "cost1_mean": 202.26324085107262, "system_level_velocity_mean": 7.658303609159208, "cost2_min": -95.49915591022936, "cost1_max": 306.7088703143313, "cost1_min": 142.43990807900437, "cost2_max": -20.610939507227613, "outflow_rate_mean": 488.57823231768236, "system_level_velocity_min": 5.441121040537914, "outflow_rate_min": 162.3426857142857, "system_level_velocity_max": 11.375517522278438}, "info": {"num_steps_trained": 274528, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012313221581280231, "total_loss": 4.638436317443848, "vf_loss": 4.640970706939697, "policy_loss": -0.0037655546329915524, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.8238183856010437, "entropy": 1.3703503608703613}, "load_time_ms": 17.611, "grad_time_ms": 11014.379, "update_time_ms": 183.198, "num_steps_sampled": 274528, "sample_time_ms": 15529.371}, "episode_len_mean": 700.0, "time_this_iter_s": 25.751128673553467, "num_metric_batches_dropped": 0, "timesteps_total": 274528, "hostname": "flow-main", "episodes_total": 80, "timestamp": 1557222764, "episode_reward_max": 792.1067709515632, "episodes_this_iter": 20, "time_total_s": 161.04698634147644, "time_since_restore": 161.04698634147644}
{"timesteps_since_restore": 314823, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40295, "date": "2019-05-07_09-53-07", "episode_reward_min": 52.474518385092665, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd7b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 7, "episode_reward_mean": 556.5087653604602, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 7, "custom_metrics": {"outflow_rate_max": 888.4860103896102, "cost2_mean": -46.832694788569036, "cost1_mean": 199.65294817526828, "system_level_velocity_mean": 7.9261566349310515, "cost2_min": -95.49915591022936, "cost1_max": 306.7088703143313, "cost1_min": 30.693452534867898, "cost2_max": -9.921686557405417, "outflow_rate_mean": 508.2476477040924, "system_level_velocity_min": 5.441121040537914, "outflow_rate_min": 162.3426857142857, "system_level_velocity_max": 18.938159996333564}, "info": {"num_steps_trained": 314823, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.020083047449588776, "total_loss": 4.602049827575684, "vf_loss": 4.606564998626709, "policy_loss": -0.006523253861814737, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.868759036064148, "entropy": 1.3650959730148315}, "load_time_ms": 16.079, "grad_time_ms": 10760.256, "update_time_ms": 158.349, "num_steps_sampled": 314823, "sample_time_ms": 15343.628}, "episode_len_mean": 685.8260869565217, "time_this_iter_s": 23.566314935684204, "num_metric_batches_dropped": 0, "timesteps_total": 314823, "hostname": "flow-main", "episodes_total": 92, "timestamp": 1557222787, "episode_reward_max": 810.2209096800149, "episodes_this_iter": 12, "time_total_s": 184.61330127716064, "time_since_restore": 184.61330127716064}
{"timesteps_since_restore": 356109, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41286, "date": "2019-05-07_09-53-33", "episode_reward_min": 52.474518385092665, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 8, "episode_reward_mean": 598.437683204254, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 8, "custom_metrics": {"outflow_rate_max": 888.4860103896102, "cost2_mean": -39.78090931975072, "cost1_mean": 201.9486905947056, "system_level_velocity_mean": 7.9662622038627955, "cost2_min": -95.49915591022936, "cost1_max": 306.7088703143313, "cost1_min": 30.693452534867898, "cost2_max": -9.921686557405417, "outflow_rate_mean": 572.8788786929598, "system_level_velocity_min": 5.441121040537914, "outflow_rate_min": 282.3294077922078, "system_level_velocity_max": 18.938159996333564}, "info": {"num_steps_trained": 356109, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.005769318901002407, "total_loss": 7.25077486038208, "vf_loss": 7.251136779785156, "policy_loss": -0.0012272200547158718, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.6698603630065918, "entropy": 1.3426839113235474}, "load_time_ms": 15.156, "grad_time_ms": 10677.945, "update_time_ms": 139.683, "num_steps_sampled": 356109, "sample_time_ms": 15423.413}, "episode_len_mean": 686.96, "time_this_iter_s": 26.200172424316406, "num_metric_batches_dropped": 0, "timesteps_total": 356109, "hostname": "flow-main", "episodes_total": 112, "timestamp": 1557222813, "episode_reward_max": 869.784103388507, "episodes_this_iter": 20, "time_total_s": 210.81347370147705, "time_since_restore": 210.81347370147705}
{"timesteps_since_restore": 397768, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41659, "date": "2019-05-07_09-53-58", "episode_reward_min": 52.474518385092665, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f94611baf98>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 9, "episode_reward_mean": 611.4886700596784, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 9, "custom_metrics": {"outflow_rate_max": 923.2610493506494, "cost2_mean": -34.31234087150848, "cost1_mean": 202.1279247919812, "system_level_velocity_mean": 7.964099988284683, "cost2_min": -76.80293497534265, "cost1_max": 286.4108670632912, "cost1_min": 30.693452534867898, "cost2_max": -9.921686557405417, "outflow_rate_mean": 601.1338253582944, "system_level_velocity_min": 5.441121040537914, "outflow_rate_min": 304.392, "system_level_velocity_max": 18.938159996333564}, "info": {"num_steps_trained": 397768, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006599456537514925, "total_loss": 4.471188545227051, "vf_loss": 4.472290515899658, "policy_loss": -0.002092222450301051, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.8309466242790222, "entropy": 1.3397767543792725}, "load_time_ms": 14.158, "grad_time_ms": 10458.496, "update_time_ms": 125.322, "num_steps_sampled": 397768, "sample_time_ms": 15432.614}, "episode_len_mean": 686.96, "time_this_iter_s": 24.304425716400146, "num_metric_batches_dropped": 0, "timesteps_total": 397768, "hostname": "flow-main", "episodes_total": 122, "timestamp": 1557222838, "episode_reward_max": 869.784103388507, "episodes_this_iter": 10, "time_total_s": 235.1178994178772, "time_since_restore": 235.1178994178772}
{"timesteps_since_restore": 437702, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39934, "date": "2019-05-07_09-54-21", "episode_reward_min": 52.474518385092665, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 10, "episode_reward_mean": 655.7738195940358, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 10, "custom_metrics": {"outflow_rate_max": 967.7632935064936, "cost2_mean": -27.529412509350273, "cost1_mean": 207.80623122426238, "system_level_velocity_mean": 8.15927889824254, "cost2_min": -61.22963692221026, "cost1_max": 261.38549026165776, "cost1_min": 30.693452534867898, "cost2_max": -9.921686557405417, "outflow_rate_mean": 672.8110163712815, "system_level_velocity_min": 5.441121040537914, "outflow_rate_min": 314.9856, "system_level_velocity_max": 18.938159996333564}, "info": {"num_steps_trained": 437702, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.005310887936502695, "total_loss": 8.294422149658203, "vf_loss": 8.294103622436523, "policy_loss": -0.00047757962602190673, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.7637292146682739, "entropy": 1.3322051763534546}, "load_time_ms": 13.464, "grad_time_ms": 10158.378, "update_time_ms": 113.856, "num_steps_sampled": 437702, "sample_time_ms": 15475.088}, "episode_len_mean": 686.96, "time_this_iter_s": 23.417370796203613, "num_metric_batches_dropped": 0, "timesteps_total": 437702, "hostname": "flow-main", "episodes_total": 140, "timestamp": 1557222861, "episode_reward_max": 869.784103388507, "episodes_this_iter": 18, "time_total_s": 258.5352702140808, "time_since_restore": 258.5352702140808}
{"timesteps_since_restore": 478100, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40398, "date": "2019-05-07_09-54-45", "episode_reward_min": 52.474518385092665, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170f60>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 11, "episode_reward_mean": 705.7650176110826, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 11, "custom_metrics": {"outflow_rate_max": 967.7632935064936, "cost2_mean": -24.964068525929417, "cost1_mean": 220.3898208789893, "system_level_velocity_mean": 8.62148114746933, "cost2_min": -61.22963692221026, "cost1_max": 264.00021856495056, "cost1_min": 30.693452534867898, "cost2_max": -9.921686557405417, "outflow_rate_mean": 745.3272358518011, "system_level_velocity_min": 5.696437180294124, "outflow_rate_min": 330.37556185957516, "system_level_velocity_max": 18.938159996333564}, "info": {"num_steps_trained": 478100, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006041232496500015, "total_loss": 8.93183708190918, "vf_loss": 8.930938720703125, "policy_loss": -7.61274304750259e-06, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.7215889096260071, "entropy": 1.3304762840270996}, "load_time_ms": 7.512, "grad_time_ms": 9815.597, "update_time_ms": 8.928, "num_steps_sampled": 478100, "sample_time_ms": 15319.133}, "episode_len_mean": 686.96, "time_this_iter_s": 23.59074330329895, "num_metric_batches_dropped": 0, "timesteps_total": 478100, "hostname": "flow-main", "episodes_total": 158, "timestamp": 1557222885, "episode_reward_max": 869.784103388507, "episodes_this_iter": 18, "time_total_s": 282.12601351737976, "time_since_restore": 282.12601351737976}
{"timesteps_since_restore": 518231, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40131, "date": "2019-05-07_09-55-08", "episode_reward_min": 52.474518385092665, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9461150dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461150ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9461150a20>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 12, "episode_reward_mean": 735.1022655835609, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 12, "custom_metrics": {"outflow_rate_max": 967.7632935064936, "cost2_mean": -23.666195429148274, "cost1_mean": 231.22833684857042, "system_level_velocity_mean": 9.025713439866006, "cost2_min": -34.208811405506964, "cost1_max": 275.74500891168094, "cost1_min": 30.693452534867898, "cost2_max": -9.921686557405417, "outflow_rate_mean": 787.4364154881646, "system_level_velocity_min": 5.85295514033987, "outflow_rate_min": 330.37556185957516, "system_level_velocity_max": 18.938159996333564}, "info": {"num_steps_trained": 518231, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006430584937334061, "total_loss": 8.394548416137695, "vf_loss": 8.395340919494629, "policy_loss": -0.0017570658819749951, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.7978827357292175, "entropy": 1.3295949697494507}, "load_time_ms": 7.296, "grad_time_ms": 9521.208, "update_time_ms": 9.121, "num_steps_sampled": 518231, "sample_time_ms": 15152.795}, "episode_len_mean": 686.96, "time_this_iter_s": 23.259269952774048, "num_metric_batches_dropped": 0, "timesteps_total": 518231, "hostname": "flow-main", "episodes_total": 174, "timestamp": 1557222908, "episode_reward_max": 879.8010060750319, "episodes_this_iter": 16, "time_total_s": 305.3852834701538, "time_since_restore": 305.3852834701538}
{"timesteps_since_restore": 558616, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40385, "date": "2019-05-07_09-55-33", "episode_reward_min": 650.1010011567467, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 13, "episode_reward_mean": 779.993025709964, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 13, "custom_metrics": {"outflow_rate_max": 975.8117818181819, "cost2_mean": -23.102166426699736, "cost1_mean": 247.4242129975808, "system_level_velocity_mean": 9.290345958409755, "cost2_min": -31.681327690193385, "cost1_max": 285.071054131286, "cost1_min": 206.3147787760277, "cost2_max": -16.251972776810405, "outflow_rate_mean": 838.2324936623377, "system_level_velocity_min": 7.757735300450697, "outflow_rate_min": 647.1130857142857, "system_level_velocity_max": 10.74758752543188}, "info": {"num_steps_trained": 558616, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007681524846702814, "total_loss": 11.731239318847656, "vf_loss": 11.7322359085083, "policy_loss": -0.0021490640938282013, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.5975996851921082, "entropy": 1.314862847328186}, "load_time_ms": 7.217, "grad_time_ms": 9144.551, "update_time_ms": 8.858, "num_steps_sampled": 558616, "sample_time_ms": 15037.428}, "episode_len_mean": 700.0, "time_this_iter_s": 24.694745540618896, "num_metric_batches_dropped": 0, "timesteps_total": 558616, "hostname": "flow-main", "episodes_total": 194, "timestamp": 1557222933, "episode_reward_max": 916.3665808083052, "episodes_this_iter": 20, "time_total_s": 330.0800290107727, "time_since_restore": 330.0800290107727}
{"timesteps_since_restore": 599147, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40531, "date": "2019-05-07_09-55-56", "episode_reward_min": 63.86480823125639, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc800f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc806d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 14, "episode_reward_mean": 780.0653845746023, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 14, "custom_metrics": {"outflow_rate_max": 975.8117818181819, "cost2_mean": -22.70960767904978, "cost1_mean": 249.59056755959836, "system_level_velocity_mean": 9.545523321386243, "cost2_min": -31.681327690193385, "cost1_max": 293.7571241503587, "cost1_min": 32.45196278938432, "cost2_max": -9.740194761584702, "outflow_rate_mean": 841.1346274539848, "system_level_velocity_min": 7.757735300450697, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.122811427405107}, "info": {"num_steps_trained": 599147, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007270664442330599, "total_loss": 7.36608362197876, "vf_loss": 7.367776393890381, "policy_loss": -0.0027831855695694685, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.7954428195953369, "entropy": 1.3285261392593384}, "load_time_ms": 7.241, "grad_time_ms": 9064.075, "update_time_ms": 8.749, "num_steps_sampled": 599147, "sample_time_ms": 15136.433}, "episode_len_mean": 693.5, "time_this_iter_s": 23.439652681350708, "num_metric_batches_dropped": 0, "timesteps_total": 599147, "hostname": "flow-main", "episodes_total": 204, "timestamp": 1557222956, "episode_reward_max": 916.3665808083052, "episodes_this_iter": 10, "time_total_s": 353.5196816921234, "time_since_restore": 353.5196816921234}
{"timesteps_since_restore": 639039, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39892, "date": "2019-05-07_09-56-19", "episode_reward_min": 63.86480823125639, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd1d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 15, "episode_reward_mean": 803.2229238274668, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 15, "custom_metrics": {"outflow_rate_max": 993.2968207792209, "cost2_mean": -22.166683266544652, "cost1_mean": 258.8416663667109, "system_level_velocity_mean": 9.905485445883382, "cost2_min": -29.400758043204736, "cost1_max": 310.47469039506706, "cost1_min": 32.45196278938432, "cost2_max": -9.740194761584702, "outflow_rate_mean": 865.8094936358026, "system_level_velocity_min": 8.004495020383604, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.122811427405107}, "info": {"num_steps_trained": 639039, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.005654509644955397, "total_loss": 12.31689453125, "vf_loss": 12.316608428955078, "policy_loss": -0.000562395725864917, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.7339861989021301, "entropy": 1.3292421102523804}, "load_time_ms": 7.294, "grad_time_ms": 9002.297, "update_time_ms": 10.907, "num_steps_sampled": 639039, "sample_time_ms": 15001.346}, "episode_len_mean": 693.5, "time_this_iter_s": 22.895637273788452, "num_metric_batches_dropped": 0, "timesteps_total": 639039, "hostname": "flow-main", "episodes_total": 222, "timestamp": 1557222979, "episode_reward_max": 932.7660600912468, "episodes_this_iter": 18, "time_total_s": 376.41531896591187, "time_since_restore": 376.41531896591187}
{"timesteps_since_restore": 678418, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39379, "date": "2019-05-07_09-56-42", "episode_reward_min": 63.86480823125639, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80d30>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 16, "episode_reward_mean": 828.2853072433262, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 16, "custom_metrics": {"outflow_rate_max": 1143.224025974026, "cost2_mean": -22.260733415834537, "cost1_mean": 270.3560948655941, "system_level_velocity_mean": 10.354041301950296, "cost2_min": -29.400758043204736, "cost1_max": 337.1478645953214, "cost1_min": 32.45196278938432, "cost2_max": -9.740194761584702, "outflow_rate_mean": 894.5218563091294, "system_level_velocity_min": 8.134322762989369, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.122811427405107}, "info": {"num_steps_trained": 678418, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.005664294119924307, "total_loss": 15.304487228393555, "vf_loss": 15.305606842041016, "policy_loss": -0.0019677523523569107, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.6579594612121582, "entropy": 1.3181538581848145}, "load_time_ms": 7.292, "grad_time_ms": 8865.589, "update_time_ms": 10.877, "num_steps_sampled": 678418, "sample_time_ms": 14843.855}, "episode_len_mean": 693.5, "time_this_iter_s": 22.817105054855347, "num_metric_batches_dropped": 0, "timesteps_total": 678418, "hostname": "flow-main", "episodes_total": 240, "timestamp": 1557223002, "episode_reward_max": 981.1353324816627, "episodes_this_iter": 18, "time_total_s": 399.2324240207672, "time_since_restore": 399.2324240207672}
{"timesteps_since_restore": 718103, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39685, "date": "2019-05-07_09-57-07", "episode_reward_min": 51.86236705520613, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfda20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdda0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 17, "episode_reward_mean": 840.8633747173295, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 17, "custom_metrics": {"outflow_rate_max": 1143.224025974026, "cost2_mean": -22.37301188087072, "cost1_mean": 277.6757378137404, "system_level_velocity_mean": 10.985680179201829, "cost2_min": -29.400758043204736, "cost1_max": 337.1478645953214, "cost1_min": 28.23261938086179, "cost2_max": -8.04660134222281, "outflow_rate_mean": 922.1400589532673, "system_level_velocity_min": 8.595256586053539, "outflow_rate_min": 319.3448272743482, "system_level_velocity_max": 18.264694936554644}, "info": {"num_steps_trained": 718103, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006237823981791735, "total_loss": 17.4995059967041, "vf_loss": 17.500316619873047, "policy_loss": -0.0017481351969763637, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.6420562267303467, "entropy": 1.325607180595398}, "load_time_ms": 7.282, "grad_time_ms": 8831.832, "update_time_ms": 10.946, "num_steps_sampled": 718103, "sample_time_ms": 14991.738}, "episode_len_mean": 680.46, "time_this_iter_s": 24.730066061019897, "num_metric_batches_dropped": 0, "timesteps_total": 718103, "hostname": "flow-main", "episodes_total": 259, "timestamp": 1557223027, "episode_reward_max": 998.685419962543, "episodes_this_iter": 19, "time_total_s": 423.9624900817871, "time_since_restore": 423.9624900817871}
{"timesteps_since_restore": 756470, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 38367, "date": "2019-05-07_09-57-30", "episode_reward_min": 51.86236705520613, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdc88>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 18, "episode_reward_mean": 860.9579984062765, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 18, "custom_metrics": {"outflow_rate_max": 1150.095044155844, "cost2_mean": -22.465429237805473, "cost1_mean": 288.63870104829374, "system_level_velocity_mean": 11.42363197236216, "cost2_min": -32.087677666024106, "cost1_max": 338.3896373989917, "cost1_min": 28.23261938086179, "cost2_max": -8.04660134222281, "outflow_rate_mean": 958.4931741620583, "system_level_velocity_min": 9.301653594823799, "outflow_rate_min": 319.3448272743482, "system_level_velocity_max": 18.264694936554644}, "info": {"num_steps_trained": 756470, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007373581640422344, "total_loss": 17.500585556030273, "vf_loss": 17.503019332885742, "policy_loss": -0.00353989633731544, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.6837201118469238, "entropy": 1.3032214641571045}, "load_time_ms": 7.174, "grad_time_ms": 8675.315, "update_time_ms": 11.039, "num_steps_sampled": 756470, "sample_time_ms": 14872.747}, "episode_len_mean": 680.46, "time_this_iter_s": 23.42192053794861, "num_metric_batches_dropped": 0, "timesteps_total": 756470, "hostname": "flow-main", "episodes_total": 278, "timestamp": 1557223050, "episode_reward_max": 998.685419962543, "episodes_this_iter": 19, "time_total_s": 447.3844106197357, "time_since_restore": 447.3844106197357}
{"timesteps_since_restore": 794582, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 38112, "date": "2019-05-07_09-57-54", "episode_reward_min": 51.86236705520613, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc808d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80b38>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 19, "episode_reward_mean": 873.6444524666081, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 19, "custom_metrics": {"outflow_rate_max": 1192.6131116883116, "cost2_mean": -23.510871900558378, "cost1_mean": 298.3561040993103, "system_level_velocity_mean": 11.817429176726055, "cost2_min": -43.905573345403795, "cost1_max": 348.7990530620556, "cost1_min": 28.23261938086179, "cost2_max": -8.04660134222281, "outflow_rate_mean": 993.0936276325878, "system_level_velocity_min": 9.677975431120704, "outflow_rate_min": 319.3448272743482, "system_level_velocity_max": 18.264694936554644}, "info": {"num_steps_trained": 794582, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007008213084191084, "total_loss": 14.915177345275879, "vf_loss": 14.916661262512207, "policy_loss": -0.002536553191021085, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.7763902544975281, "entropy": 1.304602026939392}, "load_time_ms": 7.268, "grad_time_ms": 8652.08, "update_time_ms": 10.887, "num_steps_sampled": 794582, "sample_time_ms": 14865.271}, "episode_len_mean": 680.46, "time_this_iter_s": 24.001062870025635, "num_metric_batches_dropped": 0, "timesteps_total": 794582, "hostname": "flow-main", "episodes_total": 296, "timestamp": 1557223074, "episode_reward_max": 998.685419962543, "episodes_this_iter": 18, "time_total_s": 471.38547348976135, "time_since_restore": 471.38547348976135}
{"timesteps_since_restore": 833993, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39411, "date": "2019-05-07_09-58-19", "episode_reward_min": 51.86236705520613, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc804a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 20, "episode_reward_mean": 886.8821939195894, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 20, "custom_metrics": {"outflow_rate_max": 1206.367251948052, "cost2_mean": -23.93423092064212, "cost1_mean": 306.20768884522215, "system_level_velocity_mean": 12.14420247718624, "cost2_min": -43.905573345403795, "cost1_max": 349.92541659358983, "cost1_min": 28.23261938086179, "cost2_max": -8.04660134222281, "outflow_rate_mean": 1028.5372162155481, "system_level_velocity_min": 10.37622941694128, "outflow_rate_min": 319.3448272743482, "system_level_velocity_max": 18.264694936554644}, "info": {"num_steps_trained": 833993, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006771156098693609, "total_loss": 18.490665435791016, "vf_loss": 18.491724014282227, "policy_loss": -0.002073568757623434, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.5910160541534424, "entropy": 1.2988739013671875}, "load_time_ms": 7.207, "grad_time_ms": 8766.382, "update_time_ms": 10.634, "num_steps_sampled": 833993, "sample_time_ms": 14859.718}, "episode_len_mean": 678.97, "time_this_iter_s": 24.501325130462646, "num_metric_batches_dropped": 0, "timesteps_total": 833993, "hostname": "flow-main", "episodes_total": 315, "timestamp": 1557223099, "episode_reward_max": 998.685419962543, "episodes_this_iter": 19, "time_total_s": 495.886798620224, "time_since_restore": 495.886798620224}
{"timesteps_since_restore": 872123, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 38130, "date": "2019-05-07_09-58-42", "episode_reward_min": 51.86236705520613, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170b00>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 21, "episode_reward_mean": 894.8195097993428, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 21, "custom_metrics": {"outflow_rate_max": 1236.9556523476522, "cost2_mean": -24.376191090929197, "cost1_mean": 310.8817402754718, "system_level_velocity_mean": 12.339266467213445, "cost2_min": -43.905573345403795, "cost1_max": 349.92541659358983, "cost1_min": 28.23261938086179, "cost2_max": -8.04660134222281, "outflow_rate_mean": 1049.6770437200437, "system_level_velocity_min": 10.37622941694128, "outflow_rate_min": 319.3448272743482, "system_level_velocity_max": 18.264694936554644}, "info": {"num_steps_trained": 872123, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0051252874545753, "total_loss": 13.104889869689941, "vf_loss": 13.105644226074219, "policy_loss": -0.0015233285957947373, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.7585211992263794, "entropy": 1.2902637720108032}, "load_time_ms": 7.175, "grad_time_ms": 8749.531, "update_time_ms": 10.811, "num_steps_sampled": 872123, "sample_time_ms": 14835.641}, "episode_len_mean": 678.97, "time_this_iter_s": 23.17947745323181, "num_metric_batches_dropped": 0, "timesteps_total": 872123, "hostname": "flow-main", "episodes_total": 327, "timestamp": 1557223122, "episode_reward_max": 1013.3560937861573, "episodes_this_iter": 12, "time_total_s": 519.0662760734558, "time_since_restore": 519.0662760734558}
{"timesteps_since_restore": 910409, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 38286, "date": "2019-05-07_09-59-08", "episode_reward_min": 51.86236705520613, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 22, "episode_reward_mean": 899.6402207320644, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 22, "custom_metrics": {"outflow_rate_max": 1279.258441158841, "cost2_mean": -25.328650188081042, "cost1_mean": 316.7975891917341, "system_level_velocity_mean": 12.605109904903422, "cost2_min": -43.905573345403795, "cost1_max": 360.0838370734159, "cost1_min": 28.23261938086179, "cost2_max": -8.04660134222281, "outflow_rate_mean": 1076.2784889068569, "system_level_velocity_min": 10.37622941694128, "outflow_rate_min": 319.3448272743482, "system_level_velocity_max": 18.264694936554644}, "info": {"num_steps_trained": 910409, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006005747709423304, "total_loss": 18.5107364654541, "vf_loss": 18.512176513671875, "policy_loss": -0.002339606173336506, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.7699999809265137, "entropy": 1.2848833799362183}, "load_time_ms": 7.143, "grad_time_ms": 8805.337, "update_time_ms": 10.602, "num_steps_sampled": 910409, "sample_time_ms": 15006.171}, "episode_len_mean": 678.41, "time_this_iter_s": 25.519840478897095, "num_metric_batches_dropped": 0, "timesteps_total": 910409, "hostname": "flow-main", "episodes_total": 346, "timestamp": 1557223148, "episode_reward_max": 1013.3560937861573, "episodes_this_iter": 19, "time_total_s": 544.5861165523529, "time_since_restore": 544.5861165523529}
{"timesteps_since_restore": 949024, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 38615, "date": "2019-05-07_09-59-33", "episode_reward_min": 333.437661230586, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80b38>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 23, "episode_reward_mean": 912.0423772161151, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 23, "custom_metrics": {"outflow_rate_max": 1279.258441158841, "cost2_mean": -26.1665332187507, "cost1_mean": 325.17083231897993, "system_level_velocity_mean": 12.738323032121489, "cost2_min": -43.905573345403795, "cost1_max": 368.4688494631222, "cost1_min": 120.6171875586689, "cost2_max": -18.74423366169062, "outflow_rate_mean": 1105.8006331537122, "system_level_velocity_min": 11.295854295759119, "outflow_rate_min": 691.597460236924, "system_level_velocity_max": 15.25473117982169}, "info": {"num_steps_trained": 949024, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0056147449649870396, "total_loss": 19.705928802490234, "vf_loss": 19.70647430419922, "policy_loss": -0.0013897704193368554, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.6875224113464355, "entropy": 1.2677571773529053}, "load_time_ms": 7.117, "grad_time_ms": 8907.829, "update_time_ms": 10.62, "num_steps_sampled": 949024, "sample_time_ms": 14940.09}, "episode_len_mean": 685.18, "time_this_iter_s": 25.058753728866577, "num_metric_batches_dropped": 0, "timesteps_total": 949024, "hostname": "flow-main", "episodes_total": 366, "timestamp": 1557223173, "episode_reward_max": 1013.3560937861573, "episodes_this_iter": 20, "time_total_s": 569.6448702812195, "time_since_restore": 569.6448702812195}
{"timesteps_since_restore": 987958, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 38934, "date": "2019-05-07_09-59-57", "episode_reward_min": 333.437661230586, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc805f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 24, "episode_reward_mean": 912.7166298090723, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 24, "custom_metrics": {"outflow_rate_max": 1279.258441158841, "cost2_mean": -26.30479506431665, "cost1_mean": 326.5620788795906, "system_level_velocity_mean": 12.906581930305217, "cost2_min": -45.42448461023432, "cost1_max": 368.4688494631222, "cost1_min": 120.6171875586689, "cost2_max": -17.524012182784436, "outflow_rate_mean": 1113.9457698563067, "system_level_velocity_min": 11.311575076279416, "outflow_rate_min": 691.597460236924, "system_level_velocity_max": 15.25473117982169}, "info": {"num_steps_trained": 987958, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008088037371635437, "total_loss": 15.650310516357422, "vf_loss": 15.652122497558594, "policy_loss": -0.0030223114881664515, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.8331231474876404, "entropy": 1.262907862663269}, "load_time_ms": 6.97, "grad_time_ms": 8952.335, "update_time_ms": 10.634, "num_steps_sampled": 987958, "sample_time_ms": 15029.757}, "episode_len_mean": 681.14, "time_this_iter_s": 24.772353410720825, "num_metric_batches_dropped": 0, "timesteps_total": 987958, "hostname": "flow-main", "episodes_total": 384, "timestamp": 1557223197, "episode_reward_max": 1013.3560937861573, "episodes_this_iter": 18, "time_total_s": 594.4172236919403, "time_since_restore": 594.4172236919403}
{"timesteps_since_restore": 1025949, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 37991, "date": "2019-05-07_10-00-22", "episode_reward_min": 438.478195088081, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170ef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 25, "episode_reward_mean": 925.0182788034892, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 25, "custom_metrics": {"outflow_rate_max": 1279.258441158841, "cost2_mean": -25.9315122064194, "cost1_mean": 332.1169329687852, "system_level_velocity_mean": 13.001405028735862, "cost2_min": -45.42448461023432, "cost1_max": 368.4688494631222, "cost1_min": 158.65560406716548, "cost2_max": -17.524012182784436, "outflow_rate_mean": 1132.3423957214595, "system_level_velocity_min": 11.311575076279416, "outflow_rate_min": 803.988445958956, "system_level_velocity_max": 14.618146703700582}, "info": {"num_steps_trained": 1025949, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006367545574903488, "total_loss": 19.30813980102539, "vf_loss": 19.309101104736328, "policy_loss": -0.0019174657063558698, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.7112874388694763, "entropy": 1.2477188110351562}, "load_time_ms": 7.021, "grad_time_ms": 9017.292, "update_time_ms": 8.118, "num_steps_sampled": 1025949, "sample_time_ms": 15111.613}, "episode_len_mean": 688.71, "time_this_iter_s": 24.34465789794922, "num_metric_batches_dropped": 0, "timesteps_total": 1025949, "hostname": "flow-main", "episodes_total": 403, "timestamp": 1557223222, "episode_reward_max": 1013.3560937861573, "episodes_this_iter": 19, "time_total_s": 618.7618815898895, "time_since_restore": 618.7618815898895}
{"timesteps_since_restore": 1063946, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 37997, "date": "2019-05-07_10-00-47", "episode_reward_min": 438.478195088081, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a198>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 26, "episode_reward_mean": 922.4828793464026, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 26, "custom_metrics": {"outflow_rate_max": 1279.258441158841, "cost2_mean": -25.690729418129646, "cost1_mean": 335.28078663395974, "system_level_velocity_mean": 13.16304169653637, "cost2_min": -45.42448461023432, "cost1_max": 368.4688494631222, "cost1_min": 158.65560406716548, "cost2_max": -17.524012182784436, "outflow_rate_mean": 1147.2367695676135, "system_level_velocity_min": 11.311575076279416, "outflow_rate_min": 803.988445958956, "system_level_velocity_max": 14.618146703700582}, "info": {"num_steps_trained": 1063946, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.005853351671248674, "total_loss": 18.118444442749023, "vf_loss": 18.11966323852539, "policy_loss": -0.0020965724252164364, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.7504666447639465, "entropy": 1.2574734687805176}, "load_time_ms": 6.647, "grad_time_ms": 9098.418, "update_time_ms": 8.069, "num_steps_sampled": 1063946, "sample_time_ms": 15284.422}, "episode_len_mean": 688.71, "time_this_iter_s": 25.31731104850769, "num_metric_batches_dropped": 0, "timesteps_total": 1063946, "hostname": "flow-main", "episodes_total": 420, "timestamp": 1557223247, "episode_reward_max": 1013.3560937861573, "episodes_this_iter": 17, "time_total_s": 644.0791926383972, "time_since_restore": 644.0791926383972}
{"timesteps_since_restore": 1103098, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39152, "date": "2019-05-07_10-01-12", "episode_reward_min": 438.478195088081, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80d30>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 27, "episode_reward_mean": 917.7644919393199, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 27, "custom_metrics": {"outflow_rate_max": 1267.642957842158, "cost2_mean": -25.66966608292978, "cost1_mean": 335.53247294653585, "system_level_velocity_mean": 13.19662876130852, "cost2_min": -45.42448461023432, "cost1_max": 368.4688494631222, "cost1_min": 158.65560406716548, "cost2_max": -17.524012182784436, "outflow_rate_mean": 1146.9774375116695, "system_level_velocity_min": 11.311575076279416, "outflow_rate_min": 803.988445958956, "system_level_velocity_max": 14.618146703700582}, "info": {"num_steps_trained": 1103098, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00562802841886878, "total_loss": 17.45076560974121, "vf_loss": 17.45149040222168, "policy_loss": -0.0015696362825110555, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.7929735779762268, "entropy": 1.254936695098877}, "load_time_ms": 6.675, "grad_time_ms": 9212.285, "update_time_ms": 7.973, "num_steps_sampled": 1103098, "sample_time_ms": 15217.656}, "episode_len_mean": 689.27, "time_this_iter_s": 25.178338289260864, "num_metric_batches_dropped": 0, "timesteps_total": 1103098, "hostname": "flow-main", "episodes_total": 440, "timestamp": 1557223272, "episode_reward_max": 1001.9119836954682, "episodes_this_iter": 20, "time_total_s": 669.2575309276581, "time_since_restore": 669.2575309276581}
{"timesteps_since_restore": 1142003, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 38905, "date": "2019-05-07_10-01-37", "episode_reward_min": 58.99331278184686, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f0b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 28, "episode_reward_mean": 900.0522407337537, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 28, "custom_metrics": {"outflow_rate_max": 1304.8646645354645, "cost2_mean": -25.36222733094152, "cost1_mean": 328.8803702616188, "system_level_velocity_mean": 13.405509964669385, "cost2_min": -45.42448461023432, "cost1_max": 369.7035737810874, "cost1_min": 33.53208012338329, "cost2_max": -9.096960731427613, "outflow_rate_mean": 1141.5132758662214, "system_level_velocity_min": 11.311575076279416, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.730300569165333}, "info": {"num_steps_trained": 1142003, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00827604066580534, "total_loss": 17.71462059020996, "vf_loss": 17.715946197509766, "policy_loss": -0.0025663557462394238, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.8042393326759338, "entropy": 1.2566170692443848}, "load_time_ms": 6.579, "grad_time_ms": 9348.89, "update_time_ms": 7.993, "num_steps_sampled": 1142003, "sample_time_ms": 15224.516}, "episode_len_mean": 671.2, "time_this_iter_s": 24.86549186706543, "num_metric_batches_dropped": 0, "timesteps_total": 1142003, "hostname": "flow-main", "episodes_total": 455, "timestamp": 1557223297, "episode_reward_max": 1045.6809214737143, "episodes_this_iter": 15, "time_total_s": 694.1230227947235, "time_since_restore": 694.1230227947235}
{"timesteps_since_restore": 1180993, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 38990, "date": "2019-05-07_10-02-02", "episode_reward_min": 58.99331278184686, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f358>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 29, "episode_reward_mean": 910.9366090368193, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 29, "custom_metrics": {"outflow_rate_max": 1321.9620851148852, "cost2_mean": -26.7298836504892, "cost1_mean": 333.34975018974546, "system_level_velocity_mean": 13.457427084453846, "cost2_min": -46.324364954905015, "cost1_max": 381.2600502963065, "cost1_min": 33.53208012338329, "cost2_max": -9.096960731427613, "outflow_rate_mean": 1150.6925566969492, "system_level_velocity_min": 11.311575076279416, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.730300569165333}, "info": {"num_steps_trained": 1180993, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007370666600763798, "total_loss": 15.06067180633545, "vf_loss": 15.062620162963867, "policy_loss": -0.0030545778572559357, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.8618067502975464, "entropy": 1.25657320022583}, "load_time_ms": 6.517, "grad_time_ms": 9502.624, "update_time_ms": 7.897, "num_steps_sampled": 1180993, "sample_time_ms": 15170.504}, "episode_len_mean": 677.97, "time_this_iter_s": 25.02061629295349, "num_metric_batches_dropped": 0, "timesteps_total": 1180993, "hostname": "flow-main", "episodes_total": 473, "timestamp": 1557223322, "episode_reward_max": 1045.6809214737143, "episodes_this_iter": 18, "time_total_s": 719.143639087677, "time_since_restore": 719.143639087677}
{"timesteps_since_restore": 1219868, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 38875, "date": "2019-05-07_10-02-27", "episode_reward_min": 58.99331278184686, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fc18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 30, "episode_reward_mean": 913.5573030471476, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 30, "custom_metrics": {"outflow_rate_max": 1321.9620851148852, "cost2_mean": -27.54155957919043, "cost1_mean": 333.8932951294483, "system_level_velocity_mean": 13.59737084733275, "cost2_min": -46.324364954905015, "cost1_max": 381.2600502963065, "cost1_min": 33.53208012338329, "cost2_max": -9.096960731427613, "outflow_rate_mean": 1157.9862184951508, "system_level_velocity_min": 11.664734897859866, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.730300569165333}, "info": {"num_steps_trained": 1219868, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006288892589509487, "total_loss": 15.824174880981445, "vf_loss": 15.825907707214355, "policy_loss": -0.0026762669440358877, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.872500479221344, "entropy": 1.2688002586364746}, "load_time_ms": 6.6, "grad_time_ms": 9529.183, "update_time_ms": 8.055, "num_steps_sampled": 1219868, "sample_time_ms": 15152.374}, "episode_len_mean": 673.5, "time_this_iter_s": 24.585721731185913, "num_metric_batches_dropped": 0, "timesteps_total": 1219868, "hostname": "flow-main", "episodes_total": 491, "timestamp": 1557223347, "episode_reward_max": 1045.6809214737143, "episodes_this_iter": 18, "time_total_s": 743.7293608188629, "time_since_restore": 743.7293608188629}
{"timesteps_since_restore": 1258752, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 38884, "date": "2019-05-07_10-02-52", "episode_reward_min": 58.99331278184686, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd66d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 31, "episode_reward_mean": 920.1037871410294, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 31, "custom_metrics": {"outflow_rate_max": 1329.3640115884116, "cost2_mean": -29.012209552950527, "cost1_mean": 336.5260448754013, "system_level_velocity_mean": 13.693517795462549, "cost2_min": -46.324364954905015, "cost1_max": 381.2600502963065, "cost1_min": 33.53208012338329, "cost2_max": -9.096960731427613, "outflow_rate_mean": 1169.7052811924536, "system_level_velocity_min": 11.664734897859866, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.730300569165333}, "info": {"num_steps_trained": 1258752, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008521544747054577, "total_loss": 14.6004056930542, "vf_loss": 14.603164672851562, "policy_loss": -0.004037808161228895, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.8644790649414062, "entropy": 1.2707898616790771}, "load_time_ms": 6.232, "grad_time_ms": 9468.208, "update_time_ms": 8.053, "num_steps_sampled": 1258752, "sample_time_ms": 15354.246}, "episode_len_mean": 673.5, "time_this_iter_s": 24.569209814071655, "num_metric_batches_dropped": 0, "timesteps_total": 1258752, "hostname": "flow-main", "episodes_total": 509, "timestamp": 1557223372, "episode_reward_max": 1051.418303476455, "episodes_this_iter": 18, "time_total_s": 768.2985706329346, "time_since_restore": 768.2985706329346}
{"timesteps_since_restore": 1298124, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39372, "date": "2019-05-07_10-03-15", "episode_reward_min": 58.99331278184686, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f358>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 32, "episode_reward_mean": 921.6054974096597, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 32, "custom_metrics": {"outflow_rate_max": 1351.61447992008, "cost2_mean": -30.130087142908017, "cost1_mean": 336.3154599565681, "system_level_velocity_mean": 13.844428884793418, "cost2_min": -47.092259532619025, "cost1_max": 387.4601900881137, "cost1_min": 33.53208012338329, "cost2_max": -9.096960731427613, "outflow_rate_mean": 1168.131633286304, "system_level_velocity_min": 11.461889752454896, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.730300569165333}, "info": {"num_steps_trained": 1298124, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007338865660130978, "total_loss": 12.873038291931152, "vf_loss": 12.874303817749023, "policy_loss": -0.0023663281463086605, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9219568967819214, "entropy": 1.244334101676941}, "load_time_ms": 6.322, "grad_time_ms": 9475.135, "update_time_ms": 8.084, "num_steps_sampled": 1298124, "sample_time_ms": 15144.729}, "episode_len_mean": 667.28, "time_this_iter_s": 23.496718883514404, "num_metric_batches_dropped": 0, "timesteps_total": 1298124, "hostname": "flow-main", "episodes_total": 527, "timestamp": 1557223395, "episode_reward_max": 1067.0404528482393, "episodes_this_iter": 18, "time_total_s": 791.795289516449, "time_since_restore": 791.795289516449}
{"timesteps_since_restore": 1336613, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 38489, "date": "2019-05-07_10-03-40", "episode_reward_min": 51.60043695460005, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fb00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03240>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 33, "episode_reward_mean": 938.2084205586235, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 33, "custom_metrics": {"outflow_rate_max": 1454.3158197802197, "cost2_mean": -30.963250493796863, "cost1_mean": 342.5789344049029, "system_level_velocity_mean": 14.066268308418701, "cost2_min": -47.092259532619025, "cost1_max": 406.53452311313833, "cost1_min": 29.114608781623904, "cost2_max": -12.340999578594511, "outflow_rate_mean": 1188.1269551705782, "system_level_velocity_min": 11.461889752454896, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.801712316301554}, "info": {"num_steps_trained": 1336613, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006107664667069912, "total_loss": 18.149646759033203, "vf_loss": 18.150062561035156, "policy_loss": -0.0013313431991264224, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.8736047148704529, "entropy": 1.2472385168075562}, "load_time_ms": 6.421, "grad_time_ms": 9400.82, "update_time_ms": 8.039, "num_steps_sampled": 1336613, "sample_time_ms": 15157.395}, "episode_len_mean": 669.64, "time_this_iter_s": 24.44080924987793, "num_metric_batches_dropped": 0, "timesteps_total": 1336613, "hostname": "flow-main", "episodes_total": 546, "timestamp": 1557223420, "episode_reward_max": 1094.5286506923624, "episodes_this_iter": 19, "time_total_s": 816.2360987663269, "time_since_restore": 816.2360987663269}
{"timesteps_since_restore": 1377785, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41172, "date": "2019-05-07_10-04-05", "episode_reward_min": 51.60043695460005, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8feb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fc88>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 34, "episode_reward_mean": 950.9201728242465, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 34, "custom_metrics": {"outflow_rate_max": 1454.3158197802197, "cost2_mean": -32.46157244985484, "cost1_mean": 348.29003180682, "system_level_velocity_mean": 14.177570230819597, "cost2_min": -51.44840162649277, "cost1_max": 416.0706901775495, "cost1_min": 29.114608781623904, "cost2_max": -12.340999578594511, "outflow_rate_mean": 1192.484618206528, "system_level_velocity_min": 11.28276037182894, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.801712316301554}, "info": {"num_steps_trained": 1377785, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0062898569740355015, "total_loss": 8.574090003967285, "vf_loss": 8.575111389160156, "policy_loss": -0.001965276198461652, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9637903571128845, "entropy": 1.2149232625961304}, "load_time_ms": 6.511, "grad_time_ms": 9360.107, "update_time_ms": 7.973, "num_steps_sampled": 1377785, "sample_time_ms": 15255.539}, "episode_len_mean": 674.65, "time_this_iter_s": 25.32363271713257, "num_metric_batches_dropped": 0, "timesteps_total": 1377785, "hostname": "flow-main", "episodes_total": 563, "timestamp": 1557223445, "episode_reward_max": 1094.6005089615774, "episodes_this_iter": 17, "time_total_s": 841.5597314834595, "time_since_restore": 841.5597314834595}
{"timesteps_since_restore": 1419058, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41273, "date": "2019-05-07_10-04-30", "episode_reward_min": 51.60043695460005, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ab00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ac50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a860>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 35, "episode_reward_mean": 950.4858820515094, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 35, "custom_metrics": {"outflow_rate_max": 1454.3158197802197, "cost2_mean": -32.92961258851292, "cost1_mean": 349.85070206668513, "system_level_velocity_mean": 14.314309618879657, "cost2_min": -51.44840162649277, "cost1_max": 436.2916532111724, "cost1_min": 29.114608781623904, "cost2_max": -12.340999578594511, "outflow_rate_mean": 1194.079546694653, "system_level_velocity_min": 11.28276037182894, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.801712316301554}, "info": {"num_steps_trained": 1419058, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007981940172612667, "total_loss": 8.190094947814941, "vf_loss": 8.193084716796875, "policy_loss": -0.004187182988971472, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9605414271354675, "entropy": 1.2102159261703491}, "load_time_ms": 6.48, "grad_time_ms": 9365.987, "update_time_ms": 7.969, "num_steps_sampled": 1419058, "sample_time_ms": 15359.603}, "episode_len_mean": 672.52, "time_this_iter_s": 25.412593126296997, "num_metric_batches_dropped": 0, "timesteps_total": 1419058, "hostname": "flow-main", "episodes_total": 579, "timestamp": 1557223470, "episode_reward_max": 1094.6005089615774, "episodes_this_iter": 16, "time_total_s": 866.9723246097565, "time_since_restore": 866.9723246097565}
{"timesteps_since_restore": 1460021, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40963, "date": "2019-05-07_10-04-55", "episode_reward_min": 51.60043695460005, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f358>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 36, "episode_reward_mean": 936.0954719740607, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 36, "custom_metrics": {"outflow_rate_max": 1495.988593006993, "cost2_mean": -34.41694684637482, "cost1_mean": 346.7136806422233, "system_level_velocity_mean": 14.502130177513504, "cost2_min": -51.44840162649277, "cost1_max": 436.2916532111724, "cost1_min": 29.114608781623904, "cost2_max": -12.340999578594511, "outflow_rate_mean": 1185.1761309963506, "system_level_velocity_min": 11.28276037182894, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.801712316301554}, "info": {"num_steps_trained": 1460021, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0063060251995921135, "total_loss": 9.418943405151367, "vf_loss": 9.419930458068848, "policy_loss": -0.0019334936514496803, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9613110423088074, "entropy": 1.2060925960540771}, "load_time_ms": 6.919, "grad_time_ms": 9386.244, "update_time_ms": 7.725, "num_steps_sampled": 1460021, "sample_time_ms": 15234.787}, "episode_len_mean": 661.56, "time_this_iter_s": 24.283819437026978, "num_metric_batches_dropped": 0, "timesteps_total": 1460021, "hostname": "flow-main", "episodes_total": 596, "timestamp": 1557223495, "episode_reward_max": 1143.4101574420674, "episodes_this_iter": 17, "time_total_s": 891.2561440467834, "time_since_restore": 891.2561440467834}
{"timesteps_since_restore": 1501525, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41504, "date": "2019-05-07_10-05-19", "episode_reward_min": 51.60043695460005, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fc50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f2b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 37, "episode_reward_mean": 950.5447863036657, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 37, "custom_metrics": {"outflow_rate_max": 1495.988593006993, "cost2_mean": -35.986652024221804, "cost1_mean": 350.05103279800204, "system_level_velocity_mean": 14.481063496157878, "cost2_min": -51.44840162649277, "cost1_max": 436.2916532111724, "cost1_min": 29.114608781623904, "cost2_max": -12.340999578594511, "outflow_rate_mean": 1186.4637495758266, "system_level_velocity_min": 11.28276037182894, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.801712316301554}, "info": {"num_steps_trained": 1501525, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007271378301084042, "total_loss": 5.18935489654541, "vf_loss": 5.191232681274414, "policy_loss": -0.0029686004854738712, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.975164532661438, "entropy": 1.19271981716156}, "load_time_ms": 6.987, "grad_time_ms": 9426.441, "update_time_ms": 7.518, "num_steps_sampled": 1501525, "sample_time_ms": 15153.363}, "episode_len_mean": 667.46, "time_this_iter_s": 24.76292657852173, "num_metric_batches_dropped": 0, "timesteps_total": 1501525, "hostname": "flow-main", "episodes_total": 612, "timestamp": 1557223519, "episode_reward_max": 1143.4101574420674, "episodes_this_iter": 16, "time_total_s": 916.0190706253052, "time_since_restore": 916.0190706253052}
{"timesteps_since_restore": 1543133, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41608, "date": "2019-05-07_10-05-45", "episode_reward_min": 51.60043695460005, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80be0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 38, "episode_reward_mean": 949.5062557550897, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 38, "custom_metrics": {"outflow_rate_max": 1495.988593006993, "cost2_mean": -37.40696754388279, "cost1_mean": 348.20612878584376, "system_level_velocity_mean": 14.516356149073705, "cost2_min": -51.44840162649277, "cost1_max": 436.2916532111724, "cost1_min": 29.114608781623904, "cost2_max": -12.340999578594511, "outflow_rate_mean": 1176.8242255335201, "system_level_velocity_min": 11.28276037182894, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.801712316301554}, "info": {"num_steps_trained": 1543133, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00573546951636672, "total_loss": 6.005370140075684, "vf_loss": 6.00695276260376, "policy_loss": -0.0024424802977591753, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9747898578643799, "entropy": 1.2011637687683105}, "load_time_ms": 7.178, "grad_time_ms": 9539.544, "update_time_ms": 7.232, "num_steps_sampled": 1543133, "sample_time_ms": 15119.772}, "episode_len_mean": 662.24, "time_this_iter_s": 25.673151969909668, "num_metric_batches_dropped": 0, "timesteps_total": 1543133, "hostname": "flow-main", "episodes_total": 631, "timestamp": 1557223545, "episode_reward_max": 1151.7725593986147, "episodes_this_iter": 19, "time_total_s": 941.6922225952148, "time_since_restore": 941.6922225952148}
{"timesteps_since_restore": 1585509, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42376, "date": "2019-05-07_10-06-11", "episode_reward_min": 71.06019757626697, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc952b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95160>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 39, "episode_reward_mean": 942.6029475911575, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 39, "custom_metrics": {"outflow_rate_max": 1495.988593006993, "cost2_mean": -38.862443713189165, "cost1_mean": 342.836136724366, "system_level_velocity_mean": 14.40094695714569, "cost2_min": -59.029577518829456, "cost1_max": 436.2916532111724, "cost1_min": 38.236676788561724, "cost2_max": -10.448551193095373, "outflow_rate_mean": 1156.5961161393893, "system_level_velocity_min": 11.28276037182894, "outflow_rate_min": 318.4083481673764, "system_level_velocity_max": 18.921385070826663}, "info": {"num_steps_trained": 1585509, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006767989136278629, "total_loss": 7.653264045715332, "vf_loss": 7.6550726890563965, "policy_loss": -0.0028226724825799465, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9691322445869446, "entropy": 1.1884477138519287}, "load_time_ms": 7.264, "grad_time_ms": 9564.909, "update_time_ms": 7.339, "num_steps_sampled": 1585509, "sample_time_ms": 15170.789}, "episode_len_mean": 656.78, "time_this_iter_s": 25.75785255432129, "num_metric_batches_dropped": 0, "timesteps_total": 1585509, "hostname": "flow-main", "episodes_total": 648, "timestamp": 1557223571, "episode_reward_max": 1152.9090061505149, "episodes_this_iter": 17, "time_total_s": 967.4500751495361, "time_since_restore": 967.4500751495361}
{"timesteps_since_restore": 1628105, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42596, "date": "2019-05-07_10-06-38", "episode_reward_min": 71.06019757626697, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc804e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9461150940>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 40, "episode_reward_mean": 938.5666099388357, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 40, "custom_metrics": {"outflow_rate_max": 1495.988593006993, "cost2_mean": -39.11959393745793, "cost1_mean": 340.35580251144745, "system_level_velocity_mean": 14.539473816205334, "cost2_min": -59.029577518829456, "cost1_max": 436.2916532111724, "cost1_min": 38.236676788561724, "cost2_max": -10.448551193095373, "outflow_rate_mean": 1156.4169597714608, "system_level_velocity_min": 11.527081811211215, "outflow_rate_min": 318.4083481673764, "system_level_velocity_max": 18.921385070826663}, "info": {"num_steps_trained": 1628105, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006644532084465027, "total_loss": 7.252645015716553, "vf_loss": 7.253625869750977, "policy_loss": -0.001977640436962247, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.969813883304596, "entropy": 1.1816978454589844}, "load_time_ms": 7.233, "grad_time_ms": 9699.929, "update_time_ms": 6.973, "num_steps_sampled": 1628105, "sample_time_ms": 15234.749}, "episode_len_mean": 647.19, "time_this_iter_s": 26.567511320114136, "num_metric_batches_dropped": 0, "timesteps_total": 1628105, "hostname": "flow-main", "episodes_total": 665, "timestamp": 1557223598, "episode_reward_max": 1190.2461572207665, "episodes_this_iter": 17, "time_total_s": 994.0175864696503, "time_since_restore": 994.0175864696503}
{"timesteps_since_restore": 1669300, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41195, "date": "2019-05-07_10-07-03", "episode_reward_min": 71.06019757626697, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fe80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f470>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 41, "episode_reward_mean": 946.1866130461677, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 41, "custom_metrics": {"outflow_rate_max": 1495.988593006993, "cost2_mean": -39.7511253073744, "cost1_mean": 339.13634910296247, "system_level_velocity_mean": 14.433882303545408, "cost2_min": -59.029577518829456, "cost1_max": 420.56811982062396, "cost1_min": 38.236676788561724, "cost2_max": -10.448551193095373, "outflow_rate_mean": 1151.866275530007, "system_level_velocity_min": 11.527081811211215, "outflow_rate_min": 318.4083481673764, "system_level_velocity_max": 18.921385070826663}, "info": {"num_steps_trained": 1669300, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007925216108560562, "total_loss": 6.833035945892334, "vf_loss": 6.8349456787109375, "policy_loss": -0.0030981882009655237, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9684686660766602, "entropy": 1.1866822242736816}, "load_time_ms": 7.75, "grad_time_ms": 9843.232, "update_time_ms": 6.958, "num_steps_sampled": 1669300, "sample_time_ms": 15191.89}, "episode_len_mean": 648.2, "time_this_iter_s": 25.590421199798584, "num_metric_batches_dropped": 0, "timesteps_total": 1669300, "hostname": "flow-main", "episodes_total": 681, "timestamp": 1557223623, "episode_reward_max": 1190.2461572207665, "episodes_this_iter": 16, "time_total_s": 1019.6080076694489, "time_since_restore": 1019.6080076694489}
{"timesteps_since_restore": 1711697, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42397, "date": "2019-05-07_10-07-28", "episode_reward_min": 71.06019757626697, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc956a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc954e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95630>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 42, "episode_reward_mean": 981.2707530419752, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 42, "custom_metrics": {"outflow_rate_max": 1495.988593006993, "cost2_mean": -39.720290986882674, "cost1_mean": 350.3232601221383, "system_level_velocity_mean": 14.448934064977978, "cost2_min": -59.029577518829456, "cost1_max": 421.5146291970875, "cost1_min": 38.236676788561724, "cost2_max": -10.448551193095373, "outflow_rate_mean": 1180.7288239655727, "system_level_velocity_min": 11.527081811211215, "outflow_rate_min": 318.4083481673764, "system_level_velocity_max": 18.851749729273276}, "info": {"num_steps_trained": 1711697, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0066205100156366825, "total_loss": 6.733913421630859, "vf_loss": 6.735209941864014, "policy_loss": -0.002289510564878583, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.970842182636261, "entropy": 1.1770981550216675}, "load_time_ms": 7.747, "grad_time_ms": 9935.302, "update_time_ms": 6.884, "num_steps_sampled": 1711697, "sample_time_ms": 15248.09}, "episode_len_mean": 664.05, "time_this_iter_s": 24.98668122291565, "num_metric_batches_dropped": 0, "timesteps_total": 1711697, "hostname": "flow-main", "episodes_total": 694, "timestamp": 1557223648, "episode_reward_max": 1190.2461572207665, "episodes_this_iter": 13, "time_total_s": 1044.5946888923645, "time_since_restore": 1044.5946888923645}
{"timesteps_since_restore": 1754065, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42368, "date": "2019-05-07_10-07-54", "episode_reward_min": 52.1383889439715, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc955c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc950f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 43, "episode_reward_mean": 957.580728958046, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 43, "custom_metrics": {"outflow_rate_max": 1425.8958761238764, "cost2_mean": -38.800364893573594, "cost1_mean": 342.69242334701914, "system_level_velocity_mean": 14.505453855964163, "cost2_min": -59.029577518829456, "cost1_max": 421.5146291970875, "cost1_min": 29.115836438176395, "cost2_max": -10.155473220635447, "outflow_rate_mean": 1154.5153802815737, "system_level_velocity_min": 11.527081811211215, "outflow_rate_min": 318.4083481673764, "system_level_velocity_max": 19.57139016946365}, "info": {"num_steps_trained": 1754065, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006823811214417219, "total_loss": 7.1227545738220215, "vf_loss": 7.12401008605957, "policy_loss": -0.0022793756797909737, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9734817743301392, "entropy": 1.1792778968811035}, "load_time_ms": 7.268, "grad_time_ms": 10018.955, "update_time_ms": 6.894, "num_steps_sampled": 1754065, "sample_time_ms": 15268.499}, "episode_len_mean": 650.95, "time_this_iter_s": 25.4794659614563, "num_metric_batches_dropped": 0, "timesteps_total": 1754065, "hostname": "flow-main", "episodes_total": 714, "timestamp": 1557223674, "episode_reward_max": 1190.2461572207665, "episodes_this_iter": 20, "time_total_s": 1070.0741548538208, "time_since_restore": 1070.0741548538208}
{"timesteps_since_restore": 1798146, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 44081, "date": "2019-05-07_10-08-20", "episode_reward_min": 46.00025727223613, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc952b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95d68>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 44, "episode_reward_mean": 947.5356059640987, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 44, "custom_metrics": {"outflow_rate_max": 1425.8958761238764, "cost2_mean": -39.44495598789181, "cost1_mean": 338.95855062979933, "system_level_velocity_mean": 14.47171074787826, "cost2_min": -59.029577518829456, "cost1_max": 421.5146291970875, "cost1_min": 29.115836438176395, "cost2_max": -10.155473220635447, "outflow_rate_mean": 1141.2421567009242, "system_level_velocity_min": 11.580213280624555, "outflow_rate_min": 318.4083481673764, "system_level_velocity_max": 19.762985111346325}, "info": {"num_steps_trained": 1798146, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007288106717169285, "total_loss": 5.490808010101318, "vf_loss": 5.492316722869873, "policy_loss": -0.0026016251649707556, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.977808952331543, "entropy": 1.1694852113723755}, "load_time_ms": 7.225, "grad_time_ms": 10036.484, "update_time_ms": 6.885, "num_steps_sampled": 1798146, "sample_time_ms": 15359.984}, "episode_len_mean": 648.4, "time_this_iter_s": 26.416777849197388, "num_metric_batches_dropped": 0, "timesteps_total": 1798146, "hostname": "flow-main", "episodes_total": 730, "timestamp": 1557223700, "episode_reward_max": 1190.2461572207665, "episodes_this_iter": 16, "time_total_s": 1096.4909327030182, "time_since_restore": 1096.4909327030182}
{"timesteps_since_restore": 1841368, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 43222, "date": "2019-05-07_10-08-46", "episode_reward_min": 46.00025727223613, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95128>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 45, "episode_reward_mean": 953.9135049121237, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 45, "custom_metrics": {"outflow_rate_max": 1425.8958761238764, "cost2_mean": -40.43605260005632, "cost1_mean": 343.8097268286947, "system_level_velocity_mean": 14.352105502436462, "cost2_min": -57.00751752703018, "cost1_max": 422.95283055827855, "cost1_min": 29.115836438176395, "cost2_max": -10.155473220635447, "outflow_rate_mean": 1148.3497619294549, "system_level_velocity_min": 11.580213280624555, "outflow_rate_min": 335.6139678872712, "system_level_velocity_max": 19.762985111346325}, "info": {"num_steps_trained": 1841368, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009525171481072903, "total_loss": 3.0031514167785645, "vf_loss": 3.0048277378082275, "policy_loss": -0.003104893025010824, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9888575673103333, "entropy": 1.1665802001953125}, "load_time_ms": 7.176, "grad_time_ms": 9951.279, "update_time_ms": 6.923, "num_steps_sampled": 1841368, "sample_time_ms": 15457.565}, "episode_len_mean": 660.43, "time_this_iter_s": 25.53265953063965, "num_metric_batches_dropped": 0, "timesteps_total": 1841368, "hostname": "flow-main", "episodes_total": 745, "timestamp": 1557223726, "episode_reward_max": 1190.2461572207665, "episodes_this_iter": 15, "time_total_s": 1122.0235922336578, "time_since_restore": 1122.0235922336578}
{"timesteps_since_restore": 1884561, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 43193, "date": "2019-05-07_10-09-12", "episode_reward_min": 46.00025727223613, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 46, "episode_reward_mean": 947.9258755798844, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 46, "custom_metrics": {"outflow_rate_max": 1442.8657950049949, "cost2_mean": -42.17501215797637, "cost1_mean": 343.0628933141013, "system_level_velocity_mean": 14.343163344645504, "cost2_min": -62.98313651887124, "cost1_max": 434.6437955811786, "cost1_min": 29.115836438176395, "cost2_max": -10.155473220635447, "outflow_rate_mean": 1144.8632184809037, "system_level_velocity_min": 10.740741719240045, "outflow_rate_min": 335.6139678872712, "system_level_velocity_max": 19.762985111346325}, "info": {"num_steps_trained": 1884561, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00845404714345932, "total_loss": 4.128974914550781, "vf_loss": 4.132564544677734, "policy_loss": -0.004857975523918867, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.983559787273407, "entropy": 1.1695107221603394}, "load_time_ms": 6.928, "grad_time_ms": 9910.152, "update_time_ms": 6.918, "num_steps_sampled": 1884561, "sample_time_ms": 15709.717}, "episode_len_mean": 660.43, "time_this_iter_s": 26.390894889831543, "num_metric_batches_dropped": 0, "timesteps_total": 1884561, "hostname": "flow-main", "episodes_total": 760, "timestamp": 1557223752, "episode_reward_max": 1184.2215855206969, "episodes_this_iter": 15, "time_total_s": 1148.4144871234894, "time_since_restore": 1148.4144871234894}
{"timesteps_since_restore": 1926559, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41998, "date": "2019-05-07_10-09-39", "episode_reward_min": 46.00025727223613, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc955c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 47, "episode_reward_mean": 940.5077231928732, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 47, "custom_metrics": {"outflow_rate_max": 1442.8657950049949, "cost2_mean": -44.21343258018743, "cost1_mean": 341.02398773500636, "system_level_velocity_mean": 14.244849153876617, "cost2_min": -63.42153252352001, "cost1_max": 434.6437955811786, "cost1_min": 29.115836438176395, "cost2_max": -10.155473220635447, "outflow_rate_mean": 1130.9616255482943, "system_level_velocity_min": 10.740741719240045, "outflow_rate_min": 335.6139678872712, "system_level_velocity_max": 19.943610372729356}, "info": {"num_steps_trained": 1926559, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008837860077619553, "total_loss": 6.836636543273926, "vf_loss": 6.838688373565674, "policy_loss": -0.0033783214166760445, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9757222533226013, "entropy": 1.164778709411621}, "load_time_ms": 6.838, "grad_time_ms": 9789.572, "update_time_ms": 6.869, "num_steps_sampled": 1926559, "sample_time_ms": 16004.132}, "episode_len_mean": 662.46, "time_this_iter_s": 26.502908945083618, "num_metric_batches_dropped": 0, "timesteps_total": 1926559, "hostname": "flow-main", "episodes_total": 777, "timestamp": 1557223779, "episode_reward_max": 1184.2215855206969, "episodes_this_iter": 17, "time_total_s": 1174.917396068573, "time_since_restore": 1174.917396068573}
{"timesteps_since_restore": 1968503, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41944, "date": "2019-05-07_10-10-04", "episode_reward_min": 43.535141314303836, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc955f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc957f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 48, "episode_reward_mean": 910.6595028010472, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 48, "custom_metrics": {"outflow_rate_max": 1442.8657950049949, "cost2_mean": -45.00039617598066, "cost1_mean": 331.75852959978255, "system_level_velocity_mean": 14.31070887612804, "cost2_min": -63.42153252352001, "cost1_max": 434.6437955811786, "cost1_min": 29.115836438176395, "cost2_max": -10.155473220635447, "outflow_rate_mean": 1101.306130408226, "system_level_velocity_min": 10.740741719240045, "outflow_rate_min": 335.6139678872712, "system_level_velocity_max": 20.046621970322622}, "info": {"num_steps_trained": 1968503, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009003506042063236, "total_loss": 9.374485969543457, "vf_loss": 9.37777042388916, "policy_loss": -0.004635443910956383, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9657554626464844, "entropy": 1.1633002758026123}, "load_time_ms": 6.695, "grad_time_ms": 9605.693, "update_time_ms": 7.141, "num_steps_sampled": 1968503, "sample_time_ms": 16184.698}, "episode_len_mean": 646.33, "time_this_iter_s": 25.625431776046753, "num_metric_batches_dropped": 0, "timesteps_total": 1968503, "hostname": "flow-main", "episodes_total": 798, "timestamp": 1557223804, "episode_reward_max": 1184.2215855206969, "episodes_this_iter": 21, "time_total_s": 1200.5428278446198, "time_since_restore": 1200.5428278446198}
{"timesteps_since_restore": 2012412, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 43909, "date": "2019-05-07_10-10-30", "episode_reward_min": 43.535141314303836, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc954e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 49, "episode_reward_mean": 911.5498629228866, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 49, "custom_metrics": {"outflow_rate_max": 1442.8657950049949, "cost2_mean": -46.14399550490635, "cost1_mean": 331.37735153467014, "system_level_velocity_mean": 14.242691307444709, "cost2_min": -63.42153252352001, "cost1_max": 434.6437955811786, "cost1_min": 29.144984096329004, "cost2_max": -12.80900157234636, "outflow_rate_mean": 1100.6711217927216, "system_level_velocity_min": 10.740741719240045, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 20.046621970322622}, "info": {"num_steps_trained": 2012412, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007823926396667957, "total_loss": 6.174760341644287, "vf_loss": 6.176935195922852, "policy_loss": -0.0033481374848634005, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9709157943725586, "entropy": 1.1388130187988281}, "load_time_ms": 6.744, "grad_time_ms": 9616.742, "update_time_ms": 7.197, "num_steps_sampled": 2012412, "sample_time_ms": 16212.838}, "episode_len_mean": 647.43, "time_this_iter_s": 26.17680835723877, "num_metric_batches_dropped": 0, "timesteps_total": 2012412, "hostname": "flow-main", "episodes_total": 812, "timestamp": 1557223830, "episode_reward_max": 1167.7813496616825, "episodes_this_iter": 14, "time_total_s": 1226.7196362018585, "time_since_restore": 1226.7196362018585}
{"timesteps_since_restore": 2056267, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 43855, "date": "2019-05-07_10-10-58", "episode_reward_min": 43.535141314303836, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc957b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc954a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95d68>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 50, "episode_reward_mean": 936.5594377288755, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 50, "custom_metrics": {"outflow_rate_max": 1442.8657950049949, "cost2_mean": -47.01360353291588, "cost1_mean": 336.94753521213823, "system_level_velocity_mean": 14.102436248287589, "cost2_min": -63.42153252352001, "cost1_max": 434.6437955811786, "cost1_min": 29.19260619246289, "cost2_max": -13.827197859862101, "outflow_rate_mean": 1109.0359485202882, "system_level_velocity_min": 10.740741719240045, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 20.046621970322622}, "info": {"num_steps_trained": 2056267, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00881304033100605, "total_loss": 2.796369791030884, "vf_loss": 2.7992422580718994, "policy_loss": -0.0041944184340536594, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9883121252059937, "entropy": 1.1271803379058838}, "load_time_ms": 6.802, "grad_time_ms": 9639.169, "update_time_ms": 7.351, "num_steps_sampled": 2056267, "sample_time_ms": 16270.208}, "episode_len_mean": 659.65, "time_this_iter_s": 27.374666690826416, "num_metric_batches_dropped": 0, "timesteps_total": 2056267, "hostname": "flow-main", "episodes_total": 827, "timestamp": 1557223858, "episode_reward_max": 1167.7813496616825, "episodes_this_iter": 15, "time_total_s": 1254.094302892685, "time_since_restore": 1254.094302892685}
{"timesteps_since_restore": 2099300, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 43033, "date": "2019-05-07_10-11-24", "episode_reward_min": 43.535141314303836, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc805c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 51, "episode_reward_mean": 944.9394294713039, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 51, "custom_metrics": {"outflow_rate_max": 1442.8657950049949, "cost2_mean": -46.196541552306606, "cost1_mean": 338.5589977734878, "system_level_velocity_mean": 14.140887118034541, "cost2_min": -63.42153252352001, "cost1_max": 434.6437955811786, "cost1_min": 29.19260619246289, "cost2_max": -13.827197859862101, "outflow_rate_mean": 1117.0581957970116, "system_level_velocity_min": 10.740741719240045, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 20.046621970322622}, "info": {"num_steps_trained": 2099300, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009347187355160713, "total_loss": 9.27722454071045, "vf_loss": 9.279545783996582, "policy_loss": -0.0037235808558762074, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9496357440948486, "entropy": 1.1324834823608398}, "load_time_ms": 6.858, "grad_time_ms": 9668.061, "update_time_ms": 7.333, "num_steps_sampled": 2099300, "sample_time_ms": 16281.851}, "episode_len_mean": 659.65, "time_this_iter_s": 26.023158073425293, "num_metric_batches_dropped": 0, "timesteps_total": 2099300, "hostname": "flow-main", "episodes_total": 841, "timestamp": 1557223884, "episode_reward_max": 1182.6698410582362, "episodes_this_iter": 14, "time_total_s": 1280.1174609661102, "time_since_restore": 1280.1174609661102}
{"timesteps_since_restore": 2139723, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40423, "date": "2019-05-07_10-11-48", "episode_reward_min": 43.535141314303836, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 52, "episode_reward_mean": 941.2980928932616, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 52, "custom_metrics": {"outflow_rate_max": 1429.3657486513484, "cost2_mean": -43.69910571550862, "cost1_mean": 334.5763035001874, "system_level_velocity_mean": 14.124497746141282, "cost2_min": -63.42153252352001, "cost1_max": 424.1210298664136, "cost1_min": 29.19260619246289, "cost2_max": -13.827197859862101, "outflow_rate_mean": 1100.3216525916553, "system_level_velocity_min": 11.563213448137999, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 20.046621970322622}, "info": {"num_steps_trained": 2139723, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008808418177068233, "total_loss": 8.803285598754883, "vf_loss": 8.805996894836426, "policy_loss": -0.004033650271594524, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9639536142349243, "entropy": 1.1266356706619263}, "load_time_ms": 6.779, "grad_time_ms": 9626.185, "update_time_ms": 7.555, "num_steps_sampled": 2139723, "sample_time_ms": 16214.53}, "episode_len_mean": 653.15, "time_this_iter_s": 23.913681983947754, "num_metric_batches_dropped": 0, "timesteps_total": 2139723, "hostname": "flow-main", "episodes_total": 860, "timestamp": 1557223908, "episode_reward_max": 1182.6698410582362, "episodes_this_iter": 19, "time_total_s": 1304.031142950058, "time_since_restore": 1304.031142950058}
{"timesteps_since_restore": 2180218, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40495, "date": "2019-05-07_10-12-13", "episode_reward_min": 61.898128625471394, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc807f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80978>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 53, "episode_reward_mean": 962.0896628239276, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 53, "custom_metrics": {"outflow_rate_max": 1429.3657486513484, "cost2_mean": -41.114347128415936, "cost1_mean": 339.49563601529235, "system_level_velocity_mean": 13.95796215858166, "cost2_min": -57.66553756908574, "cost1_max": 424.1210298664136, "cost1_min": 33.66828783705242, "cost2_max": -13.827197859862101, "outflow_rate_mean": 1111.9414806057425, "system_level_velocity_min": 11.563213448137999, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.391711192277356}, "info": {"num_steps_trained": 2180218, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00904578622430563, "total_loss": 11.549115180969238, "vf_loss": 11.551169395446777, "policy_loss": -0.0034106592647731304, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9514753222465515, "entropy": 1.1121655702590942}, "load_time_ms": 7.081, "grad_time_ms": 9660.414, "update_time_ms": 7.679, "num_steps_sampled": 2180218, "sample_time_ms": 16171.424}, "episode_len_mean": 664.38, "time_this_iter_s": 25.402096271514893, "num_metric_batches_dropped": 0, "timesteps_total": 2180218, "hostname": "flow-main", "episodes_total": 881, "timestamp": 1557223933, "episode_reward_max": 1182.6698410582362, "episodes_this_iter": 21, "time_total_s": 1329.4332392215729, "time_since_restore": 1329.4332392215729}
{"timesteps_since_restore": 2221688, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41470, "date": "2019-05-07_10-12-39", "episode_reward_min": 61.898128625471394, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc955c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95cc0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 54, "episode_reward_mean": 962.7770496030037, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 54, "custom_metrics": {"outflow_rate_max": 1429.3657486513484, "cost2_mean": -39.77268468736994, "cost1_mean": 337.5470301011069, "system_level_velocity_mean": 13.94293091743432, "cost2_min": -57.66553756908574, "cost1_max": 424.1210298664136, "cost1_min": 33.66828783705242, "cost2_max": -13.827197859862101, "outflow_rate_mean": 1106.712992150541, "system_level_velocity_min": 11.220112981915655, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.274567252331966}, "info": {"num_steps_trained": 2221688, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009084820747375488, "total_loss": 9.649582862854004, "vf_loss": 9.652435302734375, "policy_loss": -0.004214701242744923, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9493006467819214, "entropy": 1.109791874885559}, "load_time_ms": 7.153, "grad_time_ms": 9689.539, "update_time_ms": 8.066, "num_steps_sampled": 2221688, "sample_time_ms": 16075.35}, "episode_len_mean": 661.87, "time_this_iter_s": 25.77488374710083, "num_metric_batches_dropped": 0, "timesteps_total": 2221688, "hostname": "flow-main", "episodes_total": 894, "timestamp": 1557223959, "episode_reward_max": 1197.1200121635648, "episodes_this_iter": 13, "time_total_s": 1355.2081229686737, "time_since_restore": 1355.2081229686737}
{"timesteps_since_restore": 2263523, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41835, "date": "2019-05-07_10-13-05", "episode_reward_min": 63.877867645404656, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc959b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 55, "episode_reward_mean": 985.0308945200841, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 55, "custom_metrics": {"outflow_rate_max": 1397.009303896104, "cost2_mean": -38.38694669277052, "cost1_mean": 343.8899744665372, "system_level_velocity_mean": 13.834259549865294, "cost2_min": -57.66553756908574, "cost1_max": 417.7010576964292, "cost1_min": 33.66828783705242, "cost2_max": -14.36667167585462, "outflow_rate_mean": 1122.2615922462476, "system_level_velocity_min": 11.220112981915655, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.274567252331966}, "info": {"num_steps_trained": 2263523, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00835002027451992, "total_loss": 8.132861137390137, "vf_loss": 8.134636878967285, "policy_loss": -0.0030286647379398346, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9527097344398499, "entropy": 1.096880555152893}, "load_time_ms": 7.069, "grad_time_ms": 9767.247, "update_time_ms": 8.421, "num_steps_sampled": 2263523, "sample_time_ms": 16023.025}, "episode_len_mean": 673.87, "time_this_iter_s": 25.80136799812317, "num_metric_batches_dropped": 0, "timesteps_total": 2263523, "hostname": "flow-main", "episodes_total": 909, "timestamp": 1557223985, "episode_reward_max": 1197.1200121635648, "episodes_this_iter": 15, "time_total_s": 1381.0094909667969, "time_since_restore": 1381.0094909667969}
{"timesteps_since_restore": 2304758, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41235, "date": "2019-05-07_10-13-30", "episode_reward_min": 55.07488265961606, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd630>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 56, "episode_reward_mean": 979.9084278117986, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 56, "custom_metrics": {"outflow_rate_max": 1397.009303896104, "cost2_mean": -34.920155566437955, "cost1_mean": 341.5215213072666, "system_level_velocity_mean": 13.898717761147665, "cost2_min": -53.51338921488425, "cost1_max": 417.7010576964292, "cost1_min": 29.51887443059725, "cost2_max": -6.604777002630751, "outflow_rate_mean": 1119.6760251162384, "system_level_velocity_min": 11.220112981915655, "outflow_rate_min": 322.48354194410126, "system_level_velocity_max": 19.274567252331966}, "info": {"num_steps_trained": 2304758, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008097758516669273, "total_loss": 10.395709037780762, "vf_loss": 10.397525787353516, "policy_loss": -0.0030317616183310747, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9516729712486267, "entropy": 1.0939453840255737}, "load_time_ms": 7.231, "grad_time_ms": 9727.066, "update_time_ms": 8.754, "num_steps_sampled": 2304758, "sample_time_ms": 15946.09}, "episode_len_mean": 667.31, "time_this_iter_s": 25.226686000823975, "num_metric_batches_dropped": 0, "timesteps_total": 2304758, "hostname": "flow-main", "episodes_total": 926, "timestamp": 1557224010, "episode_reward_max": 1197.1200121635648, "episodes_this_iter": 17, "time_total_s": 1406.2361769676208, "time_since_restore": 1406.2361769676208}
{"timesteps_since_restore": 2344604, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39846, "date": "2019-05-07_10-13-53", "episode_reward_min": 55.07488265961606, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f630>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 57, "episode_reward_mean": 956.2449487546229, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 57, "custom_metrics": {"outflow_rate_max": 1343.9843648351646, "cost2_mean": -31.642050073792856, "cost1_mean": 333.5622384699047, "system_level_velocity_mean": 13.99338454576296, "cost2_min": -53.51338921488425, "cost1_max": 417.7010576964292, "cost1_min": 29.51887443059725, "cost2_max": -6.604777002630751, "outflow_rate_mean": 1104.310233631327, "system_level_velocity_min": 11.220112981915655, "outflow_rate_min": 322.48354194410126, "system_level_velocity_max": 19.274567252331966}, "info": {"num_steps_trained": 2344604, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010041763074696064, "total_loss": 15.459397315979004, "vf_loss": 15.46242904663086, "policy_loss": -0.004537270404398441, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.921248733997345, "entropy": 1.0775365829467773}, "load_time_ms": 7.19, "grad_time_ms": 9586.571, "update_time_ms": 9.158, "num_steps_sampled": 2344604, "sample_time_ms": 15730.494}, "episode_len_mean": 651.21, "time_this_iter_s": 22.942818641662598, "num_metric_batches_dropped": 0, "timesteps_total": 2344604, "hostname": "flow-main", "episodes_total": 946, "timestamp": 1557224033, "episode_reward_max": 1197.1200121635648, "episodes_this_iter": 20, "time_total_s": 1429.1789956092834, "time_since_restore": 1429.1789956092834}
{"timesteps_since_restore": 2386133, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41529, "date": "2019-05-07_10-14-18", "episode_reward_min": 55.07488265961606, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdbe0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 58, "episode_reward_mean": 969.7317267540216, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 58, "custom_metrics": {"outflow_rate_max": 1333.5897954045954, "cost2_mean": -29.602165685228133, "cost1_mean": 336.93414051742525, "system_level_velocity_mean": 13.873492970754617, "cost2_min": -50.33468016342405, "cost1_max": 417.7010576964292, "cost1_min": 29.51887443059725, "cost2_max": -6.604777002630751, "outflow_rate_mean": 1120.2263724405814, "system_level_velocity_min": 11.220112981915655, "outflow_rate_min": 322.48354194410126, "system_level_velocity_max": 19.274567252331966}, "info": {"num_steps_trained": 2386133, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009569881483912468, "total_loss": 10.81728458404541, "vf_loss": 10.820573806762695, "policy_loss": -0.00472422456368804, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9403384923934937, "entropy": 1.0714350938796997}, "load_time_ms": 7.211, "grad_time_ms": 9484.046, "update_time_ms": 9.281, "num_steps_sampled": 2386133, "sample_time_ms": 15789.24}, "episode_len_mean": 659.03, "time_this_iter_s": 25.186066150665283, "num_metric_batches_dropped": 0, "timesteps_total": 2386133, "hostname": "flow-main", "episodes_total": 965, "timestamp": 1557224058, "episode_reward_max": 1197.1200121635648, "episodes_this_iter": 19, "time_total_s": 1454.3650617599487, "time_since_restore": 1454.3650617599487}
{"timesteps_since_restore": 2426678, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40545, "date": "2019-05-07_10-14-42", "episode_reward_min": 52.16412762668433, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9461150320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc9d160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9461150940>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 59, "episode_reward_mean": 958.2980949163914, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 59, "custom_metrics": {"outflow_rate_max": 1333.5897954045954, "cost2_mean": -28.095443757608336, "cost1_mean": 330.9238280019931, "system_level_velocity_mean": 13.902904201649326, "cost2_min": -50.33468016342405, "cost1_max": 417.7010576964292, "cost1_min": 28.567858683914125, "cost2_max": -6.604777002630751, "outflow_rate_mean": 1107.5053248616136, "system_level_velocity_min": 11.220112981915655, "outflow_rate_min": 322.48354194410126, "system_level_velocity_max": 19.37629778236097}, "info": {"num_steps_trained": 2426678, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011047834530472755, "total_loss": 11.17170524597168, "vf_loss": 11.17347526550293, "policy_loss": -0.0034271373879164457, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9315658807754517, "entropy": 1.0645021200180054}, "load_time_ms": 7.051, "grad_time_ms": 9216.064, "update_time_ms": 9.183, "num_steps_sampled": 2426678, "sample_time_ms": 15791.457}, "episode_len_mean": 648.71, "time_this_iter_s": 23.49163317680359, "num_metric_batches_dropped": 0, "timesteps_total": 2426678, "hostname": "flow-main", "episodes_total": 979, "timestamp": 1557224082, "episode_reward_max": 1197.1200121635648, "episodes_this_iter": 14, "time_total_s": 1477.8566949367523, "time_since_restore": 1477.8566949367523}
{"timesteps_since_restore": 2467144, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40466, "date": "2019-05-07_10-15-06", "episode_reward_min": 52.16412762668433, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc9d940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc9d9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc806d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 60, "episode_reward_mean": 983.0871801557904, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 60, "custom_metrics": {"outflow_rate_max": 1333.5897954045954, "cost2_mean": -25.58327418873799, "cost1_mean": 338.3313122785848, "system_level_velocity_mean": 13.838659522008038, "cost2_min": -43.91382418279853, "cost1_max": 413.6632670406289, "cost1_min": 28.567858683914125, "cost2_max": -6.604777002630751, "outflow_rate_mean": 1132.0152603714776, "system_level_velocity_min": 11.442772876558852, "outflow_rate_min": 322.48354194410126, "system_level_velocity_max": 19.37629778236097}, "info": {"num_steps_trained": 2467144, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009654944762587547, "total_loss": 14.828140258789062, "vf_loss": 14.829656600952148, "policy_loss": -0.0029654300305992365, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.8927181363105774, "entropy": 1.052391767501831}, "load_time_ms": 6.583, "grad_time_ms": 8932.322, "update_time_ms": 9.312, "num_steps_sampled": 2467144, "sample_time_ms": 15702.984}, "episode_len_mean": 660.78, "time_this_iter_s": 23.642727613449097, "num_metric_batches_dropped": 0, "timesteps_total": 2467144, "hostname": "flow-main", "episodes_total": 997, "timestamp": 1557224106, "episode_reward_max": 1170.7111706749577, "episodes_this_iter": 18, "time_total_s": 1501.4994225502014, "time_since_restore": 1501.4994225502014}
{"timesteps_since_restore": 2507866, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40722, "date": "2019-05-07_10-15-31", "episode_reward_min": 52.16412762668433, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 61, "episode_reward_mean": 990.6628466121479, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 61, "custom_metrics": {"outflow_rate_max": 1333.5897954045954, "cost2_mean": -24.57963670654736, "cost1_mean": 338.8888281471258, "system_level_velocity_mean": 13.774183603796608, "cost2_min": -35.0247525082568, "cost1_max": 413.6632670406289, "cost1_min": 28.567858683914125, "cost2_max": -9.548826487966926, "outflow_rate_mean": 1136.0721410781919, "system_level_velocity_min": 11.442772876558852, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.37629778236097}, "info": {"num_steps_trained": 2507866, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009946982376277447, "total_loss": 10.532877922058105, "vf_loss": 10.534008979797363, "policy_loss": -0.002621985040605068, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9475436210632324, "entropy": 1.0563952922821045}, "load_time_ms": 6.539, "grad_time_ms": 8743.863, "update_time_ms": 9.302, "num_steps_sampled": 2507866, "sample_time_ms": 15796.136}, "episode_len_mean": 662.68, "time_this_iter_s": 25.034435033798218, "num_metric_batches_dropped": 0, "timesteps_total": 2507866, "hostname": "flow-main", "episodes_total": 1016, "timestamp": 1557224131, "episode_reward_max": 1158.3164843729644, "episodes_this_iter": 19, "time_total_s": 1526.5338575839996, "time_since_restore": 1526.5338575839996}
{"timesteps_since_restore": 2549621, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41755, "date": "2019-05-07_10-15-56", "episode_reward_min": 52.16412762668433, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80780>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 62, "episode_reward_mean": 984.3010336669349, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 62, "custom_metrics": {"outflow_rate_max": 1333.5897954045954, "cost2_mean": -24.400263810866836, "cost1_mean": 337.59008747509273, "system_level_velocity_mean": 13.871768404518587, "cost2_min": -33.815109165823465, "cost1_max": 413.6632670406289, "cost1_min": 28.567858683914125, "cost2_max": -9.548826487966926, "outflow_rate_mean": 1129.746157012154, "system_level_velocity_min": 11.442772876558852, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.37629778236097}, "info": {"num_steps_trained": 2549621, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009064764715731144, "total_loss": 7.513525009155273, "vf_loss": 7.515326976776123, "policy_loss": -0.0031606489792466164, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9654893279075623, "entropy": 1.0632879734039307}, "load_time_ms": 6.553, "grad_time_ms": 8759.665, "update_time_ms": 9.077, "num_steps_sampled": 2549621, "sample_time_ms": 15917.447}, "episode_len_mean": 656.85, "time_this_iter_s": 25.259532928466797, "num_metric_batches_dropped": 0, "timesteps_total": 2549621, "hostname": "flow-main", "episodes_total": 1030, "timestamp": 1557224156, "episode_reward_max": 1183.9952595315774, "episodes_this_iter": 14, "time_total_s": 1551.7933905124664, "time_since_restore": 1551.7933905124664}
{"timesteps_since_restore": 2592357, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42736, "date": "2019-05-07_10-16-22", "episode_reward_min": 52.16412762668433, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdeb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 63, "episode_reward_mean": 1010.1421999760672, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 63, "custom_metrics": {"outflow_rate_max": 1313.3671728271731, "cost2_mean": -25.887793139157825, "cost1_mean": 344.25980448952794, "system_level_velocity_mean": 13.693656583765549, "cost2_min": -39.1195468451361, "cost1_max": 413.6632670406289, "cost1_min": 28.567858683914125, "cost2_max": -9.548826487966926, "outflow_rate_mean": 1143.6601581234388, "system_level_velocity_min": 11.560804821979026, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.37629778236097}, "info": {"num_steps_trained": 2592357, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007652914151549339, "total_loss": 4.18975830078125, "vf_loss": 4.192113876342773, "policy_loss": -0.003503493033349514, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9834597706794739, "entropy": 1.052827000617981}, "load_time_ms": 6.698, "grad_time_ms": 8666.942, "update_time_ms": 9.093, "num_steps_sampled": 2592357, "sample_time_ms": 16113.715}, "episode_len_mean": 672.95, "time_this_iter_s": 26.435163497924805, "num_metric_batches_dropped": 0, "timesteps_total": 2592357, "hostname": "flow-main", "episodes_total": 1047, "timestamp": 1557224182, "episode_reward_max": 1183.9952595315774, "episodes_this_iter": 17, "time_total_s": 1578.2285540103912, "time_since_restore": 1578.2285540103912}
{"timesteps_since_restore": 2634413, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42056, "date": "2019-05-07_10-16-49", "episode_reward_min": 52.16412762668433, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f4e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 64, "episode_reward_mean": 1020.171381606885, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 64, "custom_metrics": {"outflow_rate_max": 1365.0164347652346, "cost2_mean": -26.530904922960705, "cost1_mean": 344.13234140349044, "system_level_velocity_mean": 13.668425430561667, "cost2_min": -39.1195468451361, "cost1_max": 398.5422115595137, "cost1_min": 28.567858683914125, "cost2_max": -9.548826487966926, "outflow_rate_mean": 1144.0287385450322, "system_level_velocity_min": 11.492977796426738, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.37629778236097}, "info": {"num_steps_trained": 2634413, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008914895355701447, "total_loss": 7.73454475402832, "vf_loss": 7.735764026641846, "policy_loss": -0.0025557088665664196, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9721372723579407, "entropy": 1.054535984992981}, "load_time_ms": 6.513, "grad_time_ms": 8618.613, "update_time_ms": 8.704, "num_steps_sampled": 2634413, "sample_time_ms": 16227.891}, "episode_len_mean": 673.2, "time_this_iter_s": 26.40263867378235, "num_metric_batches_dropped": 0, "timesteps_total": 2634413, "hostname": "flow-main", "episodes_total": 1061, "timestamp": 1557224209, "episode_reward_max": 1208.3147560825562, "episodes_this_iter": 14, "time_total_s": 1604.6311926841736, "time_since_restore": 1604.6311926841736}
{"timesteps_since_restore": 2676572, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42159, "date": "2019-05-07_10-17-14", "episode_reward_min": 52.16412762668433, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca30b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 65, "episode_reward_mean": 1007.9970290305077, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 65, "custom_metrics": {"outflow_rate_max": 1365.0164347652346, "cost2_mean": -26.733383503036148, "cost1_mean": 341.0980886264559, "system_level_velocity_mean": 13.859871197101969, "cost2_min": -39.1195468451361, "cost1_max": 400.07442663579536, "cost1_min": 28.567858683914125, "cost2_max": -9.548826487966926, "outflow_rate_mean": 1134.1943092684073, "system_level_velocity_min": 11.492977796426738, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.37629778236097}, "info": {"num_steps_trained": 2676572, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011375857517123222, "total_loss": 8.374809265136719, "vf_loss": 8.377715110778809, "policy_loss": -0.0046122390776872635, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.971782386302948, "entropy": 1.0613459348678589}, "load_time_ms": 6.924, "grad_time_ms": 8570.058, "update_time_ms": 8.644, "num_steps_sampled": 2676572, "sample_time_ms": 16238.826}, "episode_len_mean": 661.48, "time_this_iter_s": 25.43181824684143, "num_metric_batches_dropped": 0, "timesteps_total": 2676572, "hostname": "flow-main", "episodes_total": 1077, "timestamp": 1557224234, "episode_reward_max": 1208.3147560825562, "episodes_this_iter": 16, "time_total_s": 1630.063010931015, "time_since_restore": 1630.063010931015}
{"timesteps_since_restore": 2718327, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41755, "date": "2019-05-07_10-17-40", "episode_reward_min": 164.50268809217502, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95c18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 66, "episode_reward_mean": 1023.0740800879644, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 66, "custom_metrics": {"outflow_rate_max": 1365.0164347652346, "cost2_mean": -28.579880552115924, "cost1_mean": 345.57771919329053, "system_level_velocity_mean": 13.71040617399264, "cost2_min": -39.1195468451361, "cost1_max": 413.5197203708721, "cost1_min": 72.96646292309627, "cost2_max": -12.997978043427125, "outflow_rate_mean": 1141.0435009620355, "system_level_velocity_min": 10.483187857018828, "outflow_rate_min": 419.7710726438931, "system_level_velocity_max": 18.756880240054606}, "info": {"num_steps_trained": 2718327, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009781780652701855, "total_loss": 4.845946311950684, "vf_loss": 4.849399089813232, "policy_loss": -0.004919561091810465, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9827616810798645, "entropy": 1.0507607460021973}, "load_time_ms": 6.943, "grad_time_ms": 8637.599, "update_time_ms": 8.429, "num_steps_sampled": 2718327, "sample_time_ms": 16174.702}, "episode_len_mean": 673.67, "time_this_iter_s": 25.24927282333374, "num_metric_batches_dropped": 0, "timesteps_total": 2718327, "hostname": "flow-main", "episodes_total": 1096, "timestamp": 1557224260, "episode_reward_max": 1208.3147560825562, "episodes_this_iter": 19, "time_total_s": 1655.3122837543488, "time_since_restore": 1655.3122837543488}
{"timesteps_since_restore": 2760671, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42344, "date": "2019-05-07_10-18-06", "episode_reward_min": 63.38970845024307, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca33c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3f28>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 67, "episode_reward_mean": 1020.1578240418844, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 67, "custom_metrics": {"outflow_rate_max": 1365.0164347652346, "cost2_mean": -29.215944050035176, "cost1_mean": 343.1423662450796, "system_level_velocity_mean": 13.694856469470764, "cost2_min": -39.1195468451361, "cost1_max": 413.5197203708721, "cost1_min": 33.696909488868556, "cost2_max": -11.154866257668862, "outflow_rate_mean": 1129.5197059002546, "system_level_velocity_min": 10.483187857018828, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.778514865411466}, "info": {"num_steps_trained": 2760671, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011029699817299843, "total_loss": 5.041942596435547, "vf_loss": 5.0448899269104, "policy_loss": -0.004601627588272095, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9821838140487671, "entropy": 1.054444670677185}, "load_time_ms": 6.985, "grad_time_ms": 8861.009, "update_time_ms": 8.246, "num_steps_sampled": 2760671, "sample_time_ms": 16327.316}, "episode_len_mean": 671.83, "time_this_iter_s": 26.7126944065094, "num_metric_batches_dropped": 0, "timesteps_total": 2760671, "hostname": "flow-main", "episodes_total": 1111, "timestamp": 1557224286, "episode_reward_max": 1208.3147560825562, "episodes_this_iter": 15, "time_total_s": 1682.0249781608582, "time_since_restore": 1682.0249781608582}
{"timesteps_since_restore": 2801664, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40993, "date": "2019-05-07_10-18-31", "episode_reward_min": 63.38970845024307, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca37b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 68, "episode_reward_mean": 1001.3004405971612, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 68, "custom_metrics": {"outflow_rate_max": 1380.4764231768231, "cost2_mean": -28.71081814070962, "cost1_mean": 339.59481887416916, "system_level_velocity_mean": 13.835013826277093, "cost2_min": -39.1195468451361, "cost1_max": 413.5197203708721, "cost1_min": 33.696909488868556, "cost2_max": -10.672462823080632, "outflow_rate_mean": 1128.274346955682, "system_level_velocity_min": 10.483187857018828, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.778514865411466}, "info": {"num_steps_trained": 2801664, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011922474019229412, "total_loss": 14.190582275390625, "vf_loss": 14.191946029663086, "policy_loss": -0.0031526037491858006, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.932228684425354, "entropy": 1.0443449020385742}, "load_time_ms": 6.878, "grad_time_ms": 9011.782, "update_time_ms": 7.925, "num_steps_sampled": 2801664, "sample_time_ms": 16149.665}, "episode_len_mean": 661.39, "time_this_iter_s": 24.918877124786377, "num_metric_batches_dropped": 0, "timesteps_total": 2801664, "hostname": "flow-main", "episodes_total": 1129, "timestamp": 1557224311, "episode_reward_max": 1208.3147560825562, "episodes_this_iter": 18, "time_total_s": 1706.9438552856445, "time_since_restore": 1706.9438552856445}
{"timesteps_since_restore": 2843095, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41431, "date": "2019-05-07_10-18-56", "episode_reward_min": 57.48395073281273, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 69, "episode_reward_mean": 993.7853466691196, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 69, "custom_metrics": {"outflow_rate_max": 1398.9021962037964, "cost2_mean": -27.351886862837304, "cost1_mean": 337.90713938074276, "system_level_velocity_mean": 13.96271398903222, "cost2_min": -38.46909847045164, "cost1_max": 413.5197203708721, "cost1_min": 30.177476615880956, "cost2_max": -4.785004164915289, "outflow_rate_mean": 1127.7554158077735, "system_level_velocity_min": 10.483187857018828, "outflow_rate_min": 311.59295316392297, "system_level_velocity_max": 18.778514865411466}, "info": {"num_steps_trained": 2843095, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011022306978702545, "total_loss": 11.322531700134277, "vf_loss": 11.326436996459961, "policy_loss": -0.005558956414461136, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9561563730239868, "entropy": 1.0321128368377686}, "load_time_ms": 6.914, "grad_time_ms": 9155.375, "update_time_ms": 7.908, "num_steps_sampled": 2843095, "sample_time_ms": 16129.882}, "episode_len_mean": 654.83, "time_this_iter_s": 24.731268167495728, "num_metric_batches_dropped": 0, "timesteps_total": 2843095, "hostname": "flow-main", "episodes_total": 1146, "timestamp": 1557224336, "episode_reward_max": 1208.3147560825562, "episodes_this_iter": 17, "time_total_s": 1731.6751234531403, "time_since_restore": 1731.6751234531403}
{"timesteps_since_restore": 2882713, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39618, "date": "2019-05-07_10-19-20", "episode_reward_min": 53.88400845467736, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3e10>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 70, "episode_reward_mean": 973.7873645511468, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 70, "custom_metrics": {"outflow_rate_max": 1398.9021962037964, "cost2_mean": -25.91949401221118, "cost1_mean": 333.13168756464796, "system_level_velocity_mean": 14.05391323614577, "cost2_min": -38.46909847045164, "cost1_max": 413.5197203708721, "cost1_min": 30.177476615880956, "cost2_max": -4.785004164915289, "outflow_rate_mean": 1120.0357841645489, "system_level_velocity_min": 10.483187857018828, "outflow_rate_min": 311.59295316392297, "system_level_velocity_max": 18.778514865411466}, "info": {"num_steps_trained": 2882713, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010118831880390644, "total_loss": 14.505987167358398, "vf_loss": 14.509058952331543, "policy_loss": -0.004588275216519833, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9489842653274536, "entropy": 1.0482219457626343}, "load_time_ms": 7.247, "grad_time_ms": 9250.152, "update_time_ms": 8.119, "num_steps_sampled": 2882713, "sample_time_ms": 16101.578}, "episode_len_mean": 645.12, "time_this_iter_s": 24.318227529525757, "num_metric_batches_dropped": 0, "timesteps_total": 2882713, "hostname": "flow-main", "episodes_total": 1165, "timestamp": 1557224360, "episode_reward_max": 1184.8544628670434, "episodes_this_iter": 19, "time_total_s": 1755.993350982666, "time_since_restore": 1755.993350982666}
{"timesteps_since_restore": 2923031, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40318, "date": "2019-05-07_10-19-45", "episode_reward_min": 53.88400845467736, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3d30>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 71, "episode_reward_mean": 983.4368014313351, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 71, "custom_metrics": {"outflow_rate_max": 1445.6370429570434, "cost2_mean": -24.780437372796946, "cost1_mean": 339.66895165160383, "system_level_velocity_mean": 14.148301536200805, "cost2_min": -38.46909847045164, "cost1_max": 433.8993204020117, "cost1_min": 30.177476615880956, "cost2_max": -4.785004164915289, "outflow_rate_mean": 1140.9296608758677, "system_level_velocity_min": 11.168735471128155, "outflow_rate_min": 311.59295316392297, "system_level_velocity_max": 18.778514865411466}, "info": {"num_steps_trained": 2923031, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013031089678406715, "total_loss": 13.160473823547363, "vf_loss": 13.16375732421875, "policy_loss": -0.005239561200141907, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9491934776306152, "entropy": 1.0502506494522095}, "load_time_ms": 7.026, "grad_time_ms": 9279.224, "update_time_ms": 8.345, "num_steps_sampled": 2923031, "sample_time_ms": 16026.477}, "episode_len_mean": 652.02, "time_this_iter_s": 24.589223861694336, "num_metric_batches_dropped": 0, "timesteps_total": 2923031, "hostname": "flow-main", "episodes_total": 1184, "timestamp": 1557224385, "episode_reward_max": 1176.4075248058725, "episodes_this_iter": 19, "time_total_s": 1780.5825748443604, "time_since_restore": 1780.5825748443604}
{"timesteps_since_restore": 2965441, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42410, "date": "2019-05-07_10-20-12", "episode_reward_min": 53.88400845467736, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca33c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3ef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 72, "episode_reward_mean": 981.7026050326263, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 72, "custom_metrics": {"outflow_rate_max": 1445.6370429570434, "cost2_mean": -24.064789611643235, "cost1_mean": 339.87853883929864, "system_level_velocity_mean": 14.176091203615663, "cost2_min": -38.70132818762984, "cost1_max": 433.8993204020117, "cost1_min": 30.177476615880956, "cost2_max": -4.785004164915289, "outflow_rate_mean": 1144.928734102641, "system_level_velocity_min": 11.168735471128155, "outflow_rate_min": 311.59295316392297, "system_level_velocity_max": 18.778514865411466}, "info": {"num_steps_trained": 2965441, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009341541677713394, "total_loss": 7.229815483093262, "vf_loss": 7.231546878814697, "policy_loss": -0.0031325039453804493, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9729164242744446, "entropy": 1.0477626323699951}, "load_time_ms": 6.973, "grad_time_ms": 9334.939, "update_time_ms": 8.61, "num_steps_sampled": 2965441, "sample_time_ms": 16144.841}, "episode_len_mean": 652.02, "time_this_iter_s": 27.033032655715942, "num_metric_batches_dropped": 0, "timesteps_total": 2965441, "hostname": "flow-main", "episodes_total": 1200, "timestamp": 1557224412, "episode_reward_max": 1153.2345196892843, "episodes_this_iter": 16, "time_total_s": 1807.6156075000763, "time_since_restore": 1807.6156075000763}
{"timesteps_since_restore": 3008196, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42755, "date": "2019-05-07_10-20-38", "episode_reward_min": 53.88400845467736, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca39b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 73, "episode_reward_mean": 982.074367525855, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 73, "custom_metrics": {"outflow_rate_max": 1445.6370429570434, "cost2_mean": -24.34681153914869, "cost1_mean": 338.38874595388586, "system_level_velocity_mean": 14.147228534313326, "cost2_min": -38.70132818762984, "cost1_max": 433.8993204020117, "cost1_min": 30.177476615880956, "cost2_max": -4.785004164915289, "outflow_rate_mean": 1142.2172818826446, "system_level_velocity_min": 11.589890996281865, "outflow_rate_min": 311.59295316392297, "system_level_velocity_max": 18.428553691466117}, "info": {"num_steps_trained": 3008196, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010850785300135612, "total_loss": 7.610122203826904, "vf_loss": 7.611889362335205, "policy_loss": -0.003395075909793377, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.970859944820404, "entropy": 1.0459320545196533}, "load_time_ms": 6.897, "grad_time_ms": 9422.452, "update_time_ms": 8.712, "num_steps_sampled": 3008196, "sample_time_ms": 16034.647}, "episode_len_mean": 651.35, "time_this_iter_s": 26.213722467422485, "num_metric_batches_dropped": 0, "timesteps_total": 3008196, "hostname": "flow-main", "episodes_total": 1216, "timestamp": 1557224438, "episode_reward_max": 1153.2345196892843, "episodes_this_iter": 16, "time_total_s": 1833.8293299674988, "time_since_restore": 1833.8293299674988}
{"timesteps_since_restore": 3050695, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42499, "date": "2019-05-07_10-21-05", "episode_reward_min": 53.88400845467736, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3470>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 74, "episode_reward_mean": 982.7414921604654, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 74, "custom_metrics": {"outflow_rate_max": 1445.6370429570434, "cost2_mean": -24.998416982761814, "cost1_mean": 338.7755314354646, "system_level_velocity_mean": 14.107631658988836, "cost2_min": -41.09357615536012, "cost1_max": 433.8993204020117, "cost1_min": 30.177476615880956, "cost2_max": -4.785004164915289, "outflow_rate_mean": 1139.043196024297, "system_level_velocity_min": 11.559759516320716, "outflow_rate_min": 311.59295316392297, "system_level_velocity_max": 18.428553691466117}, "info": {"num_steps_trained": 3050695, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012473956681787968, "total_loss": 8.215929985046387, "vf_loss": 8.220163345336914, "policy_loss": -0.006103800144046545, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9691874384880066, "entropy": 1.0444488525390625}, "load_time_ms": 7.057, "grad_time_ms": 9518.355, "update_time_ms": 8.952, "num_steps_sampled": 3050695, "sample_time_ms": 15950.537}, "episode_len_mean": 655.29, "time_this_iter_s": 26.534942865371704, "num_metric_batches_dropped": 0, "timesteps_total": 3050695, "hostname": "flow-main", "episodes_total": 1231, "timestamp": 1557224465, "episode_reward_max": 1153.2345196892843, "episodes_this_iter": 15, "time_total_s": 1860.3642728328705, "time_since_restore": 1860.3642728328705}
{"timesteps_since_restore": 3092364, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41669, "date": "2019-05-07_10-21-32", "episode_reward_min": 53.88400845467736, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca32b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 75, "episode_reward_mean": 996.6253856422534, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 75, "custom_metrics": {"outflow_rate_max": 1445.6370429570434, "cost2_mean": -26.590930444865613, "cost1_mean": 343.18475778721375, "system_level_velocity_mean": 13.969929633212416, "cost2_min": -41.09357615536012, "cost1_max": 433.8993204020117, "cost1_min": 30.62637499697942, "cost2_max": -8.116198552071726, "outflow_rate_mean": 1148.1596861912903, "system_level_velocity_min": 11.559759516320716, "outflow_rate_min": 330.64184967339077, "system_level_velocity_max": 18.428553691466117}, "info": {"num_steps_trained": 3092364, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011575347743928432, "total_loss": 4.323888778686523, "vf_loss": 4.326982498168945, "policy_loss": -0.004830456804484129, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9850674271583557, "entropy": 1.0218604803085327}, "load_time_ms": 6.803, "grad_time_ms": 9545.013, "update_time_ms": 8.949, "num_steps_sampled": 3092364, "sample_time_ms": 16071.46}, "episode_len_mean": 667.68, "time_this_iter_s": 26.88780665397644, "num_metric_batches_dropped": 0, "timesteps_total": 3092364, "hostname": "flow-main", "episodes_total": 1247, "timestamp": 1557224492, "episode_reward_max": 1153.2345196892843, "episodes_this_iter": 16, "time_total_s": 1887.252079486847, "time_since_restore": 1887.252079486847}
{"timesteps_since_restore": 3134569, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42205, "date": "2019-05-07_10-21-57", "episode_reward_min": 58.16636058067972, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fd30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f400>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 76, "episode_reward_mean": 1015.1169046867844, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 76, "custom_metrics": {"outflow_rate_max": 1466.7151708291708, "cost2_mean": -27.743794001727423, "cost1_mean": 348.3121487218482, "system_level_velocity_mean": 13.940230699776976, "cost2_min": -41.09357615536012, "cost1_max": 433.8993204020117, "cost1_min": 33.07047438974384, "cost2_max": -8.98373615097697, "outflow_rate_mean": 1160.7705736913654, "system_level_velocity_min": 11.559759516320716, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.17432115442148}, "info": {"num_steps_trained": 3134569, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010517147369682789, "total_loss": 9.786704063415527, "vf_loss": 9.787714004516602, "policy_loss": -0.0025876068975776434, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9670224785804749, "entropy": 1.0243923664093018}, "load_time_ms": 6.874, "grad_time_ms": 9439.451, "update_time_ms": 8.907, "num_steps_sampled": 3134569, "sample_time_ms": 16179.988}, "episode_len_mean": 677.74, "time_this_iter_s": 25.282421350479126, "num_metric_batches_dropped": 0, "timesteps_total": 3134569, "hostname": "flow-main", "episodes_total": 1265, "timestamp": 1557224517, "episode_reward_max": 1152.193302277551, "episodes_this_iter": 18, "time_total_s": 1912.534500837326, "time_since_restore": 1912.534500837326}
{"timesteps_since_restore": 3176793, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42224, "date": "2019-05-07_10-22-23", "episode_reward_min": 55.91583475222201, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca30b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 77, "episode_reward_mean": 1000.1581311812561, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 77, "custom_metrics": {"outflow_rate_max": 1466.7151708291708, "cost2_mean": -28.475303686198828, "cost1_mean": 340.6202710427552, "system_level_velocity_mean": 13.864106385273017, "cost2_min": -41.09357615536012, "cost1_max": 422.1359984244159, "cost1_min": 33.07047438974384, "cost2_max": -8.98373615097697, "outflow_rate_mean": 1138.284836864456, "system_level_velocity_min": 11.419340746930516, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.77695272706797}, "info": {"num_steps_trained": 3176793, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014755361713469028, "total_loss": 9.952588081359863, "vf_loss": 9.957357406616211, "policy_loss": -0.006982894614338875, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9649376273155212, "entropy": 1.0268532037734985}, "load_time_ms": 6.465, "grad_time_ms": 9302.211, "update_time_ms": 8.632, "num_steps_sampled": 3176793, "sample_time_ms": 16195.433}, "episode_len_mean": 670.38, "time_this_iter_s": 25.469099044799805, "num_metric_batches_dropped": 0, "timesteps_total": 3176793, "hostname": "flow-main", "episodes_total": 1282, "timestamp": 1557224543, "episode_reward_max": 1176.7956216255561, "episodes_this_iter": 17, "time_total_s": 1938.0035998821259, "time_since_restore": 1938.0035998821259}
{"timesteps_since_restore": 3218638, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41845, "date": "2019-05-07_10-22-49", "episode_reward_min": 55.91583475222201, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca36d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ab00>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 78, "episode_reward_mean": 987.2213464927296, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 78, "custom_metrics": {"outflow_rate_max": 1466.7151708291708, "cost2_mean": -28.84105146585248, "cost1_mean": 336.8790183730101, "system_level_velocity_mean": 13.98970981142656, "cost2_min": -41.49166786522237, "cost1_max": 422.1359984244159, "cost1_min": 33.07047438974384, "cost2_max": -8.66868675729213, "outflow_rate_mean": 1134.532292887076, "system_level_velocity_min": 11.419340746930516, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.77695272706797}, "info": {"num_steps_trained": 3218638, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01161807682365179, "total_loss": 9.593852996826172, "vf_loss": 9.595791816711426, "policy_loss": -0.0036802643444389105, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9685101509094238, "entropy": 1.0312093496322632}, "load_time_ms": 6.569, "grad_time_ms": 9186.846, "update_time_ms": 8.446, "num_steps_sampled": 3218638, "sample_time_ms": 16439.842}, "episode_len_mean": 660.6, "time_this_iter_s": 26.20685648918152, "num_metric_batches_dropped": 0, "timesteps_total": 3218638, "hostname": "flow-main", "episodes_total": 1298, "timestamp": 1557224569, "episode_reward_max": 1178.0050173967377, "episodes_this_iter": 16, "time_total_s": 1964.2104563713074, "time_since_restore": 1964.2104563713074}
{"timesteps_since_restore": 3260539, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41901, "date": "2019-05-07_10-23-14", "episode_reward_min": 55.91583475222201, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca38d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3940>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 79, "episode_reward_mean": 990.9116816075771, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 79, "custom_metrics": {"outflow_rate_max": 1466.7151708291708, "cost2_mean": -29.412406362248642, "cost1_mean": 343.62225284898227, "system_level_velocity_mean": 14.12827383689689, "cost2_min": -42.809997662153364, "cost1_max": 422.1359984244159, "cost1_min": 33.07047438974384, "cost2_max": -8.66868675729213, "outflow_rate_mean": 1151.7129754792945, "system_level_velocity_min": 11.419340746930516, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.77695272706797}, "info": {"num_steps_trained": 3260539, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012448707595467567, "total_loss": 5.167927265167236, "vf_loss": 5.171291351318359, "policy_loss": -0.00523121003061533, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9833613038063049, "entropy": 1.0279396772384644}, "load_time_ms": 6.705, "grad_time_ms": 9253.011, "update_time_ms": 8.416, "num_steps_sampled": 3260539, "sample_time_ms": 16380.907}, "episode_len_mean": 665.65, "time_this_iter_s": 24.802167415618896, "num_metric_batches_dropped": 0, "timesteps_total": 3260539, "hostname": "flow-main", "episodes_total": 1314, "timestamp": 1557224594, "episode_reward_max": 1178.0050173967377, "episodes_this_iter": 16, "time_total_s": 1989.0126237869263, "time_since_restore": 1989.0126237869263}
{"timesteps_since_restore": 3302641, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42102, "date": "2019-05-07_10-23-38", "episode_reward_min": 55.91583475222201, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca30b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3d68>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 80, "episode_reward_mean": 1015.0965727515534, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 80, "custom_metrics": {"outflow_rate_max": 1466.7151708291708, "cost2_mean": -30.35164870823236, "cost1_mean": 353.9600913968568, "system_level_velocity_mean": 14.28423157502092, "cost2_min": -42.809997662153364, "cost1_max": 463.84313913559356, "cost1_min": 33.26531205123472, "cost2_max": -8.66868675729213, "outflow_rate_mean": 1179.4259745918723, "system_level_velocity_min": 11.419340746930516, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.77695272706797}, "info": {"num_steps_trained": 3302641, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01264994591474533, "total_loss": 6.717896938323975, "vf_loss": 6.720696449279785, "policy_loss": -0.004696361254900694, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9778932929039001, "entropy": 1.018472671508789}, "load_time_ms": 6.765, "grad_time_ms": 9431.697, "update_time_ms": 7.934, "num_steps_sampled": 3302641, "sample_time_ms": 16209.11}, "episode_len_mean": 674.27, "time_this_iter_s": 24.39043426513672, "num_metric_batches_dropped": 0, "timesteps_total": 3302641, "hostname": "flow-main", "episodes_total": 1330, "timestamp": 1557224618, "episode_reward_max": 1241.7011666857206, "episodes_this_iter": 16, "time_total_s": 2013.403058052063, "time_since_restore": 2013.403058052063}
{"timesteps_since_restore": 3343824, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41183, "date": "2019-05-07_10-24-04", "episode_reward_min": 51.67805382346469, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ab00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95be0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 81, "episode_reward_mean": 1019.6813020949542, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 81, "custom_metrics": {"outflow_rate_max": 1485.1088327672328, "cost2_mean": -30.26333857100939, "cost1_mean": 354.0319927481224, "system_level_velocity_mean": 14.44351055750683, "cost2_min": -42.809997662153364, "cost1_max": 464.09746139354536, "cost1_min": 28.31828302035566, "cost2_max": -8.66868675729213, "outflow_rate_mean": 1179.8619356825473, "system_level_velocity_min": 11.419340746930516, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.882753065962564}, "info": {"num_steps_trained": 3343824, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011376040056347847, "total_loss": 9.034561157226562, "vf_loss": 9.03870677947998, "policy_loss": -0.00585065595805645, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.97163987159729, "entropy": 1.0186561346054077}, "load_time_ms": 6.894, "grad_time_ms": 9617.264, "update_time_ms": 7.962, "num_steps_sampled": 3343824, "sample_time_ms": 16166.44}, "episode_len_mean": 667.7, "time_this_iter_s": 26.016276597976685, "num_metric_batches_dropped": 0, "timesteps_total": 3343824, "hostname": "flow-main", "episodes_total": 1350, "timestamp": 1557224644, "episode_reward_max": 1320.3281328790795, "episodes_this_iter": 20, "time_total_s": 2039.4193346500397, "time_since_restore": 2039.4193346500397}
{"timesteps_since_restore": 3387947, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 44123, "date": "2019-05-07_10-24-29", "episode_reward_min": 51.67805382346469, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdb00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461146208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8aac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 82, "episode_reward_mean": 1020.2039269799855, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 82, "custom_metrics": {"outflow_rate_max": 1485.1088327672328, "cost2_mean": -30.02625298377939, "cost1_mean": 354.26044235441276, "system_level_velocity_mean": 14.477549505964777, "cost2_min": -42.809997662153364, "cost1_max": 464.09746139354536, "cost1_min": 28.31828302035566, "cost2_max": -8.66868675729213, "outflow_rate_mean": 1174.308083832694, "system_level_velocity_min": 11.419340746930516, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.882753065962564}, "info": {"num_steps_trained": 3387947, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011955967172980309, "total_loss": 5.976007461547852, "vf_loss": 5.977633953094482, "policy_loss": -0.003420745488256216, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9751753807067871, "entropy": 0.9986259937286377}, "load_time_ms": 7.072, "grad_time_ms": 9700.644, "update_time_ms": 7.818, "num_steps_sampled": 3387947, "sample_time_ms": 15913.04}, "episode_len_mean": 666.08, "time_this_iter_s": 25.34733247756958, "num_metric_batches_dropped": 0, "timesteps_total": 3387947, "hostname": "flow-main", "episodes_total": 1366, "timestamp": 1557224669, "episode_reward_max": 1320.3281328790795, "episodes_this_iter": 16, "time_total_s": 2064.7666671276093, "time_since_restore": 2064.7666671276093}
{"timesteps_since_restore": 3431213, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 43266, "date": "2019-05-07_10-24-56", "episode_reward_min": 51.67805382346469, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca69b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3630>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 83, "episode_reward_mean": 1022.7084914090348, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 83, "custom_metrics": {"outflow_rate_max": 1485.1088327672328, "cost2_mean": -30.37414212212475, "cost1_mean": 352.9332870208859, "system_level_velocity_mean": 14.411609262125905, "cost2_min": -42.809997662153364, "cost1_max": 464.09746139354536, "cost1_min": 28.31828302035566, "cost2_max": -8.66868675729213, "outflow_rate_mean": 1168.9920090783075, "system_level_velocity_min": 11.915522619960758, "outflow_rate_min": 330.22370737173105, "system_level_velocity_max": 18.882753065962564}, "info": {"num_steps_trained": 3431213, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01210501603782177, "total_loss": 6.427196979522705, "vf_loss": 6.432205677032471, "policy_loss": -0.006824095733463764, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9753795266151428, "entropy": 0.9876112341880798}, "load_time_ms": 7.066, "grad_time_ms": 9797.314, "update_time_ms": 7.882, "num_steps_sampled": 3431213, "sample_time_ms": 15827.065}, "episode_len_mean": 665.31, "time_this_iter_s": 26.3280668258667, "num_metric_batches_dropped": 0, "timesteps_total": 3431213, "hostname": "flow-main", "episodes_total": 1379, "timestamp": 1557224696, "episode_reward_max": 1320.3281328790795, "episodes_this_iter": 13, "time_total_s": 2091.094733953476, "time_since_restore": 2091.094733953476}
{"timesteps_since_restore": 3473929, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42716, "date": "2019-05-07_10-25-22", "episode_reward_min": 51.67805382346469, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc955c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95ef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 84, "episode_reward_mean": 1026.0059668321414, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 84, "custom_metrics": {"outflow_rate_max": 1485.1088327672328, "cost2_mean": -30.586097845286254, "cost1_mean": 353.03413405606597, "system_level_velocity_mean": 14.344574690507454, "cost2_min": -42.809997662153364, "cost1_max": 464.09746139354536, "cost1_min": 28.31828302035566, "cost2_max": -9.35360366304474, "outflow_rate_mean": 1164.5494198262566, "system_level_velocity_min": 11.915522619960758, "outflow_rate_min": 330.22370737173105, "system_level_velocity_max": 18.882753065962564}, "info": {"num_steps_trained": 3473929, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011742690578103065, "total_loss": 10.077911376953125, "vf_loss": 10.080625534057617, "policy_loss": -0.004475836176425219, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9644620418548584, "entropy": 0.9736060500144958}, "load_time_ms": 7.064, "grad_time_ms": 9782.224, "update_time_ms": 7.766, "num_steps_sampled": 3473929, "sample_time_ms": 15806.564}, "episode_len_mean": 666.63, "time_this_iter_s": 26.196419715881348, "num_metric_batches_dropped": 0, "timesteps_total": 3473929, "hostname": "flow-main", "episodes_total": 1398, "timestamp": 1557224722, "episode_reward_max": 1320.3281328790795, "episodes_this_iter": 19, "time_total_s": 2117.2911536693573, "time_since_restore": 2117.2911536693573}
{"timesteps_since_restore": 3515344, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41415, "date": "2019-05-07_10-25-48", "episode_reward_min": 51.67805382346469, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6860>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 85, "episode_reward_mean": 1023.8135373986079, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 85, "custom_metrics": {"outflow_rate_max": 1485.1088327672328, "cost2_mean": -29.698258391852892, "cost1_mean": 345.9095085254279, "system_level_velocity_mean": 14.155604565157706, "cost2_min": -40.73241532919627, "cost1_max": 464.09746139354536, "cost1_min": 28.31828302035566, "cost2_max": -9.35360366304474, "outflow_rate_mean": 1148.2027973381928, "system_level_velocity_min": 11.041856451659406, "outflow_rate_min": 330.22370737173105, "system_level_velocity_max": 18.882753065962564}, "info": {"num_steps_trained": 3515344, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01166857685893774, "total_loss": 7.381443023681641, "vf_loss": 7.383203506469727, "policy_loss": -0.0035103452391922474, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9749137163162231, "entropy": 0.9609441161155701}, "load_time_ms": 7.013, "grad_time_ms": 9735.65, "update_time_ms": 7.671, "num_steps_sampled": 3515344, "sample_time_ms": 15706.039}, "episode_len_mean": 661.77, "time_this_iter_s": 25.43131446838379, "num_metric_batches_dropped": 0, "timesteps_total": 3515344, "hostname": "flow-main", "episodes_total": 1414, "timestamp": 1557224748, "episode_reward_max": 1320.3281328790795, "episodes_this_iter": 16, "time_total_s": 2142.722468137741, "time_since_restore": 2142.722468137741}
{"timesteps_since_restore": 3557340, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41996, "date": "2019-05-07_10-26-12", "episode_reward_min": 51.67805382346469, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95320>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 86, "episode_reward_mean": 1026.0432883996264, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 86, "custom_metrics": {"outflow_rate_max": 1485.1088327672328, "cost2_mean": -28.682342946829618, "cost1_mean": 343.94221515565295, "system_level_velocity_mean": 14.071110724645655, "cost2_min": -38.55780631389516, "cost1_max": 464.09746139354536, "cost1_min": 28.31828302035566, "cost2_max": -9.35360366304474, "outflow_rate_mean": 1143.6684442992319, "system_level_velocity_min": 11.041856451659406, "outflow_rate_min": 330.22370737173105, "system_level_velocity_max": 18.882753065962564}, "info": {"num_steps_trained": 3557340, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011354065500199795, "total_loss": 6.104518413543701, "vf_loss": 6.106813907623291, "policy_loss": -0.003998970612883568, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9774234890937805, "entropy": 0.9846248030662537}, "load_time_ms": 7.005, "grad_time_ms": 9776.09, "update_time_ms": 7.682, "num_steps_sampled": 3557340, "sample_time_ms": 15591.687}, "episode_len_mean": 661.77, "time_this_iter_s": 24.549259662628174, "num_metric_batches_dropped": 0, "timesteps_total": 3557340, "hostname": "flow-main", "episodes_total": 1428, "timestamp": 1557224772, "episode_reward_max": 1320.3281328790795, "episodes_this_iter": 14, "time_total_s": 2167.2717278003693, "time_since_restore": 2167.2717278003693}
{"timesteps_since_restore": 3600290, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42950, "date": "2019-05-07_10-26-39", "episode_reward_min": 61.81278573280682, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc804e0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 87, "episode_reward_mean": 1021.5125311764386, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 87, "custom_metrics": {"outflow_rate_max": 1408.9941314685311, "cost2_mean": -27.38008405940159, "cost1_mean": 340.71461001623555, "system_level_velocity_mean": 13.920277980329274, "cost2_min": -38.55780631389516, "cost1_max": 444.43683330343976, "cost1_min": 34.81948087978774, "cost2_max": -9.35360366304474, "outflow_rate_mean": 1132.291614192353, "system_level_velocity_min": 11.041856451659406, "outflow_rate_min": 330.22370737173105, "system_level_velocity_max": 18.37415941019547}, "info": {"num_steps_trained": 3600290, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011961707845330238, "total_loss": 9.236407279968262, "vf_loss": 9.238665580749512, "policy_loss": -0.004054562654346228, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9691505432128906, "entropy": 0.980567216873169}, "load_time_ms": 7.457, "grad_time_ms": 9841.023, "update_time_ms": 7.835, "num_steps_sampled": 3600290, "sample_time_ms": 15640.55}, "episode_len_mean": 662.39, "time_this_iter_s": 26.62630534172058, "num_metric_batches_dropped": 0, "timesteps_total": 3600290, "hostname": "flow-main", "episodes_total": 1447, "timestamp": 1557224799, "episode_reward_max": 1272.0671098052737, "episodes_this_iter": 19, "time_total_s": 2193.89803314209, "time_since_restore": 2193.89803314209}
{"timesteps_since_restore": 3641633, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41343, "date": "2019-05-07_10-27-04", "episode_reward_min": 58.52671369892059, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca60b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6ef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 88, "episode_reward_mean": 1015.7499508824325, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 88, "custom_metrics": {"outflow_rate_max": 1408.9941314685311, "cost2_mean": -26.93016427067461, "cost1_mean": 337.08095761607893, "system_level_velocity_mean": 13.809520154170345, "cost2_min": -37.70748578444438, "cost1_max": 444.43683330343976, "cost1_min": 33.20025191831366, "cost2_max": -8.856653270002482, "outflow_rate_mean": 1124.8097633089487, "system_level_velocity_min": 11.041856451659406, "outflow_rate_min": 330.22370737173105, "system_level_velocity_max": 18.37415941019547}, "info": {"num_steps_trained": 3641633, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012574795633554459, "total_loss": 6.591773986816406, "vf_loss": 6.596016883850098, "policy_loss": -0.006128630135208368, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9754741787910461, "entropy": 0.9642214775085449}, "load_time_ms": 7.415, "grad_time_ms": 9800.04, "update_time_ms": 8.073, "num_steps_sampled": 3641633, "sample_time_ms": 15538.763}, "episode_len_mean": 661.28, "time_this_iter_s": 24.77992606163025, "num_metric_batches_dropped": 0, "timesteps_total": 3641633, "hostname": "flow-main", "episodes_total": 1461, "timestamp": 1557224824, "episode_reward_max": 1272.0671098052737, "episodes_this_iter": 14, "time_total_s": 2218.67795920372, "time_since_restore": 2218.67795920372}
{"timesteps_since_restore": 3683323, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41690, "date": "2019-05-07_10-27-28", "episode_reward_min": 58.52671369892059, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95cc0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 89, "episode_reward_mean": 1027.8297318787406, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 89, "custom_metrics": {"outflow_rate_max": 1408.9941314685311, "cost2_mean": -25.54892290658835, "cost1_mean": 341.745753493425, "system_level_velocity_mean": 13.824154776671694, "cost2_min": -37.70748578444438, "cost1_max": 444.43683330343976, "cost1_min": 32.85108168362276, "cost2_max": -7.189638060635675, "outflow_rate_mean": 1137.1123247185653, "system_level_velocity_min": 11.041856451659406, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.334267858479876}, "info": {"num_steps_trained": 3683323, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011848238296806812, "total_loss": 8.257532119750977, "vf_loss": 8.261648178100586, "policy_loss": -0.005892215296626091, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9679859280586243, "entropy": 0.9687535762786865}, "load_time_ms": 7.319, "grad_time_ms": 9608.549, "update_time_ms": 8.02, "num_steps_sampled": 3683323, "sample_time_ms": 15722.839}, "episode_len_mean": 667.73, "time_this_iter_s": 24.731173515319824, "num_metric_batches_dropped": 0, "timesteps_total": 3683323, "hostname": "flow-main", "episodes_total": 1480, "timestamp": 1557224848, "episode_reward_max": 1272.0671098052737, "episodes_this_iter": 19, "time_total_s": 2243.40913271904, "time_since_restore": 2243.40913271904}
{"timesteps_since_restore": 3726996, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 43673, "date": "2019-05-07_10-27-55", "episode_reward_min": 53.33438596697386, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8af60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a7f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 90, "episode_reward_mean": 1020.285065793725, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 90, "custom_metrics": {"outflow_rate_max": 1408.9941314685311, "cost2_mean": -24.199624828177807, "cost1_mean": 338.2686231494435, "system_level_velocity_mean": 13.810104956378959, "cost2_min": -35.21298238965569, "cost1_max": 444.43683330343976, "cost1_min": 28.135300174926854, "cost2_max": -6.144947203033438, "outflow_rate_mean": 1126.2634410265534, "system_level_velocity_min": 11.041856451659406, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.873463960066733}, "info": {"num_steps_trained": 3726996, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011110357008874416, "total_loss": 6.591075420379639, "vf_loss": 6.593203067779541, "policy_loss": -0.0037949872203171253, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9736813306808472, "entropy": 0.9538724422454834}, "load_time_ms": 7.371, "grad_time_ms": 9435.014, "update_time_ms": 8.319, "num_steps_sampled": 3726996, "sample_time_ms": 16142.822}, "episode_len_mean": 663.86, "time_this_iter_s": 26.864993572235107, "num_metric_batches_dropped": 0, "timesteps_total": 3726996, "hostname": "flow-main", "episodes_total": 1493, "timestamp": 1557224875, "episode_reward_max": 1259.9079772823711, "episodes_this_iter": 13, "time_total_s": 2270.274126291275, "time_since_restore": 2270.274126291275}
{"timesteps_since_restore": 3768630, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41634, "date": "2019-05-07_10-28-20", "episode_reward_min": 53.33438596697386, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6ba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 91, "episode_reward_mean": 1028.4361567295928, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 91, "custom_metrics": {"outflow_rate_max": 1408.9941314685311, "cost2_mean": -23.002021611264954, "cost1_mean": 341.18164077767426, "system_level_velocity_mean": 13.786816357405755, "cost2_min": -35.21298238965569, "cost1_max": 444.43683330343976, "cost1_min": 28.135300174926854, "cost2_max": -6.144947203033438, "outflow_rate_mean": 1133.227174153556, "system_level_velocity_min": 11.422206625825714, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.873463960066733}, "info": {"num_steps_trained": 3768630, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01153832208365202, "total_loss": 6.015655994415283, "vf_loss": 6.018520832061768, "policy_loss": -0.0045963856391608715, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.978070080280304, "entropy": 0.9617961049079895}, "load_time_ms": 7.357, "grad_time_ms": 9244.345, "update_time_ms": 8.226, "num_steps_sampled": 3768630, "sample_time_ms": 16232.585}, "episode_len_mean": 669.62, "time_this_iter_s": 25.000670909881592, "num_metric_batches_dropped": 0, "timesteps_total": 3768630, "hostname": "flow-main", "episodes_total": 1508, "timestamp": 1557224900, "episode_reward_max": 1259.9079772823711, "episodes_this_iter": 15, "time_total_s": 2295.2747972011566, "time_since_restore": 2295.2747972011566}
{"timesteps_since_restore": 3810326, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41696, "date": "2019-05-07_10-28-45", "episode_reward_min": 53.33438596697386, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80550>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 92, "episode_reward_mean": 1029.4106230061777, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 92, "custom_metrics": {"outflow_rate_max": 1421.000877922078, "cost2_mean": -21.99880717726939, "cost1_mean": 342.2738537103604, "system_level_velocity_mean": 13.72589238615552, "cost2_min": -35.21298238965569, "cost1_max": 456.1886523205979, "cost1_min": 28.135300174926854, "cost2_max": -6.144947203033438, "outflow_rate_mean": 1130.3117286815802, "system_level_velocity_min": 10.567600249238936, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.873463960066733}, "info": {"num_steps_trained": 3810326, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01218833401799202, "total_loss": 8.102849960327148, "vf_loss": 8.105884552001953, "policy_loss": -0.0048619466833770275, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9723210334777832, "entropy": 0.9511589407920837}, "load_time_ms": 6.803, "grad_time_ms": 8892.71, "update_time_ms": 7.99, "num_steps_sampled": 3810326, "sample_time_ms": 16533.464}, "episode_len_mean": 674.48, "time_this_iter_s": 24.785602569580078, "num_metric_batches_dropped": 0, "timesteps_total": 3810326, "hostname": "flow-main", "episodes_total": 1528, "timestamp": 1557224925, "episode_reward_max": 1259.9079772823711, "episodes_this_iter": 20, "time_total_s": 2320.0603997707367, "time_since_restore": 2320.0603997707367}
{"timesteps_since_restore": 3851450, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41124, "date": "2019-05-07_10-29-10", "episode_reward_min": 53.33438596697386, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca67f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 93, "episode_reward_mean": 1033.632147113177, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 93, "custom_metrics": {"outflow_rate_max": 1421.000877922078, "cost2_mean": -21.280816893965394, "cost1_mean": 344.4397719202942, "system_level_velocity_mean": 13.684042482047735, "cost2_min": -30.530118202285962, "cost1_max": 456.1886523205979, "cost1_min": 28.135300174926854, "cost2_max": -6.144947203033438, "outflow_rate_mean": 1133.4773156917895, "system_level_velocity_min": 10.567600249238936, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.873463960066733}, "info": {"num_steps_trained": 3851450, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01321781799197197, "total_loss": 6.692215442657471, "vf_loss": 6.695133686065674, "policy_loss": -0.004901275970041752, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9776822328567505, "entropy": 0.9261875748634338}, "load_time_ms": 6.777, "grad_time_ms": 8638.463, "update_time_ms": 7.719, "num_steps_sampled": 3851450, "sample_time_ms": 16649.637}, "episode_len_mean": 680.43, "time_this_iter_s": 24.926309823989868, "num_metric_batches_dropped": 0, "timesteps_total": 3851450, "hostname": "flow-main", "episodes_total": 1542, "timestamp": 1557224950, "episode_reward_max": 1259.9079772823711, "episodes_this_iter": 14, "time_total_s": 2344.9867095947266, "time_since_restore": 2344.9867095947266}
{"timesteps_since_restore": 3893325, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41875, "date": "2019-05-07_10-29-35", "episode_reward_min": 53.33438596697386, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6080>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 94, "episode_reward_mean": 1035.5722401293513, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 94, "custom_metrics": {"outflow_rate_max": 1421.000877922078, "cost2_mean": -20.449325168279916, "cost1_mean": 347.3596004078869, "system_level_velocity_mean": 13.643309130203694, "cost2_min": -29.120617517276663, "cost1_max": 456.1886523205979, "cost1_min": 28.135300174926854, "cost2_max": -6.144947203033438, "outflow_rate_mean": 1140.1898453446981, "system_level_velocity_min": 10.567600249238936, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.873463960066733}, "info": {"num_steps_trained": 3893325, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01145421527326107, "total_loss": 7.7001848220825195, "vf_loss": 7.70148229598999, "policy_loss": -0.0030152699910104275, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9719054698944092, "entropy": 0.934080183506012}, "load_time_ms": 6.803, "grad_time_ms": 8526.076, "update_time_ms": 7.678, "num_steps_sampled": 3893325, "sample_time_ms": 16650.824}, "episode_len_mean": 686.93, "time_this_iter_s": 25.056121110916138, "num_metric_batches_dropped": 0, "timesteps_total": 3893325, "hostname": "flow-main", "episodes_total": 1558, "timestamp": 1557224975, "episode_reward_max": 1242.88516190009, "episodes_this_iter": 16, "time_total_s": 2370.0428307056427, "time_since_restore": 2370.0428307056427}
{"timesteps_since_restore": 3936159, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42834, "date": "2019-05-07_10-30-00", "episode_reward_min": 53.33438596697386, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca60b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 95, "episode_reward_mean": 1034.9308149222195, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 95, "custom_metrics": {"outflow_rate_max": 1421.000877922078, "cost2_mean": -20.147168750955785, "cost1_mean": 348.7076055910427, "system_level_velocity_mean": 13.690395283053197, "cost2_min": -28.887703765872676, "cost1_max": 456.1886523205979, "cost1_min": 28.135300174926854, "cost2_max": -6.144947203033438, "outflow_rate_mean": 1146.0912266558244, "system_level_velocity_min": 10.567600249238936, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.873463960066733}, "info": {"num_steps_trained": 3936159, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014260643161833286, "total_loss": 8.712361335754395, "vf_loss": 8.715035438537598, "policy_loss": -0.004814209882169962, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9690141677856445, "entropy": 0.9245675206184387}, "load_time_ms": 6.885, "grad_time_ms": 8516.445, "update_time_ms": 7.413, "num_steps_sampled": 3936159, "sample_time_ms": 16604.005}, "episode_len_mean": 687.94, "time_this_iter_s": 24.858155012130737, "num_metric_batches_dropped": 0, "timesteps_total": 3936159, "hostname": "flow-main", "episodes_total": 1572, "timestamp": 1557225000, "episode_reward_max": 1251.6494020028051, "episodes_this_iter": 14, "time_total_s": 2394.9009857177734, "time_since_restore": 2394.9009857177734}
{"timesteps_since_restore": 3977193, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41034, "date": "2019-05-07_10-30-25", "episode_reward_min": 64.58872960621088, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ae48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 96, "episode_reward_mean": 1028.630669070583, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 96, "custom_metrics": {"outflow_rate_max": 1421.000877922078, "cost2_mean": -19.551010464679933, "cost1_mean": 348.9217502258418, "system_level_velocity_mean": 13.75451710088293, "cost2_min": -28.887703765872676, "cost1_max": 456.1886523205979, "cost1_min": 33.112601547533295, "cost2_max": -7.135172606422708, "outflow_rate_mean": 1146.4375553162163, "system_level_velocity_min": 10.567600249238936, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.64659061050328}, "info": {"num_steps_trained": 3977193, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013433369807898998, "total_loss": 10.29271411895752, "vf_loss": 10.295967102050781, "policy_loss": -0.0052676936611533165, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9633423089981079, "entropy": 0.911479115486145}, "load_time_ms": 6.845, "grad_time_ms": 8520.655, "update_time_ms": 7.312, "num_steps_sampled": 3977193, "sample_time_ms": 16692.345}, "episode_len_mean": 685.31, "time_this_iter_s": 25.46634554862976, "num_metric_batches_dropped": 0, "timesteps_total": 3977193, "hostname": "flow-main", "episodes_total": 1591, "timestamp": 1557225025, "episode_reward_max": 1251.6494020028051, "episodes_this_iter": 19, "time_total_s": 2420.367331266403, "time_since_restore": 2420.367331266403}
{"timesteps_since_restore": 4017992, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40799, "date": "2019-05-07_10-30-50", "episode_reward_min": 64.58872960621088, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca67f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 97, "episode_reward_mean": 1001.4531279635518, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 97, "custom_metrics": {"outflow_rate_max": 1421.000877922078, "cost2_mean": -19.003896306161547, "cost1_mean": 342.6419324582218, "system_level_velocity_mean": 13.854009974739174, "cost2_min": -26.407856698062538, "cost1_max": 456.1886523205979, "cost1_min": 33.112601547533295, "cost2_max": -7.135172606422708, "outflow_rate_mean": 1134.4701775765839, "system_level_velocity_min": 10.567600249238936, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.64659061050328}, "info": {"num_steps_trained": 4017992, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014961374923586845, "total_loss": 15.230806350708008, "vf_loss": 15.2319917678833, "policy_loss": -0.0034284614957869053, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9511570930480957, "entropy": 0.8986130356788635}, "load_time_ms": 6.766, "grad_time_ms": 8478.228, "update_time_ms": 7.178, "num_steps_sampled": 4017992, "sample_time_ms": 16532.402}, "episode_len_mean": 671.72, "time_this_iter_s": 24.590627908706665, "num_metric_batches_dropped": 0, "timesteps_total": 4017992, "hostname": "flow-main", "episodes_total": 1613, "timestamp": 1557225050, "episode_reward_max": 1251.6494020028051, "episodes_this_iter": 22, "time_total_s": 2444.95795917511, "time_since_restore": 2444.95795917511}
{"timesteps_since_restore": 4060471, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42479, "date": "2019-05-07_10-31-15", "episode_reward_min": 64.58872960621088, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6f28>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 98, "episode_reward_mean": 990.7592854593826, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 98, "custom_metrics": {"outflow_rate_max": 1384.8659112887112, "cost2_mean": -18.46199239996165, "cost1_mean": 339.61905698062657, "system_level_velocity_mean": 13.894886766731839, "cost2_min": -26.407856698062538, "cost1_max": 422.9348883044443, "cost1_min": 33.112601547533295, "cost2_max": -7.135172606422708, "outflow_rate_mean": 1125.3911790477396, "system_level_velocity_min": 11.386927936956477, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.64659061050328}, "info": {"num_steps_trained": 4060471, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01410922221839428, "total_loss": 8.42877197265625, "vf_loss": 8.43191909790039, "policy_loss": -0.005263512022793293, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9683743715286255, "entropy": 0.8965422511100769}, "load_time_ms": 6.778, "grad_time_ms": 8524.257, "update_time_ms": 7.29, "num_steps_sampled": 4060471, "sample_time_ms": 16496.39}, "episode_len_mean": 666.09, "time_this_iter_s": 24.889881134033203, "num_metric_batches_dropped": 0, "timesteps_total": 4060471, "hostname": "flow-main", "episodes_total": 1626, "timestamp": 1557225075, "episode_reward_max": 1251.6494020028051, "episodes_this_iter": 13, "time_total_s": 2469.847840309143, "time_since_restore": 2469.847840309143}
{"timesteps_since_restore": 4102232, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41761, "date": "2019-05-07_10-31-41", "episode_reward_min": 64.58872960621088, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f048>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 99, "episode_reward_mean": 986.9365043417681, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 99, "custom_metrics": {"outflow_rate_max": 1352.9505190809193, "cost2_mean": -18.060911636604068, "cost1_mean": 337.80676913453834, "system_level_velocity_mean": 13.98019407375072, "cost2_min": -24.318804420452206, "cost1_max": 422.9348883044443, "cost1_min": 33.112601547533295, "cost2_max": -7.135172606422708, "outflow_rate_mean": 1123.3008511650607, "system_level_velocity_min": 11.386927936956477, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.64659061050328}, "info": {"num_steps_trained": 4102232, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014150730334222317, "total_loss": 9.23550796508789, "vf_loss": 9.239137649536133, "policy_loss": -0.0057519241236150265, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9628444910049438, "entropy": 0.9047986268997192}, "load_time_ms": 6.704, "grad_time_ms": 8640.543, "update_time_ms": 7.254, "num_steps_sampled": 4102232, "sample_time_ms": 16543.181}, "episode_len_mean": 659.59, "time_this_iter_s": 26.366828203201294, "num_metric_batches_dropped": 0, "timesteps_total": 4102232, "hostname": "flow-main", "episodes_total": 1642, "timestamp": 1557225101, "episode_reward_max": 1251.6494020028051, "episodes_this_iter": 16, "time_total_s": 2496.2146685123444, "time_since_restore": 2496.2146685123444}
{"timesteps_since_restore": 4143491, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41259, "date": "2019-05-07_10-32-06", "episode_reward_min": 48.9998060461898, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd550>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 100, "episode_reward_mean": 976.9077197380968, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 100, "custom_metrics": {"outflow_rate_max": 1352.9505190809193, "cost2_mean": -17.75211507737254, "cost1_mean": 333.3719620182159, "system_level_velocity_mean": 13.965983640332327, "cost2_min": -24.15374471752759, "cost1_max": 426.96877086259417, "cost1_min": 28.420497261391038, "cost2_max": -7.135172606422708, "outflow_rate_mean": 1113.2584132687227, "system_level_velocity_min": 11.386927936956477, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.245893489237513}, "info": {"num_steps_trained": 4143491, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013314771465957165, "total_loss": 9.965463638305664, "vf_loss": 9.967949867248535, "policy_loss": -0.004483509808778763, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9608703255653381, "entropy": 0.8910439014434814}, "load_time_ms": 6.655, "grad_time_ms": 8573.336, "update_time_ms": 7.258, "num_steps_sampled": 4143491, "sample_time_ms": 16368.082}, "episode_len_mean": 653.02, "time_this_iter_s": 24.44382405281067, "num_metric_batches_dropped": 0, "timesteps_total": 4143491, "hostname": "flow-main", "episodes_total": 1660, "timestamp": 1557225126, "episode_reward_max": 1251.6494020028051, "episodes_this_iter": 18, "time_total_s": 2520.658492565155, "time_since_restore": 2520.658492565155}
{"timesteps_since_restore": 4185281, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41790, "date": "2019-05-07_10-32-31", "episode_reward_min": 48.9998060461898, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc806d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80ba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 101, "episode_reward_mean": 984.0824446756317, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 101, "custom_metrics": {"outflow_rate_max": 1352.9505190809193, "cost2_mean": -17.644714085012048, "cost1_mean": 336.3781211900295, "system_level_velocity_mean": 13.909707960079345, "cost2_min": -23.26205846770486, "cost1_max": 426.96877086259417, "cost1_min": 28.420497261391038, "cost2_max": -7.135172606422708, "outflow_rate_mean": 1118.3627538234532, "system_level_velocity_min": 11.390030779165054, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.245893489237513}, "info": {"num_steps_trained": 4185281, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014421559870243073, "total_loss": 6.994373321533203, "vf_loss": 6.998201370239258, "policy_loss": -0.005990789737552404, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.972382128238678, "entropy": 0.9033821821212769}, "load_time_ms": 6.593, "grad_time_ms": 8598.729, "update_time_ms": 7.163, "num_steps_sampled": 4185281, "sample_time_ms": 16362.919}, "episode_len_mean": 658.51, "time_this_iter_s": 25.205411672592163, "num_metric_batches_dropped": 0, "timesteps_total": 4185281, "hostname": "flow-main", "episodes_total": 1675, "timestamp": 1557225151, "episode_reward_max": 1161.4484263431245, "episodes_this_iter": 15, "time_total_s": 2545.863904237747, "time_since_restore": 2545.863904237747}
{"timesteps_since_restore": 4226635, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41354, "date": "2019-05-07_10-32-56", "episode_reward_min": 48.9998060461898, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc952e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95eb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 102, "episode_reward_mean": 996.9420790979606, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 102, "custom_metrics": {"outflow_rate_max": 1352.9505190809193, "cost2_mean": -17.654770437916078, "cost1_mean": 339.73637550154825, "system_level_velocity_mean": 13.807429386359203, "cost2_min": -22.89322837258121, "cost1_max": 426.96877086259417, "cost1_min": 28.420497261391038, "cost2_max": -8.29999330878209, "outflow_rate_mean": 1126.913482727731, "system_level_velocity_min": 11.390030779165054, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.245893489237513}, "info": {"num_steps_trained": 4226635, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013364747166633606, "total_loss": 7.120662689208984, "vf_loss": 7.123469352722168, "policy_loss": -0.004811250604689121, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9763525724411011, "entropy": 0.9040569067001343}, "load_time_ms": 7.043, "grad_time_ms": 8685.088, "update_time_ms": 7.327, "num_steps_sampled": 4226635, "sample_time_ms": 16280.61}, "episode_len_mean": 667.71, "time_this_iter_s": 24.845380544662476, "num_metric_batches_dropped": 0, "timesteps_total": 4226635, "hostname": "flow-main", "episodes_total": 1693, "timestamp": 1557225176, "episode_reward_max": 1161.4484263431245, "episodes_this_iter": 18, "time_total_s": 2570.7092847824097, "time_since_restore": 2570.7092847824097}
{"timesteps_since_restore": 4268145, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41510, "date": "2019-05-07_10-33-21", "episode_reward_min": 48.9998060461898, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461150588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f2b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 103, "episode_reward_mean": 1011.0574387607879, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 103, "custom_metrics": {"outflow_rate_max": 1356.8963724275725, "cost2_mean": -17.65338677441265, "cost1_mean": 345.27055999843697, "system_level_velocity_mean": 13.914873196620395, "cost2_min": -22.89322837258121, "cost1_max": 430.0204782396197, "cost1_min": 28.420497261391038, "cost2_max": -8.29999330878209, "outflow_rate_mean": 1142.0445812171558, "system_level_velocity_min": 11.390030779165054, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.245893489237513}, "info": {"num_steps_trained": 4268145, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011995422653853893, "total_loss": 11.778849601745605, "vf_loss": 11.781590461730957, "policy_loss": -0.004540326539427042, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9527670741081238, "entropy": 0.9205659627914429}, "load_time_ms": 7.079, "grad_time_ms": 8666.164, "update_time_ms": 7.376, "num_steps_sampled": 4268145, "sample_time_ms": 16313.566}, "episode_len_mean": 672.06, "time_this_iter_s": 25.070813417434692, "num_metric_batches_dropped": 0, "timesteps_total": 4268145, "hostname": "flow-main", "episodes_total": 1709, "timestamp": 1557225201, "episode_reward_max": 1187.659375986422, "episodes_this_iter": 16, "time_total_s": 2595.7800981998444, "time_since_restore": 2595.7800981998444}
{"timesteps_since_restore": 4308810, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40665, "date": "2019-05-07_10-33-46", "episode_reward_min": 48.9998060461898, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03da0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 104, "episode_reward_mean": 1014.108121338504, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 104, "custom_metrics": {"outflow_rate_max": 1356.8963724275725, "cost2_mean": -17.942209893482893, "cost1_mean": 344.8363715210044, "system_level_velocity_mean": 13.914219199418282, "cost2_min": -23.485189233911132, "cost1_max": 430.0204782396197, "cost1_min": 28.420497261391038, "cost2_max": -8.29999330878209, "outflow_rate_mean": 1144.4297712143998, "system_level_velocity_min": 11.454703008397892, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.245893489237513}, "info": {"num_steps_trained": 4308810, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013559362851083279, "total_loss": 11.35112476348877, "vf_loss": 11.353185653686523, "policy_loss": -0.004094541072845459, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9610349535942078, "entropy": 0.8964791893959045}, "load_time_ms": 7.003, "grad_time_ms": 8493.924, "update_time_ms": 7.595, "num_steps_sampled": 4308810, "sample_time_ms": 16512.665}, "episode_len_mean": 671.76, "time_this_iter_s": 25.33002495765686, "num_metric_batches_dropped": 0, "timesteps_total": 4308810, "hostname": "flow-main", "episodes_total": 1728, "timestamp": 1557225226, "episode_reward_max": 1187.659375986422, "episodes_this_iter": 19, "time_total_s": 2621.110123157501, "time_since_restore": 2621.110123157501}
{"timesteps_since_restore": 4350566, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41756, "date": "2019-05-07_10-34-11", "episode_reward_min": 48.9998060461898, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfda90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca31d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 105, "episode_reward_mean": 1015.5071179560259, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 105, "custom_metrics": {"outflow_rate_max": 1388.4145434565437, "cost2_mean": -18.20711575350255, "cost1_mean": 346.1509017452086, "system_level_velocity_mean": 13.936850855308359, "cost2_min": -24.554732896348543, "cost1_max": 430.0204782396197, "cost1_min": 28.420497261391038, "cost2_max": -8.85246394191056, "outflow_rate_mean": 1152.081080284025, "system_level_velocity_min": 11.454703008397892, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.245893489237513}, "info": {"num_steps_trained": 4350566, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014058645814657211, "total_loss": 11.591383934020996, "vf_loss": 11.595067977905273, "policy_loss": -0.00579379266127944, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9508869051933289, "entropy": 0.9141486883163452}, "load_time_ms": 6.856, "grad_time_ms": 8445.963, "update_time_ms": 7.608, "num_steps_sampled": 4350566, "sample_time_ms": 16553.259}, "episode_len_mean": 672.3, "time_this_iter_s": 24.78833031654358, "num_metric_batches_dropped": 0, "timesteps_total": 4350566, "hostname": "flow-main", "episodes_total": 1745, "timestamp": 1557225251, "episode_reward_max": 1187.659375986422, "episodes_this_iter": 17, "time_total_s": 2645.898453474045, "time_since_restore": 2645.898453474045}
{"timesteps_since_restore": 4391645, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41079, "date": "2019-05-07_10-34-36", "episode_reward_min": 154.0481831705969, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3ac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 106, "episode_reward_mean": 1016.4980457694048, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 106, "custom_metrics": {"outflow_rate_max": 1388.4145434565437, "cost2_mean": -18.643258061894, "cost1_mean": 346.75189817200726, "system_level_velocity_mean": 13.925098320394692, "cost2_min": -26.092474800762165, "cost1_max": 430.0204782396197, "cost1_min": 70.2638959229435, "cost2_max": -9.960904559068553, "outflow_rate_mean": 1155.6405090730725, "system_level_velocity_min": 11.454703008397892, "outflow_rate_min": 439.954575437889, "system_level_velocity_max": 18.67720583792801}, "info": {"num_steps_trained": 4391645, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014344966039061546, "total_loss": 9.862996101379395, "vf_loss": 9.86768913269043, "policy_loss": -0.006845034658908844, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9649084806442261, "entropy": 0.911312460899353}, "load_time_ms": 6.866, "grad_time_ms": 8430.456, "update_time_ms": 7.681, "num_steps_sampled": 4391645, "sample_time_ms": 16511.146}, "episode_len_mean": 673.28, "time_this_iter_s": 24.89143991470337, "num_metric_batches_dropped": 0, "timesteps_total": 4391645, "hostname": "flow-main", "episodes_total": 1760, "timestamp": 1557225276, "episode_reward_max": 1187.659375986422, "episodes_this_iter": 15, "time_total_s": 2670.789893388748, "time_since_restore": 2670.789893388748}
{"timesteps_since_restore": 4433955, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42310, "date": "2019-05-07_10-35-01", "episode_reward_min": 154.0481831705969, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 107, "episode_reward_mean": 1022.7109112926581, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 107, "custom_metrics": {"outflow_rate_max": 1396.5268647352648, "cost2_mean": -18.921572767696784, "cost1_mean": 349.06782041039673, "system_level_velocity_mean": 14.026770766216504, "cost2_min": -26.135235299150946, "cost1_max": 430.0204782396197, "cost1_min": 70.2638959229435, "cost2_max": -9.960904559068553, "outflow_rate_mean": 1163.0975556984472, "system_level_velocity_min": 11.454703008397892, "outflow_rate_min": 439.954575437889, "system_level_velocity_max": 18.67720583792801}, "info": {"num_steps_trained": 4433955, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013897746801376343, "total_loss": 7.653388977050781, "vf_loss": 7.657090663909912, "policy_loss": -0.005786455236375332, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.969738781452179, "entropy": 0.8935576677322388}, "load_time_ms": 7.1, "grad_time_ms": 8534.348, "update_time_ms": 7.826, "num_steps_sampled": 4433955, "sample_time_ms": 16425.207}, "episode_len_mean": 673.28, "time_this_iter_s": 24.787779808044434, "num_metric_batches_dropped": 0, "timesteps_total": 4433955, "hostname": "flow-main", "episodes_total": 1777, "timestamp": 1557225301, "episode_reward_max": 1187.659375986422, "episodes_this_iter": 17, "time_total_s": 2695.5776731967926, "time_since_restore": 2695.5776731967926}
{"timesteps_since_restore": 4474692, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40737, "date": "2019-05-07_10-35-25", "episode_reward_min": 154.0481831705969, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca37f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca33c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 108, "episode_reward_mean": 1026.677943695673, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 108, "custom_metrics": {"outflow_rate_max": 1396.5268647352648, "cost2_mean": -19.089199503631704, "cost1_mean": 349.6424962249095, "system_level_velocity_mean": 14.048555836554067, "cost2_min": -26.382950709261205, "cost1_max": 430.0204782396197, "cost1_min": 70.2638959229435, "cost2_max": -9.960904559068553, "outflow_rate_mean": 1166.3004841220234, "system_level_velocity_min": 11.924480603444339, "outflow_rate_min": 439.954575437889, "system_level_velocity_max": 18.67720583792801}, "info": {"num_steps_trained": 4474692, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014094081707298756, "total_loss": 9.414009094238281, "vf_loss": 9.417795181274414, "policy_loss": -0.005899670533835888, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9628744125366211, "entropy": 0.9073705077171326}, "load_time_ms": 7.069, "grad_time_ms": 8671.701, "update_time_ms": 7.611, "num_steps_sampled": 4474692, "sample_time_ms": 16230.377}, "episode_len_mean": 673.28, "time_this_iter_s": 24.302236318588257, "num_metric_batches_dropped": 0, "timesteps_total": 4474692, "hostname": "flow-main", "episodes_total": 1792, "timestamp": 1557225325, "episode_reward_max": 1187.659375986422, "episodes_this_iter": 15, "time_total_s": 2719.879909515381, "time_since_restore": 2719.879909515381}
{"timesteps_since_restore": 4516044, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41352, "date": "2019-05-07_10-35-50", "episode_reward_min": 154.0481831705969, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95710>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 109, "episode_reward_mean": 1034.4163916959799, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 109, "custom_metrics": {"outflow_rate_max": 1396.5268647352648, "cost2_mean": -19.28011110969926, "cost1_mean": 351.1169090958616, "system_level_velocity_mean": 13.958041707161769, "cost2_min": -26.382950709261205, "cost1_max": 414.6994254989693, "cost1_min": 70.2638959229435, "cost2_max": -9.960904559068553, "outflow_rate_mean": 1170.4389299064815, "system_level_velocity_min": 11.924480603444339, "outflow_rate_min": 439.954575437889, "system_level_velocity_max": 18.67720583792801}, "info": {"num_steps_trained": 4516044, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014484387822449207, "total_loss": 13.085836410522461, "vf_loss": 13.089487075805664, "policy_loss": -0.005824495572596788, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9525643587112427, "entropy": 0.919933021068573}, "load_time_ms": 7.244, "grad_time_ms": 8764.252, "update_time_ms": 7.655, "num_steps_sampled": 4516044, "sample_time_ms": 15981.889}, "episode_len_mean": 678.63, "time_this_iter_s": 24.803775787353516, "num_metric_batches_dropped": 0, "timesteps_total": 4516044, "hostname": "flow-main", "episodes_total": 1810, "timestamp": 1557225350, "episode_reward_max": 1173.3647668470828, "episodes_this_iter": 18, "time_total_s": 2744.6836853027344, "time_since_restore": 2744.6836853027344}
{"timesteps_since_restore": 4557353, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41309, "date": "2019-05-07_10-36-14", "episode_reward_min": 154.0481831705969, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8aef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a2e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 110, "episode_reward_mean": 1043.4677921688024, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 110, "custom_metrics": {"outflow_rate_max": 1396.5268647352648, "cost2_mean": -19.3202927952738, "cost1_mean": 354.54938469207605, "system_level_velocity_mean": 13.938493153486014, "cost2_min": -26.382950709261205, "cost1_max": 414.6994254989693, "cost1_min": 70.2638959229435, "cost2_max": -11.00562376319268, "outflow_rate_mean": 1175.4626649395802, "system_level_velocity_min": 11.924480603444339, "outflow_rate_min": 439.954575437889, "system_level_velocity_max": 18.67720583792801}, "info": {"num_steps_trained": 4557353, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014587116427719593, "total_loss": 7.5412278175354, "vf_loss": 7.5454254150390625, "policy_loss": -0.006384704262018204, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9724920988082886, "entropy": 0.917582094669342}, "load_time_ms": 7.246, "grad_time_ms": 8916.659, "update_time_ms": 7.614, "num_steps_sampled": 4557353, "sample_time_ms": 15811.752}, "episode_len_mean": 684.56, "time_this_iter_s": 24.250157594680786, "num_metric_batches_dropped": 0, "timesteps_total": 4557353, "hostname": "flow-main", "episodes_total": 1826, "timestamp": 1557225374, "episode_reward_max": 1173.3647668470828, "episodes_this_iter": 16, "time_total_s": 2768.933842897415, "time_since_restore": 2768.933842897415}
{"timesteps_since_restore": 4596929, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39576, "date": "2019-05-07_10-36-40", "episode_reward_min": 225.54029605886765, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc952b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95c88>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 111, "episode_reward_mean": 1043.093373161913, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 111, "custom_metrics": {"outflow_rate_max": 1396.5268647352648, "cost2_mean": -19.2761423451778, "cost1_mean": 354.8012390635834, "system_level_velocity_mean": 13.968191583912926, "cost2_min": -26.382950709261205, "cost1_max": 414.6994254989693, "cost1_min": 94.61598743744958, "cost2_max": -13.622626120330839, "outflow_rate_mean": 1176.4180919519213, "system_level_velocity_min": 11.901689259834987, "outflow_rate_min": 515.4032375227074, "system_level_velocity_max": 18.171108645798522}, "info": {"num_steps_trained": 4596929, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013878373429179192, "total_loss": 12.31430721282959, "vf_loss": 12.318085670471191, "policy_loss": -0.0058600264601409435, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.954580545425415, "entropy": 0.9460352659225464}, "load_time_ms": 7.44, "grad_time_ms": 8994.996, "update_time_ms": 7.607, "num_steps_sampled": 4596929, "sample_time_ms": 15766.292}, "episode_len_mean": 683.88, "time_this_iter_s": 25.537251710891724, "num_metric_batches_dropped": 0, "timesteps_total": 4596929, "hostname": "flow-main", "episodes_total": 1844, "timestamp": 1557225400, "episode_reward_max": 1173.3647668470828, "episodes_this_iter": 18, "time_total_s": 2794.471094608307, "time_since_restore": 2794.471094608307}
{"timesteps_since_restore": 4638506, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41577, "date": "2019-05-07_10-37-05", "episode_reward_min": 244.23587346051508, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd5f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 112, "episode_reward_mean": 1055.822821128662, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 112, "custom_metrics": {"outflow_rate_max": 1396.5268647352648, "cost2_mean": -18.770702097956462, "cost1_mean": 360.0772080232745, "system_level_velocity_mean": 14.051338460949651, "cost2_min": -26.382950709261205, "cost1_max": 414.6994254989693, "cost1_min": 101.84574048131003, "cost2_max": -13.622626120330839, "outflow_rate_mean": 1192.4950268973737, "system_level_velocity_min": 11.901689259834987, "outflow_rate_min": 521.2836954532164, "system_level_velocity_max": 17.4200269444809}, "info": {"num_steps_trained": 4638506, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01263858936727047, "total_loss": 10.082470893859863, "vf_loss": 10.08575439453125, "policy_loss": -0.005180285777896643, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9574989080429077, "entropy": 0.9474055767059326}, "load_time_ms": 7.485, "grad_time_ms": 9030.976, "update_time_ms": 7.845, "num_steps_sampled": 4638506, "sample_time_ms": 15761.851}, "episode_len_mean": 689.47, "time_this_iter_s": 25.160995483398438, "num_metric_batches_dropped": 0, "timesteps_total": 4638506, "hostname": "flow-main", "episodes_total": 1862, "timestamp": 1557225425, "episode_reward_max": 1173.3647668470828, "episodes_this_iter": 18, "time_total_s": 2819.6320900917053, "time_since_restore": 2819.6320900917053}
{"timesteps_since_restore": 4680980, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42474, "date": "2019-05-07_10-37-36", "episode_reward_min": 244.23587346051508, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0278>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 113, "episode_reward_mean": 1055.6765833715644, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 113, "custom_metrics": {"outflow_rate_max": 1372.616226973027, "cost2_mean": -18.456305157286884, "cost1_mean": 358.03568510574206, "system_level_velocity_mean": 14.015475242807304, "cost2_min": -26.382950709261205, "cost1_max": 414.6994254989693, "cost1_min": 101.84574048131003, "cost2_max": -13.622626120330839, "outflow_rate_mean": 1188.1544708834135, "system_level_velocity_min": 11.901689259834987, "outflow_rate_min": 521.2836954532164, "system_level_velocity_max": 17.4200269444809}, "info": {"num_steps_trained": 4680980, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012520984746515751, "total_loss": 7.098237991333008, "vf_loss": 7.100708484649658, "policy_loss": -0.004347403068095446, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9719032049179077, "entropy": 0.9202187657356262}, "load_time_ms": 7.521, "grad_time_ms": 9496.062, "update_time_ms": 7.99, "num_steps_sampled": 4680980, "sample_time_ms": 15871.849}, "episode_len_mean": 687.09, "time_this_iter_s": 30.861499786376953, "num_metric_batches_dropped": 0, "timesteps_total": 4680980, "hostname": "flow-main", "episodes_total": 1875, "timestamp": 1557225456, "episode_reward_max": 1221.99210667185, "episodes_this_iter": 13, "time_total_s": 2850.4935898780823, "time_since_restore": 2850.4935898780823}
{"timesteps_since_restore": 4723036, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42056, "date": "2019-05-07_10-38-02", "episode_reward_min": 244.23587346051508, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdeb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 114, "episode_reward_mean": 1055.6510891783848, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 114, "custom_metrics": {"outflow_rate_max": 1372.616226973027, "cost2_mean": -18.342689028376945, "cost1_mean": 358.04527410740064, "system_level_velocity_mean": 14.021794792749194, "cost2_min": -23.71742814540064, "cost1_max": 411.8141168840759, "cost1_min": 101.84574048131003, "cost2_max": -11.859330847748554, "outflow_rate_mean": 1186.4629246776192, "system_level_velocity_min": 11.847517887964843, "outflow_rate_min": 521.2836954532164, "system_level_velocity_max": 17.4200269444809}, "info": {"num_steps_trained": 4723036, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01471036858856678, "total_loss": 7.924737930297852, "vf_loss": 7.928380489349365, "policy_loss": -0.005848837550729513, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9665852785110474, "entropy": 0.936553955078125}, "load_time_ms": 7.474, "grad_time_ms": 9605.572, "update_time_ms": 8.079, "num_steps_sampled": 4723036, "sample_time_ms": 15770.695}, "episode_len_mean": 687.09, "time_this_iter_s": 25.405130624771118, "num_metric_batches_dropped": 0, "timesteps_total": 4723036, "hostname": "flow-main", "episodes_total": 1891, "timestamp": 1557225482, "episode_reward_max": 1221.99210667185, "episodes_this_iter": 16, "time_total_s": 2875.8987205028534, "time_since_restore": 2875.8987205028534}
{"timesteps_since_restore": 4764946, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41910, "date": "2019-05-07_10-38-28", "episode_reward_min": 244.23587346051508, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 115, "episode_reward_mean": 1053.4009368334237, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 115, "custom_metrics": {"outflow_rate_max": 1418.2294441558445, "cost2_mean": -18.136378390490794, "cost1_mean": 354.9858158241669, "system_level_velocity_mean": 14.007180282474248, "cost2_min": -24.462154970630138, "cost1_max": 412.14672257129934, "cost1_min": 101.84574048131003, "cost2_max": -11.859330847748554, "outflow_rate_mean": 1178.8896163402833, "system_level_velocity_min": 11.825117745433714, "outflow_rate_min": 521.2836954532164, "system_level_velocity_max": 17.4200269444809}, "info": {"num_steps_trained": 4764946, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012210283428430557, "total_loss": 9.955949783325195, "vf_loss": 9.959264755249023, "policy_loss": -0.005147324409335852, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9547430872917175, "entropy": 0.9420709013938904}, "load_time_ms": 7.558, "grad_time_ms": 9552.122, "update_time_ms": 8.096, "num_steps_sampled": 4764946, "sample_time_ms": 15946.849}, "episode_len_mean": 682.29, "time_this_iter_s": 26.00559401512146, "num_metric_batches_dropped": 0, "timesteps_total": 4764946, "hostname": "flow-main", "episodes_total": 1908, "timestamp": 1557225508, "episode_reward_max": 1221.99210667185, "episodes_this_iter": 17, "time_total_s": 2901.904314517975, "time_since_restore": 2901.904314517975}
{"timesteps_since_restore": 4806045, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41099, "date": "2019-05-07_10-38-53", "episode_reward_min": 244.23587346051508, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb09b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 116, "episode_reward_mean": 1059.5947608403812, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 116, "custom_metrics": {"outflow_rate_max": 1418.2294441558445, "cost2_mean": -17.87594533895296, "cost1_mean": 353.41866688148707, "system_level_velocity_mean": 13.851257221801333, "cost2_min": -24.462154970630138, "cost1_max": 412.14672257129934, "cost1_min": 101.84574048131003, "cost2_max": -11.859330847748554, "outflow_rate_mean": 1174.2710612585806, "system_level_velocity_min": 11.825117745433714, "outflow_rate_min": 521.2836954532164, "system_level_velocity_max": 17.4200269444809}, "info": {"num_steps_trained": 4806045, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015167726203799248, "total_loss": 8.016531944274902, "vf_loss": 8.019474029541016, "policy_loss": -0.005217321682721376, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9698946475982666, "entropy": 0.9283215999603271}, "load_time_ms": 7.677, "grad_time_ms": 9456.669, "update_time_ms": 8.36, "num_steps_sampled": 4806045, "sample_time_ms": 16074.776}, "episode_len_mean": 686.18, "time_this_iter_s": 25.241475343704224, "num_metric_batches_dropped": 0, "timesteps_total": 4806045, "hostname": "flow-main", "episodes_total": 1926, "timestamp": 1557225533, "episode_reward_max": 1221.99210667185, "episodes_this_iter": 18, "time_total_s": 2927.145789861679, "time_since_restore": 2927.145789861679}
{"timesteps_since_restore": 4846963, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40918, "date": "2019-05-07_10-39-17", "episode_reward_min": 334.65672753390754, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca35c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 117, "episode_reward_mean": 1075.191529335244, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 117, "custom_metrics": {"outflow_rate_max": 1418.2294441558445, "cost2_mean": -17.661128770808183, "cost1_mean": 355.22507712866945, "system_level_velocity_mean": 13.744111687427669, "cost2_min": -24.462154970630138, "cost1_max": 412.14672257129934, "cost1_min": 139.04407425209752, "cost2_max": -11.859330847748554, "outflow_rate_mean": 1180.1306652231297, "system_level_velocity_min": 10.94531419699427, "outflow_rate_min": 734.8738931395534, "system_level_velocity_max": 17.0404694724742}, "info": {"num_steps_trained": 4846963, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012586494907736778, "total_loss": 10.556440353393555, "vf_loss": 10.559850692749023, "policy_loss": -0.005299043375998735, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9555180668830872, "entropy": 0.9397096037864685}, "load_time_ms": 7.468, "grad_time_ms": 9282.076, "update_time_ms": 8.587, "num_steps_sampled": 4846963, "sample_time_ms": 16216.268}, "episode_len_mean": 692.82, "time_this_iter_s": 24.470086097717285, "num_metric_batches_dropped": 0, "timesteps_total": 4846963, "hostname": "flow-main", "episodes_total": 1943, "timestamp": 1557225557, "episode_reward_max": 1221.99210667185, "episodes_this_iter": 17, "time_total_s": 2951.6158759593964, "time_since_restore": 2951.6158759593964}
{"timesteps_since_restore": 4888355, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41392, "date": "2019-05-07_10-39-42", "episode_reward_min": 334.65672753390754, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb08d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 118, "episode_reward_mean": 1075.961420682646, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 118, "custom_metrics": {"outflow_rate_max": 1418.8479592407596, "cost2_mean": -17.537755239936384, "cost1_mean": 354.1947147096026, "system_level_velocity_mean": 13.746149032775156, "cost2_min": -24.462154970630138, "cost1_max": 418.5781421091915, "cost1_min": 139.04407425209752, "cost2_max": -11.859330847748554, "outflow_rate_mean": 1177.2790490978969, "system_level_velocity_min": 10.94531419699427, "outflow_rate_min": 734.8738931395534, "system_level_velocity_max": 17.0404694724742}, "info": {"num_steps_trained": 4888355, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015432783402502537, "total_loss": 9.684957504272461, "vf_loss": 9.689705848693848, "policy_loss": -0.007064062170684338, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9522806406021118, "entropy": 0.9637694954872131}, "load_time_ms": 7.608, "grad_time_ms": 9197.184, "update_time_ms": 8.795, "num_steps_sampled": 4888355, "sample_time_ms": 16317.999}, "episode_len_mean": 690.49, "time_this_iter_s": 24.493114948272705, "num_metric_batches_dropped": 0, "timesteps_total": 4888355, "hostname": "flow-main", "episodes_total": 1955, "timestamp": 1557225582, "episode_reward_max": 1221.99210667185, "episodes_this_iter": 12, "time_total_s": 2976.108990907669, "time_since_restore": 2976.108990907669}
{"timesteps_since_restore": 4929552, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41197, "date": "2019-05-07_10-40-07", "episode_reward_min": 334.65672753390754, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb05c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb03c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0160>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 119, "episode_reward_mean": 1079.8145019588526, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 119, "custom_metrics": {"outflow_rate_max": 1418.8479592407596, "cost2_mean": -17.629570743665955, "cost1_mean": 356.5030549908126, "system_level_velocity_mean": 13.802892911978917, "cost2_min": -24.462154970630138, "cost1_max": 418.5781421091915, "cost1_min": 139.04407425209752, "cost2_max": -11.859330847748554, "outflow_rate_mean": 1181.7825152577113, "system_level_velocity_min": 10.94531419699427, "outflow_rate_min": 734.8738931395534, "system_level_velocity_max": 17.0404694724742}, "info": {"num_steps_trained": 4929552, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013864652253687382, "total_loss": 9.455711364746094, "vf_loss": 9.458946228027344, "policy_loss": -0.005315697286278009, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9570064544677734, "entropy": 0.9763792157173157}, "load_time_ms": 7.46, "grad_time_ms": 9161.944, "update_time_ms": 8.954, "num_steps_sampled": 4929552, "sample_time_ms": 16371.131}, "episode_len_mean": 692.87, "time_this_iter_s": 25.0064594745636, "num_metric_batches_dropped": 0, "timesteps_total": 4929552, "hostname": "flow-main", "episodes_total": 1973, "timestamp": 1557225607, "episode_reward_max": 1221.99210667185, "episodes_this_iter": 18, "time_total_s": 3001.1154503822327, "time_since_restore": 3001.1154503822327}
{"timesteps_since_restore": 4970416, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40864, "date": "2019-05-07_10-40-32", "episode_reward_min": 198.65128072373685, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0da0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 120, "episode_reward_mean": 1063.8981328931543, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 120, "custom_metrics": {"outflow_rate_max": 1418.8479592407596, "cost2_mean": -17.874468299139366, "cost1_mean": 350.26423221634985, "system_level_velocity_mean": 13.854389198307105, "cost2_min": -27.274738039448167, "cost1_max": 418.5781421091915, "cost1_min": 87.63863013376351, "cost2_max": -11.830015170307654, "outflow_rate_mean": 1170.6886587176266, "system_level_velocity_min": 10.94531419699427, "outflow_rate_min": 514.0301288336074, "system_level_velocity_max": 18.776502599081525}, "info": {"num_steps_trained": 4970416, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015409388579428196, "total_loss": 11.713818550109863, "vf_loss": 11.716702461242676, "policy_loss": -0.005195139907300472, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9561582803726196, "entropy": 0.9738578200340271}, "load_time_ms": 7.567, "grad_time_ms": 9189.85, "update_time_ms": 9.061, "num_steps_sampled": 4970416, "sample_time_ms": 16439.19}, "episode_len_mean": 682.1, "time_this_iter_s": 25.214460849761963, "num_metric_batches_dropped": 0, "timesteps_total": 4970416, "hostname": "flow-main", "episodes_total": 1992, "timestamp": 1557225632, "episode_reward_max": 1206.2829846603336, "episodes_this_iter": 19, "time_total_s": 3026.3299112319946, "time_since_restore": 3026.3299112319946}
{"timesteps_since_restore": 5011597, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41181, "date": "2019-05-07_10-40-57", "episode_reward_min": 198.65128072373685, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80b70>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 121, "episode_reward_mean": 1054.8305329479845, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 121, "custom_metrics": {"outflow_rate_max": 1418.8479592407596, "cost2_mean": -18.04321255408392, "cost1_mean": 349.7757125729073, "system_level_velocity_mean": 14.001737065156592, "cost2_min": -27.28957147004857, "cost1_max": 418.5781421091915, "cost1_min": 87.63863013376351, "cost2_max": -11.043431541534451, "outflow_rate_mean": 1169.8573259945936, "system_level_velocity_min": 10.94531419699427, "outflow_rate_min": 497.0154819424521, "system_level_velocity_max": 18.776502599081525}, "info": {"num_steps_trained": 5011597, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01588335633277893, "total_loss": 11.236126899719238, "vf_loss": 11.240412712097168, "policy_loss": -0.006666439585387707, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9480892419815063, "entropy": 0.9864766001701355}, "load_time_ms": 7.522, "grad_time_ms": 9245.294, "update_time_ms": 9.002, "num_steps_sampled": 5011597, "sample_time_ms": 16277.513}, "episode_len_mean": 676.57, "time_this_iter_s": 24.478984355926514, "num_metric_batches_dropped": 0, "timesteps_total": 5011597, "hostname": "flow-main", "episodes_total": 2007, "timestamp": 1557225657, "episode_reward_max": 1219.3078127272165, "episodes_this_iter": 15, "time_total_s": 3050.808895587921, "time_since_restore": 3050.808895587921}
{"timesteps_since_restore": 5053056, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41459, "date": "2019-05-07_10-41-20", "episode_reward_min": 198.65128072373685, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca37f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca35c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 122, "episode_reward_mean": 1059.0155193055282, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 122, "custom_metrics": {"outflow_rate_max": 1418.8479592407596, "cost2_mean": -18.451387939648022, "cost1_mean": 354.1215735432264, "system_level_velocity_mean": 14.190695851954995, "cost2_min": -27.28957147004857, "cost1_max": 418.5781421091915, "cost1_min": 87.63863013376351, "cost2_max": -11.043431541534451, "outflow_rate_mean": 1183.2252620705176, "system_level_velocity_min": 10.94531419699427, "outflow_rate_min": 497.0154819424521, "system_level_velocity_max": 18.776502599081525}, "info": {"num_steps_trained": 5053056, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011992091313004494, "total_loss": 9.666097640991211, "vf_loss": 9.67008113861084, "policy_loss": -0.005781983025372028, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9603917598724365, "entropy": 0.9725174307823181}, "load_time_ms": 7.431, "grad_time_ms": 9329.891, "update_time_ms": 8.982, "num_steps_sampled": 5053056, "sample_time_ms": 16056.659}, "episode_len_mean": 676.57, "time_this_iter_s": 23.818626880645752, "num_metric_batches_dropped": 0, "timesteps_total": 5053056, "hostname": "flow-main", "episodes_total": 2026, "timestamp": 1557225680, "episode_reward_max": 1221.8952026597478, "episodes_this_iter": 19, "time_total_s": 3074.627522468567, "time_since_restore": 3074.627522468567}
{"timesteps_since_restore": 5093268, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40212, "date": "2019-05-07_10-41-45", "episode_reward_min": 198.65128072373685, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0e48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 123, "episode_reward_mean": 1045.434787695623, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 123, "custom_metrics": {"outflow_rate_max": 1418.8479592407596, "cost2_mean": -19.100975544305474, "cost1_mean": 351.58211959034384, "system_level_velocity_mean": 14.266807801527243, "cost2_min": -30.49057391533411, "cost1_max": 418.5781421091915, "cost1_min": 87.42602321466138, "cost2_max": -11.043431541534451, "outflow_rate_mean": 1174.286534833709, "system_level_velocity_min": 11.43601490090153, "outflow_rate_min": 497.0154819424521, "system_level_velocity_max": 18.776502599081525}, "info": {"num_steps_trained": 5093268, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014030339196324348, "total_loss": 7.458311080932617, "vf_loss": 7.460955619812012, "policy_loss": -0.004749152809381485, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9725567102432251, "entropy": 0.9633747339248657}, "load_time_ms": 7.36, "grad_time_ms": 8938.14, "update_time_ms": 9.145, "num_steps_sampled": 5093268, "sample_time_ms": 15771.386}, "episode_len_mean": 670.92, "time_this_iter_s": 24.08507251739502, "num_metric_batches_dropped": 0, "timesteps_total": 5093268, "hostname": "flow-main", "episodes_total": 2042, "timestamp": 1557225705, "episode_reward_max": 1221.8952026597478, "episodes_this_iter": 16, "time_total_s": 3098.712594985962, "time_since_restore": 3098.712594985962}
{"timesteps_since_restore": 5133257, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39989, "date": "2019-05-07_10-42-09", "episode_reward_min": 198.65128072373685, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb05f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 124, "episode_reward_mean": 1038.268044434207, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 124, "custom_metrics": {"outflow_rate_max": 1383.1381582417582, "cost2_mean": -19.452239332239134, "cost1_mean": 350.8648874757053, "system_level_velocity_mean": 14.3637076435488, "cost2_min": -30.49057391533411, "cost1_max": 416.5898693476031, "cost1_min": 87.42602321466138, "cost2_max": -11.043431541534451, "outflow_rate_mean": 1173.1105445520393, "system_level_velocity_min": 11.43601490090153, "outflow_rate_min": 497.0154819424521, "system_level_velocity_max": 18.776502599081525}, "info": {"num_steps_trained": 5133257, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014135036617517471, "total_loss": 15.869292259216309, "vf_loss": 15.872721672058105, "policy_loss": -0.005548096727579832, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9272990822792053, "entropy": 0.9805882573127747}, "load_time_ms": 7.31, "grad_time_ms": 8968.301, "update_time_ms": 9.3, "num_steps_sampled": 5133257, "sample_time_ms": 15667.512}, "episode_len_mean": 667.58, "time_this_iter_s": 24.682659149169922, "num_metric_batches_dropped": 0, "timesteps_total": 5133257, "hostname": "flow-main", "episodes_total": 2059, "timestamp": 1557225729, "episode_reward_max": 1221.8952026597478, "episodes_this_iter": 17, "time_total_s": 3123.395254135132, "time_since_restore": 3123.395254135132}
{"timesteps_since_restore": 5174476, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41219, "date": "2019-05-07_10-42-35", "episode_reward_min": 173.90166937308686, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb00f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 125, "episode_reward_mean": 1017.5897484658315, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 125, "custom_metrics": {"outflow_rate_max": 1430.5485762237763, "cost2_mean": -19.834941562705676, "cost1_mean": 345.1888981730075, "system_level_velocity_mean": 14.414681065429958, "cost2_min": -37.695934067713836, "cost1_max": 416.8747410484732, "cost1_min": 76.29980609996113, "cost2_max": -10.491229714187886, "outflow_rate_mean": 1161.5327223554198, "system_level_velocity_min": 11.43601490090153, "outflow_rate_min": 449.64285161611645, "system_level_velocity_max": 18.776502599081525}, "info": {"num_steps_trained": 5174476, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016934024170041084, "total_loss": 12.019086837768555, "vf_loss": 12.024471282958984, "policy_loss": -0.00792466290295124, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9562159776687622, "entropy": 0.9849506616592407}, "load_time_ms": 7.253, "grad_time_ms": 9000.741, "update_time_ms": 9.782, "num_steps_sampled": 5174476, "sample_time_ms": 15575.402}, "episode_len_mean": 657.6, "time_this_iter_s": 25.411691427230835, "num_metric_batches_dropped": 0, "timesteps_total": 5174476, "hostname": "flow-main", "episodes_total": 2077, "timestamp": 1557225755, "episode_reward_max": 1221.8952026597478, "episodes_this_iter": 18, "time_total_s": 3148.8069455623627, "time_since_restore": 3148.8069455623627}
{"timesteps_since_restore": 5213458, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 38982, "date": "2019-05-07_10-43-09", "episode_reward_min": 53.661078994119514, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0fd0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 126, "episode_reward_mean": 1018.3854381957921, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 126, "custom_metrics": {"outflow_rate_max": 1430.5485762237763, "cost2_mean": -19.841026150617566, "cost1_mean": 347.6420281065281, "system_level_velocity_mean": 14.483545688932674, "cost2_min": -38.00426600794427, "cost1_max": 416.8747410484732, "cost1_min": 28.557082650754584, "cost2_max": -7.026465328452192, "outflow_rate_mean": 1163.8642943663917, "system_level_velocity_min": 11.43601490090153, "outflow_rate_min": 338.35525222187107, "system_level_velocity_max": 19.221188653450252}, "info": {"num_steps_trained": 5213458, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016867641359567642, "total_loss": 13.288497924804688, "vf_loss": 13.293663024902344, "policy_loss": -0.007694931235164404, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9472442269325256, "entropy": 1.0014907121658325}, "load_time_ms": 7.035, "grad_time_ms": 9203.442, "update_time_ms": 9.703, "num_steps_sampled": 5213458, "sample_time_ms": 16270.59}, "episode_len_mean": 660.7, "time_this_iter_s": 34.215434551239014, "num_metric_batches_dropped": 0, "timesteps_total": 5213458, "hostname": "flow-main", "episodes_total": 2095, "timestamp": 1557225789, "episode_reward_max": 1221.8952026597478, "episodes_this_iter": 18, "time_total_s": 3183.0223801136017, "time_since_restore": 3183.0223801136017}
{"timesteps_since_restore": 5253698, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40240, "date": "2019-05-07_10-43-38", "episode_reward_min": 53.661078994119514, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca65f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 127, "episode_reward_mean": 1002.0080519247217, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 127, "custom_metrics": {"outflow_rate_max": 1430.5485762237763, "cost2_mean": -19.866036138080812, "cost1_mean": 344.3183205502162, "system_level_velocity_mean": 14.560403229678496, "cost2_min": -38.00426600794427, "cost1_max": 416.8747410484732, "cost1_min": 28.207516213305492, "cost2_max": -4.52786821759828, "outflow_rate_mean": 1157.7464652195774, "system_level_velocity_min": 11.43601490090153, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 19.221188653450252}, "info": {"num_steps_trained": 5253698, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015340576879680157, "total_loss": 19.623783111572266, "vf_loss": 19.627880096435547, "policy_loss": -0.006398844998329878, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9099634289741516, "entropy": 0.9982171654701233}, "load_time_ms": 7.036, "grad_time_ms": 9278.14, "update_time_ms": 9.974, "num_steps_sampled": 5253698, "sample_time_ms": 16648.517}, "episode_len_mean": 654.23, "time_this_iter_s": 28.984902381896973, "num_metric_batches_dropped": 0, "timesteps_total": 5253698, "hostname": "flow-main", "episodes_total": 2116, "timestamp": 1557225818, "episode_reward_max": 1221.8952026597478, "episodes_this_iter": 21, "time_total_s": 3212.0072824954987, "time_since_restore": 3212.0072824954987}
{"timesteps_since_restore": 5293849, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40151, "date": "2019-05-07_10-44-02", "episode_reward_min": 53.661078994119514, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca37f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca39b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3240>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 128, "episode_reward_mean": 983.7702521161045, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 128, "custom_metrics": {"outflow_rate_max": 1430.5485762237763, "cost2_mean": -19.54312655476732, "cost1_mean": 339.65032872424234, "system_level_velocity_mean": 14.608285981036685, "cost2_min": -38.00426600794427, "cost1_max": 416.8747410484732, "cost1_min": 28.207516213305492, "cost2_max": -4.52786821759828, "outflow_rate_mean": 1149.063242370843, "system_level_velocity_min": 11.886598896096324, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 19.221188653450252}, "info": {"num_steps_trained": 5293849, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012688787654042244, "total_loss": 13.890789985656738, "vf_loss": 13.894314765930176, "policy_loss": -0.005428551696240902, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9385536909103394, "entropy": 0.9832029342651367}, "load_time_ms": 6.884, "grad_time_ms": 9249.552, "update_time_ms": 9.861, "num_steps_sampled": 5293849, "sample_time_ms": 16654.151}, "episode_len_mean": 646.05, "time_this_iter_s": 24.241366147994995, "num_metric_batches_dropped": 0, "timesteps_total": 5293849, "hostname": "flow-main", "episodes_total": 2133, "timestamp": 1557225842, "episode_reward_max": 1205.065939776472, "episodes_this_iter": 17, "time_total_s": 3236.2486486434937, "time_since_restore": 3236.2486486434937}
{"timesteps_since_restore": 5334175, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40326, "date": "2019-05-07_10-44-27", "episode_reward_min": 53.661078994119514, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb05f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0080>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 129, "episode_reward_mean": 978.4411061668809, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 129, "custom_metrics": {"outflow_rate_max": 1430.5485762237763, "cost2_mean": -19.75895349128326, "cost1_mean": 337.4597306592532, "system_level_velocity_mean": 14.545676868918612, "cost2_min": -38.00426600794427, "cost1_max": 420.42088363936614, "cost1_min": 28.207516213305492, "cost2_max": -4.52786821759828, "outflow_rate_mean": 1144.2363514137999, "system_level_velocity_min": 11.886598896096324, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 19.221188653450252}, "info": {"num_steps_trained": 5334175, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014165672473609447, "total_loss": 9.217535018920898, "vf_loss": 9.22236442565918, "policy_loss": -0.006954723037779331, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9544892907142639, "entropy": 1.014807105064392}, "load_time_ms": 7.014, "grad_time_ms": 9209.148, "update_time_ms": 9.79, "num_steps_sampled": 5334175, "sample_time_ms": 16694.016}, "episode_len_mean": 646.05, "time_this_iter_s": 24.974961519241333, "num_metric_batches_dropped": 0, "timesteps_total": 5334175, "hostname": "flow-main", "episodes_total": 2150, "timestamp": 1557225867, "episode_reward_max": 1205.065939776472, "episodes_this_iter": 17, "time_total_s": 3261.223610162735, "time_since_restore": 3261.223610162735}
{"timesteps_since_restore": 5375271, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41096, "date": "2019-05-07_10-44-53", "episode_reward_min": 53.661078994119514, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0550>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 130, "episode_reward_mean": 966.1852474145805, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 130, "custom_metrics": {"outflow_rate_max": 1430.5485762237763, "cost2_mean": -20.126409383010042, "cost1_mean": 337.42446850703794, "system_level_velocity_mean": 14.580128491976446, "cost2_min": -38.00426600794427, "cost1_max": 420.42088363936614, "cost1_min": 28.207516213305492, "cost2_max": -4.52786821759828, "outflow_rate_mean": 1145.1139678043999, "system_level_velocity_min": 11.886598896096324, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 19.221188653450252}, "info": {"num_steps_trained": 5375271, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013110318221151829, "total_loss": 13.372382164001465, "vf_loss": 13.373244285583496, "policy_loss": -0.0028302886057645082, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9417393803596497, "entropy": 1.0134670734405518}, "load_time_ms": 6.899, "grad_time_ms": 9211.217, "update_time_ms": 9.619, "num_steps_sampled": 5375271, "sample_time_ms": 16714.723}, "episode_len_mean": 646.23, "time_this_iter_s": 25.440584659576416, "num_metric_batches_dropped": 0, "timesteps_total": 5375271, "hostname": "flow-main", "episodes_total": 2166, "timestamp": 1557225893, "episode_reward_max": 1166.952976247581, "episodes_this_iter": 16, "time_total_s": 3286.6641948223114, "time_since_restore": 3286.6641948223114}
{"timesteps_since_restore": 5416306, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41035, "date": "2019-05-07_10-45-19", "episode_reward_min": 53.661078994119514, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdb38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdeb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 131, "episode_reward_mean": 983.7905706932892, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 131, "custom_metrics": {"outflow_rate_max": 1430.5219404595405, "cost2_mean": -20.249145354100673, "cost1_mean": 341.9093981729581, "system_level_velocity_mean": 14.521061205025863, "cost2_min": -37.19198634493045, "cost1_max": 420.42088363936614, "cost1_min": 28.207516213305492, "cost2_max": -4.52786821759828, "outflow_rate_mean": 1157.7182958391813, "system_level_velocity_min": 11.886598896096324, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 19.221188653450252}, "info": {"num_steps_trained": 5416306, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01295575313270092, "total_loss": 10.686190605163574, "vf_loss": 10.689767837524414, "policy_loss": -0.005519003141671419, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9562381505966187, "entropy": 0.9759979248046875}, "load_time_ms": 6.834, "grad_time_ms": 9339.045, "update_time_ms": 9.572, "num_steps_sampled": 5416306, "sample_time_ms": 16747.571}, "episode_len_mean": 656.21, "time_this_iter_s": 26.080436944961548, "num_metric_batches_dropped": 0, "timesteps_total": 5416306, "hostname": "flow-main", "episodes_total": 2181, "timestamp": 1557225919, "episode_reward_max": 1166.952976247581, "episodes_this_iter": 15, "time_total_s": 3312.744631767273, "time_since_restore": 3312.744631767273}
{"timesteps_since_restore": 5457173, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40867, "date": "2019-05-07_10-45-43", "episode_reward_min": 53.69831149605203, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3c18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 132, "episode_reward_mean": 992.6936369641688, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 132, "custom_metrics": {"outflow_rate_max": 1430.5219404595405, "cost2_mean": -21.51940943741592, "cost1_mean": 344.44046808702547, "system_level_velocity_mean": 14.410105605709404, "cost2_min": -37.19198634493045, "cost1_max": 420.42088363936614, "cost1_min": 28.207516213305492, "cost2_max": -4.52786821759828, "outflow_rate_mean": 1164.335254914823, "system_level_velocity_min": 11.886598896096324, "outflow_rate_min": 327.3926328531922, "system_level_velocity_max": 18.164238126529444}, "info": {"num_steps_trained": 5457173, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012219313532114029, "total_loss": 11.690720558166504, "vf_loss": 11.693267822265625, "policy_loss": -0.004379699006676674, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9540696144104004, "entropy": 0.9681267142295837}, "load_time_ms": 6.99, "grad_time_ms": 9419.829, "update_time_ms": 9.584, "num_steps_sampled": 5457173, "sample_time_ms": 16683.838}, "episode_len_mean": 663.39, "time_this_iter_s": 23.974933385849, "num_metric_batches_dropped": 0, "timesteps_total": 5457173, "hostname": "flow-main", "episodes_total": 2201, "timestamp": 1557225943, "episode_reward_max": 1166.952976247581, "episodes_this_iter": 20, "time_total_s": 3336.719565153122, "time_since_restore": 3336.719565153122}
{"timesteps_since_restore": 5497917, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40744, "date": "2019-05-07_10-46-07", "episode_reward_min": 58.36800099197103, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb08d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb07f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0a90>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 133, "episode_reward_mean": 1005.0305209605821, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 133, "custom_metrics": {"outflow_rate_max": 1430.5219404595405, "cost2_mean": -22.176944624250314, "cost1_mean": 345.490970535517, "system_level_velocity_mean": 14.260243649709514, "cost2_min": -37.19198634493045, "cost1_max": 420.42088363936614, "cost1_min": 32.54507893507956, "cost2_max": -6.843715725875082, "outflow_rate_mean": 1168.409288717716, "system_level_velocity_min": 11.886598896096324, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.03603375877061}, "info": {"num_steps_trained": 5497917, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015144065953791142, "total_loss": 9.727551460266113, "vf_loss": 9.732030868530273, "policy_loss": -0.00675154197961092, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9624511003494263, "entropy": 0.972260594367981}, "load_time_ms": 7.139, "grad_time_ms": 9514.893, "update_time_ms": 9.527, "num_steps_sampled": 5497917, "sample_time_ms": 16592.127}, "episode_len_mean": 670.33, "time_this_iter_s": 24.120477437973022, "num_metric_batches_dropped": 0, "timesteps_total": 5497917, "hostname": "flow-main", "episodes_total": 2217, "timestamp": 1557225967, "episode_reward_max": 1159.7841839258535, "episodes_this_iter": 16, "time_total_s": 3360.840042591095, "time_since_restore": 3360.840042591095}
{"timesteps_since_restore": 5537491, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39574, "date": "2019-05-07_10-46-32", "episode_reward_min": 232.8740368492574, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8feb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f4a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 134, "episode_reward_mean": 1005.16711385457, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 134, "custom_metrics": {"outflow_rate_max": 1430.5219404595405, "cost2_mean": -22.857510888084544, "cost1_mean": 347.1535767057825, "system_level_velocity_mean": 14.360382437510427, "cost2_min": -37.19198634493045, "cost1_max": 430.5867888637627, "cost1_min": 95.0712876148755, "cost2_max": -8.020790046993557, "outflow_rate_mean": 1172.6710247167173, "system_level_velocity_min": 11.983986560913607, "outflow_rate_min": 542.8084493082149, "system_level_velocity_max": 18.004334147213292}, "info": {"num_steps_trained": 5537491, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01597934402525425, "total_loss": 15.98082447052002, "vf_loss": 15.984596252441406, "policy_loss": -0.006169549655169249, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9356357455253601, "entropy": 0.9943077564239502}, "load_time_ms": 7.178, "grad_time_ms": 9545.337, "update_time_ms": 9.327, "num_steps_sampled": 5537491, "sample_time_ms": 16594.769}, "episode_len_mean": 669.78, "time_this_iter_s": 25.010152101516724, "num_metric_batches_dropped": 0, "timesteps_total": 5537491, "hostname": "flow-main", "episodes_total": 2236, "timestamp": 1557225992, "episode_reward_max": 1159.7841839258535, "episodes_this_iter": 19, "time_total_s": 3385.8501946926117, "time_since_restore": 3385.8501946926117}
{"timesteps_since_restore": 5577787, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40296, "date": "2019-05-07_10-46-59", "episode_reward_min": 232.8740368492574, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb01d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 135, "episode_reward_mean": 1005.2770669980448, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 135, "custom_metrics": {"outflow_rate_max": 1434.0694877122876, "cost2_mean": -22.84214727523222, "cost1_mean": 348.8528729984583, "system_level_velocity_mean": 14.436019746050803, "cost2_min": -37.19198634493045, "cost1_max": 430.5867888637627, "cost1_min": 95.0712876148755, "cost2_max": -8.020790046993557, "outflow_rate_mean": 1179.7702247207133, "system_level_velocity_min": 11.983986560913607, "outflow_rate_min": 542.8084493082149, "system_level_velocity_max": 18.004334147213292}, "info": {"num_steps_trained": 5577787, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016566671431064606, "total_loss": 14.575020790100098, "vf_loss": 14.577024459838867, "policy_loss": -0.004488594364374876, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9402095675468445, "entropy": 0.9645336866378784}, "load_time_ms": 7.131, "grad_time_ms": 9634.216, "update_time_ms": 8.972, "num_steps_sampled": 5577787, "sample_time_ms": 16645.711}, "episode_len_mean": 669.78, "time_this_iter_s": 26.82041096687317, "num_metric_batches_dropped": 0, "timesteps_total": 5577787, "hostname": "flow-main", "episodes_total": 2253, "timestamp": 1557226019, "episode_reward_max": 1159.7841839258535, "episodes_this_iter": 17, "time_total_s": 3412.670605659485, "time_since_restore": 3412.670605659485}
{"timesteps_since_restore": 5618604, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40817, "date": "2019-05-07_10-47-24", "episode_reward_min": 65.26846965621306, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc952e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 136, "episode_reward_mean": 1011.6618690458544, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 136, "custom_metrics": {"outflow_rate_max": 1434.0694877122876, "cost2_mean": -21.93920297849242, "cost1_mean": 348.51403575351867, "system_level_velocity_mean": 14.429179984413116, "cost2_min": -34.55578604128213, "cost1_max": 430.5867888637627, "cost1_min": 33.68468147103089, "cost2_max": -7.917416686462962, "outflow_rate_mean": 1174.5666584689282, "system_level_velocity_min": 12.102663113569706, "outflow_rate_min": 323.39756559883244, "system_level_velocity_max": 18.41122683401589}, "info": {"num_steps_trained": 5618604, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016879867762327194, "total_loss": 13.72446346282959, "vf_loss": 13.729860305786133, "policy_loss": -0.007928519509732723, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9444883465766907, "entropy": 0.9537860155105591}, "load_time_ms": 7.376, "grad_time_ms": 9405.442, "update_time_ms": 9.157, "num_steps_sampled": 5618604, "sample_time_ms": 15928.326}, "episode_len_mean": 668.78, "time_this_iter_s": 24.748764991760254, "num_metric_batches_dropped": 0, "timesteps_total": 5618604, "hostname": "flow-main", "episodes_total": 2270, "timestamp": 1557226044, "episode_reward_max": 1159.7841839258535, "episodes_this_iter": 17, "time_total_s": 3437.419370651245, "time_since_restore": 3437.419370651245}
{"timesteps_since_restore": 5659647, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41043, "date": "2019-05-07_10-47-49", "episode_reward_min": 65.26846965621306, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3160>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 137, "episode_reward_mean": 1016.2227465785877, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 137, "custom_metrics": {"outflow_rate_max": 1434.0694877122876, "cost2_mean": -21.006377406050397, "cost1_mean": 348.23213973667254, "system_level_velocity_mean": 14.398179452857002, "cost2_min": -34.55578604128213, "cost1_max": 430.5867888637627, "cost1_min": 33.68468147103089, "cost2_max": -7.917416686462962, "outflow_rate_mean": 1173.2065056257713, "system_level_velocity_min": 12.102663113569706, "outflow_rate_min": 323.39756559883244, "system_level_velocity_max": 18.41122683401589}, "info": {"num_steps_trained": 5659647, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017899248749017715, "total_loss": 12.731463432312012, "vf_loss": 12.735495567321777, "policy_loss": -0.006716775707900524, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9465734362602234, "entropy": 0.9457914233207703}, "load_time_ms": 7.487, "grad_time_ms": 9346.38, "update_time_ms": 8.711, "num_steps_sampled": 5659647, "sample_time_ms": 15639.6}, "episode_len_mean": 668.78, "time_this_iter_s": 25.495805740356445, "num_metric_batches_dropped": 0, "timesteps_total": 5659647, "hostname": "flow-main", "episodes_total": 2288, "timestamp": 1557226069, "episode_reward_max": 1159.7841839258535, "episodes_this_iter": 18, "time_total_s": 3462.9151763916016, "time_since_restore": 3462.9151763916016}
{"timesteps_since_restore": 5700097, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40450, "date": "2019-05-07_10-48-13", "episode_reward_min": 65.26846965621306, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ab00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8af60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca39b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 138, "episode_reward_mean": 1022.8470456872651, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 138, "custom_metrics": {"outflow_rate_max": 1456.612237762238, "cost2_mean": -20.296273881649945, "cost1_mean": 352.72456899240876, "system_level_velocity_mean": 14.451098161509526, "cost2_min": -34.55578604128213, "cost1_max": 430.5867888637627, "cost1_min": 33.68468147103089, "cost2_max": -7.917416686462962, "outflow_rate_mean": 1187.099269162832, "system_level_velocity_min": 12.102663113569706, "outflow_rate_min": 323.39756559883244, "system_level_velocity_max": 18.41122683401589}, "info": {"num_steps_trained": 5700097, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018551766872406006, "total_loss": 14.823272705078125, "vf_loss": 14.82736587524414, "policy_loss": -0.006873695179820061, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.940372109413147, "entropy": 0.9467033743858337}, "load_time_ms": 7.483, "grad_time_ms": 9191.163, "update_time_ms": 8.594, "num_steps_sampled": 5700097, "sample_time_ms": 15760.481}, "episode_len_mean": 674.07, "time_this_iter_s": 23.887027502059937, "num_metric_batches_dropped": 0, "timesteps_total": 5700097, "hostname": "flow-main", "episodes_total": 2302, "timestamp": 1557226093, "episode_reward_max": 1159.7841839258535, "episodes_this_iter": 14, "time_total_s": 3486.8022038936615, "time_since_restore": 3486.8022038936615}
{"timesteps_since_restore": 5742079, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41982, "date": "2019-05-07_10-48-38", "episode_reward_min": 65.26846965621306, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb32b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8feb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 139, "episode_reward_mean": 1026.4716796027485, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 139, "custom_metrics": {"outflow_rate_max": 1456.612237762238, "cost2_mean": -19.452369734383545, "cost1_mean": 355.5725166964636, "system_level_velocity_mean": 14.422185041299812, "cost2_min": -34.55578604128213, "cost1_max": 430.5867888637627, "cost1_min": 33.68468147103089, "cost2_max": -7.917416686462962, "outflow_rate_mean": 1190.9147015694464, "system_level_velocity_min": 12.076693537189811, "outflow_rate_min": 323.39756559883244, "system_level_velocity_max": 18.41122683401589}, "info": {"num_steps_trained": 5742079, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01697075180709362, "total_loss": 10.64490032196045, "vf_loss": 10.648555755615234, "policy_loss": -0.006200456526130438, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9504689574241638, "entropy": 0.935295820236206}, "load_time_ms": 7.413, "grad_time_ms": 9099.484, "update_time_ms": 8.431, "num_steps_sampled": 5742079, "sample_time_ms": 15800.783}, "episode_len_mean": 679.13, "time_this_iter_s": 24.46183204650879, "num_metric_batches_dropped": 0, "timesteps_total": 5742079, "hostname": "flow-main", "episodes_total": 2318, "timestamp": 1557226118, "episode_reward_max": 1141.6629225030445, "episodes_this_iter": 16, "time_total_s": 3511.2640359401703, "time_since_restore": 3511.2640359401703}
{"timesteps_since_restore": 5783182, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41103, "date": "2019-05-07_10-49-02", "episode_reward_min": 59.77238861139544, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3da0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 140, "episode_reward_mean": 1019.1427661606202, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 140, "custom_metrics": {"outflow_rate_max": 1456.612237762238, "cost2_mean": -18.4271191815679, "cost1_mean": 350.44038801050175, "system_level_velocity_mean": 14.302239168554886, "cost2_min": -34.55578604128213, "cost1_max": 426.62552712605975, "cost1_min": 32.705328199210676, "cost2_max": -7.917416686462962, "outflow_rate_mean": 1174.0105479115105, "system_level_velocity_min": 11.522016119896517, "outflow_rate_min": 322.6655169108091, "system_level_velocity_max": 18.41122683401589}, "info": {"num_steps_trained": 5783182, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014398720115423203, "total_loss": 17.29793357849121, "vf_loss": 17.300874710083008, "policy_loss": -0.005099114030599594, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9309772253036499, "entropy": 0.9532777070999146}, "load_time_ms": 7.536, "grad_time_ms": 9068.154, "update_time_ms": 8.189, "num_steps_sampled": 5783182, "sample_time_ms": 15757.149}, "episode_len_mean": 673.89, "time_this_iter_s": 24.67915630340576, "num_metric_batches_dropped": 0, "timesteps_total": 5783182, "hostname": "flow-main", "episodes_total": 2338, "timestamp": 1557226142, "episode_reward_max": 1141.6629225030445, "episodes_this_iter": 20, "time_total_s": 3535.943192243576, "time_since_restore": 3535.943192243576}
{"timesteps_since_restore": 5823299, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40117, "date": "2019-05-07_10-49-27", "episode_reward_min": 59.77238861139544, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 141, "episode_reward_mean": 1014.103377477179, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 141, "custom_metrics": {"outflow_rate_max": 1473.5150869130869, "cost2_mean": -18.438297616410285, "cost1_mean": 345.7804715960865, "system_level_velocity_mean": 14.21601706761229, "cost2_min": -26.564849808743915, "cost1_max": 468.74489005592096, "cost1_min": 32.705328199210676, "cost2_max": -7.917416686462962, "outflow_rate_mean": 1158.1714623471564, "system_level_velocity_min": 11.522016119896517, "outflow_rate_min": 322.6655169108091, "system_level_velocity_max": 18.41122683401589}, "info": {"num_steps_trained": 5823299, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016054442152380943, "total_loss": 12.850783348083496, "vf_loss": 12.85442066192627, "policy_loss": -0.0060456483624875546, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9547763466835022, "entropy": 0.9412315487861633}, "load_time_ms": 7.567, "grad_time_ms": 8866.626, "update_time_ms": 8.224, "num_steps_sampled": 5823299, "sample_time_ms": 15807.729}, "episode_len_mean": 668.35, "time_this_iter_s": 24.566426277160645, "num_metric_batches_dropped": 0, "timesteps_total": 5823299, "hostname": "flow-main", "episodes_total": 2356, "timestamp": 1557226167, "episode_reward_max": 1218.9953665762605, "episodes_this_iter": 18, "time_total_s": 3560.5096185207367, "time_since_restore": 3560.5096185207367}
{"timesteps_since_restore": 5864750, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41451, "date": "2019-05-07_10-49-52", "episode_reward_min": 59.77238861139544, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3e48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 142, "episode_reward_mean": 1022.5661510088543, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 142, "custom_metrics": {"outflow_rate_max": 1473.5150869130869, "cost2_mean": -19.018706940517166, "cost1_mean": 351.1801910833796, "system_level_velocity_mean": 14.231159283416755, "cost2_min": -26.795809454052026, "cost1_max": 468.74489005592096, "cost1_min": 32.705328199210676, "cost2_max": -8.164121109009292, "outflow_rate_mean": 1171.7027441816779, "system_level_velocity_min": 11.522016119896517, "outflow_rate_min": 322.6655169108091, "system_level_velocity_max": 18.387606735483253}, "info": {"num_steps_trained": 5864750, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01594940945506096, "total_loss": 13.414741516113281, "vf_loss": 13.416910171508789, "policy_loss": -0.004562050569802523, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9481369256973267, "entropy": 0.9095428586006165}, "load_time_ms": 7.478, "grad_time_ms": 8823.952, "update_time_ms": 8.001, "num_steps_sampled": 5864750, "sample_time_ms": 15951.48}, "episode_len_mean": 674.84, "time_this_iter_s": 25.000890016555786, "num_metric_batches_dropped": 0, "timesteps_total": 5864750, "hostname": "flow-main", "episodes_total": 2375, "timestamp": 1557226192, "episode_reward_max": 1218.9953665762605, "episodes_this_iter": 19, "time_total_s": 3585.5105085372925, "time_since_restore": 3585.5105085372925}
{"timesteps_since_restore": 5906050, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41300, "date": "2019-05-07_10-50-17", "episode_reward_min": 48.7889498971504, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3d30>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 143, "episode_reward_mean": 1005.7685332201651, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 143, "custom_metrics": {"outflow_rate_max": 1473.5150869130869, "cost2_mean": -18.99052589365083, "cost1_mean": 344.63767091616313, "system_level_velocity_mean": 14.26207000703932, "cost2_min": -26.795809454052026, "cost1_max": 468.74489005592096, "cost1_min": 28.16530405532827, "cost2_max": -8.164121109009292, "outflow_rate_mean": 1157.7320454490296, "system_level_velocity_min": 11.522016119896517, "outflow_rate_min": 322.6655169108091, "system_level_velocity_max": 19.04344093188751}, "info": {"num_steps_trained": 5906050, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01702193170785904, "total_loss": 13.778119087219238, "vf_loss": 13.78135871887207, "policy_loss": -0.005794177297502756, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.940536379814148, "entropy": 0.9275804758071899}, "load_time_ms": 7.321, "grad_time_ms": 8798.573, "update_time_ms": 7.763, "num_steps_sampled": 5906050, "sample_time_ms": 16094.483}, "episode_len_mean": 664.01, "time_this_iter_s": 25.271689653396606, "num_metric_batches_dropped": 0, "timesteps_total": 5906050, "hostname": "flow-main", "episodes_total": 2388, "timestamp": 1557226217, "episode_reward_max": 1218.9953665762605, "episodes_this_iter": 13, "time_total_s": 3610.782198190689, "time_since_restore": 3610.782198190689}
{"timesteps_since_restore": 5946445, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40395, "date": "2019-05-07_10-50-43", "episode_reward_min": 48.7889498971504, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb36d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb33c8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 144, "episode_reward_mean": 988.4221239830374, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 144, "custom_metrics": {"outflow_rate_max": 1473.5150869130869, "cost2_mean": -19.090482134803317, "cost1_mean": 338.70851887688934, "system_level_velocity_mean": 14.374355587556556, "cost2_min": -26.795809454052026, "cost1_max": 468.74489005592096, "cost1_min": 28.16530405532827, "cost2_max": -8.164121109009292, "outflow_rate_mean": 1141.6369409115525, "system_level_velocity_min": 11.522016119896517, "outflow_rate_min": 322.6655169108091, "system_level_velocity_max": 19.04344093188751}, "info": {"num_steps_trained": 5946445, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01455705426633358, "total_loss": 18.14226531982422, "vf_loss": 18.145185470581055, "policy_loss": -0.005105308722704649, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9231323003768921, "entropy": 0.9457160234451294}, "load_time_ms": 7.274, "grad_time_ms": 8792.24, "update_time_ms": 7.67, "num_steps_sampled": 5946445, "sample_time_ms": 16146.328}, "episode_len_mean": 649.72, "time_this_iter_s": 25.49100637435913, "num_metric_batches_dropped": 0, "timesteps_total": 5946445, "hostname": "flow-main", "episodes_total": 2407, "timestamp": 1557226243, "episode_reward_max": 1218.9953665762605, "episodes_this_iter": 19, "time_total_s": 3636.273204565048, "time_since_restore": 3636.273204565048}
{"timesteps_since_restore": 5987211, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40766, "date": "2019-05-07_10-51-08", "episode_reward_min": 48.7889498971504, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3358>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 145, "episode_reward_mean": 993.628885846087, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 145, "custom_metrics": {"outflow_rate_max": 1473.5150869130869, "cost2_mean": -19.49144197505766, "cost1_mean": 341.82878300333914, "system_level_velocity_mean": 14.43940579173846, "cost2_min": -28.452080157514793, "cost1_max": 468.74489005592096, "cost1_min": 28.16530405532827, "cost2_max": -8.164121109009292, "outflow_rate_mean": 1149.5139664875444, "system_level_velocity_min": 11.522016119896517, "outflow_rate_min": 322.6655169108091, "system_level_velocity_max": 19.04344093188751}, "info": {"num_steps_trained": 5987211, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016339413821697235, "total_loss": 15.715953826904297, "vf_loss": 15.720755577087402, "policy_loss": -0.0072518219240009785, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9385579228401184, "entropy": 0.945962131023407}, "load_time_ms": 7.33, "grad_time_ms": 8738.677, "update_time_ms": 7.931, "num_steps_sampled": 5987211, "sample_time_ms": 16058.301}, "episode_len_mean": 652.34, "time_this_iter_s": 25.39639639854431, "num_metric_batches_dropped": 0, "timesteps_total": 5987211, "hostname": "flow-main", "episodes_total": 2425, "timestamp": 1557226268, "episode_reward_max": 1218.9953665762605, "episodes_this_iter": 18, "time_total_s": 3661.6696009635925, "time_since_restore": 3661.6696009635925}
{"timesteps_since_restore": 6028650, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41439, "date": "2019-05-07_10-51-33", "episode_reward_min": 48.7889498971504, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8a048>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 146, "episode_reward_mean": 1002.4474467585466, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 146, "custom_metrics": {"outflow_rate_max": 1473.5150869130869, "cost2_mean": -19.96044987633113, "cost1_mean": 347.34868218758834, "system_level_velocity_mean": 14.499314589898134, "cost2_min": -28.61577805395345, "cost1_max": 468.74489005592096, "cost1_min": 28.16530405532827, "cost2_max": -8.451600093816012, "outflow_rate_mean": 1159.5027000311336, "system_level_velocity_min": 11.934041993528018, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.04344093188751}, "info": {"num_steps_trained": 6028650, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015063213184475899, "total_loss": 10.004014015197754, "vf_loss": 10.00615406036377, "policy_loss": -0.004398804157972336, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9609323740005493, "entropy": 0.9542525410652161}, "load_time_ms": 7.23, "grad_time_ms": 8796.059, "update_time_ms": 7.64, "num_steps_sampled": 6028650, "sample_time_ms": 16009.805}, "episode_len_mean": 658.99, "time_this_iter_s": 24.841243505477905, "num_metric_batches_dropped": 0, "timesteps_total": 6028650, "hostname": "flow-main", "episodes_total": 2444, "timestamp": 1557226293, "episode_reward_max": 1218.9953665762605, "episodes_this_iter": 19, "time_total_s": 3686.5108444690704, "time_since_restore": 3686.5108444690704}
{"timesteps_since_restore": 6070069, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41419, "date": "2019-05-07_10-51-58", "episode_reward_min": 48.7889498971504, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb32b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 147, "episode_reward_mean": 1000.4536124576629, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 147, "custom_metrics": {"outflow_rate_max": 1444.4519120879122, "cost2_mean": -19.605732172215042, "cost1_mean": 347.42818516153517, "system_level_velocity_mean": 14.55061924545727, "cost2_min": -28.61577805395345, "cost1_max": 430.8413786098927, "cost1_min": 28.16530405532827, "cost2_max": -7.2123272887934755, "outflow_rate_mean": 1161.1762552076414, "system_level_velocity_min": 11.934041993528018, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.04344093188751}, "info": {"num_steps_trained": 6070069, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017322679981589317, "total_loss": 10.69442367553711, "vf_loss": 10.700246810913086, "policy_loss": -0.008421342819929123, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.957099437713623, "entropy": 0.9598450064659119}, "load_time_ms": 6.793, "grad_time_ms": 8808.682, "update_time_ms": 7.544, "num_steps_sampled": 6070069, "sample_time_ms": 15924.274}, "episode_len_mean": 657.96, "time_this_iter_s": 24.78435468673706, "num_metric_batches_dropped": 0, "timesteps_total": 6070069, "hostname": "flow-main", "episodes_total": 2460, "timestamp": 1557226318, "episode_reward_max": 1182.960362510937, "episodes_this_iter": 16, "time_total_s": 3711.2951991558075, "time_since_restore": 3711.2951991558075}
{"timesteps_since_restore": 6111296, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41227, "date": "2019-05-07_10-52-22", "episode_reward_min": 48.7889498971504, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb35f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb33c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3c18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 148, "episode_reward_mean": 988.7270468408573, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 148, "custom_metrics": {"outflow_rate_max": 1428.5470689310687, "cost2_mean": -19.40172994764558, "cost1_mean": 341.6611539987351, "system_level_velocity_mean": 14.489171647709723, "cost2_min": -28.61577805395345, "cost1_max": 430.8413786098927, "cost1_min": 28.16530405532827, "cost2_max": -7.2123272887934755, "outflow_rate_mean": 1145.5824621181691, "system_level_velocity_min": 11.739097327291168, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.04344093188751}, "info": {"num_steps_trained": 6111296, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014896136708557606, "total_loss": 10.806415557861328, "vf_loss": 10.809760093688965, "policy_loss": -0.005577996838837862, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.956182062625885, "entropy": 0.9465894103050232}, "load_time_ms": 6.842, "grad_time_ms": 8839.156, "update_time_ms": 7.652, "num_steps_sampled": 6111296, "sample_time_ms": 15941.427}, "episode_len_mean": 651.46, "time_this_iter_s": 24.37585997581482, "num_metric_batches_dropped": 0, "timesteps_total": 6111296, "hostname": "flow-main", "episodes_total": 2477, "timestamp": 1557226342, "episode_reward_max": 1155.0315595026286, "episodes_this_iter": 17, "time_total_s": 3735.6710591316223, "time_since_restore": 3735.6710591316223}
{"timesteps_since_restore": 6152874, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41578, "date": "2019-05-07_10-52-48", "episode_reward_min": 53.020415262433865, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca65f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6358>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 149, "episode_reward_mean": 1013.1933739985419, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 149, "custom_metrics": {"outflow_rate_max": 1428.5470689310687, "cost2_mean": -19.71185686591985, "cost1_mean": 349.127175526154, "system_level_velocity_mean": 14.39635076054829, "cost2_min": -28.61577805395345, "cost1_max": 430.8413786098927, "cost1_min": 28.296813740754608, "cost2_max": -7.2123272887934755, "outflow_rate_mean": 1157.4479354554803, "system_level_velocity_min": 11.60730752061937, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.030130139582234}, "info": {"num_steps_trained": 6152874, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016830936074256897, "total_loss": 8.687765121459961, "vf_loss": 8.69155502319336, "policy_loss": -0.006314871367067099, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9649442434310913, "entropy": 0.9619119763374329}, "load_time_ms": 6.778, "grad_time_ms": 8838.701, "update_time_ms": 7.695, "num_steps_sampled": 6152874, "sample_time_ms": 16087.731}, "episode_len_mean": 665.96, "time_this_iter_s": 25.919074296951294, "num_metric_batches_dropped": 0, "timesteps_total": 6152874, "hostname": "flow-main", "episodes_total": 2494, "timestamp": 1557226368, "episode_reward_max": 1212.1611507408377, "episodes_this_iter": 17, "time_total_s": 3761.5901334285736, "time_since_restore": 3761.5901334285736}
{"timesteps_since_restore": 6193456, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40582, "date": "2019-05-07_10-53-14", "episode_reward_min": 53.020415262433865, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3f98>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 150, "episode_reward_mean": 1019.2879636133492, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 150, "custom_metrics": {"outflow_rate_max": 1503.6123460539463, "cost2_mean": -20.258299948599063, "cost1_mean": 350.39276615817175, "system_level_velocity_mean": 14.332749879668615, "cost2_min": -37.04778980485577, "cost1_max": 430.8413786098927, "cost1_min": 28.296813740754608, "cost2_max": -7.2123272887934755, "outflow_rate_mean": 1167.6694310820014, "system_level_velocity_min": 11.60730752061937, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.030130139582234}, "info": {"num_steps_trained": 6193456, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0189348217099905, "total_loss": 16.85340118408203, "vf_loss": 16.86014747619629, "policy_loss": -0.009587390348315239, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9286819696426392, "entropy": 0.9772830009460449}, "load_time_ms": 6.642, "grad_time_ms": 8727.978, "update_time_ms": 7.826, "num_steps_sampled": 6193456, "sample_time_ms": 16278.034}, "episode_len_mean": 670.48, "time_this_iter_s": 25.472412109375, "num_metric_batches_dropped": 0, "timesteps_total": 6193456, "hostname": "flow-main", "episodes_total": 2510, "timestamp": 1557226394, "episode_reward_max": 1212.1611507408377, "episodes_this_iter": 16, "time_total_s": 3787.0625455379486, "time_since_restore": 3787.0625455379486}
{"timesteps_since_restore": 6234435, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40979, "date": "2019-05-07_10-53-40", "episode_reward_min": 53.020415262433865, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3b70>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 151, "episode_reward_mean": 1021.7285436790986, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 151, "custom_metrics": {"outflow_rate_max": 1503.6123460539463, "cost2_mean": -21.537219450013946, "cost1_mean": 349.80009165156815, "system_level_velocity_mean": 14.289782658501274, "cost2_min": -37.04778980485577, "cost1_max": 430.8413786098927, "cost1_min": 28.296813740754608, "cost2_max": -7.2123272887934755, "outflow_rate_mean": 1164.7306412418418, "system_level_velocity_min": 11.60730752061937, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.030130139582234}, "info": {"num_steps_trained": 6234435, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0167657732963562, "total_loss": 8.021235466003418, "vf_loss": 8.024548530578613, "policy_loss": -0.005827863700687885, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9671441912651062, "entropy": 0.9652091860771179}, "load_time_ms": 6.688, "grad_time_ms": 8637.627, "update_time_ms": 7.723, "num_steps_sampled": 6234435, "sample_time_ms": 16497.072}, "episode_len_mean": 670.48, "time_this_iter_s": 25.85941743850708, "num_metric_batches_dropped": 0, "timesteps_total": 6234435, "hostname": "flow-main", "episodes_total": 2527, "timestamp": 1557226420, "episode_reward_max": 1212.1611507408377, "episodes_this_iter": 17, "time_total_s": 3812.9219629764557, "time_since_restore": 3812.9219629764557}
{"timesteps_since_restore": 6274860, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40425, "date": "2019-05-07_10-54-05", "episode_reward_min": 53.020415262433865, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc952b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca66d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 152, "episode_reward_mean": 1035.248168929355, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 152, "custom_metrics": {"outflow_rate_max": 1503.6123460539463, "cost2_mean": -21.835890377470438, "cost1_mean": 354.9901604313884, "system_level_velocity_mean": 14.356214011890215, "cost2_min": -37.04778980485577, "cost1_max": 423.71820751983705, "cost1_min": 28.296813740754608, "cost2_max": -7.2123272887934755, "outflow_rate_mean": 1181.3019629695236, "system_level_velocity_min": 11.60730752061937, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.030130139582234}, "info": {"num_steps_trained": 6274860, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016176503151655197, "total_loss": 11.856739044189453, "vf_loss": 11.860220909118652, "policy_loss": -0.005908790044486523, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.952316403388977, "entropy": 0.9685118794441223}, "load_time_ms": 6.749, "grad_time_ms": 8514.254, "update_time_ms": 7.633, "num_steps_sampled": 6274860, "sample_time_ms": 16618.872}, "episode_len_mean": 675.45, "time_this_iter_s": 24.959050178527832, "num_metric_batches_dropped": 0, "timesteps_total": 6274860, "hostname": "flow-main", "episodes_total": 2543, "timestamp": 1557226445, "episode_reward_max": 1212.1611507408377, "episodes_this_iter": 16, "time_total_s": 3837.8810131549835, "time_since_restore": 3837.8810131549835}
{"timesteps_since_restore": 6315205, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40345, "date": "2019-05-07_10-54-29", "episode_reward_min": 57.18120077718155, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8ff60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fe10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 153, "episode_reward_mean": 1048.3306300279705, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 153, "custom_metrics": {"outflow_rate_max": 1503.6123460539463, "cost2_mean": -22.23689966791198, "cost1_mean": 358.4824898853343, "system_level_velocity_mean": 14.30257915403613, "cost2_min": -37.04778980485577, "cost1_max": 420.46084246330577, "cost1_min": 32.22094814993558, "cost2_max": -7.612354706708076, "outflow_rate_mean": 1193.35534714758, "system_level_velocity_min": 11.60730752061937, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.53134594249697}, "info": {"num_steps_trained": 6315205, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01623133011162281, "total_loss": 11.951945304870605, "vf_loss": 11.954910278320312, "policy_loss": -0.0054003274999558926, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9535239338874817, "entropy": 0.962530255317688}, "load_time_ms": 6.386, "grad_time_ms": 8478.66, "update_time_ms": 7.623, "num_steps_sampled": 6315205, "sample_time_ms": 16600.928}, "episode_len_mean": 682.02, "time_this_iter_s": 24.726089477539062, "num_metric_batches_dropped": 0, "timesteps_total": 6315205, "hostname": "flow-main", "episodes_total": 2559, "timestamp": 1557226469, "episode_reward_max": 1212.1611507408377, "episodes_this_iter": 16, "time_total_s": 3862.6071026325226, "time_since_restore": 3862.6071026325226}
{"timesteps_since_restore": 6356986, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41781, "date": "2019-05-07_10-54-55", "episode_reward_min": 62.5910456259781, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc955c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 154, "episode_reward_mean": 1050.0385635713799, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 154, "custom_metrics": {"outflow_rate_max": 1503.6123460539463, "cost2_mean": -22.75639382606877, "cost1_mean": 358.7440207778709, "system_level_velocity_mean": 14.298193461557066, "cost2_min": -37.04778980485577, "cost1_max": 420.46084246330577, "cost1_min": 32.622769047429756, "cost2_max": -7.612354706708076, "outflow_rate_mean": 1198.4990310874132, "system_level_velocity_min": 11.60730752061937, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.79459529626855}, "info": {"num_steps_trained": 6356986, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016659177839756012, "total_loss": 11.073318481445312, "vf_loss": 11.076516151428223, "policy_loss": -0.005696187261492014, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9567710161209106, "entropy": 0.9439388513565063}, "load_time_ms": 6.538, "grad_time_ms": 8534.481, "update_time_ms": 7.421, "num_steps_sampled": 6356986, "sample_time_ms": 16585.389}, "episode_len_mean": 682.84, "time_this_iter_s": 25.868285655975342, "num_metric_batches_dropped": 0, "timesteps_total": 6356986, "hostname": "flow-main", "episodes_total": 2578, "timestamp": 1557226495, "episode_reward_max": 1190.5683132889496, "episodes_this_iter": 19, "time_total_s": 3888.475388288498, "time_since_restore": 3888.475388288498}
{"timesteps_since_restore": 6398079, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41093, "date": "2019-05-07_10-55-20", "episode_reward_min": 62.5910456259781, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 155, "episode_reward_mean": 1054.038037564005, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 155, "custom_metrics": {"outflow_rate_max": 1503.6123460539463, "cost2_mean": -23.424526719117054, "cost1_mean": 361.0666193457463, "system_level_velocity_mean": 14.370023235793585, "cost2_min": -37.04778980485577, "cost1_max": 427.3020139667891, "cost1_min": 32.622769047429756, "cost2_max": -7.612354706708076, "outflow_rate_mean": 1207.212014887613, "system_level_velocity_min": 11.970448015124381, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.79459529626855}, "info": {"num_steps_trained": 6398079, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01779954321682453, "total_loss": 9.850358963012695, "vf_loss": 9.854730606079102, "policy_loss": -0.0070416866801679134, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.962945282459259, "entropy": 0.9512844085693359}, "load_time_ms": 6.641, "grad_time_ms": 8641.428, "update_time_ms": 7.01, "num_steps_sampled": 6398079, "sample_time_ms": 16432.705}, "episode_len_mean": 682.84, "time_this_iter_s": 24.941900968551636, "num_metric_batches_dropped": 0, "timesteps_total": 6398079, "hostname": "flow-main", "episodes_total": 2592, "timestamp": 1557226520, "episode_reward_max": 1199.1734394112866, "episodes_this_iter": 14, "time_total_s": 3913.4172892570496, "time_since_restore": 3913.4172892570496}
{"timesteps_since_restore": 6439739, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41660, "date": "2019-05-07_10-55-45", "episode_reward_min": 200.35882615695328, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb38d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb36a0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 156, "episode_reward_mean": 1070.9546851560135, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 156, "custom_metrics": {"outflow_rate_max": 1430.3278481518482, "cost2_mean": -24.113625867287215, "cost1_mean": 365.2293650561875, "system_level_velocity_mean": 14.27883675715134, "cost2_min": -35.770383877690136, "cost1_max": 427.3020139667891, "cost1_min": 88.2077783997112, "cost2_max": -12.178807781086386, "outflow_rate_mean": 1215.6777241750365, "system_level_velocity_min": 11.675156702153773, "outflow_rate_min": 527.1352764447101, "system_level_velocity_max": 18.79459529626855}, "info": {"num_steps_trained": 6439739, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015612517483532429, "total_loss": 8.539024353027344, "vf_loss": 8.541824340820312, "policy_loss": -0.005140842404216528, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9683852791786194, "entropy": 0.9584587216377258}, "load_time_ms": 6.708, "grad_time_ms": 8774.009, "update_time_ms": 6.891, "num_steps_sampled": 6439739, "sample_time_ms": 16331.553}, "episode_len_mean": 692.85, "time_this_iter_s": 25.141643285751343, "num_metric_batches_dropped": 0, "timesteps_total": 6439739, "hostname": "flow-main", "episodes_total": 2608, "timestamp": 1557226545, "episode_reward_max": 1199.1734394112866, "episodes_this_iter": 16, "time_total_s": 3938.558932542801, "time_since_restore": 3938.558932542801}
{"timesteps_since_restore": 6480736, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40997, "date": "2019-05-07_10-56-10", "episode_reward_min": 49.346638618828564, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca66d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 157, "episode_reward_mean": 1045.7649302840261, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 157, "custom_metrics": {"outflow_rate_max": 1430.3278481518482, "cost2_mean": -23.5843212654782, "cost1_mean": 356.19721290313856, "system_level_velocity_mean": 14.447487255738638, "cost2_min": -38.60090369460001, "cost1_max": 457.09555496670976, "cost1_min": 28.33991920857511, "cost2_max": -8.441638838305948, "outflow_rate_mean": 1190.5474667014798, "system_level_velocity_min": 11.675156702153773, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.35374548151808}, "info": {"num_steps_trained": 6480736, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01856936514377594, "total_loss": 11.298422813415527, "vf_loss": 11.303757667541504, "policy_loss": -0.008119834586977959, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9603533744812012, "entropy": 0.9578900337219238}, "load_time_ms": 7.112, "grad_time_ms": 8874.824, "update_time_ms": 6.936, "num_steps_sampled": 6480736, "sample_time_ms": 16245.458}, "episode_len_mean": 674.68, "time_this_iter_s": 24.92266583442688, "num_metric_batches_dropped": 0, "timesteps_total": 6480736, "hostname": "flow-main", "episodes_total": 2627, "timestamp": 1557226570, "episode_reward_max": 1310.2478670722871, "episodes_this_iter": 19, "time_total_s": 3963.481598377228, "time_since_restore": 3963.481598377228}
{"timesteps_since_restore": 6522532, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41796, "date": "2019-05-07_10-56-35", "episode_reward_min": 49.346638618828564, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 158, "episode_reward_mean": 1045.6927605182223, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 158, "custom_metrics": {"outflow_rate_max": 1430.3278481518482, "cost2_mean": -24.06114339248475, "cost1_mean": 353.811987766521, "system_level_velocity_mean": 14.379745783722406, "cost2_min": -38.60090369460001, "cost1_max": 457.09555496670976, "cost1_min": 28.33991920857511, "cost2_max": -8.441638838305948, "outflow_rate_mean": 1184.527775532649, "system_level_velocity_min": 11.675156702153773, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.35374548151808}, "info": {"num_steps_trained": 6522532, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016631437465548515, "total_loss": 8.010049819946289, "vf_loss": 8.015363693237305, "policy_loss": -0.0078092701733112335, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9694375991821289, "entropy": 0.931083083152771}, "load_time_ms": 7.122, "grad_time_ms": 9066.72, "update_time_ms": 6.914, "num_steps_sampled": 6522532, "sample_time_ms": 16100.901}, "episode_len_mean": 674.68, "time_this_iter_s": 24.854028463363647, "num_metric_batches_dropped": 0, "timesteps_total": 6522532, "hostname": "flow-main", "episodes_total": 2642, "timestamp": 1557226595, "episode_reward_max": 1310.2478670722871, "episodes_this_iter": 15, "time_total_s": 3988.3356268405914, "time_since_restore": 3988.3356268405914}
{"timesteps_since_restore": 6563694, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41162, "date": "2019-05-07_10-57-01", "episode_reward_min": 49.346638618828564, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3a90>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 159, "episode_reward_mean": 1008.414749337345, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 159, "custom_metrics": {"outflow_rate_max": 1483.7096183816184, "cost2_mean": -24.123329757321958, "cost1_mean": 340.1574484727378, "system_level_velocity_mean": 14.451689588591638, "cost2_min": -38.60090369460001, "cost1_max": 457.09555496670976, "cost1_min": 28.33991920857511, "cost2_max": -6.912282001673933, "outflow_rate_mean": 1147.7572559814355, "system_level_velocity_min": 11.675156702153773, "outflow_rate_min": 327.73704299220816, "system_level_velocity_max": 19.35374548151808}, "info": {"num_steps_trained": 6563694, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01625875011086464, "total_loss": 16.273338317871094, "vf_loss": 16.27694320678711, "policy_loss": -0.006043390370905399, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9413495659828186, "entropy": 0.9523994326591492}, "load_time_ms": 7.17, "grad_time_ms": 9146.96, "update_time_ms": 6.896, "num_steps_sampled": 6563694, "sample_time_ms": 15953.281}, "episode_len_mean": 651.35, "time_this_iter_s": 25.291160106658936, "num_metric_batches_dropped": 0, "timesteps_total": 6563694, "hostname": "flow-main", "episodes_total": 2662, "timestamp": 1557226621, "episode_reward_max": 1310.2478670722871, "episodes_this_iter": 20, "time_total_s": 4013.6267869472504, "time_since_restore": 4013.6267869472504}
{"timesteps_since_restore": 6604824, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41130, "date": "2019-05-07_10-57-27", "episode_reward_min": 49.346638618828564, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc912e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 160, "episode_reward_mean": 993.9171304604433, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 160, "custom_metrics": {"outflow_rate_max": 1483.7096183816184, "cost2_mean": -23.94969400618412, "cost1_mean": 337.0763416338055, "system_level_velocity_mean": 14.66022024263517, "cost2_min": -38.60090369460001, "cost1_max": 457.09555496670976, "cost1_min": 28.33991920857511, "cost2_max": -6.912282001673933, "outflow_rate_mean": 1140.4911311990465, "system_level_velocity_min": 11.675156702153773, "outflow_rate_min": 327.73704299220816, "system_level_velocity_max": 19.35374548151808}, "info": {"num_steps_trained": 6604824, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01660144329071045, "total_loss": 19.163162231445312, "vf_loss": 19.167247772216797, "policy_loss": -0.006577340420335531, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.931987464427948, "entropy": 0.9400072693824768}, "load_time_ms": 6.798, "grad_time_ms": 9293.683, "update_time_ms": 7.15, "num_steps_sampled": 6604824, "sample_time_ms": 15943.635}, "episode_len_mean": 639.95, "time_this_iter_s": 26.857603311538696, "num_metric_batches_dropped": 0, "timesteps_total": 6604824, "hostname": "flow-main", "episodes_total": 2681, "timestamp": 1557226647, "episode_reward_max": 1310.2478670722871, "episodes_this_iter": 19, "time_total_s": 4040.484390258789, "time_since_restore": 4040.484390258789}
{"timesteps_since_restore": 6644906, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40082, "date": "2019-05-07_10-57-52", "episode_reward_min": 49.346638618828564, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6978>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 161, "episode_reward_mean": 981.6993756074596, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 161, "custom_metrics": {"outflow_rate_max": 1483.7096183816184, "cost2_mean": -23.411341624606266, "cost1_mean": 334.24058570366617, "system_level_velocity_mean": 14.717861401743544, "cost2_min": -38.60090369460001, "cost1_max": 457.09555496670976, "cost1_min": 28.33991920857511, "cost2_max": -6.912282001673933, "outflow_rate_mean": 1132.2896627471412, "system_level_velocity_min": 11.988814521606713, "outflow_rate_min": 327.73704299220816, "system_level_velocity_max": 19.35374548151808}, "info": {"num_steps_trained": 6644906, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.019445735961198807, "total_loss": 11.27487850189209, "vf_loss": 11.2776460647583, "policy_loss": -0.005682989489287138, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9532455205917358, "entropy": 0.9508230090141296}, "load_time_ms": 6.714, "grad_time_ms": 9324.496, "update_time_ms": 7.578, "num_steps_sampled": 6644906, "sample_time_ms": 15784.83}, "episode_len_mean": 634.13, "time_this_iter_s": 24.57833242416382, "num_metric_batches_dropped": 0, "timesteps_total": 6644906, "hostname": "flow-main", "episodes_total": 2697, "timestamp": 1557226672, "episode_reward_max": 1310.2478670722871, "episodes_this_iter": 16, "time_total_s": 4065.062722682953, "time_since_restore": 4065.062722682953}
{"timesteps_since_restore": 6685462, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40556, "date": "2019-05-07_10-58-17", "episode_reward_min": 51.64010101490315, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb35f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 162, "episode_reward_mean": 989.6614663434797, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 162, "custom_metrics": {"outflow_rate_max": 1483.7096183816184, "cost2_mean": -22.719796552613733, "cost1_mean": 337.777503211691, "system_level_velocity_mean": 14.816011156762718, "cost2_min": -34.14219563638295, "cost1_max": 457.09555496670976, "cost1_min": 28.33991920857511, "cost2_max": -6.912282001673933, "outflow_rate_mean": 1141.4763598772886, "system_level_velocity_min": 12.186468556375049, "outflow_rate_min": 327.73704299220816, "system_level_velocity_max": 19.231808140769598}, "info": {"num_steps_trained": 6685462, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01722460240125656, "total_loss": 13.907912254333496, "vf_loss": 13.910805702209473, "policy_loss": -0.005477762781083584, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9434177875518799, "entropy": 0.9594364166259766}, "load_time_ms": 6.735, "grad_time_ms": 9330.126, "update_time_ms": 7.569, "num_steps_sampled": 6685462, "sample_time_ms": 15808.29}, "episode_len_mean": 635.06, "time_this_iter_s": 25.24202299118042, "num_metric_batches_dropped": 0, "timesteps_total": 6685462, "hostname": "flow-main", "episodes_total": 2715, "timestamp": 1557226697, "episode_reward_max": 1310.2478670722871, "episodes_this_iter": 18, "time_total_s": 4090.3047456741333, "time_since_restore": 4090.3047456741333}
{"timesteps_since_restore": 6727542, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42080, "date": "2019-05-07_10-58-45", "episode_reward_min": 51.64010101490315, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc80ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc807f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8fe10>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 163, "episode_reward_mean": 1009.2177172072485, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 163, "custom_metrics": {"outflow_rate_max": 1483.7096183816184, "cost2_mean": -22.607972905900386, "cost1_mean": 344.55894305574367, "system_level_velocity_mean": 14.725669950880613, "cost2_min": -34.14219563638295, "cost1_max": 434.9188231643121, "cost1_min": 29.223491841445664, "cost2_max": -6.912282001673933, "outflow_rate_mean": 1164.5872187412203, "system_level_velocity_min": 11.951954538338114, "outflow_rate_min": 327.73704299220816, "system_level_velocity_max": 19.01776079505788}, "info": {"num_steps_trained": 6727542, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017775941640138626, "total_loss": 11.763336181640625, "vf_loss": 11.768037796020508, "policy_loss": -0.007368179503828287, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9483423233032227, "entropy": 0.9657095074653625}, "load_time_ms": 7.674, "grad_time_ms": 9419.292, "update_time_ms": 7.678, "num_steps_sampled": 6727542, "sample_time_ms": 16033.483}, "episode_len_mean": 648.13, "time_this_iter_s": 27.899083614349365, "num_metric_batches_dropped": 0, "timesteps_total": 6727542, "hostname": "flow-main", "episodes_total": 2732, "timestamp": 1557226725, "episode_reward_max": 1192.2652225724314, "episodes_this_iter": 17, "time_total_s": 4118.203829288483, "time_since_restore": 4118.203829288483}
{"timesteps_since_restore": 6769831, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42289, "date": "2019-05-07_10-59-11", "episode_reward_min": 51.64010101490315, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91320>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 164, "episode_reward_mean": 1001.1027050275796, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 164, "custom_metrics": {"outflow_rate_max": 1483.7096183816184, "cost2_mean": -22.452933726903574, "cost1_mean": 340.5838896934469, "system_level_velocity_mean": 14.722411598488604, "cost2_min": -34.14219563638295, "cost1_max": 434.9188231643121, "cost1_min": 29.223491841445664, "cost2_max": -6.912282001673933, "outflow_rate_mean": 1154.1333646199862, "system_level_velocity_min": 11.951954538338114, "outflow_rate_min": 327.73704299220816, "system_level_velocity_max": 19.084883326027406}, "info": {"num_steps_trained": 6769831, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018111174926161766, "total_loss": 9.416542053222656, "vf_loss": 9.421287536621094, "policy_loss": -0.0074623823165893555, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9609367847442627, "entropy": 0.9437372088432312}, "load_time_ms": 7.606, "grad_time_ms": 9376.102, "update_time_ms": 7.774, "num_steps_sampled": 6769831, "sample_time_ms": 16046.179}, "episode_len_mean": 642.37, "time_this_iter_s": 25.5544650554657, "num_metric_batches_dropped": 0, "timesteps_total": 6769831, "hostname": "flow-main", "episodes_total": 2747, "timestamp": 1557226751, "episode_reward_max": 1192.2652225724314, "episodes_this_iter": 15, "time_total_s": 4143.758294343948, "time_since_restore": 4143.758294343948}
{"timesteps_since_restore": 6811579, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41748, "date": "2019-05-07_10-59-36", "episode_reward_min": 63.59761788421477, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc914a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0278>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 165, "episode_reward_mean": 1036.3901419505514, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 165, "custom_metrics": {"outflow_rate_max": 1469.7492475524475, "cost2_mean": -22.64023042996842, "cost1_mean": 350.8670314396836, "system_level_velocity_mean": 14.516371223829546, "cost2_min": -34.07596644636, "cost1_max": 434.9188231643121, "cost1_min": 33.25134551477486, "cost2_max": -9.267410669750484, "outflow_rate_mean": 1178.302644482888, "system_level_velocity_min": 11.951954538338114, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.084883326027406}, "info": {"num_steps_trained": 6811579, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017847411334514618, "total_loss": 7.970343589782715, "vf_loss": 7.973140716552734, "policy_loss": -0.005474181845784187, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.9704568982124329, "entropy": 0.9479972124099731}, "load_time_ms": 7.552, "grad_time_ms": 9304.506, "update_time_ms": 7.803, "num_steps_sampled": 6811579, "sample_time_ms": 16143.336}, "episode_len_mean": 665.7, "time_this_iter_s": 25.194010019302368, "num_metric_batches_dropped": 0, "timesteps_total": 6811579, "hostname": "flow-main", "episodes_total": 2763, "timestamp": 1557226776, "episode_reward_max": 1192.2652225724314, "episodes_this_iter": 16, "time_total_s": 4168.952304363251, "time_since_restore": 4168.952304363251}
{"timesteps_since_restore": 6853796, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42217, "date": "2019-05-07_11-00-01", "episode_reward_min": 56.719339511594235, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc917f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 166, "episode_reward_mean": 1029.9630937914073, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 166, "custom_metrics": {"outflow_rate_max": 1453.7808495504496, "cost2_mean": -22.402194137672105, "cost1_mean": 348.42014826609767, "system_level_velocity_mean": 14.417249652591899, "cost2_min": -34.07596644636, "cost1_max": 434.9188231643121, "cost1_min": 33.49061128418462, "cost2_max": -9.36828596703246, "outflow_rate_mean": 1169.0629531162301, "system_level_velocity_min": 11.951954538338114, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.084883326027406}, "info": {"num_steps_trained": 6853796, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018661342561244965, "total_loss": 14.307320594787598, "vf_loss": 14.312678337097168, "policy_loss": -0.008158872835338116, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9381654262542725, "entropy": 0.9556564092636108}, "load_time_ms": 7.563, "grad_time_ms": 9303.561, "update_time_ms": 7.805, "num_steps_sampled": 6853796, "sample_time_ms": 16112.052}, "episode_len_mean": 664.61, "time_this_iter_s": 24.82418131828308, "num_metric_batches_dropped": 0, "timesteps_total": 6853796, "hostname": "flow-main", "episodes_total": 2782, "timestamp": 1557226801, "episode_reward_max": 1192.2652225724314, "episodes_this_iter": 19, "time_total_s": 4193.776485681534, "time_since_restore": 4193.776485681534}
{"timesteps_since_restore": 6894223, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40427, "date": "2019-05-07_11-00-25", "episode_reward_min": 56.719339511594235, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91e80>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 167, "episode_reward_mean": 1040.893711571303, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 167, "custom_metrics": {"outflow_rate_max": 1453.7808495504496, "cost2_mean": -22.41361371619699, "cost1_mean": 348.5999671164477, "system_level_velocity_mean": 14.250247023954737, "cost2_min": -34.07596644636, "cost1_max": 434.9188231643121, "cost1_min": 33.49061128418462, "cost2_max": -9.36828596703246, "outflow_rate_mean": 1170.905701134569, "system_level_velocity_min": 11.628682308754229, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.084883326027406}, "info": {"num_steps_trained": 6894223, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018137477338314056, "total_loss": 9.873909950256348, "vf_loss": 9.876869201660156, "policy_loss": -0.005680337082594633, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9619977474212646, "entropy": 0.9445765614509583}, "load_time_ms": 7.674, "grad_time_ms": 9340.853, "update_time_ms": 7.676, "num_steps_sampled": 6894223, "sample_time_ms": 16005.365}, "episode_len_mean": 670.43, "time_this_iter_s": 24.221344709396362, "num_metric_batches_dropped": 0, "timesteps_total": 6894223, "hostname": "flow-main", "episodes_total": 2798, "timestamp": 1557226825, "episode_reward_max": 1192.2652225724314, "episodes_this_iter": 16, "time_total_s": 4217.99783039093, "time_since_restore": 4217.99783039093}
{"timesteps_since_restore": 6934861, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40638, "date": "2019-05-07_11-00-50", "episode_reward_min": 56.719339511594235, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc915f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91dd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 168, "episode_reward_mean": 1047.7790039041438, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 168, "custom_metrics": {"outflow_rate_max": 1492.6338617382617, "cost2_mean": -22.38179597409477, "cost1_mean": 352.5006408394904, "system_level_velocity_mean": 14.250665348338636, "cost2_min": -32.13694954201974, "cost1_max": 446.26366952945915, "cost1_min": 33.49061128418462, "cost2_max": -9.36828596703246, "outflow_rate_mean": 1181.3652836110493, "system_level_velocity_min": 11.628682308754229, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.084883326027406}, "info": {"num_steps_trained": 6934861, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018933597952127457, "total_loss": 14.7437105178833, "vf_loss": 14.7467679977417, "policy_loss": -0.005895842798054218, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9399397969245911, "entropy": 0.9968512058258057}, "load_time_ms": 7.865, "grad_time_ms": 9437.204, "update_time_ms": 7.663, "num_steps_sampled": 6934861, "sample_time_ms": 15858.28}, "episode_len_mean": 676.07, "time_this_iter_s": 24.36688756942749, "num_metric_batches_dropped": 0, "timesteps_total": 6934861, "hostname": "flow-main", "episodes_total": 2815, "timestamp": 1557226850, "episode_reward_max": 1202.2047673594504, "episodes_this_iter": 17, "time_total_s": 4242.364717960358, "time_since_restore": 4242.364717960358}
{"timesteps_since_restore": 6976335, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41474, "date": "2019-05-07_11-01-14", "episode_reward_min": 56.719339511594235, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 169, "episode_reward_mean": 1030.039312457903, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 169, "custom_metrics": {"outflow_rate_max": 1492.6338617382617, "cost2_mean": -22.098087038359722, "cost1_mean": 347.7443461049453, "system_level_velocity_mean": 14.33489282761468, "cost2_min": -32.13694954201974, "cost1_max": 446.26366952945915, "cost1_min": 33.49061128418462, "cost2_max": -9.36828596703246, "outflow_rate_mean": 1166.3906504920658, "system_level_velocity_min": 11.628682308754229, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.084883326027406}, "info": {"num_steps_trained": 6976335, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.019653499126434326, "total_loss": 13.645383834838867, "vf_loss": 13.649720191955566, "policy_loss": -0.007283600978553295, "cur_kl_coeff": 0.1499999761581421, "vf_explained_var": 0.945518970489502, "entropy": 0.9728808999061584}, "load_time_ms": 7.832, "grad_time_ms": 9620.045, "update_time_ms": 7.586, "num_steps_sampled": 6976335, "sample_time_ms": 15589.814}, "episode_len_mean": 665.58, "time_this_iter_s": 24.415128707885742, "num_metric_batches_dropped": 0, "timesteps_total": 6976335, "hostname": "flow-main", "episodes_total": 2831, "timestamp": 1557226874, "episode_reward_max": 1232.206183282156, "episodes_this_iter": 16, "time_total_s": 4266.779846668243, "time_since_restore": 4266.779846668243}
{"timesteps_since_restore": 7016584, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40249, "date": "2019-05-07_11-01-38", "episode_reward_min": 56.719339511594235, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc919b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91e48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 170, "episode_reward_mean": 1011.5973150608065, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 170, "custom_metrics": {"outflow_rate_max": 1492.6338617382617, "cost2_mean": -21.41367281033179, "cost1_mean": 344.6996119357856, "system_level_velocity_mean": 14.436845392920107, "cost2_min": -29.712948134912537, "cost1_max": 446.26366952945915, "cost1_min": 32.46410979263297, "cost2_max": -6.954610687870352, "outflow_rate_mean": 1163.2466385662292, "system_level_velocity_min": 11.628682308754229, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.956844180117557}, "info": {"num_steps_trained": 7016584, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018388060852885246, "total_loss": 19.527063369750977, "vf_loss": 19.53020668029785, "policy_loss": -0.005902153439819813, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9238601922988892, "entropy": 0.9867473840713501}, "load_time_ms": 8.332, "grad_time_ms": 9553.724, "update_time_ms": 7.428, "num_steps_sampled": 7016584, "sample_time_ms": 15377.718}, "episode_len_mean": 655.97, "time_this_iter_s": 24.075753688812256, "num_metric_batches_dropped": 0, "timesteps_total": 7016584, "hostname": "flow-main", "episodes_total": 2850, "timestamp": 1557226898, "episode_reward_max": 1232.206183282156, "episodes_this_iter": 19, "time_total_s": 4290.855600357056, "time_since_restore": 4290.855600357056}
{"timesteps_since_restore": 7057629, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41045, "date": "2019-05-07_11-02-04", "episode_reward_min": 56.719339511594235, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc917b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0780>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 171, "episode_reward_mean": 1005.9070344510685, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 171, "custom_metrics": {"outflow_rate_max": 1492.6338617382617, "cost2_mean": -21.32308982633466, "cost1_mean": 346.57729329908295, "system_level_velocity_mean": 14.533617142424848, "cost2_min": -29.712948134912537, "cost1_max": 446.26366952945915, "cost1_min": 32.46410979263297, "cost2_max": -6.954610687870352, "outflow_rate_mean": 1170.6968241251268, "system_level_velocity_min": 11.628682308754229, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.68470662279075}, "info": {"num_steps_trained": 7057629, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018729573115706444, "total_loss": 15.512555122375488, "vf_loss": 15.516227722167969, "policy_loss": -0.006483868695795536, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9415370225906372, "entropy": 0.9693132638931274}, "load_time_ms": 8.306, "grad_time_ms": 9615.176, "update_time_ms": 7.353, "num_steps_sampled": 7057629, "sample_time_ms": 15424.539}, "episode_len_mean": 655.33, "time_this_iter_s": 25.66311001777649, "num_metric_batches_dropped": 0, "timesteps_total": 7057629, "hostname": "flow-main", "episodes_total": 2869, "timestamp": 1557226924, "episode_reward_max": 1232.206183282156, "episodes_this_iter": 19, "time_total_s": 4316.518710374832, "time_since_restore": 4316.518710374832}
{"timesteps_since_restore": 7098270, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40641, "date": "2019-05-07_11-02-29", "episode_reward_min": 49.47713465222721, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc915c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 172, "episode_reward_mean": 1011.2182913527357, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 172, "custom_metrics": {"outflow_rate_max": 1492.6338617382617, "cost2_mean": -21.002937177926068, "cost1_mean": 349.9971115556068, "system_level_velocity_mean": 14.540314684923, "cost2_min": -29.712948134912537, "cost1_max": 446.26366952945915, "cost1_min": 28.332258734193392, "cost2_max": -6.954610687870352, "outflow_rate_mean": 1183.1092857192396, "system_level_velocity_min": 11.628682308754229, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.194725965790322}, "info": {"num_steps_trained": 7098270, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018662383779883385, "total_loss": 12.431246757507324, "vf_loss": 12.434019088745117, "policy_loss": -0.0055724699050188065, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9457056522369385, "entropy": 0.983147382736206}, "load_time_ms": 8.133, "grad_time_ms": 9679.252, "update_time_ms": 7.513, "num_steps_sampled": 7098270, "sample_time_ms": 15317.618}, "episode_len_mean": 661.07, "time_this_iter_s": 24.817540407180786, "num_metric_batches_dropped": 0, "timesteps_total": 7098270, "hostname": "flow-main", "episodes_total": 2885, "timestamp": 1557226949, "episode_reward_max": 1232.206183282156, "episodes_this_iter": 16, "time_total_s": 4341.336250782013, "time_since_restore": 4341.336250782013}
{"timesteps_since_restore": 7138545, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40275, "date": "2019-05-07_11-02-53", "episode_reward_min": 49.47713465222721, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91da0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 173, "episode_reward_mean": 1002.5962808080019, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 173, "custom_metrics": {"outflow_rate_max": 1492.6228335664337, "cost2_mean": -20.381767813394173, "cost1_mean": 349.52554137476807, "system_level_velocity_mean": 14.55047852278581, "cost2_min": -29.712948134912537, "cost1_max": 446.26366952945915, "cost1_min": 28.332258734193392, "cost2_max": -6.954610687870352, "outflow_rate_mean": 1178.2829395394192, "system_level_velocity_min": 11.637717691614856, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.194725965790322}, "info": {"num_steps_trained": 7138545, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.02489101141691208, "total_loss": 12.694918632507324, "vf_loss": 12.697834968566895, "policy_loss": -0.006649216171354055, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.9523958563804626, "entropy": 0.9509376287460327}, "load_time_ms": 7.54, "grad_time_ms": 9568.791, "update_time_ms": 7.354, "num_steps_sampled": 7138545, "sample_time_ms": 15117.138}, "episode_len_mean": 661.07, "time_this_iter_s": 24.75795269012451, "num_metric_batches_dropped": 0, "timesteps_total": 7138545, "hostname": "flow-main", "episodes_total": 2903, "timestamp": 1557226973, "episode_reward_max": 1232.206183282156, "episodes_this_iter": 18, "time_total_s": 4366.094203472137, "time_since_restore": 4366.094203472137}
{"timesteps_since_restore": 7179817, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41272, "date": "2019-05-07_11-03-18", "episode_reward_min": 49.47713465222721, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc919e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 174, "episode_reward_mean": 1011.2817914133173, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 174, "custom_metrics": {"outflow_rate_max": 1492.6228335664337, "cost2_mean": -20.4761362509228, "cost1_mean": 350.264502351085, "system_level_velocity_mean": 14.441015669693973, "cost2_min": -29.712948134912537, "cost1_max": 430.82317385102016, "cost1_min": 28.332258734193392, "cost2_max": -6.954610687870352, "outflow_rate_mean": 1187.1446019647176, "system_level_velocity_min": 11.42074106052831, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.194725965790322}, "info": {"num_steps_trained": 7179817, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01575702801346779, "total_loss": 14.76025390625, "vf_loss": 14.7620267868042, "policy_loss": -0.005319408606737852, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9269838333129883, "entropy": 0.9829636216163635}, "load_time_ms": 7.669, "grad_time_ms": 9632.8, "update_time_ms": 7.399, "num_steps_sampled": 7179817, "sample_time_ms": 14924.792}, "episode_len_mean": 666.99, "time_this_iter_s": 24.278434991836548, "num_metric_batches_dropped": 0, "timesteps_total": 7179817, "hostname": "flow-main", "episodes_total": 2916, "timestamp": 1557226998, "episode_reward_max": 1232.206183282156, "episodes_this_iter": 13, "time_total_s": 4390.372638463974, "time_since_restore": 4390.372638463974}
{"timesteps_since_restore": 7219675, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39858, "date": "2019-05-07_11-03-41", "episode_reward_min": 49.47713465222721, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6fd0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 175, "episode_reward_mean": 1014.1393011961234, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 175, "custom_metrics": {"outflow_rate_max": 1492.6228335664337, "cost2_mean": -20.55984606209785, "cost1_mean": 352.55535035895264, "system_level_velocity_mean": 14.424831458038334, "cost2_min": -29.712948134912537, "cost1_max": 430.1457256751851, "cost1_min": 28.332258734193392, "cost2_max": -6.954610687870352, "outflow_rate_mean": 1195.3119632318296, "system_level_velocity_min": 11.35334174509139, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.194725965790322}, "info": {"num_steps_trained": 7219675, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017594633623957634, "total_loss": 11.482175827026367, "vf_loss": 11.484600067138672, "policy_loss": -0.006384070497006178, "cur_kl_coeff": 0.2250000238418579, "vf_explained_var": 0.951923131942749, "entropy": 1.0231181383132935}, "load_time_ms": 7.689, "grad_time_ms": 9704.504, "update_time_ms": 7.399, "num_steps_sampled": 7219675, "sample_time_ms": 14689.155}, "episode_len_mean": 671.56, "time_this_iter_s": 23.56150984764099, "num_metric_batches_dropped": 0, "timesteps_total": 7219675, "hostname": "flow-main", "episodes_total": 2933, "timestamp": 1557227021, "episode_reward_max": 1181.2644362964224, "episodes_this_iter": 17, "time_total_s": 4413.934148311615, "time_since_restore": 4413.934148311615}
{"timesteps_since_restore": 7260059, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40384, "date": "2019-05-07_11-04-06", "episode_reward_min": 49.47713465222721, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc915c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 176, "episode_reward_mean": 1041.5421863339614, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 176, "custom_metrics": {"outflow_rate_max": 1492.6228335664337, "cost2_mean": -21.047149796987952, "cost1_mean": 365.84979335953744, "system_level_velocity_mean": 14.410817977883944, "cost2_min": -29.873406374577712, "cost1_max": 430.1457256751851, "cost1_min": 28.332258734193392, "cost2_max": -7.7700506060165555, "outflow_rate_mean": 1226.2796630916494, "system_level_velocity_min": 11.35334174509139, "outflow_rate_min": 338.35525222187107, "system_level_velocity_max": 19.194725965790322}, "info": {"num_steps_trained": 7260059, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015531985089182854, "total_loss": 13.064980506896973, "vf_loss": 13.067975044250488, "policy_loss": -0.006489441730082035, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.947114109992981, "entropy": 0.9998007416725159}, "load_time_ms": 7.666, "grad_time_ms": 9763.113, "update_time_ms": 7.412, "num_steps_sampled": 7260059, "sample_time_ms": 14571.215}, "episode_len_mean": 693.14, "time_this_iter_s": 24.222188234329224, "num_metric_batches_dropped": 0, "timesteps_total": 7260059, "hostname": "flow-main", "episodes_total": 2953, "timestamp": 1557227046, "episode_reward_max": 1181.2644362964224, "episodes_this_iter": 20, "time_total_s": 4438.156336545944, "time_since_restore": 4438.156336545944}
{"timesteps_since_restore": 7300530, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40471, "date": "2019-05-07_11-04-30", "episode_reward_min": 49.47713465222721, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb07b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb05f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 177, "episode_reward_mean": 1021.6264564553788, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 177, "custom_metrics": {"outflow_rate_max": 1478.2311244755242, "cost2_mean": -20.793333049605145, "cost1_mean": 358.6145185235583, "system_level_velocity_mean": 14.46731392021764, "cost2_min": -29.873406374577712, "cost1_max": 430.1457256751851, "cost1_min": 28.332258734193392, "cost2_max": -7.184356423401312, "outflow_rate_mean": 1206.7583120609902, "system_level_velocity_min": 11.35334174509139, "outflow_rate_min": 337.7301442378166, "system_level_velocity_max": 19.194725965790322}, "info": {"num_steps_trained": 7300530, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015773842111229897, "total_loss": 13.201338768005371, "vf_loss": 13.206235885620117, "policy_loss": -0.00844474695622921, "cur_kl_coeff": 0.2250000238418579, "vf_explained_var": 0.9492198824882507, "entropy": 0.9962204694747925}, "load_time_ms": 7.427, "grad_time_ms": 9783.729, "update_time_ms": 7.542, "num_steps_sampled": 7300530, "sample_time_ms": 14574.43}, "episode_len_mean": 680.65, "time_this_iter_s": 24.451095819473267, "num_metric_batches_dropped": 0, "timesteps_total": 7300530, "hostname": "flow-main", "episodes_total": 2970, "timestamp": 1557227070, "episode_reward_max": 1181.2644362964224, "episodes_this_iter": 17, "time_total_s": 4462.6074323654175, "time_since_restore": 4462.6074323654175}
{"timesteps_since_restore": 7341420, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40890, "date": "2019-05-07_11-04-54", "episode_reward_min": 54.28359259666741, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc955c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc956d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 178, "episode_reward_mean": 1029.2805007967127, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 178, "custom_metrics": {"outflow_rate_max": 1460.455325074925, "cost2_mean": -21.454437081877405, "cost1_mean": 361.7754595731902, "system_level_velocity_mean": 14.578441244122018, "cost2_min": -29.968248012752777, "cost1_max": 430.1457256751851, "cost1_min": 29.297103225354103, "cost2_max": -7.184356423401312, "outflow_rate_mean": 1217.2797498041236, "system_level_velocity_min": 11.35334174509139, "outflow_rate_min": 337.7301442378166, "system_level_velocity_max": 18.76612713896984}, "info": {"num_steps_trained": 7341420, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01576772704720497, "total_loss": 17.465927124023438, "vf_loss": 17.470476150512695, "policy_loss": -0.008096964098513126, "cur_kl_coeff": 0.2250000238418579, "vf_explained_var": 0.9228829145431519, "entropy": 1.0270458459854126}, "load_time_ms": 7.114, "grad_time_ms": 9711.165, "update_time_ms": 7.754, "num_steps_sampled": 7341420, "sample_time_ms": 14601.843}, "episode_len_mean": 681.45, "time_this_iter_s": 23.896377086639404, "num_metric_batches_dropped": 0, "timesteps_total": 7341420, "hostname": "flow-main", "episodes_total": 2988, "timestamp": 1557227094, "episode_reward_max": 1181.2644362964224, "episodes_this_iter": 18, "time_total_s": 4486.503809452057, "time_since_restore": 4486.503809452057}
{"timesteps_since_restore": 7382651, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41231, "date": "2019-05-07_11-05-19", "episode_reward_min": 54.28359259666741, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb79e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb75c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 179, "episode_reward_mean": 1020.1124619517077, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 179, "custom_metrics": {"outflow_rate_max": 1460.455325074925, "cost2_mean": -21.65214697626844, "cost1_mean": 359.0704228285242, "system_level_velocity_mean": 14.623904444471913, "cost2_min": -29.968248012752777, "cost1_max": 430.1457256751851, "cost1_min": 29.297103225354103, "cost2_max": -7.184356423401312, "outflow_rate_mean": 1212.3962033385137, "system_level_velocity_min": 11.35334174509139, "outflow_rate_min": 337.7301442378166, "system_level_velocity_max": 18.76612713896984}, "info": {"num_steps_trained": 7382651, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016455478966236115, "total_loss": 11.597787857055664, "vf_loss": 11.60316276550293, "policy_loss": -0.009076942689716816, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9484391212463379, "entropy": 0.9823457598686218}, "load_time_ms": 7.034, "grad_time_ms": 9559.113, "update_time_ms": 8.084, "num_steps_sampled": 7382651, "sample_time_ms": 14783.721}, "episode_len_mean": 675.52, "time_this_iter_s": 24.685753107070923, "num_metric_batches_dropped": 0, "timesteps_total": 7382651, "hostname": "flow-main", "episodes_total": 3003, "timestamp": 1557227119, "episode_reward_max": 1181.2644362964224, "episodes_this_iter": 15, "time_total_s": 4511.189562559128, "time_since_restore": 4511.189562559128}
{"timesteps_since_restore": 7423560, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40909, "date": "2019-05-07_11-05-45", "episode_reward_min": 54.28359259666741, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb72b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 180, "episode_reward_mean": 996.9499301518273, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 180, "custom_metrics": {"outflow_rate_max": 1445.5454413586413, "cost2_mean": -21.01419115798598, "cost1_mean": 349.13586631070166, "system_level_velocity_mean": 14.542786576205318, "cost2_min": -29.968248012752777, "cost1_max": 425.13288699665554, "cost1_min": 29.297103225354103, "cost2_max": -6.65661904888219, "outflow_rate_mean": 1177.075176580149, "system_level_velocity_min": 11.273804514976002, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.76612713896984}, "info": {"num_steps_trained": 7423560, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016456954181194305, "total_loss": 12.641603469848633, "vf_loss": 12.644842147827148, "policy_loss": -0.006942399777472019, "cur_kl_coeff": 0.2250000238418579, "vf_explained_var": 0.9469329714775085, "entropy": 0.9967465996742249}, "load_time_ms": 7.006, "grad_time_ms": 9599.577, "update_time_ms": 8.286, "num_steps_sampled": 7423560, "sample_time_ms": 14919.253}, "episode_len_mean": 662.52, "time_this_iter_s": 25.82589864730835, "num_metric_batches_dropped": 0, "timesteps_total": 7423560, "hostname": "flow-main", "episodes_total": 3023, "timestamp": 1557227145, "episode_reward_max": 1169.0493384932115, "episodes_this_iter": 20, "time_total_s": 4537.015461206436, "time_since_restore": 4537.015461206436}
{"timesteps_since_restore": 7464365, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40805, "date": "2019-05-07_11-06-09", "episode_reward_min": 54.28359259666741, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb34a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3080>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 181, "episode_reward_mean": 997.7329586985298, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 181, "custom_metrics": {"outflow_rate_max": 1445.5454413586413, "cost2_mean": -20.905770656403128, "cost1_mean": 348.86175074425876, "system_level_velocity_mean": 14.510551536123224, "cost2_min": -29.968248012752777, "cost1_max": 425.13288699665554, "cost1_min": 29.297103225354103, "cost2_max": -6.65661904888219, "outflow_rate_mean": 1175.0830652115176, "system_level_velocity_min": 11.273804514976002, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.76612713896984}, "info": {"num_steps_trained": 7464365, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016193071380257607, "total_loss": 8.939356803894043, "vf_loss": 8.944205284118652, "policy_loss": -0.00849300529807806, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9647548794746399, "entropy": 1.0208196640014648}, "load_time_ms": 6.993, "grad_time_ms": 9597.035, "update_time_ms": 8.079, "num_steps_sampled": 7464365, "sample_time_ms": 14844.151}, "episode_len_mean": 662.52, "time_this_iter_s": 24.892868041992188, "num_metric_batches_dropped": 0, "timesteps_total": 7464365, "hostname": "flow-main", "episodes_total": 3038, "timestamp": 1557227169, "episode_reward_max": 1171.6625101881023, "episodes_this_iter": 15, "time_total_s": 4561.908329248428, "time_since_restore": 4561.908329248428}
{"timesteps_since_restore": 7505504, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41139, "date": "2019-05-07_11-06-34", "episode_reward_min": 54.28359259666741, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 182, "episode_reward_mean": 982.51701718722, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 182, "custom_metrics": {"outflow_rate_max": 1437.0607796203797, "cost2_mean": -20.04815849787988, "cost1_mean": 341.4422934126173, "system_level_velocity_mean": 14.50432325215998, "cost2_min": -29.968248012752777, "cost1_max": 424.0972257977554, "cost1_min": 29.297103225354103, "cost2_max": -6.65661904888219, "outflow_rate_mean": 1153.7188586615923, "system_level_velocity_min": 11.043294513970173, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.76612713896984}, "info": {"num_steps_trained": 7505504, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016788003966212273, "total_loss": 13.79580307006836, "vf_loss": 13.800947189331055, "policy_loss": -0.008922144770622253, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9380245804786682, "entropy": 1.027052879333496}, "load_time_ms": 7.023, "grad_time_ms": 9595.47, "update_time_ms": 8.058, "num_steps_sampled": 7505504, "sample_time_ms": 14842.356}, "episode_len_mean": 651.48, "time_this_iter_s": 24.800111770629883, "num_metric_batches_dropped": 0, "timesteps_total": 7505504, "hostname": "flow-main", "episodes_total": 3054, "timestamp": 1557227194, "episode_reward_max": 1177.8696873176523, "episodes_this_iter": 16, "time_total_s": 4586.708441019058, "time_since_restore": 4586.708441019058}
{"timesteps_since_restore": 7546836, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41332, "date": "2019-05-07_11-06-59", "episode_reward_min": 57.80585489510793, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 183, "episode_reward_mean": 1005.4724458007327, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 183, "custom_metrics": {"outflow_rate_max": 1437.0607796203797, "cost2_mean": -19.981433846403974, "cost1_mean": 347.371630047404, "system_level_velocity_mean": 14.367005728322276, "cost2_min": -29.968248012752777, "cost1_max": 424.0972257977554, "cost1_min": 32.62083091998022, "cost2_max": -6.65661904888219, "outflow_rate_mean": 1173.3047181437996, "system_level_velocity_min": 11.043294513970173, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.62654644359516}, "info": {"num_steps_trained": 7546836, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016494017094373703, "total_loss": 12.532304763793945, "vf_loss": 12.535552978515625, "policy_loss": -0.006960245314985514, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9456197619438171, "entropy": 1.037013053894043}, "load_time_ms": 7.111, "grad_time_ms": 9691.127, "update_time_ms": 8.088, "num_steps_sampled": 7546836, "sample_time_ms": 14779.248}, "episode_len_mean": 664.05, "time_this_iter_s": 25.09455895423889, "num_metric_batches_dropped": 0, "timesteps_total": 7546836, "hostname": "flow-main", "episodes_total": 3072, "timestamp": 1557227219, "episode_reward_max": 1177.8696873176523, "episodes_this_iter": 18, "time_total_s": 4611.802999973297, "time_since_restore": 4611.802999973297}
{"timesteps_since_restore": 7587928, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41092, "date": "2019-05-07_11-07-25", "episode_reward_min": 55.70616720160711, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc955c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3f28>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 184, "episode_reward_mean": 994.094217153533, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 184, "custom_metrics": {"outflow_rate_max": 1458.053792207792, "cost2_mean": -19.860609282404543, "cost1_mean": 341.96804307888306, "system_level_velocity_mean": 14.267497844439031, "cost2_min": -29.493471214618687, "cost1_max": 424.2238234671606, "cost1_min": 31.553607656266724, "cost2_max": -6.65661904888219, "outflow_rate_mean": 1156.824484022702, "system_level_velocity_min": 11.043294513970173, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.62654644359516}, "info": {"num_steps_trained": 7587928, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015313725918531418, "total_loss": 14.515243530273438, "vf_loss": 14.517578125, "policy_loss": -0.005781073588877916, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9445126056671143, "entropy": 0.9967796802520752}, "load_time_ms": 7.028, "grad_time_ms": 9738.037, "update_time_ms": 8.078, "num_steps_sampled": 7587928, "sample_time_ms": 14828.112}, "episode_len_mean": 658.3, "time_this_iter_s": 25.243983268737793, "num_metric_batches_dropped": 0, "timesteps_total": 7587928, "hostname": "flow-main", "episodes_total": 3091, "timestamp": 1557227245, "episode_reward_max": 1177.8696873176523, "episodes_this_iter": 19, "time_total_s": 4637.046983242035, "time_since_restore": 4637.046983242035}
{"timesteps_since_restore": 7628589, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40661, "date": "2019-05-07_11-07-50", "episode_reward_min": 55.70616720160711, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3160>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 185, "episode_reward_mean": 1002.6854311214962, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 185, "custom_metrics": {"outflow_rate_max": 1458.053792207792, "cost2_mean": -20.065700593424037, "cost1_mean": 344.5029924580935, "system_level_velocity_mean": 14.18009343285622, "cost2_min": -29.493471214618687, "cost1_max": 424.2238234671606, "cost1_min": 31.553607656266724, "cost2_max": -6.65661904888219, "outflow_rate_mean": 1161.064556666134, "system_level_velocity_min": 11.043294513970173, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.62654644359516}, "info": {"num_steps_trained": 7628589, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0154503108933568, "total_loss": 9.544453620910645, "vf_loss": 9.548613548278809, "policy_loss": -0.007636052090674639, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9599435329437256, "entropy": 0.9872145652770996}, "load_time_ms": 7.191, "grad_time_ms": 9855.445, "update_time_ms": 8.209, "num_steps_sampled": 7628589, "sample_time_ms": 14918.268}, "episode_len_mean": 664.23, "time_this_iter_s": 25.649187326431274, "num_metric_batches_dropped": 0, "timesteps_total": 7628589, "hostname": "flow-main", "episodes_total": 3108, "timestamp": 1557227270, "episode_reward_max": 1177.8696873176523, "episodes_this_iter": 17, "time_total_s": 4662.696170568466, "time_since_restore": 4662.696170568466}
{"timesteps_since_restore": 7670980, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42391, "date": "2019-05-07_11-08-15", "episode_reward_min": 55.70616720160711, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb32e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3828>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 186, "episode_reward_mean": 1026.5481737152363, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 186, "custom_metrics": {"outflow_rate_max": 1458.053792207792, "cost2_mean": -20.63342741629417, "cost1_mean": 352.52889272989955, "system_level_velocity_mean": 14.164213039377524, "cost2_min": -29.493471214618687, "cost1_max": 424.2238234671606, "cost1_min": 31.553607656266724, "cost2_max": -8.209335422690797, "outflow_rate_mean": 1182.0066040119113, "system_level_velocity_min": 11.043294513970173, "outflow_rate_min": 334.62201022295307, "system_level_velocity_max": 18.62654644359516}, "info": {"num_steps_trained": 7670980, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015941407531499863, "total_loss": 7.937252044677734, "vf_loss": 7.942260265350342, "policy_loss": -0.008596009574830532, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9648955464363098, "entropy": 0.9994056820869446}, "load_time_ms": 7.23, "grad_time_ms": 9895.648, "update_time_ms": 8.283, "num_steps_sampled": 7670980, "sample_time_ms": 14947.743}, "episode_len_mean": 677.23, "time_this_iter_s": 24.926384210586548, "num_metric_batches_dropped": 0, "timesteps_total": 7670980, "hostname": "flow-main", "episodes_total": 3123, "timestamp": 1557227295, "episode_reward_max": 1182.4085398361153, "episodes_this_iter": 15, "time_total_s": 4687.622554779053, "time_since_restore": 4687.622554779053}
{"timesteps_since_restore": 7713330, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42350, "date": "2019-05-07_11-08-40", "episode_reward_min": 55.70616720160711, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb72b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 187, "episode_reward_mean": 1029.3800626125415, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 187, "custom_metrics": {"outflow_rate_max": 1467.2094805194806, "cost2_mean": -20.889930746461243, "cost1_mean": 352.3246593611604, "system_level_velocity_mean": 14.163105312008991, "cost2_min": -28.76538508210125, "cost1_max": 433.81399835477305, "cost1_min": 31.553607656266724, "cost2_max": -8.209335422690797, "outflow_rate_mean": 1181.8667972746487, "system_level_velocity_min": 11.043294513970173, "outflow_rate_min": 334.62201022295307, "system_level_velocity_max": 18.62654644359516}, "info": {"num_steps_trained": 7713330, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016097839921712875, "total_loss": 10.033074378967285, "vf_loss": 10.035998344421387, "policy_loss": -0.00654562609270215, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9544875621795654, "entropy": 0.9972379803657532}, "load_time_ms": 7.318, "grad_time_ms": 9884.0, "update_time_ms": 8.374, "num_steps_sampled": 7713330, "sample_time_ms": 14961.667}, "episode_len_mean": 677.23, "time_this_iter_s": 24.479482173919678, "num_metric_batches_dropped": 0, "timesteps_total": 7713330, "hostname": "flow-main", "episodes_total": 3137, "timestamp": 1557227320, "episode_reward_max": 1182.4085398361153, "episodes_this_iter": 14, "time_total_s": 4712.102036952972, "time_since_restore": 4712.102036952972}
{"timesteps_since_restore": 7755148, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41818, "date": "2019-05-07_11-09-05", "episode_reward_min": 55.70616720160711, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f8d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 188, "episode_reward_mean": 1040.3997428679138, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 188, "custom_metrics": {"outflow_rate_max": 1467.2094805194806, "cost2_mean": -21.8757986720329, "cost1_mean": 353.8425938816137, "system_level_velocity_mean": 14.060101462631028, "cost2_min": -33.04942638466967, "cost1_max": 433.81399835477305, "cost1_min": 31.553607656266724, "cost2_max": -8.209335422690797, "outflow_rate_mean": 1187.8355516706279, "system_level_velocity_min": 11.18244558891048, "outflow_rate_min": 334.62201022295307, "system_level_velocity_max": 18.64555594288709}, "info": {"num_steps_trained": 7755148, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015674028545618057, "total_loss": 11.203356742858887, "vf_loss": 11.206780433654785, "policy_loss": -0.006950261536985636, "cur_kl_coeff": 0.2250000238418579, "vf_explained_var": 0.9516487121582031, "entropy": 1.0174980163574219}, "load_time_ms": 7.372, "grad_time_ms": 9874.928, "update_time_ms": 8.355, "num_steps_sampled": 7755148, "sample_time_ms": 15055.921}, "episode_len_mean": 682.97, "time_this_iter_s": 24.75971484184265, "num_metric_batches_dropped": 0, "timesteps_total": 7755148, "hostname": "flow-main", "episodes_total": 3153, "timestamp": 1557227345, "episode_reward_max": 1197.2673033284827, "episodes_this_iter": 16, "time_total_s": 4736.861751794815, "time_since_restore": 4736.861751794815}
{"timesteps_since_restore": 7796918, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41770, "date": "2019-05-07_11-09-30", "episode_reward_min": 55.70616720160711, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 189, "episode_reward_mean": 1037.914035930227, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 189, "custom_metrics": {"outflow_rate_max": 1467.2094805194806, "cost2_mean": -22.395374397974035, "cost1_mean": 352.02933274507626, "system_level_velocity_mean": 13.993578918064031, "cost2_min": -33.04942638466967, "cost1_max": 433.81399835477305, "cost1_min": 31.553607656266724, "cost2_max": -8.209335422690797, "outflow_rate_mean": 1180.328519700598, "system_level_velocity_min": 11.18244558891048, "outflow_rate_min": 334.62201022295307, "system_level_velocity_max": 18.64555594288709}, "info": {"num_steps_trained": 7796918, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015084284357726574, "total_loss": 9.95358943939209, "vf_loss": 9.95702075958252, "policy_loss": -0.006826473865658045, "cur_kl_coeff": 0.2250000238418579, "vf_explained_var": 0.955797553062439, "entropy": 0.996645987033844}, "load_time_ms": 7.119, "grad_time_ms": 9881.116, "update_time_ms": 8.133, "num_steps_sampled": 7796918, "sample_time_ms": 15147.266}, "episode_len_mean": 682.97, "time_this_iter_s": 25.666503190994263, "num_metric_batches_dropped": 0, "timesteps_total": 7796918, "hostname": "flow-main", "episodes_total": 3171, "timestamp": 1557227370, "episode_reward_max": 1197.2673033284827, "episodes_this_iter": 18, "time_total_s": 4762.528254985809, "time_since_restore": 4762.528254985809}
{"timesteps_since_restore": 7837312, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40394, "date": "2019-05-07_11-09-55", "episode_reward_min": 58.04868975571218, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7c50>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 190, "episode_reward_mean": 1034.3133256701303, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 190, "custom_metrics": {"outflow_rate_max": 1467.2094805194806, "cost2_mean": -22.363995651241773, "cost1_mean": 348.7311810252653, "system_level_velocity_mean": 13.968047313239772, "cost2_min": -33.04942638466967, "cost1_max": 433.81399835477305, "cost1_min": 32.83397417151877, "cost2_max": -8.442444967844907, "outflow_rate_mean": 1171.949756703463, "system_level_velocity_min": 11.18244558891048, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.64555594288709}, "info": {"num_steps_trained": 7837312, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01608433574438095, "total_loss": 13.811444282531738, "vf_loss": 13.814859390258789, "policy_loss": -0.007033032365143299, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9485884308815002, "entropy": 1.0122478008270264}, "load_time_ms": 7.013, "grad_time_ms": 9806.369, "update_time_ms": 7.865, "num_steps_sampled": 7837312, "sample_time_ms": 15139.254}, "episode_len_mean": 678.8, "time_this_iter_s": 24.99417781829834, "num_metric_batches_dropped": 0, "timesteps_total": 7837312, "hostname": "flow-main", "episodes_total": 3190, "timestamp": 1557227395, "episode_reward_max": 1197.2673033284827, "episodes_this_iter": 19, "time_total_s": 4787.522432804108, "time_since_restore": 4787.522432804108}
{"timesteps_since_restore": 7878970, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41658, "date": "2019-05-07_11-10-20", "episode_reward_min": 58.04868975571218, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3f98>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 191, "episode_reward_mean": 1048.4041624221381, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 191, "custom_metrics": {"outflow_rate_max": 1467.2094805194806, "cost2_mean": -22.37608114148113, "cost1_mean": 353.5516866782258, "system_level_velocity_mean": 14.044522463991429, "cost2_min": -33.04942638466967, "cost1_max": 433.81399835477305, "cost1_min": 32.83397417151877, "cost2_max": -8.442444967844907, "outflow_rate_mean": 1188.294360193906, "system_level_velocity_min": 11.559075468197474, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.64555594288709}, "info": {"num_steps_trained": 7878970, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016098087653517723, "total_loss": 10.885211944580078, "vf_loss": 10.887211799621582, "policy_loss": -0.005622234661132097, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9510031342506409, "entropy": 1.018640398979187}, "load_time_ms": 7.237, "grad_time_ms": 9781.409, "update_time_ms": 7.76, "num_steps_sampled": 7878970, "sample_time_ms": 15155.712}, "episode_len_mean": 683.72, "time_this_iter_s": 24.793120622634888, "num_metric_batches_dropped": 0, "timesteps_total": 7878970, "hostname": "flow-main", "episodes_total": 3205, "timestamp": 1557227420, "episode_reward_max": 1197.2673033284827, "episodes_this_iter": 15, "time_total_s": 4812.315553426743, "time_since_restore": 4812.315553426743}
{"timesteps_since_restore": 7920316, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41346, "date": "2019-05-07_11-10-45", "episode_reward_min": 58.04868975571218, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb07b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f4a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 192, "episode_reward_mean": 1046.1803941626779, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 192, "custom_metrics": {"outflow_rate_max": 1467.2094805194806, "cost2_mean": -22.070841749514763, "cost1_mean": 352.05587629014923, "system_level_velocity_mean": 13.977010469265213, "cost2_min": -33.04942638466967, "cost1_max": 433.81399835477305, "cost1_min": 32.83397417151877, "cost2_max": -8.442444967844907, "outflow_rate_mean": 1183.7286237703295, "system_level_velocity_min": 11.559075468197474, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.64555594288709}, "info": {"num_steps_trained": 7920316, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017352165654301643, "total_loss": 9.74399185180664, "vf_loss": 9.749267578125, "policy_loss": -0.009180236607789993, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9634370803833008, "entropy": 1.0011895895004272}, "load_time_ms": 7.259, "grad_time_ms": 9840.114, "update_time_ms": 7.669, "num_steps_sampled": 7920316, "sample_time_ms": 15134.085}, "episode_len_mean": 683.72, "time_this_iter_s": 25.151856422424316, "num_metric_batches_dropped": 0, "timesteps_total": 7920316, "hostname": "flow-main", "episodes_total": 3220, "timestamp": 1557227445, "episode_reward_max": 1197.2673033284827, "episodes_this_iter": 15, "time_total_s": 4837.467409849167, "time_since_restore": 4837.467409849167}
{"timesteps_since_restore": 7961686, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41370, "date": "2019-05-07_11-11-11", "episode_reward_min": 58.04868975571218, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb05c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7978>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 193, "episode_reward_mean": 1027.698048100033, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 193, "custom_metrics": {"outflow_rate_max": 1422.1579196803198, "cost2_mean": -21.198101684854826, "cost1_mean": 347.7788558483607, "system_level_velocity_mean": 14.038397434195646, "cost2_min": -33.04942638466967, "cost1_max": 424.2562863795201, "cost1_min": 32.83397417151877, "cost2_max": -8.442444967844907, "outflow_rate_mean": 1174.8333054436166, "system_level_velocity_min": 11.382705035854888, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.64555594288709}, "info": {"num_steps_trained": 7961686, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015631053596735, "total_loss": 13.81662654876709, "vf_loss": 13.820176124572754, "policy_loss": -0.0070640649646520615, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9461763501167297, "entropy": 1.0281965732574463}, "load_time_ms": 6.848, "grad_time_ms": 9808.949, "update_time_ms": 7.769, "num_steps_sampled": 7961686, "sample_time_ms": 15173.802}, "episode_len_mean": 675.21, "time_this_iter_s": 25.174884796142578, "num_metric_batches_dropped": 0, "timesteps_total": 7961686, "hostname": "flow-main", "episodes_total": 3237, "timestamp": 1557227471, "episode_reward_max": 1197.2673033284827, "episodes_this_iter": 17, "time_total_s": 4862.642294645309, "time_since_restore": 4862.642294645309}
{"timesteps_since_restore": 8002371, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40685, "date": "2019-05-07_11-11-35", "episode_reward_min": 58.04868975571218, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb05f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd03438>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 194, "episode_reward_mean": 1026.1505962723343, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 194, "custom_metrics": {"outflow_rate_max": 1422.1579196803198, "cost2_mean": -20.488742797101967, "cost1_mean": 347.9745769777169, "system_level_velocity_mean": 13.97513158412169, "cost2_min": -29.862764773422587, "cost1_max": 420.40469143103235, "cost1_min": 32.83397417151877, "cost2_max": -8.442444967844907, "outflow_rate_mean": 1174.0425780984444, "system_level_velocity_min": 11.382705035854888, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.398865780951226}, "info": {"num_steps_trained": 8002371, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018328335136175156, "total_loss": 13.741894721984863, "vf_loss": 13.745219230651855, "policy_loss": -0.007448411546647549, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9494272470474243, "entropy": 1.0360841751098633}, "load_time_ms": 6.751, "grad_time_ms": 9765.72, "update_time_ms": 7.625, "num_steps_sampled": 8002371, "sample_time_ms": 15159.091}, "episode_len_mean": 677.04, "time_this_iter_s": 24.65477204322815, "num_metric_batches_dropped": 0, "timesteps_total": 8002371, "hostname": "flow-main", "episodes_total": 3255, "timestamp": 1557227495, "episode_reward_max": 1179.699769035517, "episodes_this_iter": 18, "time_total_s": 4887.297066688538, "time_since_restore": 4887.297066688538}
{"timesteps_since_restore": 8042280, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39909, "date": "2019-05-07_11-11-59", "episode_reward_min": 49.87048963296559, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb71d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb77f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3b70>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 195, "episode_reward_mean": 1008.3409063506224, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 195, "custom_metrics": {"outflow_rate_max": 1422.1579196803198, "cost2_mean": -19.585529759266322, "cost1_mean": 345.9346620527507, "system_level_velocity_mean": 14.087474541280681, "cost2_min": -28.64511972348136, "cost1_max": 422.7374169030187, "cost1_min": 28.350039677884393, "cost2_max": -7.116587997853192, "outflow_rate_mean": 1164.9370466763746, "system_level_velocity_min": 11.281667165327296, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 19.117935207839576}, "info": {"num_steps_trained": 8042280, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015448358841240406, "total_loss": 12.585667610168457, "vf_loss": 12.589469909667969, "policy_loss": -0.007278254721313715, "cur_kl_coeff": 0.2250000238418579, "vf_explained_var": 0.9527710676193237, "entropy": 1.0210908651351929}, "load_time_ms": 6.63, "grad_time_ms": 9640.084, "update_time_ms": 7.595, "num_steps_sampled": 8042280, "sample_time_ms": 15136.664}, "episode_len_mean": 670.47, "time_this_iter_s": 24.149008989334106, "num_metric_batches_dropped": 0, "timesteps_total": 8042280, "hostname": "flow-main", "episodes_total": 3274, "timestamp": 1557227519, "episode_reward_max": 1169.1798499698389, "episodes_this_iter": 19, "time_total_s": 4911.446075677872, "time_since_restore": 4911.446075677872}
{"timesteps_since_restore": 8083547, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41267, "date": "2019-05-07_11-12-23", "episode_reward_min": 49.87048963296559, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb02e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca69b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 196, "episode_reward_mean": 1021.6476169680816, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 196, "custom_metrics": {"outflow_rate_max": 1449.278736863137, "cost2_mean": -19.04458862150839, "cost1_mean": 353.1384821679223, "system_level_velocity_mean": 14.097604521111712, "cost2_min": -28.64511972348136, "cost1_max": 435.0895613284485, "cost1_min": 28.350039677884393, "cost2_max": -7.116587997853192, "outflow_rate_mean": 1181.9451788539973, "system_level_velocity_min": 11.281667165327296, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.117935207839576}, "info": {"num_steps_trained": 8083547, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016603853553533554, "total_loss": 9.811985969543457, "vf_loss": 9.815707206726074, "policy_loss": -0.007457823492586613, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9616856575012207, "entropy": 1.0057308673858643}, "load_time_ms": 6.56, "grad_time_ms": 9533.175, "update_time_ms": 7.521, "num_steps_sampled": 8083547, "sample_time_ms": 15100.237}, "episode_len_mean": 681.16, "time_this_iter_s": 23.511952877044678, "num_metric_batches_dropped": 0, "timesteps_total": 8083547, "hostname": "flow-main", "episodes_total": 3289, "timestamp": 1557227543, "episode_reward_max": 1169.1798499698389, "episodes_this_iter": 15, "time_total_s": 4934.958028554916, "time_since_restore": 4934.958028554916}
{"timesteps_since_restore": 8125222, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41675, "date": "2019-05-07_11-12-47", "episode_reward_min": 49.87048963296559, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0828>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 197, "episode_reward_mean": 1008.0889858873194, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 197, "custom_metrics": {"outflow_rate_max": 1449.278736863137, "cost2_mean": -18.582348083194734, "cost1_mean": 349.2918387471579, "system_level_velocity_mean": 14.039863126103171, "cost2_min": -27.257381999462254, "cost1_max": 460.9395223157406, "cost1_min": 28.350039677884393, "cost2_max": -7.116587997853192, "outflow_rate_mean": 1169.2930240883513, "system_level_velocity_min": 11.281667165327296, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.117935207839576}, "info": {"num_steps_trained": 8125222, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.019980328157544136, "total_loss": 10.875285148620605, "vf_loss": 10.874025344848633, "policy_loss": -0.0032346185762435198, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9568154811859131, "entropy": 1.002982258796692}, "load_time_ms": 6.541, "grad_time_ms": 9531.802, "update_time_ms": 7.511, "num_steps_sampled": 8125222, "sample_time_ms": 15096.822}, "episode_len_mean": 676.88, "time_this_iter_s": 24.435757160186768, "num_metric_batches_dropped": 0, "timesteps_total": 8125222, "hostname": "flow-main", "episodes_total": 3306, "timestamp": 1557227567, "episode_reward_max": 1191.1521721387478, "episodes_this_iter": 17, "time_total_s": 4959.393785715103, "time_since_restore": 4959.393785715103}
{"timesteps_since_restore": 8166030, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40808, "date": "2019-05-07_11-13-13", "episode_reward_min": 49.87048963296559, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0940>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 198, "episode_reward_mean": 1005.7317208307094, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 198, "custom_metrics": {"outflow_rate_max": 1449.278736863137, "cost2_mean": -18.43824175872235, "cost1_mean": 347.93188417539625, "system_level_velocity_mean": 13.969317593165727, "cost2_min": -27.257381999462254, "cost1_max": 460.9395223157406, "cost1_min": 28.350039677884393, "cost2_max": -7.116587997853192, "outflow_rate_mean": 1165.2131821822572, "system_level_velocity_min": 11.281667165327296, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.117935207839576}, "info": {"num_steps_trained": 8166030, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015387441962957382, "total_loss": 8.909269332885742, "vf_loss": 8.911642074584961, "policy_loss": -0.005834711715579033, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9681439399719238, "entropy": 1.0026051998138428}, "load_time_ms": 6.673, "grad_time_ms": 9538.092, "update_time_ms": 7.472, "num_steps_sampled": 8166030, "sample_time_ms": 15173.533}, "episode_len_mean": 676.88, "time_this_iter_s": 25.58102583885193, "num_metric_batches_dropped": 0, "timesteps_total": 8166030, "hostname": "flow-main", "episodes_total": 3321, "timestamp": 1557227593, "episode_reward_max": 1191.1521721387478, "episodes_this_iter": 15, "time_total_s": 4984.974811553955, "time_since_restore": 4984.974811553955}
{"timesteps_since_restore": 8207592, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41562, "date": "2019-05-07_11-13-37", "episode_reward_min": 49.87048963296559, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f8d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 199, "episode_reward_mean": 1019.8590262060302, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 199, "custom_metrics": {"outflow_rate_max": 1449.278736863137, "cost2_mean": -18.672096753120776, "cost1_mean": 352.38595726683064, "system_level_velocity_mean": 13.913254282815869, "cost2_min": -26.300121823396427, "cost1_max": 460.9395223157406, "cost1_min": 28.350039677884393, "cost2_max": -7.116587997853192, "outflow_rate_mean": 1176.6888745868919, "system_level_velocity_min": 11.281667165327296, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.117935207839576}, "info": {"num_steps_trained": 8207592, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014761660248041153, "total_loss": 12.19957447052002, "vf_loss": 12.202764511108398, "policy_loss": -0.0065111760050058365, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9445316791534424, "entropy": 1.0132160186767578}, "load_time_ms": 7.083, "grad_time_ms": 9479.101, "update_time_ms": 7.575, "num_steps_sampled": 8207592, "sample_time_ms": 15108.778}, "episode_len_mean": 685.39, "time_this_iter_s": 24.425476789474487, "num_metric_batches_dropped": 0, "timesteps_total": 8207592, "hostname": "flow-main", "episodes_total": 3336, "timestamp": 1557227617, "episode_reward_max": 1191.1521721387478, "episodes_this_iter": 15, "time_total_s": 5009.40028834343, "time_since_restore": 5009.40028834343}
{"timesteps_since_restore": 8248857, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41265, "date": "2019-05-07_11-14-03", "episode_reward_min": 49.87048963296559, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3eb8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 200, "episode_reward_mean": 1023.6895459302744, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 200, "custom_metrics": {"outflow_rate_max": 1449.278736863137, "cost2_mean": -18.59430388972397, "cost1_mean": 352.7402384022787, "system_level_velocity_mean": 13.83416550019481, "cost2_min": -25.70048411516354, "cost1_max": 460.9395223157406, "cost1_min": 28.350039677884393, "cost2_max": -7.116587997853192, "outflow_rate_mean": 1176.003350921175, "system_level_velocity_min": 11.281667165327296, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.117935207839576}, "info": {"num_steps_trained": 8248857, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013098061084747314, "total_loss": 9.543185234069824, "vf_loss": 9.545173645019531, "policy_loss": -0.0049348012544214725, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9553073644638062, "entropy": 0.970662534236908}, "load_time_ms": 7.13, "grad_time_ms": 9427.418, "update_time_ms": 7.445, "num_steps_sampled": 8248857, "sample_time_ms": 15164.744}, "episode_len_mean": 689.15, "time_this_iter_s": 25.040051698684692, "num_metric_batches_dropped": 0, "timesteps_total": 8248857, "hostname": "flow-main", "episodes_total": 3354, "timestamp": 1557227643, "episode_reward_max": 1191.1521721387478, "episodes_this_iter": 18, "time_total_s": 5034.440340042114, "time_since_restore": 5034.440340042114}
{"timesteps_since_restore": 8289902, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41045, "date": "2019-05-07_11-14-27", "episode_reward_min": 51.10799169914188, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3160>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 201, "episode_reward_mean": 1020.6552697837085, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 201, "custom_metrics": {"outflow_rate_max": 1449.278736863137, "cost2_mean": -18.286098879128936, "cost1_mean": 348.60921709515844, "system_level_velocity_mean": 13.645367078292445, "cost2_min": -25.70048411516354, "cost1_max": 460.9395223157406, "cost1_min": 27.35185513013467, "cost2_max": -6.230723423021302, "outflow_rate_mean": 1163.1594934399138, "system_level_velocity_min": 11.053615729451062, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.549529895431956}, "info": {"num_steps_trained": 8289902, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015338575467467308, "total_loss": 9.779684066772461, "vf_loss": 9.781755447387695, "policy_loss": -0.005522377789020538, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9556798934936523, "entropy": 0.960375189781189}, "load_time_ms": 6.933, "grad_time_ms": 9414.625, "update_time_ms": 7.469, "num_steps_sampled": 8289902, "sample_time_ms": 15163.889}, "episode_len_mean": 689.15, "time_this_iter_s": 24.651832818984985, "num_metric_batches_dropped": 0, "timesteps_total": 8289902, "hostname": "flow-main", "episodes_total": 3370, "timestamp": 1557227667, "episode_reward_max": 1191.1521721387478, "episodes_this_iter": 16, "time_total_s": 5059.092172861099, "time_since_restore": 5059.092172861099}
{"timesteps_since_restore": 8331012, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41110, "date": "2019-05-07_11-14-52", "episode_reward_min": 51.10799169914188, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc8f8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0d30>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 202, "episode_reward_mean": 1029.367493566191, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 202, "custom_metrics": {"outflow_rate_max": 1437.062620979021, "cost2_mean": -18.51720334913077, "cost1_mean": 347.56663393199443, "system_level_velocity_mean": 13.57159997210237, "cost2_min": -25.70048411516354, "cost1_max": 460.9395223157406, "cost1_min": 27.35185513013467, "cost2_max": -6.230723423021302, "outflow_rate_mean": 1163.143121975378, "system_level_velocity_min": 11.053615729451062, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.549529895431956}, "info": {"num_steps_trained": 8331012, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016796259209513664, "total_loss": 12.327715873718262, "vf_loss": 12.329646110534668, "policy_loss": -0.00570882111787796, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9402943849563599, "entropy": 0.9958499670028687}, "load_time_ms": 6.962, "grad_time_ms": 9360.883, "update_time_ms": 7.363, "num_steps_sampled": 8331012, "sample_time_ms": 15131.771}, "episode_len_mean": 689.15, "time_this_iter_s": 24.2919020652771, "num_metric_batches_dropped": 0, "timesteps_total": 8331012, "hostname": "flow-main", "episodes_total": 3387, "timestamp": 1557227692, "episode_reward_max": 1191.1521721387478, "episodes_this_iter": 17, "time_total_s": 5083.384074926376, "time_since_restore": 5083.384074926376}
{"timesteps_since_restore": 8372349, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41337, "date": "2019-05-07_11-15-16", "episode_reward_min": 51.10799169914188, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 203, "episode_reward_mean": 1027.2222751898278, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 203, "custom_metrics": {"outflow_rate_max": 1411.6934693306694, "cost2_mean": -18.344610342965957, "cost1_mean": 345.0456128997754, "system_level_velocity_mean": 13.556982909759249, "cost2_min": -24.43935703172013, "cost1_max": 424.49242314672534, "cost1_min": 27.35185513013467, "cost2_max": -6.230723423021302, "outflow_rate_mean": 1154.775929643739, "system_level_velocity_min": 11.053615729451062, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.549529895431956}, "info": {"num_steps_trained": 8372349, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015357925556600094, "total_loss": 12.963383674621582, "vf_loss": 12.967860221862793, "policy_loss": -0.007931963540613651, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9433701634407043, "entropy": 1.0068516731262207}, "load_time_ms": 7.314, "grad_time_ms": 9351.362, "update_time_ms": 7.185, "num_steps_sampled": 8372349, "sample_time_ms": 15038.431}, "episode_len_mean": 685.6, "time_this_iter_s": 24.137539386749268, "num_metric_batches_dropped": 0, "timesteps_total": 8372349, "hostname": "flow-main", "episodes_total": 3402, "timestamp": 1557227716, "episode_reward_max": 1177.763879580213, "episodes_this_iter": 15, "time_total_s": 5107.521614313126, "time_since_restore": 5107.521614313126}
{"timesteps_since_restore": 8413680, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41331, "date": "2019-05-07_11-15-40", "episode_reward_min": 51.10799169914188, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca39b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3780>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 204, "episode_reward_mean": 1023.0599739181575, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 204, "custom_metrics": {"outflow_rate_max": 1411.6934693306694, "cost2_mean": -18.523119062109785, "cost1_mean": 344.2548630805388, "system_level_velocity_mean": 13.528266625894638, "cost2_min": -26.366084561789897, "cost1_max": 420.327222191598, "cost1_min": 27.35185513013467, "cost2_max": -6.230723423021302, "outflow_rate_mean": 1157.9149813040783, "system_level_velocity_min": 10.111271971691691, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.549529895431956}, "info": {"num_steps_trained": 8413680, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016454016789793968, "total_loss": 10.58297348022461, "vf_loss": 10.585041046142578, "policy_loss": -0.005769628565758467, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9543793201446533, "entropy": 0.977828860282898}, "load_time_ms": 7.021, "grad_time_ms": 9372.861, "update_time_ms": 7.118, "num_steps_sampled": 8413680, "sample_time_ms": 15026.1}, "episode_len_mean": 685.6, "time_this_iter_s": 24.742292165756226, "num_metric_batches_dropped": 0, "timesteps_total": 8413680, "hostname": "flow-main", "episodes_total": 3418, "timestamp": 1557227740, "episode_reward_max": 1177.763879580213, "episodes_this_iter": 16, "time_total_s": 5132.263906478882, "time_since_restore": 5132.263906478882}
{"timesteps_since_restore": 8455377, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41697, "date": "2019-05-07_11-16-05", "episode_reward_min": 51.10799169914188, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3e48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 205, "episode_reward_mean": 1024.4729117473553, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 205, "custom_metrics": {"outflow_rate_max": 1396.6945934065934, "cost2_mean": -18.37060869463465, "cost1_mean": 343.3799081050927, "system_level_velocity_mean": 13.60204724014072, "cost2_min": -26.366084561789897, "cost1_max": 417.4288013576363, "cost1_min": 27.35185513013467, "cost2_max": -6.230723423021302, "outflow_rate_mean": 1155.5485335345081, "system_level_velocity_min": 10.111271971691691, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.549529895431956}, "info": {"num_steps_trained": 8455377, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01843409053981304, "total_loss": 14.035164833068848, "vf_loss": 14.03790283203125, "policy_loss": -0.006884674541652203, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9384453892707825, "entropy": 1.0107884407043457}, "load_time_ms": 6.905, "grad_time_ms": 9374.799, "update_time_ms": 7.237, "num_steps_sampled": 8455377, "sample_time_ms": 15019.941}, "episode_len_mean": 680.75, "time_this_iter_s": 24.11418914794922, "num_metric_batches_dropped": 0, "timesteps_total": 8455377, "hostname": "flow-main", "episodes_total": 3435, "timestamp": 1557227765, "episode_reward_max": 1247.1116363530757, "episodes_this_iter": 17, "time_total_s": 5156.378095626831, "time_since_restore": 5156.378095626831}
{"timesteps_since_restore": 8497118, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41741, "date": "2019-05-07_11-16-29", "episode_reward_min": 51.10799169914188, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb02b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0c50>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 206, "episode_reward_mean": 1026.400994339521, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 206, "custom_metrics": {"outflow_rate_max": 1430.429633966034, "cost2_mean": -18.20479896066904, "cost1_mean": 343.023387051347, "system_level_velocity_mean": 13.568980321405595, "cost2_min": -26.366084561789897, "cost1_max": 418.93493545804967, "cost1_min": 27.35185513013467, "cost2_max": -6.230723423021302, "outflow_rate_mean": 1158.5050891349078, "system_level_velocity_min": 10.111271971691691, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 18.549529895431956}, "info": {"num_steps_trained": 8497118, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014876004308462143, "total_loss": 10.309569358825684, "vf_loss": 10.313271522521973, "policy_loss": -0.007049158215522766, "cur_kl_coeff": 0.2250000238418579, "vf_explained_var": 0.9553074836730957, "entropy": 0.9974322319030762}, "load_time_ms": 6.877, "grad_time_ms": 9361.535, "update_time_ms": 7.299, "num_steps_sampled": 8497118, "sample_time_ms": 15130.841}, "episode_len_mean": 680.75, "time_this_iter_s": 24.46310544013977, "num_metric_batches_dropped": 0, "timesteps_total": 8497118, "hostname": "flow-main", "episodes_total": 3452, "timestamp": 1557227789, "episode_reward_max": 1247.1116363530757, "episodes_this_iter": 17, "time_total_s": 5180.841201066971, "time_since_restore": 5180.841201066971}
{"timesteps_since_restore": 8539836, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42718, "date": "2019-05-07_11-16-54", "episode_reward_min": 263.28980393185896, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7748>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 207, "episode_reward_mean": 1033.7275398582362, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 207, "custom_metrics": {"outflow_rate_max": 1430.429633966034, "cost2_mean": -18.396158319369682, "cost1_mean": 346.5266399546944, "system_level_velocity_mean": 13.667300748587294, "cost2_min": -26.366084561789897, "cost1_max": 418.93493545804967, "cost1_min": 100.37966690909026, "cost2_max": -10.22097989914637, "outflow_rate_mean": 1165.244214873101, "system_level_velocity_min": 10.111271971691691, "outflow_rate_min": 566.2359230730409, "system_level_velocity_max": 17.774038789507998}, "info": {"num_steps_trained": 8539836, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016439927741885185, "total_loss": 9.697933197021484, "vf_loss": 9.700809478759766, "policy_loss": -0.006575183477252722, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9554733037948608, "entropy": 0.9797833561897278}, "load_time_ms": 6.837, "grad_time_ms": 9351.862, "update_time_ms": 7.161, "num_steps_sampled": 8539836, "sample_time_ms": 15211.252}, "episode_len_mean": 681.91, "time_this_iter_s": 25.138411045074463, "num_metric_batches_dropped": 0, "timesteps_total": 8539836, "hostname": "flow-main", "episodes_total": 3468, "timestamp": 1557227814, "episode_reward_max": 1247.1116363530757, "episodes_this_iter": 16, "time_total_s": 5205.979612112045, "time_since_restore": 5205.979612112045}
{"timesteps_since_restore": 8580917, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41081, "date": "2019-05-07_11-17-19", "episode_reward_min": 263.28980393185896, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb79e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 208, "episode_reward_mean": 1023.4625393280813, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 208, "custom_metrics": {"outflow_rate_max": 1430.429633966034, "cost2_mean": -18.63239438906618, "cost1_mean": 343.93281581943353, "system_level_velocity_mean": 13.576307372932604, "cost2_min": -26.366084561789897, "cost1_max": 418.93493545804967, "cost1_min": 100.37966690909026, "cost2_max": -10.22097989914637, "outflow_rate_mean": 1156.7110824495246, "system_level_velocity_min": 10.111271971691691, "outflow_rate_min": 566.2359230730409, "system_level_velocity_max": 17.774038789507998}, "info": {"num_steps_trained": 8580917, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016290333122015, "total_loss": 8.338678359985352, "vf_loss": 8.342692375183105, "policy_loss": -0.00767985126003623, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9669502377510071, "entropy": 0.9919757843017578}, "load_time_ms": 6.859, "grad_time_ms": 9312.584, "update_time_ms": 7.044, "num_steps_sampled": 8580917, "sample_time_ms": 15163.661}, "episode_len_mean": 681.91, "time_this_iter_s": 24.706864833831787, "num_metric_batches_dropped": 0, "timesteps_total": 8580917, "hostname": "flow-main", "episodes_total": 3484, "timestamp": 1557227839, "episode_reward_max": 1247.1116363530757, "episodes_this_iter": 16, "time_total_s": 5230.686476945877, "time_since_restore": 5230.686476945877}
{"timesteps_since_restore": 8622880, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41963, "date": "2019-05-07_11-17-45", "episode_reward_min": 263.87731119452025, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb828>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 209, "episode_reward_mean": 1037.081929810954, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 209, "custom_metrics": {"outflow_rate_max": 1430.429633966034, "cost2_mean": -18.61504713838035, "cost1_mean": 349.3108020187308, "system_level_velocity_mean": 13.575598092099412, "cost2_min": -26.366084561789897, "cost1_max": 418.93493545804967, "cost1_min": 102.53313960535782, "cost2_max": -10.22097989914637, "outflow_rate_mean": 1170.0536358924649, "system_level_velocity_min": 10.111271971691691, "outflow_rate_min": 575.7086531166066, "system_level_velocity_max": 17.774038789507998}, "info": {"num_steps_trained": 8622880, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01763095334172249, "total_loss": 10.24498462677002, "vf_loss": 10.246779441833496, "policy_loss": -0.005762222222983837, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9561251401901245, "entropy": 0.9812484979629517}, "load_time_ms": 6.884, "grad_time_ms": 9371.121, "update_time_ms": 6.914, "num_steps_sampled": 8622880, "sample_time_ms": 15235.315}, "episode_len_mean": 689.74, "time_this_iter_s": 25.745166778564453, "num_metric_batches_dropped": 0, "timesteps_total": 8622880, "hostname": "flow-main", "episodes_total": 3500, "timestamp": 1557227865, "episode_reward_max": 1247.1116363530757, "episodes_this_iter": 16, "time_total_s": 5256.4316437244415, "time_since_restore": 5256.4316437244415}
{"timesteps_since_restore": 8663600, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40720, "date": "2019-05-07_11-18-10", "episode_reward_min": 148.43046253492741, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb70f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 210, "episode_reward_mean": 1035.761486484405, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 210, "custom_metrics": {"outflow_rate_max": 1430.429633966034, "cost2_mean": -18.249554813800923, "cost1_mean": 348.0168054263824, "system_level_velocity_mean": 13.677483775548534, "cost2_min": -25.737818733122644, "cost1_max": 424.7507157557325, "cost1_min": 69.05811949287742, "cost2_max": -10.22097989914637, "outflow_rate_mean": 1166.129851391746, "system_level_velocity_min": 10.111271971691691, "outflow_rate_min": 447.5986332447785, "system_level_velocity_max": 18.150800394191194}, "info": {"num_steps_trained": 8663600, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015409191139042377, "total_loss": 13.946313858032227, "vf_loss": 13.949596405029297, "policy_loss": -0.0067502884194254875, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9444018006324768, "entropy": 0.998436689376831}, "load_time_ms": 6.894, "grad_time_ms": 9519.186, "update_time_ms": 7.036, "num_steps_sampled": 8663600, "sample_time_ms": 15123.491}, "episode_len_mean": 683.79, "time_this_iter_s": 25.41038680076599, "num_metric_batches_dropped": 0, "timesteps_total": 8663600, "hostname": "flow-main", "episodes_total": 3516, "timestamp": 1557227890, "episode_reward_max": 1247.1116363530757, "episodes_this_iter": 16, "time_total_s": 5281.8420305252075, "time_since_restore": 5281.8420305252075}
{"timesteps_since_restore": 8704547, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40947, "date": "2019-05-07_11-18-35", "episode_reward_min": 148.43046253492741, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb31d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3940>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 211, "episode_reward_mean": 1048.5544309078114, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 211, "custom_metrics": {"outflow_rate_max": 1430.429633966034, "cost2_mean": -18.503071044545987, "cost1_mean": 351.70879087752405, "system_level_velocity_mean": 13.686233885793815, "cost2_min": -26.921324053009187, "cost1_max": 424.7507157557325, "cost1_min": 69.05811949287742, "cost2_max": -10.22097989914637, "outflow_rate_mean": 1174.4041846638138, "system_level_velocity_min": 11.59984191724461, "outflow_rate_min": 447.5986332447785, "system_level_velocity_max": 18.150800394191194}, "info": {"num_steps_trained": 8704547, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017242688685655594, "total_loss": 10.734519958496094, "vf_loss": 10.738829612731934, "policy_loss": -0.008189196698367596, "cur_kl_coeff": 0.2250000238418579, "vf_explained_var": 0.956091046333313, "entropy": 0.9943826794624329}, "load_time_ms": 6.926, "grad_time_ms": 9522.722, "update_time_ms": 7.082, "num_steps_sampled": 8704547, "sample_time_ms": 15158.552}, "episode_len_mean": 688.64, "time_this_iter_s": 25.046274423599243, "num_metric_batches_dropped": 0, "timesteps_total": 8704547, "hostname": "flow-main", "episodes_total": 3534, "timestamp": 1557227915, "episode_reward_max": 1232.927653299343, "episodes_this_iter": 18, "time_total_s": 5306.888304948807, "time_since_restore": 5306.888304948807}
{"timesteps_since_restore": 8747149, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42602, "date": "2019-05-07_11-19-01", "episode_reward_min": 148.43046253492741, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb1d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 212, "episode_reward_mean": 1033.3617764187593, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 212, "custom_metrics": {"outflow_rate_max": 1397.998274125874, "cost2_mean": -18.573874797925317, "cost1_mean": 347.7799574862675, "system_level_velocity_mean": 13.835747240120602, "cost2_min": -26.921324053009187, "cost1_max": 424.7507157557325, "cost1_min": 69.05811949287742, "cost2_max": -10.275659120303837, "outflow_rate_mean": 1164.1150075249504, "system_level_velocity_min": 11.865508576193346, "outflow_rate_min": 439.91420676432364, "system_level_velocity_max": 18.150800394191194}, "info": {"num_steps_trained": 8747149, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01595589891076088, "total_loss": 12.522456169128418, "vf_loss": 12.525662422180176, "policy_loss": -0.006796882953494787, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9481930136680603, "entropy": 0.9631001949310303}, "load_time_ms": 6.883, "grad_time_ms": 9487.729, "update_time_ms": 7.19, "num_steps_sampled": 8747149, "sample_time_ms": 15288.708}, "episode_len_mean": 677.07, "time_this_iter_s": 25.261038780212402, "num_metric_batches_dropped": 0, "timesteps_total": 8747149, "hostname": "flow-main", "episodes_total": 3552, "timestamp": 1557227941, "episode_reward_max": 1232.927653299343, "episodes_this_iter": 18, "time_total_s": 5332.149343729019, "time_since_restore": 5332.149343729019}
{"timesteps_since_restore": 8788358, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41209, "date": "2019-05-07_11-19-25", "episode_reward_min": 54.829648506029415, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 213, "episode_reward_mean": 1018.6698290364537, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 213, "custom_metrics": {"outflow_rate_max": 1397.998274125874, "cost2_mean": -18.401769889590152, "cost1_mean": 343.04727977587265, "system_level_velocity_mean": 13.926163034835206, "cost2_min": -26.921324053009187, "cost1_max": 424.7507157557325, "cost1_min": 28.452049226664613, "cost2_max": -3.457416578833048, "outflow_rate_mean": 1152.7596057393994, "system_level_velocity_min": 11.798606642595587, "outflow_rate_min": 322.48354194410126, "system_level_velocity_max": 18.355278329350213}, "info": {"num_steps_trained": 8788358, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01722651533782482, "total_loss": 11.633244514465332, "vf_loss": 11.635602951049805, "policy_loss": -0.006234458647668362, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9516293406486511, "entropy": 0.9918724298477173}, "load_time_ms": 6.986, "grad_time_ms": 9341.279, "update_time_ms": 7.465, "num_steps_sampled": 8788358, "sample_time_ms": 15468.074}, "episode_len_mean": 666.32, "time_this_iter_s": 24.4775390625, "num_metric_batches_dropped": 0, "timesteps_total": 8788358, "hostname": "flow-main", "episodes_total": 3569, "timestamp": 1557227965, "episode_reward_max": 1232.927653299343, "episodes_this_iter": 17, "time_total_s": 5356.626882791519, "time_since_restore": 5356.626882791519}
{"timesteps_since_restore": 8830127, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41769, "date": "2019-05-07_11-19-50", "episode_reward_min": 54.829648506029415, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb9e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 214, "episode_reward_mean": 1033.130043135781, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 214, "custom_metrics": {"outflow_rate_max": 1403.740145054945, "cost2_mean": -18.26567732119854, "cost1_mean": 345.1433300458164, "system_level_velocity_mean": 13.99832643880201, "cost2_min": -26.921324053009187, "cost1_max": 424.7507157557325, "cost1_min": 28.452049226664613, "cost2_max": -3.457416578833048, "outflow_rate_mean": 1162.3678838373014, "system_level_velocity_min": 11.65098085050874, "outflow_rate_min": 322.48354194410126, "system_level_velocity_max": 18.355278329350213}, "info": {"num_steps_trained": 8830127, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01876956596970558, "total_loss": 11.008050918579102, "vf_loss": 11.012558937072754, "policy_loss": -0.0087302066385746, "cur_kl_coeff": 0.2250000238418579, "vf_explained_var": 0.9509300589561462, "entropy": 0.9865149855613708}, "load_time_ms": 7.297, "grad_time_ms": 9129.052, "update_time_ms": 7.807, "num_steps_sampled": 8830127, "sample_time_ms": 15704.528}, "episode_len_mean": 666.32, "time_this_iter_s": 25.013944149017334, "num_metric_batches_dropped": 0, "timesteps_total": 8830127, "hostname": "flow-main", "episodes_total": 3586, "timestamp": 1557227990, "episode_reward_max": 1232.927653299343, "episodes_this_iter": 17, "time_total_s": 5381.6408269405365, "time_since_restore": 5381.6408269405365}
{"timesteps_since_restore": 8871391, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41264, "date": "2019-05-07_11-20-14", "episode_reward_min": 54.829648506029415, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc917f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc915f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 215, "episode_reward_mean": 1026.2875589736668, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 215, "custom_metrics": {"outflow_rate_max": 1408.685699100899, "cost2_mean": -18.43305204862112, "cost1_mean": 344.22323591966784, "system_level_velocity_mean": 14.061803825460183, "cost2_min": -26.921324053009187, "cost1_max": 424.7507157557325, "cost1_min": 28.452049226664613, "cost2_max": -3.457416578833048, "outflow_rate_mean": 1162.0038379445018, "system_level_velocity_min": 11.65098085050874, "outflow_rate_min": 322.48354194410126, "system_level_velocity_max": 18.355278329350213}, "info": {"num_steps_trained": 8871391, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01464091893285513, "total_loss": 8.907646179199219, "vf_loss": 8.909893035888672, "policy_loss": -0.005541284568607807, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9624698162078857, "entropy": 0.9563238620758057}, "load_time_ms": 7.397, "grad_time_ms": 8937.439, "update_time_ms": 7.905, "num_steps_sampled": 8871391, "sample_time_ms": 15883.52}, "episode_len_mean": 662.47, "time_this_iter_s": 24.003281593322754, "num_metric_batches_dropped": 0, "timesteps_total": 8871391, "hostname": "flow-main", "episodes_total": 3599, "timestamp": 1557228014, "episode_reward_max": 1215.6642869869845, "episodes_this_iter": 13, "time_total_s": 5405.644108533859, "time_since_restore": 5405.644108533859}
{"timesteps_since_restore": 8912937, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41546, "date": "2019-05-07_11-20-39", "episode_reward_min": 54.829648506029415, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc910b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc914a8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 216, "episode_reward_mean": 1036.0808645613026, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 216, "custom_metrics": {"outflow_rate_max": 1408.685699100899, "cost2_mean": -18.81446792327245, "cost1_mean": 346.6228471723243, "system_level_velocity_mean": 13.989604395228353, "cost2_min": -26.921324053009187, "cost1_max": 415.69240165239216, "cost1_min": 28.452049226664613, "cost2_max": -3.457416578833048, "outflow_rate_mean": 1167.530933322344, "system_level_velocity_min": 11.440514580673828, "outflow_rate_min": 322.48354194410126, "system_level_velocity_max": 18.355278329350213}, "info": {"num_steps_trained": 8912937, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015652567148208618, "total_loss": 8.261404991149902, "vf_loss": 8.265170097351074, "policy_loss": -0.007285695057362318, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9675083756446838, "entropy": 0.9587416648864746}, "load_time_ms": 7.358, "grad_time_ms": 8769.394, "update_time_ms": 8.005, "num_steps_sampled": 8912937, "sample_time_ms": 16037.682}, "episode_len_mean": 668.42, "time_this_iter_s": 24.312797784805298, "num_metric_batches_dropped": 0, "timesteps_total": 8912937, "hostname": "flow-main", "episodes_total": 3618, "timestamp": 1557228039, "episode_reward_max": 1215.6642869869845, "episodes_this_iter": 19, "time_total_s": 5429.956906318665, "time_since_restore": 5429.956906318665}
{"timesteps_since_restore": 8954368, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41431, "date": "2019-05-07_11-21-03", "episode_reward_min": 54.829648506029415, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca39e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb048>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 217, "episode_reward_mean": 1028.8772334236426, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 217, "custom_metrics": {"outflow_rate_max": 1438.5306673326672, "cost2_mean": -18.4606868798708, "cost1_mean": 344.30096904092386, "system_level_velocity_mean": 13.91160415590808, "cost2_min": -24.11989843527003, "cost1_max": 416.9499476573353, "cost1_min": 28.452049226664613, "cost2_max": -3.457416578833048, "outflow_rate_mean": 1159.6942641714945, "system_level_velocity_min": 11.315548696458952, "outflow_rate_min": 322.48354194410126, "system_level_velocity_max": 18.355278329350213}, "info": {"num_steps_trained": 8954368, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015325658023357391, "total_loss": 8.84056282043457, "vf_loss": 8.843786239624023, "policy_loss": -0.006671861745417118, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9627668261528015, "entropy": 0.9443973302841187}, "load_time_ms": 7.385, "grad_time_ms": 8621.313, "update_time_ms": 7.925, "num_steps_sampled": 8954368, "sample_time_ms": 16121.514}, "episode_len_mean": 668.42, "time_this_iter_s": 24.4836368560791, "num_metric_batches_dropped": 0, "timesteps_total": 8954368, "hostname": "flow-main", "episodes_total": 3633, "timestamp": 1557228063, "episode_reward_max": 1202.7711618067112, "episodes_this_iter": 15, "time_total_s": 5454.440543174744, "time_since_restore": 5454.440543174744}
{"timesteps_since_restore": 8995911, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41543, "date": "2019-05-07_11-21-28", "episode_reward_min": 54.829648506029415, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6fd0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 218, "episode_reward_mean": 1039.8885552711984, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 218, "custom_metrics": {"outflow_rate_max": 1438.5306673326672, "cost2_mean": -18.471686332680314, "cost1_mean": 347.1128001588004, "system_level_velocity_mean": 13.867828700984441, "cost2_min": -24.11989843527003, "cost1_max": 416.9499476573353, "cost1_min": 28.452049226664613, "cost2_max": -3.457416578833048, "outflow_rate_mean": 1167.646503932923, "system_level_velocity_min": 11.315548696458952, "outflow_rate_min": 322.48354194410126, "system_level_velocity_max": 18.355278329350213}, "info": {"num_steps_trained": 8995911, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016619686037302017, "total_loss": 10.910890579223633, "vf_loss": 10.91419792175293, "policy_loss": -0.007046827580779791, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9510574340820312, "entropy": 0.9705967903137207}, "load_time_ms": 7.293, "grad_time_ms": 8567.468, "update_time_ms": 7.767, "num_steps_sampled": 8995911, "sample_time_ms": 16209.624}, "episode_len_mean": 674.42, "time_this_iter_s": 25.037583112716675, "num_metric_batches_dropped": 0, "timesteps_total": 8995911, "hostname": "flow-main", "episodes_total": 3650, "timestamp": 1557228088, "episode_reward_max": 1202.7711618067112, "episodes_this_iter": 17, "time_total_s": 5479.47812628746, "time_since_restore": 5479.47812628746}
{"timesteps_since_restore": 9036985, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41074, "date": "2019-05-07_11-21-52", "episode_reward_min": 239.40104839353282, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 219, "episode_reward_mean": 1067.704578872072, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 219, "custom_metrics": {"outflow_rate_max": 1438.5306673326672, "cost2_mean": -19.12105388642786, "cost1_mean": 355.617328452363, "system_level_velocity_mean": 13.775648147814715, "cost2_min": -25.103974019895585, "cost1_max": 416.9499476573353, "cost1_min": 93.78080896171991, "cost2_max": -9.158986922649559, "outflow_rate_mean": 1192.3532833471486, "system_level_velocity_min": 11.315548696458952, "outflow_rate_min": 533.2648660527304, "system_level_velocity_max": 18.098875263059707}, "info": {"num_steps_trained": 9036985, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01633838191628456, "total_loss": 10.466959953308105, "vf_loss": 10.471358299255371, "policy_loss": -0.008075360208749771, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9519983530044556, "entropy": 0.9844685792922974}, "load_time_ms": 7.226, "grad_time_ms": 8460.539, "update_time_ms": 7.677, "num_steps_sampled": 9036985, "sample_time_ms": 16166.518}, "episode_len_mean": 690.58, "time_this_iter_s": 24.214505910873413, "num_metric_batches_dropped": 0, "timesteps_total": 9036985, "hostname": "flow-main", "episodes_total": 3666, "timestamp": 1557228112, "episode_reward_max": 1202.7711618067112, "episodes_this_iter": 16, "time_total_s": 5503.692632198334, "time_since_restore": 5503.692632198334}
{"timesteps_since_restore": 9078175, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41190, "date": "2019-05-07_11-22-17", "episode_reward_min": 239.40104839353282, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc914a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91c18>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 220, "episode_reward_mean": 1053.5374276497878, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 220, "custom_metrics": {"outflow_rate_max": 1438.5306673326672, "cost2_mean": -19.387318723981878, "cost1_mean": 352.6856387012145, "system_level_velocity_mean": 13.777922753845788, "cost2_min": -25.113898821488345, "cost1_max": 416.9499476573353, "cost1_min": 93.78080896171991, "cost2_max": -9.158986922649559, "outflow_rate_mean": 1184.4604658514845, "system_level_velocity_min": 11.315548696458952, "outflow_rate_min": 533.2648660527304, "system_level_velocity_max": 18.098875263059707}, "info": {"num_steps_trained": 9078175, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014620029367506504, "total_loss": 11.132434844970703, "vf_loss": 11.13706111907959, "policy_loss": -0.007915999740362167, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.957801342010498, "entropy": 1.0039817094802856}, "load_time_ms": 7.363, "grad_time_ms": 8358.503, "update_time_ms": 7.719, "num_steps_sampled": 9078175, "sample_time_ms": 16163.541}, "episode_len_mean": 686.34, "time_this_iter_s": 24.350452184677124, "num_metric_batches_dropped": 0, "timesteps_total": 9078175, "hostname": "flow-main", "episodes_total": 3682, "timestamp": 1557228137, "episode_reward_max": 1202.7711618067112, "episodes_this_iter": 16, "time_total_s": 5528.043084383011, "time_since_restore": 5528.043084383011}
{"timesteps_since_restore": 9120680, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42505, "date": "2019-05-07_11-22-41", "episode_reward_min": 239.40104839353282, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb79e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 221, "episode_reward_mean": 1058.0841998207484, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 221, "custom_metrics": {"outflow_rate_max": 1438.5306673326672, "cost2_mean": -19.374893410525587, "cost1_mean": 353.3012277548898, "system_level_velocity_mean": 13.724051831042257, "cost2_min": -27.15489768739482, "cost1_max": 416.9499476573353, "cost1_min": 93.78080896171991, "cost2_max": -9.158986922649559, "outflow_rate_mean": 1181.8511142497782, "system_level_velocity_min": 11.315548696458952, "outflow_rate_min": 533.2648660527304, "system_level_velocity_max": 18.098875263059707}, "info": {"num_steps_trained": 9120680, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014501231722533703, "total_loss": 8.24903678894043, "vf_loss": 8.252530097961426, "policy_loss": -0.006757160183042288, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9634135365486145, "entropy": 0.9792822599411011}, "load_time_ms": 7.453, "grad_time_ms": 8384.524, "update_time_ms": 7.692, "num_steps_sampled": 9120680, "sample_time_ms": 16079.161}, "episode_len_mean": 690.19, "time_this_iter_s": 24.466027975082397, "num_metric_batches_dropped": 0, "timesteps_total": 9120680, "hostname": "flow-main", "episodes_total": 3699, "timestamp": 1557228161, "episode_reward_max": 1202.7711618067112, "episodes_this_iter": 17, "time_total_s": 5552.509112358093, "time_since_restore": 5552.509112358093}
{"timesteps_since_restore": 9162551, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41871, "date": "2019-05-07_11-23-06", "episode_reward_min": 57.08593720691266, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca39e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 222, "episode_reward_mean": 1042.9508435842563, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 222, "custom_metrics": {"outflow_rate_max": 1438.5306673326672, "cost2_mean": -19.15466481988362, "cost1_mean": 348.59700003950735, "system_level_velocity_mean": 13.723829938569121, "cost2_min": -27.15489768739482, "cost1_max": 416.9499476573353, "cost1_min": 33.336919110862304, "cost2_max": -9.158986922649559, "outflow_rate_mean": 1167.1868873461206, "system_level_velocity_min": 11.295513665133223, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.595333622214437}, "info": {"num_steps_trained": 9162551, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015970103442668915, "total_loss": 10.648824691772461, "vf_loss": 10.652143478393555, "policy_loss": -0.006912257056683302, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9534102082252502, "entropy": 0.9594894647598267}, "load_time_ms": 7.589, "grad_time_ms": 8365.083, "update_time_ms": 7.596, "num_steps_sampled": 9162551, "sample_time_ms": 16100.023}, "episode_len_mean": 683.69, "time_this_iter_s": 25.261663675308228, "num_metric_batches_dropped": 0, "timesteps_total": 9162551, "hostname": "flow-main", "episodes_total": 3715, "timestamp": 1557228186, "episode_reward_max": 1197.7673098207645, "episodes_this_iter": 16, "time_total_s": 5577.7707760334015, "time_since_restore": 5577.7707760334015}
{"timesteps_since_restore": 9204106, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41555, "date": "2019-05-07_11-23-32", "episode_reward_min": 57.08593720691266, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91be0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 223, "episode_reward_mean": 1029.0697865432653, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 223, "custom_metrics": {"outflow_rate_max": 1420.4832227772226, "cost2_mean": -19.037197556326593, "cost1_mean": 343.66341253623204, "system_level_velocity_mean": 13.697730168673397, "cost2_min": -27.15489768739482, "cost1_max": 419.0411319463963, "cost1_min": 33.336919110862304, "cost2_max": -9.158986922649559, "outflow_rate_mean": 1155.650220932736, "system_level_velocity_min": 11.295513665133223, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.595333622214437}, "info": {"num_steps_trained": 9204106, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01739991456270218, "total_loss": 12.52560043334961, "vf_loss": 12.529180526733398, "policy_loss": -0.007494669407606125, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9444703459739685, "entropy": 0.9881502985954285}, "load_time_ms": 7.624, "grad_time_ms": 8456.802, "update_time_ms": 7.347, "num_steps_sampled": 9204106, "sample_time_ms": 16080.187}, "episode_len_mean": 677.37, "time_this_iter_s": 25.187929391860962, "num_metric_batches_dropped": 0, "timesteps_total": 9204106, "hostname": "flow-main", "episodes_total": 3731, "timestamp": 1557228212, "episode_reward_max": 1197.7673098207645, "episodes_this_iter": 16, "time_total_s": 5602.958705425262, "time_since_restore": 5602.958705425262}
{"timesteps_since_restore": 9244838, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40732, "date": "2019-05-07_11-23-56", "episode_reward_min": 57.08593720691266, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc912b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 224, "episode_reward_mean": 1018.9223544882989, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 224, "custom_metrics": {"outflow_rate_max": 1369.836035964036, "cost2_mean": -19.098100711763628, "cost1_mean": 341.2131669500334, "system_level_velocity_mean": 13.74870265669562, "cost2_min": -27.15489768739482, "cost1_max": 419.0411319463963, "cost1_min": 32.70191531474455, "cost2_max": -7.6299842310437285, "outflow_rate_mean": 1148.6249201111007, "system_level_velocity_min": 11.295513665133223, "outflow_rate_min": 329.8655169108091, "system_level_velocity_max": 18.595333622214437}, "info": {"num_steps_trained": 9244838, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016034267842769623, "total_loss": 15.08242416381836, "vf_loss": 15.085683822631836, "policy_loss": -0.00686841644346714, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9399670362472534, "entropy": 1.003342866897583}, "load_time_ms": 7.674, "grad_time_ms": 8547.489, "update_time_ms": 7.115, "num_steps_sampled": 9244838, "sample_time_ms": 15925.97}, "episode_len_mean": 671.51, "time_this_iter_s": 24.341139316558838, "num_metric_batches_dropped": 0, "timesteps_total": 9244838, "hostname": "flow-main", "episodes_total": 3750, "timestamp": 1557228236, "episode_reward_max": 1197.7673098207645, "episodes_this_iter": 19, "time_total_s": 5627.299844741821, "time_since_restore": 5627.299844741821}
{"timesteps_since_restore": 9285271, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40433, "date": "2019-05-07_11-24-20", "episode_reward_min": 50.98406063569431, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 225, "episode_reward_mean": 1002.3085211496298, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 225, "custom_metrics": {"outflow_rate_max": 1422.5205838161837, "cost2_mean": -18.53012867638064, "cost1_mean": 338.84688425131316, "system_level_velocity_mean": 13.855778003720657, "cost2_min": -27.15489768739482, "cost1_max": 419.0411319463963, "cost1_min": 29.92704771415361, "cost2_max": -7.6299842310437285, "outflow_rate_mean": 1143.1209940210113, "system_level_velocity_min": 11.295513665133223, "outflow_rate_min": 329.8655169108091, "system_level_velocity_max": 18.997895301531546}, "info": {"num_steps_trained": 9285271, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016128379851579666, "total_loss": 15.54293155670166, "vf_loss": 15.547209739685059, "policy_loss": -0.007907785475254059, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9344300031661987, "entropy": 1.0308624505996704}, "load_time_ms": 7.536, "grad_time_ms": 8599.596, "update_time_ms": 6.81, "num_steps_sampled": 9285271, "sample_time_ms": 15855.045}, "episode_len_mean": 664.96, "time_this_iter_s": 23.790428638458252, "num_metric_batches_dropped": 0, "timesteps_total": 9285271, "hostname": "flow-main", "episodes_total": 3767, "timestamp": 1557228260, "episode_reward_max": 1197.7673098207645, "episodes_this_iter": 17, "time_total_s": 5651.0902733802795, "time_since_restore": 5651.0902733802795}
{"timesteps_since_restore": 9325465, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40194, "date": "2019-05-07_11-24-44", "episode_reward_min": 50.98406063569431, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb710>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 226, "episode_reward_mean": 1005.1876085163656, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 226, "custom_metrics": {"outflow_rate_max": 1422.5205838161837, "cost2_mean": -18.225632209527117, "cost1_mean": 340.0223358112588, "system_level_velocity_mean": 13.78414867273378, "cost2_min": -27.15489768739482, "cost1_max": 419.0411319463963, "cost1_min": 29.92704771415361, "cost2_max": -7.6299842310437285, "outflow_rate_mean": 1143.9199255466453, "system_level_velocity_min": 11.295513665133223, "outflow_rate_min": 329.8655169108091, "system_level_velocity_max": 18.997895301531546}, "info": {"num_steps_trained": 9325465, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016596823930740356, "total_loss": 14.588663101196289, "vf_loss": 14.592398643493652, "policy_loss": -0.007468547206372023, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9315424561500549, "entropy": 0.9895958304405212}, "load_time_ms": 7.539, "grad_time_ms": 8688.347, "update_time_ms": 6.587, "num_steps_sampled": 9325465, "sample_time_ms": 15733.999}, "episode_len_mean": 669.2, "time_this_iter_s": 23.994515895843506, "num_metric_batches_dropped": 0, "timesteps_total": 9325465, "hostname": "flow-main", "episodes_total": 3786, "timestamp": 1557228284, "episode_reward_max": 1197.7673098207645, "episodes_this_iter": 19, "time_total_s": 5675.084789276123, "time_since_restore": 5675.084789276123}
{"timesteps_since_restore": 9366909, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41444, "date": "2019-05-07_11-25-09", "episode_reward_min": 50.98406063569431, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 227, "episode_reward_mean": 997.3652037892185, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 227, "custom_metrics": {"outflow_rate_max": 1422.5205838161837, "cost2_mean": -18.127863152571784, "cost1_mean": 339.6791380480201, "system_level_velocity_mean": 13.754377380946575, "cost2_min": -26.13875230405824, "cost1_max": 419.0411319463963, "cost1_min": 29.92704771415361, "cost2_max": -7.6299842310437285, "outflow_rate_mean": 1144.5722039682237, "system_level_velocity_min": 11.295513665133223, "outflow_rate_min": 329.8655169108091, "system_level_velocity_max": 18.997895301531546}, "info": {"num_steps_trained": 9366909, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01543961837887764, "total_loss": 12.647790908813477, "vf_loss": 12.651103973388672, "policy_loss": -0.006786432582885027, "cur_kl_coeff": 0.22500000894069672, "vf_explained_var": 0.9358900189399719, "entropy": 1.0049731731414795}, "load_time_ms": 7.678, "grad_time_ms": 8790.683, "update_time_ms": 6.598, "num_steps_sampled": 9366909, "sample_time_ms": 15658.173}, "episode_len_mean": 669.2, "time_this_iter_s": 24.760329246520996, "num_metric_batches_dropped": 0, "timesteps_total": 9366909, "hostname": "flow-main", "episodes_total": 3801, "timestamp": 1557228309, "episode_reward_max": 1179.9971964083454, "episodes_this_iter": 15, "time_total_s": 5699.845118522644, "time_since_restore": 5699.845118522644}
{"timesteps_since_restore": 9408586, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41677, "date": "2019-05-07_11-25-33", "episode_reward_min": 50.98406063569431, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc914a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc95ac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 228, "episode_reward_mean": 1004.9385121870795, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 228, "custom_metrics": {"outflow_rate_max": 1422.5205838161837, "cost2_mean": -18.189247934057526, "cost1_mean": 342.4969807282958, "system_level_velocity_mean": 13.714771694390217, "cost2_min": -26.13875230405824, "cost1_max": 419.0411319463963, "cost1_min": 29.92704771415361, "cost2_max": -7.6299842310437285, "outflow_rate_mean": 1155.7373917669865, "system_level_velocity_min": 11.491799869414837, "outflow_rate_min": 329.8655169108091, "system_level_velocity_max": 18.997895301531546}, "info": {"num_steps_trained": 9408586, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0156417116522789, "total_loss": 11.262420654296875, "vf_loss": 11.265883445739746, "policy_loss": -0.006982330698519945, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9481837749481201, "entropy": 1.0224801301956177}, "load_time_ms": 7.706, "grad_time_ms": 8955.561, "update_time_ms": 6.659, "num_steps_sampled": 9408586, "sample_time_ms": 15462.036}, "episode_len_mean": 674.2, "time_this_iter_s": 24.72810983657837, "num_metric_batches_dropped": 0, "timesteps_total": 9408586, "hostname": "flow-main", "episodes_total": 3814, "timestamp": 1557228333, "episode_reward_max": 1179.9971964083454, "episodes_this_iter": 13, "time_total_s": 5724.573228359222, "time_since_restore": 5724.573228359222}
{"timesteps_since_restore": 9450376, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41790, "date": "2019-05-07_11-25-58", "episode_reward_min": 50.98406063569431, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ceb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c358>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 229, "episode_reward_mean": 997.8980621381609, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 229, "custom_metrics": {"outflow_rate_max": 1422.5205838161837, "cost2_mean": -17.8103360815382, "cost1_mean": 339.94876929257424, "system_level_velocity_mean": 13.710811429583785, "cost2_min": -26.13875230405824, "cost1_max": 416.63047228752725, "cost1_min": 29.92704771415361, "cost2_max": -6.167474455872416, "outflow_rate_mean": 1146.7621354180703, "system_level_velocity_min": 11.491799869414837, "outflow_rate_min": 329.8655169108091, "system_level_velocity_max": 18.997895301531546}, "info": {"num_steps_trained": 9450376, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017380354925990105, "total_loss": 16.212182998657227, "vf_loss": 16.21563148498535, "policy_loss": -0.007359257433563471, "cur_kl_coeff": 0.2250000238418579, "vf_explained_var": 0.9263976216316223, "entropy": 1.0315241813659668}, "load_time_ms": 7.731, "grad_time_ms": 9117.33, "update_time_ms": 6.644, "num_steps_sampled": 9450376, "sample_time_ms": 15328.026}, "episode_len_mean": 670.73, "time_this_iter_s": 24.515642166137695, "num_metric_batches_dropped": 0, "timesteps_total": 9450376, "hostname": "flow-main", "episodes_total": 3833, "timestamp": 1557228358, "episode_reward_max": 1179.9971964083454, "episodes_this_iter": 19, "time_total_s": 5749.08887052536, "time_since_restore": 5749.08887052536}
{"timesteps_since_restore": 9490368, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 39992, "date": "2019-05-07_11-26-22", "episode_reward_min": 50.98406063569431, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f98>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 230, "episode_reward_mean": 992.9229873651306, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 230, "custom_metrics": {"outflow_rate_max": 1422.5205838161837, "cost2_mean": -17.817359243262814, "cost1_mean": 339.0516066475709, "system_level_velocity_mean": 13.6778783513491, "cost2_min": -25.566749798825093, "cost1_max": 416.63047228752725, "cost1_min": 29.92704771415361, "cost2_max": -6.167474455872416, "outflow_rate_mean": 1143.2495584519318, "system_level_velocity_min": 11.491799869414837, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 18.997895301531546}, "info": {"num_steps_trained": 9490368, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016205204650759697, "total_loss": 14.958189010620117, "vf_loss": 14.959945678710938, "policy_loss": -0.005402649752795696, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9364978075027466, "entropy": 1.0413925647735596}, "load_time_ms": 7.685, "grad_time_ms": 9215.725, "update_time_ms": 6.604, "num_steps_sampled": 9490368, "sample_time_ms": 15150.293}, "episode_len_mean": 670.93, "time_this_iter_s": 23.561011791229248, "num_metric_batches_dropped": 0, "timesteps_total": 9490368, "hostname": "flow-main", "episodes_total": 3850, "timestamp": 1557228382, "episode_reward_max": 1179.9971964083454, "episodes_this_iter": 17, "time_total_s": 5772.649882316589, "time_since_restore": 5772.649882316589}
{"timesteps_since_restore": 9530978, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40610, "date": "2019-05-07_11-26-45", "episode_reward_min": 55.98535877244755, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c630>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 231, "episode_reward_mean": 991.8990557710842, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 231, "custom_metrics": {"outflow_rate_max": 1412.3393522477522, "cost2_mean": -18.222684157486107, "cost1_mean": 339.5828559398308, "system_level_velocity_mean": 13.79107272320997, "cost2_min": -25.566749798825093, "cost1_max": 434.7564716591333, "cost1_min": 32.160246348547176, "cost2_max": -6.167474455872416, "outflow_rate_mean": 1142.3680868911981, "system_level_velocity_min": 11.491799869414837, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 18.54679057825566}, "info": {"num_steps_trained": 9530978, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.020028915256261826, "total_loss": 13.351907730102539, "vf_loss": 13.356485366821289, "policy_loss": -0.009084540419280529, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.9415988922119141, "entropy": 1.0533077716827393}, "load_time_ms": 7.569, "grad_time_ms": 9278.687, "update_time_ms": 6.837, "num_steps_sampled": 9530978, "sample_time_ms": 15023.14}, "episode_len_mean": 667.16, "time_this_iter_s": 23.82635807991028, "num_metric_batches_dropped": 0, "timesteps_total": 9530978, "hostname": "flow-main", "episodes_total": 3869, "timestamp": 1557228405, "episode_reward_max": 1179.9971964083454, "episodes_this_iter": 19, "time_total_s": 5796.4762403965, "time_since_restore": 5796.4762403965}
{"timesteps_since_restore": 9572264, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41286, "date": "2019-05-07_11-27-09", "episode_reward_min": 55.98535877244755, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc916d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 232, "episode_reward_mean": 994.4460741056918, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 232, "custom_metrics": {"outflow_rate_max": 1432.7437230769233, "cost2_mean": -18.727932797372727, "cost1_mean": 341.9418003601069, "system_level_velocity_mean": 13.871466455182455, "cost2_min": -28.025426592981503, "cost1_max": 434.7564716591333, "cost1_min": 32.160246348547176, "cost2_max": -6.167474455872416, "outflow_rate_mean": 1150.4185551269627, "system_level_velocity_min": 11.491799869414837, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 18.54679057825566}, "info": {"num_steps_trained": 9572264, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013391598127782345, "total_loss": 13.346892356872559, "vf_loss": 13.349363327026367, "policy_loss": -0.00699172867462039, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.9408214092254639, "entropy": 1.0429097414016724}, "load_time_ms": 7.454, "grad_time_ms": 9398.772, "update_time_ms": 6.904, "num_steps_sampled": 9572264, "sample_time_ms": 14748.556}, "episode_len_mean": 667.16, "time_this_iter_s": 23.732861042022705, "num_metric_batches_dropped": 0, "timesteps_total": 9572264, "hostname": "flow-main", "episodes_total": 3885, "timestamp": 1557228429, "episode_reward_max": 1173.8382842900746, "episodes_this_iter": 16, "time_total_s": 5820.209101438522, "time_since_restore": 5820.209101438522}
{"timesteps_since_restore": 9613205, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40941, "date": "2019-05-07_11-27-33", "episode_reward_min": 55.98535877244755, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ca58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ce80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cd68>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 233, "episode_reward_mean": 982.4929273237697, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 233, "custom_metrics": {"outflow_rate_max": 1438.482923876124, "cost2_mean": -18.55974512770384, "cost1_mean": 338.33051587954833, "system_level_velocity_mean": 13.881579595399353, "cost2_min": -28.025426592981503, "cost1_max": 434.7564716591333, "cost1_min": 32.160246348547176, "cost2_max": -6.167474455872416, "outflow_rate_mean": 1143.6414252197435, "system_level_velocity_min": 10.94896342279009, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 18.54679057825566}, "info": {"num_steps_trained": 9613205, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012912708334624767, "total_loss": 14.764602661132812, "vf_loss": 14.768486976623535, "policy_loss": -0.00824224203824997, "cur_kl_coeff": 0.3375000059604645, "vf_explained_var": 0.9340940713882446, "entropy": 1.0749987363815308}, "load_time_ms": 7.49, "grad_time_ms": 9506.12, "update_time_ms": 7.35, "num_steps_sampled": 9613205, "sample_time_ms": 14510.069}, "episode_len_mean": 661.83, "time_this_iter_s": 23.8964741230011, "num_metric_batches_dropped": 0, "timesteps_total": 9613205, "hostname": "flow-main", "episodes_total": 3900, "timestamp": 1557228453, "episode_reward_max": 1173.8382842900746, "episodes_this_iter": 15, "time_total_s": 5844.105575561523, "time_since_restore": 5844.105575561523}
{"timesteps_since_restore": 9654077, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40872, "date": "2019-05-07_11-27-58", "episode_reward_min": 55.98535877244755, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91358>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 234, "episode_reward_mean": 986.1967274108928, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 234, "custom_metrics": {"outflow_rate_max": 1438.482923876124, "cost2_mean": -18.90156679403661, "cost1_mean": 340.1801531660129, "system_level_velocity_mean": 13.91267498171756, "cost2_min": -28.025426592981503, "cost1_max": 435.11069609594506, "cost1_min": 32.160246348547176, "cost2_max": -6.167474455872416, "outflow_rate_mean": 1145.031585755208, "system_level_velocity_min": 10.94896342279009, "outflow_rate_min": 331.87953903336756, "system_level_velocity_max": 18.54679057825566}, "info": {"num_steps_trained": 9654077, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0121026411652565, "total_loss": 14.809917449951172, "vf_loss": 14.812207221984863, "policy_loss": -0.006373598240315914, "cur_kl_coeff": 0.3375000059604645, "vf_explained_var": 0.9289400577545166, "entropy": 1.0357211828231812}, "load_time_ms": 7.037, "grad_time_ms": 9617.308, "update_time_ms": 7.431, "num_steps_sampled": 9654077, "sample_time_ms": 14455.81}, "episode_len_mean": 663.33, "time_this_iter_s": 24.91628909111023, "num_metric_batches_dropped": 0, "timesteps_total": 9654077, "hostname": "flow-main", "episodes_total": 3918, "timestamp": 1557228478, "episode_reward_max": 1173.8382842900746, "episodes_this_iter": 18, "time_total_s": 5869.021864652634, "time_since_restore": 5869.021864652634}
{"timesteps_since_restore": 9694306, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40229, "date": "2019-05-07_11-28-23", "episode_reward_min": 55.98535877244755, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 235, "episode_reward_mean": 988.4206661761398, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 235, "custom_metrics": {"outflow_rate_max": 1438.482923876124, "cost2_mean": -18.883504511389653, "cost1_mean": 340.5583144436849, "system_level_velocity_mean": 13.90380032052679, "cost2_min": -28.025426592981503, "cost1_max": 435.11069609594506, "cost1_min": 33.235687626806524, "cost2_max": -10.666214633735066, "outflow_rate_mean": 1147.405146748676, "system_level_velocity_min": 10.94896342279009, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.38606784787239}, "info": {"num_steps_trained": 9694306, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013738990761339664, "total_loss": 18.537307739257812, "vf_loss": 18.540231704711914, "policy_loss": -0.007560435216873884, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9123321175575256, "entropy": 1.0563757419586182}, "load_time_ms": 7.048, "grad_time_ms": 9745.434, "update_time_ms": 7.749, "num_steps_sampled": 9694306, "sample_time_ms": 14427.055}, "episode_len_mean": 663.53, "time_this_iter_s": 24.791858673095703, "num_metric_batches_dropped": 0, "timesteps_total": 9694306, "hostname": "flow-main", "episodes_total": 3937, "timestamp": 1557228503, "episode_reward_max": 1173.8382842900746, "episodes_this_iter": 19, "time_total_s": 5893.813723325729, "time_since_restore": 5893.813723325729}
{"timesteps_since_restore": 9735512, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41206, "date": "2019-05-07_11-28-48", "episode_reward_min": 49.72430806267387, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c978>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 236, "episode_reward_mean": 981.5777968988077, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 236, "custom_metrics": {"outflow_rate_max": 1438.482923876124, "cost2_mean": -18.794376080111043, "cost1_mean": 335.4110819982161, "system_level_velocity_mean": 13.92515544547831, "cost2_min": -28.025426592981503, "cost1_max": 435.11069609594506, "cost1_min": 28.53943049443322, "cost2_max": -8.046197437875955, "outflow_rate_mean": 1137.26534099071, "system_level_velocity_min": 10.94896342279009, "outflow_rate_min": 327.49577067057464, "system_level_velocity_max": 19.249877193721094}, "info": {"num_steps_trained": 9735512, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013303425163030624, "total_loss": 18.416139602661133, "vf_loss": 18.419828414916992, "policy_loss": -0.008179712109267712, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.8992621302604675, "entropy": 1.027569055557251}, "load_time_ms": 7.198, "grad_time_ms": 9829.78, "update_time_ms": 7.972, "num_steps_sampled": 9735512, "sample_time_ms": 14422.203}, "episode_len_mean": 655.23, "time_this_iter_s": 24.80276083946228, "num_metric_batches_dropped": 0, "timesteps_total": 9735512, "hostname": "flow-main", "episodes_total": 3955, "timestamp": 1557228528, "episode_reward_max": 1186.3527518510043, "episodes_this_iter": 18, "time_total_s": 5918.616484165192, "time_since_restore": 5918.616484165192}
{"timesteps_since_restore": 9777447, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41935, "date": "2019-05-07_11-29-14", "episode_reward_min": 49.72430806267387, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 237, "episode_reward_mean": 982.4447606057962, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 237, "custom_metrics": {"outflow_rate_max": 1438.482923876124, "cost2_mean": -18.201021553549534, "cost1_mean": 333.41931900521956, "system_level_velocity_mean": 13.740809751878457, "cost2_min": -28.025426592981503, "cost1_max": 435.11069609594506, "cost1_min": 28.53943049443322, "cost2_max": -8.046197437875955, "outflow_rate_mean": 1129.2189168875643, "system_level_velocity_min": 10.94896342279009, "outflow_rate_min": 327.49577067057464, "system_level_velocity_max": 19.249877193721094}, "info": {"num_steps_trained": 9777447, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013119560666382313, "total_loss": 14.307437896728516, "vf_loss": 14.30945110321045, "policy_loss": -0.006439846940338612, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9269784092903137, "entropy": 1.0241848230361938}, "load_time_ms": 7.155, "grad_time_ms": 9866.045, "update_time_ms": 8.08, "num_steps_sampled": 9777447, "sample_time_ms": 14569.17}, "episode_len_mean": 659.05, "time_this_iter_s": 26.6206533908844, "num_metric_batches_dropped": 0, "timesteps_total": 9777447, "hostname": "flow-main", "episodes_total": 3970, "timestamp": 1557228554, "episode_reward_max": 1186.3527518510043, "episodes_this_iter": 15, "time_total_s": 5945.237137556076, "time_since_restore": 5945.237137556076}
{"timesteps_since_restore": 9818939, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41492, "date": "2019-05-07_11-29-38", "episode_reward_min": 49.72430806267387, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cbe0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 238, "episode_reward_mean": 985.3730013275953, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 238, "custom_metrics": {"outflow_rate_max": 1438.482923876124, "cost2_mean": -17.80759309406832, "cost1_mean": 332.8453238461794, "system_level_velocity_mean": 13.712878054717319, "cost2_min": -27.173025916369085, "cost1_max": 435.11069609594506, "cost1_min": 28.53943049443322, "cost2_max": -8.046197437875955, "outflow_rate_mean": 1128.5727453590926, "system_level_velocity_min": 10.94896342279009, "outflow_rate_min": 327.49577067057464, "system_level_velocity_max": 19.249877193721094}, "info": {"num_steps_trained": 9818939, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01319166924804449, "total_loss": 11.624218940734863, "vf_loss": 11.627017974853516, "policy_loss": -0.007250913884490728, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9407293200492859, "entropy": 1.0720939636230469}, "load_time_ms": 7.22, "grad_time_ms": 9761.105, "update_time_ms": 8.274, "num_steps_sampled": 9818939, "sample_time_ms": 14606.837}, "episode_len_mean": 659.05, "time_this_iter_s": 24.085530996322632, "num_metric_batches_dropped": 0, "timesteps_total": 9818939, "hostname": "flow-main", "episodes_total": 3984, "timestamp": 1557228578, "episode_reward_max": 1186.3527518510043, "episodes_this_iter": 14, "time_total_s": 5969.322668552399, "time_since_restore": 5969.322668552399}
{"timesteps_since_restore": 9859913, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40974, "date": "2019-05-07_11-30-02", "episode_reward_min": 49.72430806267387, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb05f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb07b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 239, "episode_reward_mean": 1002.8649814387747, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 239, "custom_metrics": {"outflow_rate_max": 1434.3351032967032, "cost2_mean": -18.093264167003525, "cost1_mean": 337.3996180308007, "system_level_velocity_mean": 13.734232320593124, "cost2_min": -27.173025916369085, "cost1_max": 435.11069609594506, "cost1_min": 28.53943049443322, "cost2_max": -8.046197437875955, "outflow_rate_mean": 1141.105516600977, "system_level_velocity_min": 11.053098814855355, "outflow_rate_min": 327.49577067057464, "system_level_velocity_max": 19.249877193721094}, "info": {"num_steps_trained": 9859913, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010762691497802734, "total_loss": 14.56745719909668, "vf_loss": 14.57080078125, "policy_loss": -0.006974273826926947, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9319930076599121, "entropy": 1.079207181930542}, "load_time_ms": 7.14, "grad_time_ms": 9717.219, "update_time_ms": 8.321, "num_steps_sampled": 9859913, "sample_time_ms": 14572.587}, "episode_len_mean": 664.38, "time_this_iter_s": 23.7324640750885, "num_metric_batches_dropped": 0, "timesteps_total": 9859913, "hostname": "flow-main", "episodes_total": 4002, "timestamp": 1557228602, "episode_reward_max": 1186.3527518510043, "episodes_this_iter": 18, "time_total_s": 5993.055132627487, "time_since_restore": 5993.055132627487}
{"timesteps_since_restore": 9900357, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40444, "date": "2019-05-07_11-30-26", "episode_reward_min": 49.72430806267387, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb31d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb908>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 240, "episode_reward_mean": 1004.6458057621181, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 240, "custom_metrics": {"outflow_rate_max": 1373.9871728271728, "cost2_mean": -18.471064474387624, "cost1_mean": 337.60705875328944, "system_level_velocity_mean": 13.73630933065989, "cost2_min": -28.373546586854754, "cost1_max": 426.0177954569657, "cost1_min": 28.53943049443322, "cost2_max": -8.046197437875955, "outflow_rate_mean": 1143.1339950784995, "system_level_velocity_min": 11.053098814855355, "outflow_rate_min": 327.49577067057464, "system_level_velocity_max": 19.249877193721094}, "info": {"num_steps_trained": 9900357, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011655587702989578, "total_loss": 11.059473991394043, "vf_loss": 11.063087463378906, "policy_loss": -0.007546840235590935, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9507172107696533, "entropy": 1.0642651319503784}, "load_time_ms": 7.065, "grad_time_ms": 9683.167, "update_time_ms": 8.396, "num_steps_sampled": 9900357, "sample_time_ms": 14627.151}, "episode_len_mean": 664.38, "time_this_iter_s": 23.79565668106079, "num_metric_batches_dropped": 0, "timesteps_total": 9900357, "hostname": "flow-main", "episodes_total": 4019, "timestamp": 1557228626, "episode_reward_max": 1207.4258928832558, "episodes_this_iter": 17, "time_total_s": 6016.850789308548, "time_since_restore": 6016.850789308548}
{"timesteps_since_restore": 9941424, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41067, "date": "2019-05-07_11-30-50", "episode_reward_min": 49.72430806267387, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ca90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 241, "episode_reward_mean": 1031.77328747698, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 241, "custom_metrics": {"outflow_rate_max": 1373.9871728271728, "cost2_mean": -18.996331966900545, "cost1_mean": 347.3913823039284, "system_level_velocity_mean": 13.70117910033686, "cost2_min": -28.373546586854754, "cost1_max": 426.0177954569657, "cost1_min": 28.53943049443322, "cost2_max": -8.046197437875955, "outflow_rate_mean": 1166.4116833111443, "system_level_velocity_min": 11.053098814855355, "outflow_rate_min": 327.49577067057464, "system_level_velocity_max": 19.249877193721094}, "info": {"num_steps_trained": 9941424, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0121079720556736, "total_loss": 14.433586120605469, "vf_loss": 14.436223983764648, "policy_loss": -0.006725598126649857, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9333311915397644, "entropy": 1.0671155452728271}, "load_time_ms": 7.047, "grad_time_ms": 9640.549, "update_time_ms": 8.471, "num_steps_sampled": 9941424, "sample_time_ms": 14708.859}, "episode_len_mean": 680.46, "time_this_iter_s": 24.215360164642334, "num_metric_batches_dropped": 0, "timesteps_total": 9941424, "hostname": "flow-main", "episodes_total": 4036, "timestamp": 1557228650, "episode_reward_max": 1207.4258928832558, "episodes_this_iter": 17, "time_total_s": 6041.06614947319, "time_since_restore": 6041.06614947319}
{"timesteps_since_restore": 9982610, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41186, "date": "2019-05-07_11-31-15", "episode_reward_min": 66.47118429824954, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cbe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cd30>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 242, "episode_reward_mean": 1039.1220669270597, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 242, "custom_metrics": {"outflow_rate_max": 1373.9871728271728, "cost2_mean": -19.231955433045574, "cost1_mean": 351.82086708091344, "system_level_velocity_mean": 13.67212460639716, "cost2_min": -28.373546586854754, "cost1_max": 426.0177954569657, "cost1_min": 33.34874698884615, "cost2_max": -8.98563649456286, "outflow_rate_mean": 1177.132165526705, "system_level_velocity_min": 11.053098814855355, "outflow_rate_min": 329.8655169108091, "system_level_velocity_max": 18.354579634569692}, "info": {"num_steps_trained": 9982610, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012114258483052254, "total_loss": 14.174386024475098, "vf_loss": 14.177136421203613, "policy_loss": -0.006838442757725716, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.9307827353477478, "entropy": 1.0832868814468384}, "load_time_ms": 7.083, "grad_time_ms": 9598.029, "update_time_ms": 8.737, "num_steps_sampled": 9982610, "sample_time_ms": 14824.664}, "episode_len_mean": 687.85, "time_this_iter_s": 24.457032203674316, "num_metric_batches_dropped": 0, "timesteps_total": 9982610, "hostname": "flow-main", "episodes_total": 4051, "timestamp": 1557228675, "episode_reward_max": 1207.4258928832558, "episodes_this_iter": 15, "time_total_s": 6065.523181676865, "time_since_restore": 6065.523181676865}
{"timesteps_since_restore": 10022676, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40066, "date": "2019-05-07_11-31-39", "episode_reward_min": 218.50265462995378, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ce80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cef0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 243, "episode_reward_mean": 1047.738284135269, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 243, "custom_metrics": {"outflow_rate_max": 1373.9871728271728, "cost2_mean": -19.706533398922065, "cost1_mean": 354.8941658582314, "system_level_velocity_mean": 13.76596461331146, "cost2_min": -28.373546586854754, "cost1_max": 412.5347390951506, "cost1_min": 89.57296154337429, "cost2_max": -10.092131917352859, "outflow_rate_mean": 1187.9036641468615, "system_level_velocity_min": 11.623232199056924, "outflow_rate_min": 469.7279692262256, "system_level_velocity_max": 18.03240910752009}, "info": {"num_steps_trained": 10022676, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013575977645814419, "total_loss": 14.95866584777832, "vf_loss": 14.96272087097168, "policy_loss": -0.008634290657937527, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9345672130584717, "entropy": 1.1126481294631958}, "load_time_ms": 6.923, "grad_time_ms": 9531.31, "update_time_ms": 8.554, "num_steps_sampled": 10022676, "sample_time_ms": 14939.666}, "episode_len_mean": 688.81, "time_this_iter_s": 24.37261176109314, "num_metric_batches_dropped": 0, "timesteps_total": 10022676, "hostname": "flow-main", "episodes_total": 4070, "timestamp": 1557228699, "episode_reward_max": 1210.3882675183138, "episodes_this_iter": 19, "time_total_s": 6089.895793437958, "time_since_restore": 6089.895793437958}
{"timesteps_since_restore": 10064068, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41392, "date": "2019-05-07_11-32-03", "episode_reward_min": 218.50265462995378, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c358>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 244, "episode_reward_mean": 1041.9403797619213, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 244, "custom_metrics": {"outflow_rate_max": 1417.511185214785, "cost2_mean": -19.821831478335607, "cost1_mean": 353.56360618908263, "system_level_velocity_mean": 13.725848820271707, "cost2_min": -28.373546586854754, "cost1_max": 412.5347390951506, "cost1_min": 89.57296154337429, "cost2_max": -10.092131917352859, "outflow_rate_mean": 1183.6883783806277, "system_level_velocity_min": 11.623232199056924, "outflow_rate_min": 469.7279692262256, "system_level_velocity_max": 18.03240910752009}, "info": {"num_steps_trained": 10064068, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013106455095112324, "total_loss": 12.680412292480469, "vf_loss": 12.683293342590332, "policy_loss": -0.0073039112612605095, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9390063285827637, "entropy": 1.092690348625183}, "load_time_ms": 7.375, "grad_time_ms": 9474.327, "update_time_ms": 8.647, "num_steps_sampled": 10064068, "sample_time_ms": 14926.08}, "episode_len_mean": 688.81, "time_this_iter_s": 24.24100375175476, "num_metric_batches_dropped": 0, "timesteps_total": 10064068, "hostname": "flow-main", "episodes_total": 4087, "timestamp": 1557228723, "episode_reward_max": 1210.3882675183138, "episodes_this_iter": 17, "time_total_s": 6114.1367971897125, "time_since_restore": 6114.1367971897125}
{"timesteps_since_restore": 10105618, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41550, "date": "2019-05-07_11-32-29", "episode_reward_min": 218.50265462995378, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cf98>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 245, "episode_reward_mean": 1041.9588574900054, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 245, "custom_metrics": {"outflow_rate_max": 1418.5505362637361, "cost2_mean": -20.018078176879946, "cost1_mean": 353.4323942354385, "system_level_velocity_mean": 13.728927121719833, "cost2_min": -28.373546586854754, "cost1_max": 412.43891458385133, "cost1_min": 89.57296154337429, "cost2_max": -10.092131917352859, "outflow_rate_mean": 1182.2546352237848, "system_level_velocity_min": 11.623232199056924, "outflow_rate_min": 469.7279692262256, "system_level_velocity_max": 18.03240910752009}, "info": {"num_steps_trained": 10105618, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011608405038714409, "total_loss": 10.94640827178955, "vf_loss": 10.94874095916748, "policy_loss": -0.006250839214771986, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.948916494846344, "entropy": 1.106840968132019}, "load_time_ms": 7.474, "grad_time_ms": 9460.702, "update_time_ms": 8.603, "num_steps_sampled": 10105618, "sample_time_ms": 14978.969}, "episode_len_mean": 688.81, "time_this_iter_s": 25.18973708152771, "num_metric_batches_dropped": 0, "timesteps_total": 10105618, "hostname": "flow-main", "episodes_total": 4101, "timestamp": 1557228749, "episode_reward_max": 1210.3882675183138, "episodes_this_iter": 14, "time_total_s": 6139.32653427124, "time_since_restore": 6139.32653427124}
{"timesteps_since_restore": 10147452, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41834, "date": "2019-05-07_11-32-53", "episode_reward_min": 181.62252688273574, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c5f8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 246, "episode_reward_mean": 1033.3835548234401, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 246, "custom_metrics": {"outflow_rate_max": 1440.4776563436565, "cost2_mean": -20.216971179300696, "cost1_mean": 350.2282884716589, "system_level_velocity_mean": 13.772649454962066, "cost2_min": -28.27091958583373, "cost1_max": 417.52165600199646, "cost1_min": 74.56354533488373, "cost2_max": -10.092131917352859, "outflow_rate_mean": 1175.12425653242, "system_level_velocity_min": 11.623232199056924, "outflow_rate_min": 432.2115985958223, "system_level_velocity_max": 18.208555826719763}, "info": {"num_steps_trained": 10147452, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01242061797529459, "total_loss": 14.736039161682129, "vf_loss": 14.740535736083984, "policy_loss": -0.008688769303262234, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9249617457389832, "entropy": 1.0990937948226929}, "load_time_ms": 7.328, "grad_time_ms": 9436.843, "update_time_ms": 8.511, "num_steps_sampled": 10147452, "sample_time_ms": 14988.666}, "episode_len_mean": 682.91, "time_this_iter_s": 24.684497833251953, "num_metric_batches_dropped": 0, "timesteps_total": 10147452, "hostname": "flow-main", "episodes_total": 4117, "timestamp": 1557228773, "episode_reward_max": 1210.3882675183138, "episodes_this_iter": 16, "time_total_s": 6164.011032104492, "time_since_restore": 6164.011032104492}
{"timesteps_since_restore": 10189415, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41963, "date": "2019-05-07_11-33-19", "episode_reward_min": 52.34116334954423, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ce48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c860>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 247, "episode_reward_mean": 1013.7944030466829, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 247, "custom_metrics": {"outflow_rate_max": 1440.4776563436565, "cost2_mean": -20.208283422231062, "cost1_mean": 342.3017284449895, "system_level_velocity_mean": 13.7381632140504, "cost2_min": -28.484032798225133, "cost1_max": 417.52165600199646, "cost1_min": 28.452218165881494, "cost2_max": -7.605454970364579, "outflow_rate_mean": 1159.8265859052285, "system_level_velocity_min": 11.623232199056924, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.15977418410544}, "info": {"num_steps_trained": 10189415, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014139806851744652, "total_loss": 15.270293235778809, "vf_loss": 15.274312973022461, "policy_loss": -0.00879132840782404, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.92186439037323, "entropy": 1.1013906002044678}, "load_time_ms": 7.242, "grad_time_ms": 9453.355, "update_time_ms": 8.703, "num_steps_sampled": 10189415, "sample_time_ms": 14872.16}, "episode_len_mean": 672.37, "time_this_iter_s": 25.593937873840332, "num_metric_batches_dropped": 0, "timesteps_total": 10189415, "hostname": "flow-main", "episodes_total": 4134, "timestamp": 1557228799, "episode_reward_max": 1210.3882675183138, "episodes_this_iter": 17, "time_total_s": 6189.6049699783325, "time_since_restore": 6189.6049699783325}
{"timesteps_since_restore": 10230574, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41159, "date": "2019-05-07_11-33-44", "episode_reward_min": 52.34116334954423, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c3c8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 248, "episode_reward_mean": 1029.392542193457, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 248, "custom_metrics": {"outflow_rate_max": 1440.4776563436565, "cost2_mean": -20.286414084885195, "cost1_mean": 344.8889594371913, "system_level_velocity_mean": 13.692191033212602, "cost2_min": -28.97262174399956, "cost1_max": 417.52165600199646, "cost1_min": 28.452218165881494, "cost2_max": -7.605454970364579, "outflow_rate_mean": 1167.2338720571222, "system_level_velocity_min": 11.625870709314025, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.15977418410544}, "info": {"num_steps_trained": 10230574, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012633350677788258, "total_loss": 13.277036666870117, "vf_loss": 13.279406547546387, "policy_loss": -0.006633274257183075, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.9351789355278015, "entropy": 1.1497899293899536}, "load_time_ms": 7.223, "grad_time_ms": 9476.786, "update_time_ms": 8.701, "num_steps_sampled": 10230574, "sample_time_ms": 14976.284}, "episode_len_mean": 678.02, "time_this_iter_s": 25.34284496307373, "num_metric_batches_dropped": 0, "timesteps_total": 10230574, "hostname": "flow-main", "episodes_total": 4152, "timestamp": 1557228824, "episode_reward_max": 1224.19295771994, "episodes_this_iter": 18, "time_total_s": 6214.947814941406, "time_since_restore": 6214.947814941406}
{"timesteps_since_restore": 10271605, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41031, "date": "2019-05-07_11-34-09", "episode_reward_min": 52.34116334954423, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c780>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 249, "episode_reward_mean": 1045.1830963369655, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 249, "custom_metrics": {"outflow_rate_max": 1440.4776563436565, "cost2_mean": -20.83259801164502, "cost1_mean": 348.9691189308467, "system_level_velocity_mean": 13.717887601776944, "cost2_min": -30.409327255316995, "cost1_max": 423.1454467120384, "cost1_min": 28.452218165881494, "cost2_max": -7.605454970364579, "outflow_rate_mean": 1179.247398887238, "system_level_velocity_min": 11.625870709314025, "outflow_rate_min": 340.0431742023662, "system_level_velocity_max": 19.15977418410544}, "info": {"num_steps_trained": 10271605, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011471131816506386, "total_loss": 12.020166397094727, "vf_loss": 12.023489952087402, "policy_loss": -0.007196695543825626, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9444387555122375, "entropy": 1.149735689163208}, "load_time_ms": 7.422, "grad_time_ms": 9419.179, "update_time_ms": 8.95, "num_steps_sampled": 10271605, "sample_time_ms": 15077.356}, "episode_len_mean": 683.56, "time_this_iter_s": 24.16289472579956, "num_metric_batches_dropped": 0, "timesteps_total": 10271605, "hostname": "flow-main", "episodes_total": 4168, "timestamp": 1557228849, "episode_reward_max": 1224.19295771994, "episodes_this_iter": 16, "time_total_s": 6239.110709667206, "time_since_restore": 6239.110709667206}
{"timesteps_since_restore": 10313816, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42211, "date": "2019-05-07_11-34-34", "episode_reward_min": 52.34116334954423, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 250, "episode_reward_mean": 1036.179736783943, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 250, "custom_metrics": {"outflow_rate_max": 1440.4776563436565, "cost2_mean": -21.059157836648755, "cost1_mean": 346.09198791004053, "system_level_velocity_mean": 13.80482534718381, "cost2_min": -30.673195873822483, "cost1_max": 423.1454467120384, "cost1_min": 28.452218165881494, "cost2_max": -7.605454970364579, "outflow_rate_mean": 1171.0092225720284, "system_level_velocity_min": 11.625870709314025, "outflow_rate_min": 335.07121403348816, "system_level_velocity_max": 19.15977418410544}, "info": {"num_steps_trained": 10313816, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012909227050840855, "total_loss": 11.209858894348145, "vf_loss": 11.213764190673828, "policy_loss": -0.008261112496256828, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9503397345542908, "entropy": 1.1646798849105835}, "load_time_ms": 7.38, "grad_time_ms": 9413.335, "update_time_ms": 9.18, "num_steps_sampled": 10313816, "sample_time_ms": 15194.965}, "episode_len_mean": 677.02, "time_this_iter_s": 24.893905878067017, "num_metric_batches_dropped": 0, "timesteps_total": 10313816, "hostname": "flow-main", "episodes_total": 4184, "timestamp": 1557228874, "episode_reward_max": 1224.19295771994, "episodes_this_iter": 16, "time_total_s": 6264.004615545273, "time_since_restore": 6264.004615545273}
{"timesteps_since_restore": 10355020, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41204, "date": "2019-05-07_11-34-58", "episode_reward_min": 52.34116334954423, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb77f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cb00>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 251, "episode_reward_mean": 1034.798129339817, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 251, "custom_metrics": {"outflow_rate_max": 1440.4776563436565, "cost2_mean": -21.90549415681585, "cost1_mean": 346.97949020341076, "system_level_velocity_mean": 13.976407994227342, "cost2_min": -31.99414902231408, "cost1_max": 423.1454467120384, "cost1_min": 28.452218165881494, "cost2_max": -7.605454970364579, "outflow_rate_mean": 1175.852567952306, "system_level_velocity_min": 11.647299592963854, "outflow_rate_min": 335.07121403348816, "system_level_velocity_max": 19.15977418410544}, "info": {"num_steps_trained": 10355020, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01213871967047453, "total_loss": 11.863237380981445, "vf_loss": 11.865991592407227, "policy_loss": -0.006851901765912771, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.9469140768051147, "entropy": 1.1618441343307495}, "load_time_ms": 7.359, "grad_time_ms": 9433.827, "update_time_ms": 9.023, "num_steps_sampled": 10355020, "sample_time_ms": 15167.892}, "episode_len_mean": 672.36, "time_this_iter_s": 24.156068086624146, "num_metric_batches_dropped": 0, "timesteps_total": 10355020, "hostname": "flow-main", "episodes_total": 4201, "timestamp": 1557228898, "episode_reward_max": 1224.19295771994, "episodes_this_iter": 17, "time_total_s": 6288.160683631897, "time_since_restore": 6288.160683631897}
{"timesteps_since_restore": 10396548, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41528, "date": "2019-05-07_11-35-23", "episode_reward_min": 52.34116334954423, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca37f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca39b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 252, "episode_reward_mean": 1047.4831168979933, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 252, "custom_metrics": {"outflow_rate_max": 1414.4944027972028, "cost2_mean": -22.343051952909818, "cost1_mean": 350.2926467456094, "system_level_velocity_mean": 13.953106165424582, "cost2_min": -33.836673284585125, "cost1_max": 423.1454467120384, "cost1_min": 28.452218165881494, "cost2_max": -7.605454970364579, "outflow_rate_mean": 1186.582494407906, "system_level_velocity_min": 11.647299592963854, "outflow_rate_min": 335.07121403348816, "system_level_velocity_max": 19.15977418410544}, "info": {"num_steps_trained": 10396548, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011878828518092632, "total_loss": 11.723396301269531, "vf_loss": 11.726700782775879, "policy_loss": -0.007313969079405069, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9545547366142273, "entropy": 1.1418912410736084}, "load_time_ms": 7.374, "grad_time_ms": 9458.397, "update_time_ms": 9.117, "num_steps_sampled": 10396548, "sample_time_ms": 15212.25}, "episode_len_mean": 678.26, "time_this_iter_s": 25.149048328399658, "num_metric_batches_dropped": 0, "timesteps_total": 10396548, "hostname": "flow-main", "episodes_total": 4218, "timestamp": 1557228923, "episode_reward_max": 1224.19295771994, "episodes_this_iter": 17, "time_total_s": 6313.309731960297, "time_since_restore": 6313.309731960297}
{"timesteps_since_restore": 10437921, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41373, "date": "2019-05-07_11-35-47", "episode_reward_min": 56.158151110809555, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f7f0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 253, "episode_reward_mean": 1061.862723130798, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 253, "custom_metrics": {"outflow_rate_max": 1414.4944027972028, "cost2_mean": -23.040683338268515, "cost1_mean": 355.6326277488168, "system_level_velocity_mean": 14.025596504697122, "cost2_min": -33.836673284585125, "cost1_max": 423.1454467120384, "cost1_min": 30.08467044005818, "cost2_max": -10.857145261498196, "outflow_rate_mean": 1197.757813670424, "system_level_velocity_min": 11.026567042253115, "outflow_rate_min": 335.07121403348816, "system_level_velocity_max": 18.607304726561072}, "info": {"num_steps_trained": 10437921, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012658242136240005, "total_loss": 15.126115798950195, "vf_loss": 15.129144668579102, "policy_loss": -0.007302227430045605, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9376380443572998, "entropy": 1.1620054244995117}, "load_time_ms": 7.352, "grad_time_ms": 9429.121, "update_time_ms": 9.326, "num_steps_sampled": 10437921, "sample_time_ms": 15203.244}, "episode_len_mean": 683.39, "time_this_iter_s": 23.991694688796997, "num_metric_batches_dropped": 0, "timesteps_total": 10437921, "hostname": "flow-main", "episodes_total": 4235, "timestamp": 1557228947, "episode_reward_max": 1224.19295771994, "episodes_this_iter": 17, "time_total_s": 6337.301426649094, "time_since_restore": 6337.301426649094}
{"timesteps_since_restore": 10479403, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41482, "date": "2019-05-07_11-36-12", "episode_reward_min": 56.158151110809555, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fb70>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 254, "episode_reward_mean": 1045.733528393177, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 254, "custom_metrics": {"outflow_rate_max": 1414.4944027972028, "cost2_mean": -24.069834335894775, "cost1_mean": 351.9287407360743, "system_level_velocity_mean": 14.048290808879331, "cost2_min": -33.836673284585125, "cost1_max": 423.1454467120384, "cost1_min": 30.08467044005818, "cost2_max": -10.857145261498196, "outflow_rate_mean": 1186.5447291870307, "system_level_velocity_min": 11.026567042253115, "outflow_rate_min": 335.07121403348816, "system_level_velocity_max": 18.607304726561072}, "info": {"num_steps_trained": 10479403, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012752226553857327, "total_loss": 11.633018493652344, "vf_loss": 11.636902809143066, "policy_loss": -0.00818842276930809, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9485741257667542, "entropy": 1.178094506263733}, "load_time_ms": 7.315, "grad_time_ms": 9423.538, "update_time_ms": 9.203, "num_steps_sampled": 10479403, "sample_time_ms": 15295.404}, "episode_len_mean": 677.52, "time_this_iter_s": 25.07724905014038, "num_metric_batches_dropped": 0, "timesteps_total": 10479403, "hostname": "flow-main", "episodes_total": 4250, "timestamp": 1557228972, "episode_reward_max": 1223.4385236376486, "episodes_this_iter": 15, "time_total_s": 6362.378675699234, "time_since_restore": 6362.378675699234}
{"timesteps_since_restore": 10521570, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42167, "date": "2019-05-07_11-36-37", "episode_reward_min": 56.158151110809555, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbba20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb198>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 255, "episode_reward_mean": 1038.728641038237, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 255, "custom_metrics": {"outflow_rate_max": 1414.4944027972028, "cost2_mean": -24.71231287144745, "cost1_mean": 351.86434819472066, "system_level_velocity_mean": 14.040580758614862, "cost2_min": -34.92146176544284, "cost1_max": 448.22444109161063, "cost1_min": 30.08467044005818, "cost2_max": -10.857145261498196, "outflow_rate_mean": 1187.2600030571602, "system_level_velocity_min": 11.026567042253115, "outflow_rate_min": 335.07121403348816, "system_level_velocity_max": 18.607304726561072}, "info": {"num_steps_trained": 10521570, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011767356656491756, "total_loss": 11.998620986938477, "vf_loss": 12.002324104309082, "policy_loss": -0.007675143424421549, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9460777640342712, "entropy": 1.170088529586792}, "load_time_ms": 7.33, "grad_time_ms": 9365.974, "update_time_ms": 8.999, "num_steps_sampled": 10521570, "sample_time_ms": 15289.412}, "episode_len_mean": 677.52, "time_this_iter_s": 24.54654622077942, "num_metric_batches_dropped": 0, "timesteps_total": 10521570, "hostname": "flow-main", "episodes_total": 4266, "timestamp": 1557228997, "episode_reward_max": 1292.9696946338956, "episodes_this_iter": 16, "time_total_s": 6386.925221920013, "time_since_restore": 6386.925221920013}
{"timesteps_since_restore": 10562869, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41299, "date": "2019-05-07_11-37-01", "episode_reward_min": 181.54854790308664, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c8d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 256, "episode_reward_mean": 1039.0824189063758, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 256, "custom_metrics": {"outflow_rate_max": 1414.4944027972028, "cost2_mean": -25.154925289184103, "cost1_mean": 351.5860785445813, "system_level_velocity_mean": 13.980233710103876, "cost2_min": -34.92146176544284, "cost1_max": 448.22444109161063, "cost1_min": 74.37163202121059, "cost2_max": -11.82698536077841, "outflow_rate_mean": 1185.2256659897384, "system_level_velocity_min": 11.026567042253115, "outflow_rate_min": 441.34386274957296, "system_level_velocity_max": 18.005075849243497}, "info": {"num_steps_trained": 10562869, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012159912846982479, "total_loss": 12.237646102905273, "vf_loss": 12.24014949798584, "policy_loss": -0.006606836337596178, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.9496816992759705, "entropy": 1.1671136617660522}, "load_time_ms": 7.372, "grad_time_ms": 9319.448, "update_time_ms": 8.91, "num_steps_sampled": 10562869, "sample_time_ms": 15273.86}, "episode_len_mean": 678.54, "time_this_iter_s": 24.034590482711792, "num_metric_batches_dropped": 0, "timesteps_total": 10562869, "hostname": "flow-main", "episodes_total": 4284, "timestamp": 1557229021, "episode_reward_max": 1292.9696946338956, "episodes_this_iter": 18, "time_total_s": 6410.959812402725, "time_since_restore": 6410.959812402725}
{"timesteps_since_restore": 10602939, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40070, "date": "2019-05-07_11-37-25", "episode_reward_min": 64.04288738824762, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3d30>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 257, "episode_reward_mean": 1032.2689495952125, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 257, "custom_metrics": {"outflow_rate_max": 1414.4944027972028, "cost2_mean": -24.28335629683451, "cost1_mean": 347.85212361872965, "system_level_velocity_mean": 14.012321421302163, "cost2_min": -34.92146176544284, "cost1_max": 448.22444109161063, "cost1_min": 33.6866949108487, "cost2_max": -9.960427341515217, "outflow_rate_mean": 1175.4204589765684, "system_level_velocity_min": 11.026567042253115, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.627242426412494}, "info": {"num_steps_trained": 10602939, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012683594599366188, "total_loss": 16.73613166809082, "vf_loss": 16.741060256958008, "policy_loss": -0.009209995158016682, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9232394099235535, "entropy": 1.2110527753829956}, "load_time_ms": 7.348, "grad_time_ms": 9200.281, "update_time_ms": 8.61, "num_steps_sampled": 10602939, "sample_time_ms": 15263.483}, "episode_len_mean": 671.32, "time_this_iter_s": 24.289430856704712, "num_metric_batches_dropped": 0, "timesteps_total": 10602939, "hostname": "flow-main", "episodes_total": 4302, "timestamp": 1557229045, "episode_reward_max": 1292.9696946338956, "episodes_this_iter": 18, "time_total_s": 6435.24924325943, "time_since_restore": 6435.24924325943}
{"timesteps_since_restore": 10644124, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41185, "date": "2019-05-07_11-37-50", "episode_reward_min": 64.04288738824762, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cf28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ccc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ce10>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 258, "episode_reward_mean": 1033.0069966927645, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 258, "custom_metrics": {"outflow_rate_max": 1419.2761802197801, "cost2_mean": -23.810921490517327, "cost1_mean": 349.1570483406197, "system_level_velocity_mean": 14.029186669756005, "cost2_min": -34.92146176544284, "cost1_max": 448.22444109161063, "cost1_min": 33.6866949108487, "cost2_max": -9.960427341515217, "outflow_rate_mean": 1180.1743214424646, "system_level_velocity_min": 11.026567042253115, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.627242426412494}, "info": {"num_steps_trained": 10644124, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011659601703286171, "total_loss": 17.60719871520996, "vf_loss": 17.611343383789062, "policy_loss": -0.008080504834651947, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.9197970628738403, "entropy": 1.191593050956726}, "load_time_ms": 7.347, "grad_time_ms": 9139.257, "update_time_ms": 8.302, "num_steps_sampled": 10644124, "sample_time_ms": 15270.51}, "episode_len_mean": 672.63, "time_this_iter_s": 24.794856786727905, "num_metric_batches_dropped": 0, "timesteps_total": 10644124, "hostname": "flow-main", "episodes_total": 4321, "timestamp": 1557229070, "episode_reward_max": 1292.9696946338956, "episodes_this_iter": 19, "time_total_s": 6460.044100046158, "time_since_restore": 6460.044100046158}
{"timesteps_since_restore": 10686509, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42385, "date": "2019-05-07_11-38-14", "episode_reward_min": 64.04288738824762, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb518>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 259, "episode_reward_mean": 1033.5436999632273, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 259, "custom_metrics": {"outflow_rate_max": 1419.2761802197801, "cost2_mean": -23.41250447887704, "cost1_mean": 349.0976255268543, "system_level_velocity_mean": 14.028533924931544, "cost2_min": -34.92146176544284, "cost1_max": 448.22444109161063, "cost1_min": 33.6866949108487, "cost2_max": -9.960427341515217, "outflow_rate_mean": 1179.645337678229, "system_level_velocity_min": 11.269215892817542, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.627242426412494}, "info": {"num_steps_trained": 10686509, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011660836637020111, "total_loss": 11.853266716003418, "vf_loss": 11.857144355773926, "policy_loss": -0.007813239470124245, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.9444480538368225, "entropy": 1.1886570453643799}, "load_time_ms": 7.284, "grad_time_ms": 9130.744, "update_time_ms": 8.255, "num_steps_sampled": 10686509, "sample_time_ms": 15320.123}, "episode_len_mean": 672.63, "time_this_iter_s": 24.566633701324463, "num_metric_batches_dropped": 0, "timesteps_total": 10686509, "hostname": "flow-main", "episodes_total": 4334, "timestamp": 1557229094, "episode_reward_max": 1292.9696946338956, "episodes_this_iter": 13, "time_total_s": 6484.610733747482, "time_since_restore": 6484.610733747482}
{"timesteps_since_restore": 10728834, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42325, "date": "2019-05-07_11-38-39", "episode_reward_min": 64.04288738824762, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cb70>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 260, "episode_reward_mean": 1040.8747592432162, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 260, "custom_metrics": {"outflow_rate_max": 1419.2761802197801, "cost2_mean": -22.615169733139965, "cost1_mean": 351.1204140638311, "system_level_velocity_mean": 13.943974575707653, "cost2_min": -34.92146176544284, "cost1_max": 448.22444109161063, "cost1_min": 33.6866949108487, "cost2_max": -9.960427341515217, "outflow_rate_mean": 1184.5039314583255, "system_level_velocity_min": 11.391110835728757, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.627242426412494}, "info": {"num_steps_trained": 10728834, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011257744394242764, "total_loss": 8.957280158996582, "vf_loss": 8.960668563842773, "policy_loss": -0.007187908515334129, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9591615796089172, "entropy": 1.177403450012207}, "load_time_ms": 7.261, "grad_time_ms": 9118.465, "update_time_ms": 7.817, "num_steps_sampled": 10728834, "sample_time_ms": 15352.723}, "episode_len_mean": 678.5, "time_this_iter_s": 25.08170223236084, "num_metric_batches_dropped": 0, "timesteps_total": 10728834, "hostname": "flow-main", "episodes_total": 4349, "timestamp": 1557229119, "episode_reward_max": 1292.9696946338956, "episodes_this_iter": 15, "time_total_s": 6509.692435979843, "time_since_restore": 6509.692435979843}
{"timesteps_since_restore": 10769704, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40870, "date": "2019-05-07_11-39-04", "episode_reward_min": 58.44446528842731, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fbe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f748>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 261, "episode_reward_mean": 1020.4061616230919, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 261, "custom_metrics": {"outflow_rate_max": 1459.5148667332667, "cost2_mean": -20.951034369572803, "cost1_mean": 341.86118544343606, "system_level_velocity_mean": 13.942514197862439, "cost2_min": -31.296640278574376, "cost1_max": 432.4457170658786, "cost1_min": 32.302523586001485, "cost2_max": -8.356165964312606, "outflow_rate_mean": 1159.8388481805223, "system_level_velocity_min": 11.391110835728757, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.627242426412494}, "info": {"num_steps_trained": 10769704, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012464525178074837, "total_loss": 17.323518753051758, "vf_loss": 17.327219009399414, "policy_loss": -0.007905249483883381, "cur_kl_coeff": 0.3375000059604645, "vf_explained_var": 0.9278432726860046, "entropy": 1.216400384902954}, "load_time_ms": 7.295, "grad_time_ms": 9057.328, "update_time_ms": 7.637, "num_steps_sampled": 10769704, "sample_time_ms": 15457.017}, "episode_len_mean": 665.5, "time_this_iter_s": 24.579002618789673, "num_metric_batches_dropped": 0, "timesteps_total": 10769704, "hostname": "flow-main", "episodes_total": 4369, "timestamp": 1557229144, "episode_reward_max": 1210.1742498898243, "episodes_this_iter": 20, "time_total_s": 6534.271438598633, "time_since_restore": 6534.271438598633}
{"timesteps_since_restore": 10810614, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40910, "date": "2019-05-07_11-39-28", "episode_reward_min": 58.44446528842731, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cf60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ce10>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 262, "episode_reward_mean": 1021.0874231891617, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 262, "custom_metrics": {"outflow_rate_max": 1459.5148667332667, "cost2_mean": -19.91618321901427, "cost1_mean": 343.4912336341759, "system_level_velocity_mean": 14.00228323445428, "cost2_min": -31.296640278574376, "cost1_max": 432.4457170658786, "cost1_min": 32.302523586001485, "cost2_max": -8.356165964312606, "outflow_rate_mean": 1162.8363764882145, "system_level_velocity_min": 11.391110835728757, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.627242426412494}, "info": {"num_steps_trained": 10810614, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011599451303482056, "total_loss": 10.141355514526367, "vf_loss": 10.144817352294922, "policy_loss": -0.007377676200121641, "cur_kl_coeff": 0.3375000059604645, "vf_explained_var": 0.9551578164100647, "entropy": 1.20159912109375}, "load_time_ms": 6.857, "grad_time_ms": 8992.652, "update_time_ms": 7.263, "num_steps_sampled": 10810614, "sample_time_ms": 15424.752}, "episode_len_mean": 665.5, "time_this_iter_s": 24.167057752609253, "num_metric_batches_dropped": 0, "timesteps_total": 10810614, "hostname": "flow-main", "episodes_total": 4386, "timestamp": 1557229168, "episode_reward_max": 1210.1742498898243, "episodes_this_iter": 17, "time_total_s": 6558.438496351242, "time_since_restore": 6558.438496351242}
{"timesteps_since_restore": 10851069, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40455, "date": "2019-05-07_11-39-53", "episode_reward_min": 58.44446528842731, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0d68>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 263, "episode_reward_mean": 1022.9378991611343, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 263, "custom_metrics": {"outflow_rate_max": 1459.5148667332667, "cost2_mean": -19.38503908652827, "cost1_mean": 340.0034495022044, "system_level_velocity_mean": 13.771792063640152, "cost2_min": -31.296640278574376, "cost1_max": 432.4457170658786, "cost1_min": 32.302523586001485, "cost2_max": -8.356165964312606, "outflow_rate_mean": 1152.2256043186621, "system_level_velocity_min": 11.109189402994357, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.39901493535508}, "info": {"num_steps_trained": 10851069, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012046157382428646, "total_loss": 17.86345100402832, "vf_loss": 17.8667049407959, "policy_loss": -0.007319475058466196, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9133082628250122, "entropy": 1.1892473697662354}, "load_time_ms": 6.866, "grad_time_ms": 9004.885, "update_time_ms": 6.851, "num_steps_sampled": 10851069, "sample_time_ms": 15474.726}, "episode_len_mean": 667.83, "time_this_iter_s": 24.615762948989868, "num_metric_batches_dropped": 0, "timesteps_total": 10851069, "hostname": "flow-main", "episodes_total": 4406, "timestamp": 1557229193, "episode_reward_max": 1210.1742498898243, "episodes_this_iter": 20, "time_total_s": 6583.054259300232, "time_since_restore": 6583.054259300232}
{"timesteps_since_restore": 10892481, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41412, "date": "2019-05-07_11-40-18", "episode_reward_min": 58.44446528842731, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc910f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91668>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 264, "episode_reward_mean": 1022.6545886155332, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 264, "custom_metrics": {"outflow_rate_max": 1459.5148667332667, "cost2_mean": -19.043279223280273, "cost1_mean": 338.86885586765084, "system_level_velocity_mean": 13.610849903089964, "cost2_min": -31.296640278574376, "cost1_max": 419.5991970746015, "cost1_min": 32.302523586001485, "cost2_max": -8.356165964312606, "outflow_rate_mean": 1148.5522391235336, "system_level_velocity_min": 11.109189402994357, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.39901493535508}, "info": {"num_steps_trained": 10892481, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011849986389279366, "total_loss": 10.266388893127441, "vf_loss": 10.270539283752441, "policy_loss": -0.00814925879240036, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9491284489631653, "entropy": 1.1827622652053833}, "load_time_ms": 6.866, "grad_time_ms": 9015.315, "update_time_ms": 6.978, "num_steps_sampled": 10892481, "sample_time_ms": 15432.03}, "episode_len_mean": 671.93, "time_this_iter_s": 24.75514578819275, "num_metric_batches_dropped": 0, "timesteps_total": 10892481, "hostname": "flow-main", "episodes_total": 4419, "timestamp": 1557229218, "episode_reward_max": 1210.1742498898243, "episodes_this_iter": 13, "time_total_s": 6607.809405088425, "time_since_restore": 6607.809405088425}
{"timesteps_since_restore": 10933878, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41397, "date": "2019-05-07_11-40-42", "episode_reward_min": 58.44446528842731, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ce80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cf60>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 265, "episode_reward_mean": 1020.7278843031413, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 265, "custom_metrics": {"outflow_rate_max": 1459.5148667332667, "cost2_mean": -18.788702304198242, "cost1_mean": 339.0314205922487, "system_level_velocity_mean": 13.61174004695397, "cost2_min": -26.82194735760686, "cost1_max": 423.9762332320108, "cost1_min": 32.302523586001485, "cost2_max": -8.356165964312606, "outflow_rate_mean": 1154.1657950396175, "system_level_velocity_min": 11.109189402994357, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.39901493535508}, "info": {"num_steps_trained": 10933878, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011782325804233551, "total_loss": 11.335125923156738, "vf_loss": 11.338815689086914, "policy_loss": -0.007666296791285276, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9387530088424683, "entropy": 1.1938049793243408}, "load_time_ms": 6.412, "grad_time_ms": 9049.883, "update_time_ms": 6.951, "num_steps_sampled": 10933878, "sample_time_ms": 15346.378}, "episode_len_mean": 671.93, "time_this_iter_s": 24.0386483669281, "num_metric_batches_dropped": 0, "timesteps_total": 10933878, "hostname": "flow-main", "episodes_total": 4433, "timestamp": 1557229242, "episode_reward_max": 1202.2499537973988, "episodes_this_iter": 14, "time_total_s": 6631.848053455353, "time_since_restore": 6631.848053455353}
{"timesteps_since_restore": 10974954, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41076, "date": "2019-05-07_11-41-06", "episode_reward_min": 58.44446528842731, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91390>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 266, "episode_reward_mean": 1019.46041563523, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 266, "custom_metrics": {"outflow_rate_max": 1459.5148667332667, "cost2_mean": -18.62129473691346, "cost1_mean": 338.46842260525625, "system_level_velocity_mean": 13.705007795321567, "cost2_min": -26.82194735760686, "cost1_max": 423.9762332320108, "cost1_min": 32.302523586001485, "cost2_max": -8.356165964312606, "outflow_rate_mean": 1159.3803750122536, "system_level_velocity_min": 11.109189402994357, "outflow_rate_min": 331.3055169108091, "system_level_velocity_max": 18.39901493535508}, "info": {"num_steps_trained": 10974954, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011263230815529823, "total_loss": 18.324787139892578, "vf_loss": 18.32760238647461, "policy_loss": -0.006617038045078516, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9051446914672852, "entropy": 1.2055314779281616}, "load_time_ms": 6.388, "grad_time_ms": 9101.627, "update_time_ms": 7.068, "num_steps_sampled": 10974954, "sample_time_ms": 15354.695}, "episode_len_mean": 666.96, "time_this_iter_s": 24.630765199661255, "num_metric_batches_dropped": 0, "timesteps_total": 10974954, "hostname": "flow-main", "episodes_total": 4451, "timestamp": 1557229266, "episode_reward_max": 1202.9878176734492, "episodes_this_iter": 18, "time_total_s": 6656.478818655014, "time_since_restore": 6656.478818655014}
{"timesteps_since_restore": 11015761, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40807, "date": "2019-05-07_11-41-31", "episode_reward_min": 63.841549066338985, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc911d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91e48>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 267, "episode_reward_mean": 1039.3963450187575, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 267, "custom_metrics": {"outflow_rate_max": 1439.4991884115884, "cost2_mean": -19.05999936662773, "cost1_mean": 344.0948565392314, "system_level_velocity_mean": 13.587191388326591, "cost2_min": -27.25584482995571, "cost1_max": 423.9762332320108, "cost1_min": 33.192942442452996, "cost2_max": -8.372436784604393, "outflow_rate_mean": 1174.2460644130044, "system_level_velocity_min": 11.109189402994357, "outflow_rate_min": 326.22109501059714, "system_level_velocity_max": 17.722631004022897}, "info": {"num_steps_trained": 11015761, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014432938769459724, "total_loss": 14.289470672607422, "vf_loss": 14.292072296142578, "policy_loss": -0.007470489479601383, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9370819926261902, "entropy": 1.2050871849060059}, "load_time_ms": 6.619, "grad_time_ms": 9166.588, "update_time_ms": 7.393, "num_steps_sampled": 11015761, "sample_time_ms": 15268.783}, "episode_len_mean": 678.99, "time_this_iter_s": 24.107561349868774, "num_metric_batches_dropped": 0, "timesteps_total": 11015761, "hostname": "flow-main", "episodes_total": 4467, "timestamp": 1557229291, "episode_reward_max": 1202.9878176734492, "episodes_this_iter": 16, "time_total_s": 6680.586380004883, "time_since_restore": 6680.586380004883}
{"timesteps_since_restore": 11056214, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40453, "date": "2019-05-07_11-41-55", "episode_reward_min": 63.841549066338985, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 268, "episode_reward_mean": 1042.3101063325119, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 268, "custom_metrics": {"outflow_rate_max": 1439.4991884115884, "cost2_mean": -19.234580576219038, "cost1_mean": 343.68891702414277, "system_level_velocity_mean": 13.559865624974238, "cost2_min": -27.33388537515014, "cost1_max": 423.9762332320108, "cost1_min": 33.192942442452996, "cost2_max": -8.372436784604393, "outflow_rate_mean": 1179.0008394699476, "system_level_velocity_min": 11.109189402994357, "outflow_rate_min": 326.22109501059714, "system_level_velocity_max": 17.722631004022897}, "info": {"num_steps_trained": 11056214, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012038510292768478, "total_loss": 15.139132499694824, "vf_loss": 15.142840385437012, "policy_loss": -0.007772901561111212, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9317352771759033, "entropy": 1.2178047895431519}, "load_time_ms": 6.624, "grad_time_ms": 9212.986, "update_time_ms": 7.537, "num_steps_sampled": 11056214, "sample_time_ms": 15200.67}, "episode_len_mean": 678.99, "time_this_iter_s": 24.5928213596344, "num_metric_batches_dropped": 0, "timesteps_total": 11056214, "hostname": "flow-main", "episodes_total": 4487, "timestamp": 1557229315, "episode_reward_max": 1202.9878176734492, "episodes_this_iter": 20, "time_total_s": 6705.179201364517, "time_since_restore": 6705.179201364517}
{"timesteps_since_restore": 11097181, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40967, "date": "2019-05-07_11-42-19", "episode_reward_min": 63.841549066338985, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbb38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbe80>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 269, "episode_reward_mean": 1051.1155467427034, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 269, "custom_metrics": {"outflow_rate_max": 1439.4991884115884, "cost2_mean": -19.524363497266446, "cost1_mean": 348.0824426007875, "system_level_velocity_mean": 13.584938155592164, "cost2_min": -27.33388537515014, "cost1_max": 423.9762332320108, "cost1_min": 33.192942442452996, "cost2_max": -8.372436784604393, "outflow_rate_mean": 1192.5158614436168, "system_level_velocity_min": 11.3994669013828, "outflow_rate_min": 326.22109501059714, "system_level_velocity_max": 17.722631004022897}, "info": {"num_steps_trained": 11097181, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012948254123330116, "total_loss": 14.127822875976562, "vf_loss": 14.130617141723633, "policy_loss": -0.007163973990827799, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9297786951065063, "entropy": 1.2021214962005615}, "load_time_ms": 6.562, "grad_time_ms": 9297.852, "update_time_ms": 7.424, "num_steps_sampled": 11097181, "sample_time_ms": 15051.406}, "episode_len_mean": 685.05, "time_this_iter_s": 23.9392192363739, "num_metric_batches_dropped": 0, "timesteps_total": 11097181, "hostname": "flow-main", "episodes_total": 4502, "timestamp": 1557229339, "episode_reward_max": 1212.0147440954454, "episodes_this_iter": 15, "time_total_s": 6729.118420600891, "time_since_restore": 6729.118420600891}
{"timesteps_since_restore": 11139083, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41902, "date": "2019-05-07_11-42-44", "episode_reward_min": 58.29872219295833, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb6a0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 270, "episode_reward_mean": 1047.526626733813, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 270, "custom_metrics": {"outflow_rate_max": 1439.4991884115884, "cost2_mean": -19.781467558474077, "cost1_mean": 346.79796507650116, "system_level_velocity_mean": 13.706063554353236, "cost2_min": -27.33388537515014, "cost1_max": 423.9762332320108, "cost1_min": 32.799862691884826, "cost2_max": -7.926690873027828, "outflow_rate_mean": 1187.6431112912076, "system_level_velocity_min": 11.628676489126311, "outflow_rate_min": 326.22109501059714, "system_level_velocity_max": 18.30411164713264}, "info": {"num_steps_trained": 11139083, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012861581519246101, "total_loss": 11.036698341369629, "vf_loss": 11.040376663208008, "policy_loss": -0.008018854074180126, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9458330869674683, "entropy": 1.1681160926818848}, "load_time_ms": 6.734, "grad_time_ms": 9361.536, "update_time_ms": 7.486, "num_steps_sampled": 11139083, "sample_time_ms": 14954.082}, "episode_len_mean": 678.55, "time_this_iter_s": 24.78287672996521, "num_metric_batches_dropped": 0, "timesteps_total": 11139083, "hostname": "flow-main", "episodes_total": 4519, "timestamp": 1557229364, "episode_reward_max": 1212.0147440954454, "episodes_this_iter": 17, "time_total_s": 6753.901297330856, "time_since_restore": 6753.901297330856}
{"timesteps_since_restore": 11180408, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41325, "date": "2019-05-07_11-43-09", "episode_reward_min": 58.29872219295833, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc914e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca3ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91cc0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 271, "episode_reward_mean": 1036.7260884427064, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 271, "custom_metrics": {"outflow_rate_max": 1481.825225974026, "cost2_mean": -19.917590889359026, "cost1_mean": 344.33303509365834, "system_level_velocity_mean": 13.724274624945378, "cost2_min": -28.108680868616858, "cost1_max": 424.72885416540873, "cost1_min": 32.799862691884826, "cost2_max": -7.926690873027828, "outflow_rate_mean": 1175.319829467055, "system_level_velocity_min": 11.489648218712466, "outflow_rate_min": 326.22109501059714, "system_level_velocity_max": 18.30411164713264}, "info": {"num_steps_trained": 11180408, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01120488066226244, "total_loss": 10.924567222595215, "vf_loss": 10.928078651428223, "policy_loss": -0.007292511872947216, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.9469223618507385, "entropy": 1.2009469270706177}, "load_time_ms": 6.731, "grad_time_ms": 9402.374, "update_time_ms": 7.641, "num_steps_sampled": 11180408, "sample_time_ms": 14982.811}, "episode_len_mean": 674.08, "time_this_iter_s": 25.282697200775146, "num_metric_batches_dropped": 0, "timesteps_total": 11180408, "hostname": "flow-main", "episodes_total": 4535, "timestamp": 1557229389, "episode_reward_max": 1212.0147440954454, "episodes_this_iter": 16, "time_total_s": 6779.1839945316315, "time_since_restore": 6779.1839945316315}
{"timesteps_since_restore": 11222436, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42028, "date": "2019-05-07_11-43-33", "episode_reward_min": 58.29872219295833, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3f60>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 272, "episode_reward_mean": 1043.7247152092878, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 272, "custom_metrics": {"outflow_rate_max": 1481.825225974026, "cost2_mean": -19.99093027560949, "cost1_mean": 344.8057127298453, "system_level_velocity_mean": 13.624809135446515, "cost2_min": -29.429328768572645, "cost1_max": 424.72885416540873, "cost1_min": 32.799862691884826, "cost2_max": -7.926690873027828, "outflow_rate_mean": 1170.9604940858276, "system_level_velocity_min": 11.31105275330311, "outflow_rate_min": 326.22109501059714, "system_level_velocity_max": 18.30411164713264}, "info": {"num_steps_trained": 11222436, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012149891816079617, "total_loss": 9.955571174621582, "vf_loss": 9.959827423095703, "policy_loss": -0.008355241268873215, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9509130120277405, "entropy": 1.1956967115402222}, "load_time_ms": 7.186, "grad_time_ms": 9438.294, "update_time_ms": 7.551, "num_steps_sampled": 11222436, "sample_time_ms": 14929.785}, "episode_len_mean": 679.05, "time_this_iter_s": 23.993438959121704, "num_metric_batches_dropped": 0, "timesteps_total": 11222436, "hostname": "flow-main", "episodes_total": 4550, "timestamp": 1557229413, "episode_reward_max": 1212.0147440954454, "episodes_this_iter": 15, "time_total_s": 6803.177433490753, "time_since_restore": 6803.177433490753}
{"timesteps_since_restore": 11264381, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41945, "date": "2019-05-07_11-43-59", "episode_reward_min": 58.29872219295833, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c208>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 273, "episode_reward_mean": 1047.3545691277454, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 273, "custom_metrics": {"outflow_rate_max": 1481.825225974026, "cost2_mean": -20.03402899903847, "cost1_mean": 345.23925030399784, "system_level_velocity_mean": 13.511962838908524, "cost2_min": -29.429328768572645, "cost1_max": 424.72885416540873, "cost1_min": 32.799862691884826, "cost2_max": -7.926690873027828, "outflow_rate_mean": 1170.9786532728203, "system_level_velocity_min": 11.31105275330311, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.30411164713264}, "info": {"num_steps_trained": 11264381, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011620772071182728, "total_loss": 9.8348388671875, "vf_loss": 9.839316368103027, "policy_loss": -0.00840019341558218, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.958774745464325, "entropy": 1.1963589191436768}, "load_time_ms": 7.345, "grad_time_ms": 9563.78, "update_time_ms": 7.499, "num_steps_sampled": 11264381, "sample_time_ms": 14919.848}, "episode_len_mean": 683.61, "time_this_iter_s": 25.772145748138428, "num_metric_batches_dropped": 0, "timesteps_total": 11264381, "hostname": "flow-main", "episodes_total": 4566, "timestamp": 1557229439, "episode_reward_max": 1212.0147440954454, "episodes_this_iter": 16, "time_total_s": 6828.949579238892, "time_since_restore": 6828.949579238892}
{"timesteps_since_restore": 11306261, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41880, "date": "2019-05-07_11-44-25", "episode_reward_min": 58.29872219295833, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f8d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 274, "episode_reward_mean": 1034.0421740603167, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 274, "custom_metrics": {"outflow_rate_max": 1481.825225974026, "cost2_mean": -20.045041420296567, "cost1_mean": 340.0012195038829, "system_level_velocity_mean": 13.588036354949223, "cost2_min": -29.429328768572645, "cost1_max": 438.12164297426784, "cost1_min": 32.799862691884826, "cost2_max": -7.926690873027828, "outflow_rate_mean": 1154.5887781616873, "system_level_velocity_min": 11.31105275330311, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.30411164713264}, "info": {"num_steps_trained": 11306261, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01291149016469717, "total_loss": 17.200307846069336, "vf_loss": 17.20380210876465, "policy_loss": -0.007851526141166687, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.922434389591217, "entropy": 1.2018154859542847}, "load_time_ms": 6.999, "grad_time_ms": 9676.407, "update_time_ms": 7.483, "num_steps_sampled": 11306261, "sample_time_ms": 14876.114}, "episode_len_mean": 672.21, "time_this_iter_s": 25.44831681251526, "num_metric_batches_dropped": 0, "timesteps_total": 11306261, "hostname": "flow-main", "episodes_total": 4583, "timestamp": 1557229465, "episode_reward_max": 1222.0339427587223, "episodes_this_iter": 17, "time_total_s": 6854.397896051407, "time_since_restore": 6854.397896051407}
{"timesteps_since_restore": 11347377, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41116, "date": "2019-05-07_11-44-48", "episode_reward_min": 58.29872219295833, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cb70>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 275, "episode_reward_mean": 1042.0108512272197, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 275, "custom_metrics": {"outflow_rate_max": 1481.825225974026, "cost2_mean": -20.495200721972072, "cost1_mean": 340.5144210998598, "system_level_velocity_mean": 13.514797362608688, "cost2_min": -29.429328768572645, "cost1_max": 438.12164297426784, "cost1_min": 32.799862691884826, "cost2_max": -7.926690873027828, "outflow_rate_mean": 1152.0645686797736, "system_level_velocity_min": 11.31105275330311, "outflow_rate_min": 332.7571298140349, "system_level_velocity_max": 18.30411164713264}, "info": {"num_steps_trained": 11347377, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011244592256844044, "total_loss": 8.289703369140625, "vf_loss": 8.293061256408691, "policy_loss": -0.00715287821367383, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.9638183116912842, "entropy": 1.203788161277771}, "load_time_ms": 7.43, "grad_time_ms": 9683.021, "update_time_ms": 7.592, "num_steps_sampled": 11347377, "sample_time_ms": 14840.522}, "episode_len_mean": 675.7, "time_this_iter_s": 23.747530221939087, "num_metric_batches_dropped": 0, "timesteps_total": 11347377, "hostname": "flow-main", "episodes_total": 4601, "timestamp": 1557229488, "episode_reward_max": 1222.0339427587223, "episodes_this_iter": 18, "time_total_s": 6878.145426273346, "time_since_restore": 6878.145426273346}
{"timesteps_since_restore": 11388709, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41332, "date": "2019-05-07_11-45-13", "episode_reward_min": 157.02346408963612, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbc18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbcc0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 276, "episode_reward_mean": 1049.487217346881, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 276, "custom_metrics": {"outflow_rate_max": 1481.825225974026, "cost2_mean": -20.69528156473062, "cost1_mean": 341.8605838994974, "system_level_velocity_mean": 13.527157847097039, "cost2_min": -37.989402288659306, "cost1_max": 438.12164297426784, "cost1_min": 71.80338792568149, "cost2_max": -10.239291896052967, "outflow_rate_mean": 1157.056560162148, "system_level_velocity_min": 11.31105275330311, "outflow_rate_min": 432.8095179342499, "system_level_velocity_max": 17.629232224660104}, "info": {"num_steps_trained": 11388709, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011618576012551785, "total_loss": 9.373618125915527, "vf_loss": 9.377228736877441, "policy_loss": -0.007532467599958181, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.9608647227287292, "entropy": 1.2048591375350952}, "load_time_ms": 7.419, "grad_time_ms": 9719.416, "update_time_ms": 7.483, "num_steps_sampled": 11388709, "sample_time_ms": 14773.328}, "episode_len_mean": 677.33, "time_this_iter_s": 24.334638357162476, "num_metric_batches_dropped": 0, "timesteps_total": 11388709, "hostname": "flow-main", "episodes_total": 4619, "timestamp": 1557229513, "episode_reward_max": 1222.0339427587223, "episodes_this_iter": 18, "time_total_s": 6902.480064630508, "time_since_restore": 6902.480064630508}
{"timesteps_since_restore": 11432681, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 43972, "date": "2019-05-07_11-45-38", "episode_reward_min": 157.02346408963612, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb9e8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 277, "episode_reward_mean": 1057.2641761872471, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 277, "custom_metrics": {"outflow_rate_max": 1401.5668663336662, "cost2_mean": -20.87562860732298, "cost1_mean": 343.03493987745475, "system_level_velocity_mean": 13.463337674536026, "cost2_min": -37.989402288659306, "cost1_max": 438.12164297426784, "cost1_min": 71.80338792568149, "cost2_max": -10.239291896052967, "outflow_rate_mean": 1157.401989610676, "system_level_velocity_min": 11.31105275330311, "outflow_rate_min": 432.8095179342499, "system_level_velocity_max": 17.629232224660104}, "info": {"num_steps_trained": 11432681, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013685624115169048, "total_loss": 6.265450477600098, "vf_loss": 6.26738166809082, "policy_loss": -0.006550001911818981, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.970509946346283, "entropy": 1.1822752952575684}, "load_time_ms": 7.341, "grad_time_ms": 9862.318, "update_time_ms": 7.23, "num_steps_sampled": 11432681, "sample_time_ms": 14759.133}, "episode_len_mean": 681.8, "time_this_iter_s": 25.39224100112915, "num_metric_batches_dropped": 0, "timesteps_total": 11432681, "hostname": "flow-main", "episodes_total": 4631, "timestamp": 1557229538, "episode_reward_max": 1222.0339427587223, "episodes_this_iter": 12, "time_total_s": 6927.872305631638, "time_since_restore": 6927.872305631638}
{"timesteps_since_restore": 11475163, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42482, "date": "2019-05-07_11-46-03", "episode_reward_min": 157.02346408963612, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb70f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb76d8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 278, "episode_reward_mean": 1050.2044408598665, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 278, "custom_metrics": {"outflow_rate_max": 1401.5668663336662, "cost2_mean": -21.067419708222943, "cost1_mean": 339.8830059186766, "system_level_velocity_mean": 13.458593951534436, "cost2_min": -37.989402288659306, "cost1_max": 438.12164297426784, "cost1_min": 71.80338792568149, "cost2_max": -10.239291896052967, "outflow_rate_mean": 1149.3304635413022, "system_level_velocity_min": 10.612667082893752, "outflow_rate_min": 432.8095179342499, "system_level_velocity_max": 17.629232224660104}, "info": {"num_steps_trained": 11475163, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01277973037213087, "total_loss": 8.337150573730469, "vf_loss": 8.340867042541504, "policy_loss": -0.008029131218791008, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.9615932106971741, "entropy": 1.2139015197753906}, "load_time_ms": 7.296, "grad_time_ms": 9931.226, "update_time_ms": 7.197, "num_steps_sampled": 11475163, "sample_time_ms": 14683.278}, "episode_len_mean": 676.81, "time_this_iter_s": 24.510857820510864, "num_metric_batches_dropped": 0, "timesteps_total": 11475163, "hostname": "flow-main", "episodes_total": 4646, "timestamp": 1557229563, "episode_reward_max": 1222.0339427587223, "episodes_this_iter": 15, "time_total_s": 6952.383163452148, "time_since_restore": 6952.383163452148}
{"timesteps_since_restore": 11516954, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41791, "date": "2019-05-07_11-46-28", "episode_reward_min": 157.02346408963612, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb549e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb70b8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 279, "episode_reward_mean": 1056.0787916821967, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 279, "custom_metrics": {"outflow_rate_max": 1401.5668663336662, "cost2_mean": -21.510361380000848, "cost1_mean": 340.4833511506187, "system_level_velocity_mean": 13.437287456346041, "cost2_min": -37.989402288659306, "cost1_max": 438.12164297426784, "cost1_min": 71.80338792568149, "cost2_max": -10.239291896052967, "outflow_rate_mean": 1147.1818330365713, "system_level_velocity_min": 10.612667082893752, "outflow_rate_min": 432.8095179342499, "system_level_velocity_max": 17.629232224660104}, "info": {"num_steps_trained": 11516954, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01096985675394535, "total_loss": 9.711044311523438, "vf_loss": 9.714095115661621, "policy_loss": -0.006752133369445801, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9575037956237793, "entropy": 1.2041078805923462}, "load_time_ms": 7.414, "grad_time_ms": 9937.817, "update_time_ms": 7.183, "num_steps_sampled": 11516954, "sample_time_ms": 14825.627}, "episode_len_mean": 678.74, "time_this_iter_s": 25.420303344726562, "num_metric_batches_dropped": 0, "timesteps_total": 11516954, "hostname": "flow-main", "episodes_total": 4665, "timestamp": 1557229588, "episode_reward_max": 1222.0339427587223, "episodes_this_iter": 19, "time_total_s": 6977.803466796875, "time_since_restore": 6977.803466796875}
{"timesteps_since_restore": 11559114, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42160, "date": "2019-05-07_11-46-53", "episode_reward_min": 246.4287504680828, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4ffd0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 280, "episode_reward_mean": 1065.8768304620364, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 280, "custom_metrics": {"outflow_rate_max": 1347.2264787212787, "cost2_mean": -21.939300072240083, "cost1_mean": 340.1686243134173, "system_level_velocity_mean": 13.269183459706833, "cost2_min": -37.989402288659306, "cost1_max": 402.8735668504301, "cost1_min": 103.99611545262218, "cost2_max": -11.348027052011297, "outflow_rate_mean": 1144.5682500249218, "system_level_velocity_min": 10.612667082893752, "outflow_rate_min": 528.3775531563086, "system_level_velocity_max": 17.661539981215395}, "info": {"num_steps_trained": 11559114, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011485115624964237, "total_loss": 7.611996650695801, "vf_loss": 7.61625337600708, "policy_loss": -0.008133523166179657, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9665436148643494, "entropy": 1.1686077117919922}, "load_time_ms": 7.318, "grad_time_ms": 9904.337, "update_time_ms": 7.341, "num_steps_sampled": 11559114, "sample_time_ms": 14890.834}, "episode_len_mean": 684.71, "time_this_iter_s": 25.081250429153442, "num_metric_batches_dropped": 0, "timesteps_total": 11559114, "hostname": "flow-main", "episodes_total": 4681, "timestamp": 1557229613, "episode_reward_max": 1206.9513822432532, "episodes_this_iter": 16, "time_total_s": 7002.884717226028, "time_since_restore": 7002.884717226028}
{"timesteps_since_restore": 11600501, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41387, "date": "2019-05-07_11-47-17", "episode_reward_min": 246.4287504680828, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb540f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54ac8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 281, "episode_reward_mean": 1063.6215288480112, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 281, "custom_metrics": {"outflow_rate_max": 1347.2264787212787, "cost2_mean": -22.001307675253624, "cost1_mean": 339.25246521810993, "system_level_velocity_mean": 13.226694014039952, "cost2_min": -37.989402288659306, "cost1_max": 402.8735668504301, "cost1_min": 103.99611545262218, "cost2_max": -11.348027052011297, "outflow_rate_mean": 1143.136866028918, "system_level_velocity_min": 10.612667082893752, "outflow_rate_min": 528.3775531563086, "system_level_velocity_max": 17.661539981215395}, "info": {"num_steps_trained": 11600501, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01241768803447485, "total_loss": 8.838936805725098, "vf_loss": 8.842255592346191, "policy_loss": -0.007510138209909201, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9578235745429993, "entropy": 1.2040612697601318}, "load_time_ms": 7.4, "grad_time_ms": 9954.145, "update_time_ms": 7.236, "num_steps_sampled": 11600501, "sample_time_ms": 14711.572}, "episode_len_mean": 684.71, "time_this_iter_s": 23.980997562408447, "num_metric_batches_dropped": 0, "timesteps_total": 11600501, "hostname": "flow-main", "episodes_total": 4694, "timestamp": 1557229637, "episode_reward_max": 1222.6292221659487, "episodes_this_iter": 13, "time_total_s": 7026.865714788437, "time_since_restore": 7026.865714788437}
{"timesteps_since_restore": 11642681, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42180, "date": "2019-05-07_11-47-42", "episode_reward_min": 193.2420794589601, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbba8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 282, "episode_reward_mean": 1062.105585163645, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 282, "custom_metrics": {"outflow_rate_max": 1436.9315404595407, "cost2_mean": -21.851154050615634, "cost1_mean": 338.65868502177335, "system_level_velocity_mean": 13.224156097171706, "cost2_min": -37.989402288659306, "cost1_max": 420.3086907578298, "cost1_min": 75.11355977908256, "cost2_max": -11.244455035983087, "outflow_rate_mean": 1144.7611144550929, "system_level_velocity_min": 10.612667082893752, "outflow_rate_min": 413.8912465430808, "system_level_velocity_max": 17.661539981215395}, "info": {"num_steps_trained": 11642681, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012578257359564304, "total_loss": 16.182994842529297, "vf_loss": 16.186176300048828, "policy_loss": -0.007425335235893726, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9289300441741943, "entropy": 1.2111178636550903}, "load_time_ms": 7.424, "grad_time_ms": 10041.089, "update_time_ms": 7.355, "num_steps_sampled": 11642681, "sample_time_ms": 14665.698}, "episode_len_mean": 683.75, "time_this_iter_s": 24.43116331100464, "num_metric_batches_dropped": 0, "timesteps_total": 11642681, "hostname": "flow-main", "episodes_total": 4712, "timestamp": 1557229662, "episode_reward_max": 1222.6292221659487, "episodes_this_iter": 18, "time_total_s": 7051.2968780994415, "time_since_restore": 7051.2968780994415}
{"timesteps_since_restore": 11684331, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41650, "date": "2019-05-07_11-48-05", "episode_reward_min": 193.2420794589601, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb542e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0240>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 283, "episode_reward_mean": 1053.939114087844, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 283, "custom_metrics": {"outflow_rate_max": 1436.9315404595407, "cost2_mean": -20.944606798054064, "cost1_mean": 337.0561459721061, "system_level_velocity_mean": 13.305013145876314, "cost2_min": -29.459760413437785, "cost1_max": 420.3086907578298, "cost1_min": 75.11355977908256, "cost2_max": -11.244455035983087, "outflow_rate_mean": 1144.3339848166738, "system_level_velocity_min": 10.612667082893752, "outflow_rate_min": 413.8912465430808, "system_level_velocity_max": 17.661539981215395}, "info": {"num_steps_trained": 11684331, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013527906499803066, "total_loss": 10.838960647583008, "vf_loss": 10.843076705932617, "policy_loss": -0.008681665174663067, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9536728858947754, "entropy": 1.2248390913009644}, "load_time_ms": 7.309, "grad_time_ms": 10011.567, "update_time_ms": 7.539, "num_steps_sampled": 11684331, "sample_time_ms": 14457.15}, "episode_len_mean": 678.16, "time_this_iter_s": 23.38576078414917, "num_metric_batches_dropped": 0, "timesteps_total": 11684331, "hostname": "flow-main", "episodes_total": 4727, "timestamp": 1557229685, "episode_reward_max": 1222.6292221659487, "episodes_this_iter": 15, "time_total_s": 7074.682638883591, "time_since_restore": 7074.682638883591}
{"timesteps_since_restore": 11725499, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41168, "date": "2019-05-07_11-48-30", "episode_reward_min": 50.81141322936432, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb542b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54048>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 284, "episode_reward_mean": 1051.6349932721723, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 284, "custom_metrics": {"outflow_rate_max": 1436.9315404595407, "cost2_mean": -20.582055766748308, "cost1_mean": 336.9631210052211, "system_level_velocity_mean": 13.363660165194068, "cost2_min": -28.710962651051155, "cost1_max": 420.3086907578298, "cost1_min": 27.678368342222125, "cost2_max": -7.57553909179989, "outflow_rate_mean": 1146.7984546170574, "system_level_velocity_min": 11.078503343503705, "outflow_rate_min": 338.35525222187107, "system_level_velocity_max": 18.935213790978622}, "info": {"num_steps_trained": 11725499, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012846509926021099, "total_loss": 11.760826110839844, "vf_loss": 11.764162063598633, "policy_loss": -0.007672017440199852, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.9500106573104858, "entropy": 1.2245004177093506}, "load_time_ms": 7.624, "grad_time_ms": 9984.719, "update_time_ms": 7.61, "num_steps_sampled": 11725499, "sample_time_ms": 14400.949}, "episode_len_mean": 676.58, "time_this_iter_s": 24.645526885986328, "num_metric_batches_dropped": 0, "timesteps_total": 11725499, "hostname": "flow-main", "episodes_total": 4746, "timestamp": 1557229710, "episode_reward_max": 1222.6292221659487, "episodes_this_iter": 19, "time_total_s": 7099.328165769577, "time_since_restore": 7099.328165769577}
{"timesteps_since_restore": 11767186, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41687, "date": "2019-05-07_11-48-55", "episode_reward_min": 50.81141322936432, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54240>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 285, "episode_reward_mean": 1019.4208405858865, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 285, "custom_metrics": {"outflow_rate_max": 1436.9315404595407, "cost2_mean": -19.82527541299004, "cost1_mean": 331.3406687564025, "system_level_velocity_mean": 13.621333068974284, "cost2_min": -27.40504709218212, "cost1_max": 420.3086907578298, "cost1_min": 27.678368342222125, "cost2_max": -7.534581464733548, "outflow_rate_mean": 1132.983771869835, "system_level_velocity_min": 11.078503343503705, "outflow_rate_min": 337.7301442378166, "system_level_velocity_max": 18.935213790978622}, "info": {"num_steps_trained": 11767186, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012330973520874977, "total_loss": 15.762118339538574, "vf_loss": 15.766828536987305, "policy_loss": -0.008872654289007187, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9310274720191956, "entropy": 1.2431309223175049}, "load_time_ms": 7.756, "grad_time_ms": 10078.653, "update_time_ms": 7.739, "num_steps_sampled": 11767186, "sample_time_ms": 14413.211}, "episode_len_mean": 658.52, "time_this_iter_s": 24.84258270263672, "num_metric_batches_dropped": 0, "timesteps_total": 11767186, "hostname": "flow-main", "episodes_total": 4766, "timestamp": 1557229735, "episode_reward_max": 1222.6292221659487, "episodes_this_iter": 20, "time_total_s": 7124.170748472214, "time_since_restore": 7124.170748472214}
{"timesteps_since_restore": 11809824, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42638, "date": "2019-05-07_11-49-20", "episode_reward_min": 50.81141322936432, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91978>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 286, "episode_reward_mean": 1015.9588941459032, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 286, "custom_metrics": {"outflow_rate_max": 1436.9315404595407, "cost2_mean": -19.962391731874916, "cost1_mean": 331.50880103619943, "system_level_velocity_mean": 13.634238347281919, "cost2_min": -31.708348159253596, "cost1_max": 420.3086907578298, "cost1_min": 27.678368342222125, "cost2_max": -7.534581464733548, "outflow_rate_mean": 1135.8284696560486, "system_level_velocity_min": 11.078503343503705, "outflow_rate_min": 337.7301442378166, "system_level_velocity_max": 18.935213790978622}, "info": {"num_steps_trained": 11809824, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011489774100482464, "total_loss": 7.535887241363525, "vf_loss": 7.539959907531738, "policy_loss": -0.007950881496071815, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.965398371219635, "entropy": 1.2188043594360352}, "load_time_ms": 7.736, "grad_time_ms": 10192.216, "update_time_ms": 8.048, "num_steps_sampled": 11809824, "sample_time_ms": 14441.027}, "episode_len_mean": 658.52, "time_this_iter_s": 25.748226165771484, "num_metric_batches_dropped": 0, "timesteps_total": 11809824, "hostname": "flow-main", "episodes_total": 4779, "timestamp": 1557229760, "episode_reward_max": 1222.6292221659487, "episodes_this_iter": 13, "time_total_s": 7149.918974637985, "time_since_restore": 7149.918974637985}
{"timesteps_since_restore": 11852533, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42709, "date": "2019-05-07_11-49-45", "episode_reward_min": 50.81141322936432, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fc91dd8>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 287, "episode_reward_mean": 1025.4029134092636, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 287, "custom_metrics": {"outflow_rate_max": 1436.9315404595407, "cost2_mean": -19.643642322128915, "cost1_mean": 334.434053837863, "system_level_velocity_mean": 13.6105550059991, "cost2_min": -31.708348159253596, "cost1_max": 420.3086907578298, "cost1_min": 27.678368342222125, "cost2_max": -7.534581464733548, "outflow_rate_mean": 1141.1268908477623, "system_level_velocity_min": 11.099504746909128, "outflow_rate_min": 337.7301442378166, "system_level_velocity_max": 18.935213790978622}, "info": {"num_steps_trained": 11852533, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012685981579124928, "total_loss": 9.91159439086914, "vf_loss": 9.914765357971191, "policy_loss": -0.007453443016856909, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.952743411064148, "entropy": 1.2075796127319336}, "load_time_ms": 7.307, "grad_time_ms": 10186.891, "update_time_ms": 8.089, "num_steps_sampled": 11852533, "sample_time_ms": 14395.417}, "episode_len_mean": 663.95, "time_this_iter_s": 24.89220142364502, "num_metric_batches_dropped": 0, "timesteps_total": 11852533, "hostname": "flow-main", "episodes_total": 4795, "timestamp": 1557229785, "episode_reward_max": 1213.842466859022, "episodes_this_iter": 16, "time_total_s": 7174.81117606163, "time_since_restore": 7174.81117606163}
{"timesteps_since_restore": 11894899, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42366, "date": "2019-05-07_11-50-10", "episode_reward_min": 50.81141322936432, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb540b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb549e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54da0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 288, "episode_reward_mean": 1025.5543272122047, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 288, "custom_metrics": {"outflow_rate_max": 1372.155253946054, "cost2_mean": -20.131326289454773, "cost1_mean": 335.59396885013166, "system_level_velocity_mean": 13.50475979440103, "cost2_min": -35.52232315519045, "cost1_max": 409.89582565118656, "cost1_min": 27.678368342222125, "cost2_max": -7.534581464733548, "outflow_rate_mean": 1142.3491822304836, "system_level_velocity_min": 10.860619340708906, "outflow_rate_min": 337.7301442378166, "system_level_velocity_max": 18.935213790978622}, "info": {"num_steps_trained": 11894899, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012327332980930805, "total_loss": 9.0685453414917, "vf_loss": 9.07284164428711, "policy_loss": -0.008456041105091572, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9578661322593689, "entropy": 1.2164572477340698}, "load_time_ms": 7.267, "grad_time_ms": 10175.83, "update_time_ms": 8.309, "num_steps_sampled": 11894899, "sample_time_ms": 14427.114}, "episode_len_mean": 669.78, "time_this_iter_s": 24.731468677520752, "num_metric_batches_dropped": 0, "timesteps_total": 11894899, "hostname": "flow-main", "episodes_total": 4811, "timestamp": 1557229810, "episode_reward_max": 1212.4056874228302, "episodes_this_iter": 16, "time_total_s": 7199.542644739151, "time_since_restore": 7199.542644739151}
{"timesteps_since_restore": 11936789, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41890, "date": "2019-05-07_11-50-35", "episode_reward_min": 50.81141322936432, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3a90>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 289, "episode_reward_mean": 1037.4090002564287, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 289, "custom_metrics": {"outflow_rate_max": 1372.155253946054, "cost2_mean": -20.431165314586288, "cost1_mean": 336.4013050644406, "system_level_velocity_mean": 13.373560204433108, "cost2_min": -35.52232315519045, "cost1_max": 410.7579977140856, "cost1_min": 27.678368342222125, "cost2_max": -7.534581464733548, "outflow_rate_mean": 1144.4399339787922, "system_level_velocity_min": 10.860619340708906, "outflow_rate_min": 337.7301442378166, "system_level_velocity_max": 18.935213790978622}, "info": {"num_steps_trained": 11936789, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011829865165054798, "total_loss": 10.55272388458252, "vf_loss": 10.55605697631836, "policy_loss": -0.007325101178139448, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9411546587944031, "entropy": 1.2434033155441284}, "load_time_ms": 7.097, "grad_time_ms": 10168.67, "update_time_ms": 8.415, "num_steps_sampled": 11936789, "sample_time_ms": 14329.452}, "episode_len_mean": 675.37, "time_this_iter_s": 24.372130632400513, "num_metric_batches_dropped": 0, "timesteps_total": 11936789, "hostname": "flow-main", "episodes_total": 4826, "timestamp": 1557229835, "episode_reward_max": 1212.4056874228302, "episodes_this_iter": 15, "time_total_s": 7223.9147753715515, "time_since_restore": 7223.9147753715515}
{"timesteps_since_restore": 11977850, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41061, "date": "2019-05-07_11-50-59", "episode_reward_min": 54.35616054141645, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb545c0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 290, "episode_reward_mean": 1037.0141581839764, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 290, "custom_metrics": {"outflow_rate_max": 1372.155253946054, "cost2_mean": -20.460975251580432, "cost1_mean": 335.5508850110702, "system_level_velocity_mean": 13.278530470676767, "cost2_min": -35.52232315519045, "cost1_max": 410.7579977140856, "cost1_min": 29.438454710128283, "cost2_max": -7.534581464733548, "outflow_rate_mean": 1140.702592004859, "system_level_velocity_min": 10.860619340708906, "outflow_rate_min": 337.7301442378166, "system_level_velocity_max": 18.759242394496066}, "info": {"num_steps_trained": 11977850, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014985481277108192, "total_loss": 10.975074768066406, "vf_loss": 10.977934837341309, "policy_loss": -0.007917872630059719, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9447532892227173, "entropy": 1.2586814165115356}, "load_time_ms": 7.057, "grad_time_ms": 10191.567, "update_time_ms": 8.334, "num_steps_sampled": 11977850, "sample_time_ms": 14248.446}, "episode_len_mean": 676.64, "time_this_iter_s": 24.496901273727417, "num_metric_batches_dropped": 0, "timesteps_total": 11977850, "hostname": "flow-main", "episodes_total": 4843, "timestamp": 1557229859, "episode_reward_max": 1212.4056874228302, "episodes_this_iter": 17, "time_total_s": 7248.411676645279, "time_since_restore": 7248.411676645279}
{"timesteps_since_restore": 12019606, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41756, "date": "2019-05-07_11-51-24", "episode_reward_min": 54.35616054141645, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb7ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb548d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb71d0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 291, "episode_reward_mean": 1051.6724544014025, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 291, "custom_metrics": {"outflow_rate_max": 1370.6785550449551, "cost2_mean": -20.640535263804573, "cost1_mean": 337.06415802077646, "system_level_velocity_mean": 13.179221822110291, "cost2_min": -35.52232315519045, "cost1_max": 410.7579977140856, "cost1_min": 29.438454710128283, "cost2_max": -7.534581464733548, "outflow_rate_mean": 1148.9378193877656, "system_level_velocity_min": 10.860619340708906, "outflow_rate_min": 337.7301442378166, "system_level_velocity_max": 18.759242394496066}, "info": {"num_steps_trained": 12019606, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0118341576308012, "total_loss": 9.087841033935547, "vf_loss": 9.090835571289062, "policy_loss": -0.006988354027271271, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9539937376976013, "entropy": 1.2563090324401855}, "load_time_ms": 6.953, "grad_time_ms": 10221.46, "update_time_ms": 8.377, "num_steps_sampled": 12019606, "sample_time_ms": 14295.295}, "episode_len_mean": 682.39, "time_this_iter_s": 24.74923586845398, "num_metric_batches_dropped": 0, "timesteps_total": 12019606, "hostname": "flow-main", "episodes_total": 4859, "timestamp": 1557229884, "episode_reward_max": 1212.4056874228302, "episodes_this_iter": 16, "time_total_s": 7273.160912513733, "time_since_restore": 7273.160912513733}
{"timesteps_since_restore": 12061648, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42042, "date": "2019-05-07_11-51-49", "episode_reward_min": 246.57488577096308, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4fd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f198>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 292, "episode_reward_mean": 1071.2302653058318, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 292, "custom_metrics": {"outflow_rate_max": 1370.6785550449551, "cost2_mean": -20.320705193973126, "cost1_mean": 343.60378885409693, "system_level_velocity_mean": 13.096493721277708, "cost2_min": -35.52232315519045, "cost1_max": 410.7579977140856, "cost1_min": 107.86933208104531, "cost2_max": -13.200924477005248, "outflow_rate_mean": 1166.275374172661, "system_level_velocity_min": 10.860619340708906, "outflow_rate_min": 571.1195978854806, "system_level_velocity_max": 17.157506532900783}, "info": {"num_steps_trained": 12061648, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012694262899458408, "total_loss": 9.569341659545898, "vf_loss": 9.572857856750488, "policy_loss": -0.007800315972417593, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9525904059410095, "entropy": 1.2508398294448853}, "load_time_ms": 6.922, "grad_time_ms": 10152.579, "update_time_ms": 8.411, "num_steps_sampled": 12061648, "sample_time_ms": 14401.231}, "episode_len_mean": 694.7, "time_this_iter_s": 24.79124665260315, "num_metric_batches_dropped": 0, "timesteps_total": 12061648, "hostname": "flow-main", "episodes_total": 4875, "timestamp": 1557229909, "episode_reward_max": 1197.4778475550381, "episodes_this_iter": 16, "time_total_s": 7297.952159166336, "time_since_restore": 7297.952159166336}
{"timesteps_since_restore": 12104035, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42387, "date": "2019-05-07_11-52-14", "episode_reward_min": 246.57488577096308, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca6a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 293, "episode_reward_mean": 1063.328200791848, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 293, "custom_metrics": {"outflow_rate_max": 1340.1187732267733, "cost2_mean": -20.124536740632603, "cost1_mean": 340.80682905465767, "system_level_velocity_mean": 13.099898078342319, "cost2_min": -35.52232315519045, "cost1_max": 410.7579977140856, "cost1_min": 107.86933208104531, "cost2_max": -12.053460970894402, "outflow_rate_mean": 1157.719513039633, "system_level_velocity_min": 10.860619340708906, "outflow_rate_min": 571.1195978854806, "system_level_velocity_max": 17.157506532900783}, "info": {"num_steps_trained": 12104035, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01142636127769947, "total_loss": 9.92519760131836, "vf_loss": 9.930170059204102, "policy_loss": -0.008829210884869099, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.9549520015716553, "entropy": 1.239618182182312}, "load_time_ms": 6.885, "grad_time_ms": 10089.646, "update_time_ms": 8.353, "num_steps_sampled": 12104035, "sample_time_ms": 14659.798}, "episode_len_mean": 689.95, "time_this_iter_s": 25.339043855667114, "num_metric_batches_dropped": 0, "timesteps_total": 12104035, "hostname": "flow-main", "episodes_total": 4892, "timestamp": 1557229934, "episode_reward_max": 1197.4778475550381, "episodes_this_iter": 17, "time_total_s": 7323.291203022003, "time_since_restore": 7323.291203022003}
{"timesteps_since_restore": 12145950, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41915, "date": "2019-05-07_11-52-39", "episode_reward_min": 246.57488577096308, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb548d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb54198>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 294, "episode_reward_mean": 1061.4085366658758, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 294, "custom_metrics": {"outflow_rate_max": 1359.265735064935, "cost2_mean": -19.859398471143006, "cost1_mean": 340.0189975907322, "system_level_velocity_mean": 13.076247247207892, "cost2_min": -35.52232315519045, "cost1_max": 410.7579977140856, "cost1_min": 107.86933208104531, "cost2_max": -12.053460970894402, "outflow_rate_mean": 1154.9136383183547, "system_level_velocity_min": 10.860619340708906, "outflow_rate_min": 571.1195978854806, "system_level_velocity_max": 17.157506532900783}, "info": {"num_steps_trained": 12145950, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011506989598274231, "total_loss": 10.90786075592041, "vf_loss": 10.912760734558105, "policy_loss": -0.008783286437392235, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9512121677398682, "entropy": 1.2405285835266113}, "load_time_ms": 6.892, "grad_time_ms": 9991.656, "update_time_ms": 8.351, "num_steps_sampled": 12145950, "sample_time_ms": 14788.766}, "episode_len_mean": 689.95, "time_this_iter_s": 24.929826736450195, "num_metric_batches_dropped": 0, "timesteps_total": 12145950, "hostname": "flow-main", "episodes_total": 4907, "timestamp": 1557229959, "episode_reward_max": 1213.970499222718, "episodes_this_iter": 15, "time_total_s": 7348.221029758453, "time_since_restore": 7348.221029758453}
{"timesteps_since_restore": 12187584, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41634, "date": "2019-05-07_11-53-03", "episode_reward_min": 48.89989220222494, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbbe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4f588>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 295, "episode_reward_mean": 1047.3077068310936, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 295, "custom_metrics": {"outflow_rate_max": 1403.4468619380618, "cost2_mean": -19.546964926263012, "cost1_mean": 338.69475802608866, "system_level_velocity_mean": 13.22031873110727, "cost2_min": -26.65838644715445, "cost1_max": 407.8577222298998, "cost1_min": 28.470860566506936, "cost2_max": -9.229416343607571, "outflow_rate_mean": 1151.6918980910905, "system_level_velocity_min": 11.025776983670681, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 18.87744874513484}, "info": {"num_steps_trained": 12187584, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010519777424633503, "total_loss": 12.5564546585083, "vf_loss": 12.559133529663086, "policy_loss": -0.006230073980987072, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9394472241401672, "entropy": 1.2742688655853271}, "load_time_ms": 6.678, "grad_time_ms": 9832.027, "update_time_ms": 8.414, "num_steps_sampled": 12187584, "sample_time_ms": 14891.549}, "episode_len_mean": 683.38, "time_this_iter_s": 24.238426685333252, "num_metric_batches_dropped": 0, "timesteps_total": 12187584, "hostname": "flow-main", "episodes_total": 4924, "timestamp": 1557229983, "episode_reward_max": 1213.970499222718, "episodes_this_iter": 17, "time_total_s": 7372.459456443787, "time_since_restore": 7372.459456443787}
{"timesteps_since_restore": 12228363, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40779, "date": "2019-05-07_11-53-27", "episode_reward_min": 48.89989220222494, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb32e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb3358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcb0a58>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 296, "episode_reward_mean": 1056.8237791116321, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 296, "custom_metrics": {"outflow_rate_max": 1431.8685542457542, "cost2_mean": -19.481697369884206, "cost1_mean": 342.4880600501899, "system_level_velocity_mean": 13.254120997371931, "cost2_min": -26.65838644715445, "cost1_max": 415.1488838279608, "cost1_min": 28.470860566506936, "cost2_max": -9.229416343607571, "outflow_rate_mean": 1161.295006575772, "system_level_velocity_min": 11.31317484981524, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 18.87744874513484}, "info": {"num_steps_trained": 12228363, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012982924468815327, "total_loss": 12.532268524169922, "vf_loss": 12.536138534545898, "policy_loss": -0.008250989019870758, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9406977295875549, "entropy": 1.272620439529419}, "load_time_ms": 6.689, "grad_time_ms": 9601.242, "update_time_ms": 8.267, "num_steps_sampled": 12228363, "sample_time_ms": 14970.087}, "episode_len_mean": 688.68, "time_this_iter_s": 24.227688312530518, "num_metric_batches_dropped": 0, "timesteps_total": 12228363, "hostname": "flow-main", "episodes_total": 4940, "timestamp": 1557230007, "episode_reward_max": 1213.970499222718, "episodes_this_iter": 16, "time_total_s": 7396.687144756317, "time_since_restore": 7396.687144756317}
{"timesteps_since_restore": 12269044, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 40681, "date": "2019-05-07_11-53-54", "episode_reward_min": 48.85688810778151, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fca35c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb898>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 297, "episode_reward_mean": 1040.5601260549658, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 297, "custom_metrics": {"outflow_rate_max": 1431.8685542457542, "cost2_mean": -19.325476554502544, "cost1_mean": 340.1315847816179, "system_level_velocity_mean": 13.370094233009791, "cost2_min": -30.747521763999625, "cost1_max": 415.1488838279608, "cost1_min": 28.470860566506936, "cost2_max": -9.229416343607571, "outflow_rate_mean": 1152.7962032648486, "system_level_velocity_min": 10.527349403517382, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.383342744760878}, "info": {"num_steps_trained": 12269044, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012969264760613441, "total_loss": 12.807412147521973, "vf_loss": 12.81218147277832, "policy_loss": -0.009144915267825127, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.9416418075561523, "entropy": 1.2705413103103638}, "load_time_ms": 6.975, "grad_time_ms": 9408.813, "update_time_ms": 8.233, "num_steps_sampled": 12269044, "sample_time_ms": 15312.881}, "episode_len_mean": 682.11, "time_this_iter_s": 26.389623165130615, "num_metric_batches_dropped": 0, "timesteps_total": 12269044, "hostname": "flow-main", "episodes_total": 4959, "timestamp": 1557230034, "episode_reward_max": 1213.970499222718, "episodes_this_iter": 19, "time_total_s": 7423.076767921448, "time_since_restore": 7423.076767921448}
{"timesteps_since_restore": 12310526, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41482, "date": "2019-05-07_11-54-19", "episode_reward_min": 48.85688810778151, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c9b0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 298, "episode_reward_mean": 1036.343850471793, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 298, "custom_metrics": {"outflow_rate_max": 1431.8685542457542, "cost2_mean": -19.37652735545397, "cost1_mean": 341.0095684063347, "system_level_velocity_mean": 13.417865220077966, "cost2_min": -30.747521763999625, "cost1_max": 415.1488838279608, "cost1_min": 28.470860566506936, "cost2_max": -9.229416343607571, "outflow_rate_mean": 1157.338147624489, "system_level_velocity_min": 10.527349403517382, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.383342744760878}, "info": {"num_steps_trained": 12310526, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012406365014612675, "total_loss": 11.527847290039062, "vf_loss": 11.532673835754395, "policy_loss": -0.009013951756060123, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9405765533447266, "entropy": 1.2686594724655151}, "load_time_ms": 6.958, "grad_time_ms": 9342.982, "update_time_ms": 8.342, "num_steps_sampled": 12310526, "sample_time_ms": 15458.837}, "episode_len_mean": 682.11, "time_this_iter_s": 25.541033506393433, "num_metric_batches_dropped": 0, "timesteps_total": 12310526, "hostname": "flow-main", "episodes_total": 4974, "timestamp": 1557230059, "episode_reward_max": 1213.970499222718, "episodes_this_iter": 15, "time_total_s": 7448.617801427841, "time_since_restore": 7448.617801427841}
{"timesteps_since_restore": 12352810, "done": false, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 42284, "date": "2019-05-07_11-54-45", "episode_reward_min": 48.85688810778151, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4c5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fb4cf28>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 299, "episode_reward_mean": 1037.264842539226, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 299, "custom_metrics": {"outflow_rate_max": 1431.8685542457542, "cost2_mean": -19.248552484507947, "cost1_mean": 341.6551945529268, "system_level_velocity_mean": 13.455246259096834, "cost2_min": -30.747521763999625, "cost1_max": 415.1488838279608, "cost1_min": 28.470860566506936, "cost2_max": -9.229416343607571, "outflow_rate_mean": 1162.3854155086046, "system_level_velocity_min": 10.527349403517382, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.383342744760878}, "info": {"num_steps_trained": 12352810, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010991618037223816, "total_loss": 9.660626411437988, "vf_loss": 9.663576126098633, "policy_loss": -0.006658471655100584, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9485429525375366, "entropy": 1.2599291801452637}, "load_time_ms": 7.07, "grad_time_ms": 9265.922, "update_time_ms": 8.402, "num_steps_sampled": 12352810, "sample_time_ms": 15619.637}, "episode_len_mean": 682.11, "time_this_iter_s": 25.2135169506073, "num_metric_batches_dropped": 0, "timesteps_total": 12352810, "hostname": "flow-main", "episodes_total": 4988, "timestamp": 1557230085, "episode_reward_max": 1213.970499222718, "episodes_this_iter": 14, "time_total_s": 7473.8313183784485, "time_since_restore": 7473.8313183784485}
{"timesteps_since_restore": 12394540, "done": true, "node_ip": "10.138.0.2", "pid": 12022, "timesteps_this_iter": 41730, "date": "2019-05-07_11-55-09", "episode_reward_min": 48.85688810778151, "config": {"custom_resources_per_worker": {}, "input": "sampler", "sgd_minibatch_size": 128, "output_compress_columns": ["obs", "new_obs"], "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "straggler_mitigation": false, "optimizer": {}, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "kl_coeff": 0.2, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "squash_to_range": false, "conv_filters": null, "lstm_cell_size": 256, "grayscale": false, "zero_mean": true, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.3, 0.0]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbb898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcbbfd0>"}, "gamma": 0.99, "horizon": 1500, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "input_evaluation": null, "num_gpus": 0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "training_iteration": 300, "episode_reward_mean": 1039.2028201896094, "experiment_id": "de1357677bc24818a769a61cd90fe395", "policy_reward_mean": {}, "iterations_since_restore": 300, "custom_metrics": {"outflow_rate_max": 1431.8685542457542, "cost2_mean": -19.141775586063485, "cost1_mean": 342.1898747691267, "system_level_velocity_mean": 13.518207426763762, "cost2_min": -30.747521763999625, "cost1_max": 415.1488838279608, "cost1_min": 28.470860566506936, "cost2_max": -9.229416343607571, "outflow_rate_mean": 1162.5109161244716, "system_level_velocity_min": 10.527349403517382, "outflow_rate_min": 336.6808336172199, "system_level_velocity_max": 19.383342744760878}, "info": {"num_steps_trained": 12394540, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012737337499856949, "total_loss": 12.223237037658691, "vf_loss": 12.226380348205566, "policy_loss": -0.007442843168973923, "cur_kl_coeff": 0.33750003576278687, "vf_explained_var": 0.9413186311721802, "entropy": 1.2669501304626465}, "load_time_ms": 7.051, "grad_time_ms": 9193.064, "update_time_ms": 8.436, "num_steps_sampled": 12394540, "sample_time_ms": 15700.004}, "episode_len_mean": 681.1, "time_this_iter_s": 24.56703519821167, "num_metric_batches_dropped": 0, "timesteps_total": 12394540, "hostname": "flow-main", "episodes_total": 5006, "timestamp": 1557230109, "episode_reward_max": 1194.889791850862, "episodes_this_iter": 18, "time_total_s": 7498.39835357666, "time_since_restore": 7498.39835357666}
